var WN=Object.defineProperty;var HN=(t,e,n)=>e in t?WN(t,e,{enumerable:!0,configurable:!0,writable:!0,value:n}):t[e]=n;var q=(t,e,n)=>HN(t,typeof e!="symbol"?e+"":e,n);(function(){const e=document.createElement("link").relList;if(e&&e.supports&&e.supports("modulepreload"))return;for(const i of document.querySelectorAll('link[rel="modulepreload"]'))r(i);new MutationObserver(i=>{for(const s of i)if(s.type==="childList")for(const o of s.addedNodes)o.tagName==="LINK"&&o.rel==="modulepreload"&&r(o)}).observe(document,{childList:!0,subtree:!0});function n(i){const s={};return i.integrity&&(s.integrity=i.integrity),i.referrerPolicy&&(s.referrerPolicy=i.referrerPolicy),i.crossOrigin==="use-credentials"?s.credentials="include":i.crossOrigin==="anonymous"?s.credentials="omit":s.credentials="same-origin",s}function r(i){if(i.ep)return;i.ep=!0;const s=n(i);fetch(i.href,s)}})();var po=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};function Za(t){return t&&t.__esModule&&Object.prototype.hasOwnProperty.call(t,"default")?t.default:t}var LI={exports:{}},Im={},kI={exports:{}},je={};/**
 * @license React
 * react.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var Rh=Symbol.for("react.element"),KN=Symbol.for("react.portal"),YN=Symbol.for("react.fragment"),XN=Symbol.for("react.strict_mode"),ZN=Symbol.for("react.profiler"),qN=Symbol.for("react.provider"),JN=Symbol.for("react.context"),QN=Symbol.for("react.forward_ref"),ej=Symbol.for("react.suspense"),tj=Symbol.for("react.memo"),nj=Symbol.for("react.lazy"),Wb=Symbol.iterator;function rj(t){return t===null||typeof t!="object"?null:(t=Wb&&t[Wb]||t["@@iterator"],typeof t=="function"?t:null)}var MI={isMounted:function(){return!1},enqueueForceUpdate:function(){},enqueueReplaceState:function(){},enqueueSetState:function(){}},DI=Object.assign,NI={};function Jc(t,e,n){this.props=t,this.context=e,this.refs=NI,this.updater=n||MI}Jc.prototype.isReactComponent={};Jc.prototype.setState=function(t,e){if(typeof t!="object"&&typeof t!="function"&&t!=null)throw Error("setState(...): takes an object of state variables to update or a function which returns an object of state variables.");this.updater.enqueueSetState(this,t,e,"setState")};Jc.prototype.forceUpdate=function(t){this.updater.enqueueForceUpdate(this,t,"forceUpdate")};function jI(){}jI.prototype=Jc.prototype;function vx(t,e,n){this.props=t,this.context=e,this.refs=NI,this.updater=n||MI}var wx=vx.prototype=new jI;wx.constructor=vx;DI(wx,Jc.prototype);wx.isPureReactComponent=!0;var Hb=Array.isArray,zI=Object.prototype.hasOwnProperty,xx={current:null},UI={key:!0,ref:!0,__self:!0,__source:!0};function GI(t,e,n){var r,i={},s=null,o=null;if(e!=null)for(r in e.ref!==void 0&&(o=e.ref),e.key!==void 0&&(s=""+e.key),e)zI.call(e,r)&&!UI.hasOwnProperty(r)&&(i[r]=e[r]);var a=arguments.length-2;if(a===1)i.children=n;else if(1<a){for(var l=Array(a),c=0;c<a;c++)l[c]=arguments[c+2];i.children=l}if(t&&t.defaultProps)for(r in a=t.defaultProps,a)i[r]===void 0&&(i[r]=a[r]);return{$$typeof:Rh,type:t,key:s,ref:o,props:i,_owner:xx.current}}function ij(t,e){return{$$typeof:Rh,type:t.type,key:e,ref:t.ref,props:t.props,_owner:t._owner}}function Ex(t){return typeof t=="object"&&t!==null&&t.$$typeof===Rh}function sj(t){var e={"=":"=0",":":"=2"};return"$"+t.replace(/[=:]/g,function(n){return e[n]})}var Kb=/\/+/g;function m_(t,e){return typeof t=="object"&&t!==null&&t.key!=null?sj(""+t.key):e.toString(36)}function Sg(t,e,n,r,i){var s=typeof t;(s==="undefined"||s==="boolean")&&(t=null);var o=!1;if(t===null)o=!0;else switch(s){case"string":case"number":o=!0;break;case"object":switch(t.$$typeof){case Rh:case KN:o=!0}}if(o)return o=t,i=i(o),t=r===""?"."+m_(o,0):r,Hb(i)?(n="",t!=null&&(n=t.replace(Kb,"$&/")+"/"),Sg(i,e,n,"",function(c){return c})):i!=null&&(Ex(i)&&(i=ij(i,n+(!i.key||o&&o.key===i.key?"":(""+i.key).replace(Kb,"$&/")+"/")+t)),e.push(i)),1;if(o=0,r=r===""?".":r+":",Hb(t))for(var a=0;a<t.length;a++){s=t[a];var l=r+m_(s,a);o+=Sg(s,e,n,l,i)}else if(l=rj(t),typeof l=="function")for(t=l.call(t),a=0;!(s=t.next()).done;)s=s.value,l=r+m_(s,a++),o+=Sg(s,e,n,l,i);else if(s==="object")throw e=String(t),Error("Objects are not valid as a React child (found: "+(e==="[object Object]"?"object with keys {"+Object.keys(t).join(", ")+"}":e)+"). If you meant to render a collection of children, use an array instead.");return o}function uf(t,e,n){if(t==null)return t;var r=[],i=0;return Sg(t,r,"","",function(s){return e.call(n,s,i++)}),r}function oj(t){if(t._status===-1){var e=t._result;e=e(),e.then(function(n){(t._status===0||t._status===-1)&&(t._status=1,t._result=n)},function(n){(t._status===0||t._status===-1)&&(t._status=2,t._result=n)}),t._status===-1&&(t._status=0,t._result=e)}if(t._status===1)return t._result.default;throw t._result}var Hn={current:null},bg={transition:null},aj={ReactCurrentDispatcher:Hn,ReactCurrentBatchConfig:bg,ReactCurrentOwner:xx};function BI(){throw Error("act(...) is not supported in production builds of React.")}je.Children={map:uf,forEach:function(t,e,n){uf(t,function(){e.apply(this,arguments)},n)},count:function(t){var e=0;return uf(t,function(){e++}),e},toArray:function(t){return uf(t,function(e){return e})||[]},only:function(t){if(!Ex(t))throw Error("React.Children.only expected to receive a single React element child.");return t}};je.Component=Jc;je.Fragment=YN;je.Profiler=ZN;je.PureComponent=vx;je.StrictMode=XN;je.Suspense=ej;je.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=aj;je.act=BI;je.cloneElement=function(t,e,n){if(t==null)throw Error("React.cloneElement(...): The argument must be a React element, but you passed "+t+".");var r=DI({},t.props),i=t.key,s=t.ref,o=t._owner;if(e!=null){if(e.ref!==void 0&&(s=e.ref,o=xx.current),e.key!==void 0&&(i=""+e.key),t.type&&t.type.defaultProps)var a=t.type.defaultProps;for(l in e)zI.call(e,l)&&!UI.hasOwnProperty(l)&&(r[l]=e[l]===void 0&&a!==void 0?a[l]:e[l])}var l=arguments.length-2;if(l===1)r.children=n;else if(1<l){a=Array(l);for(var c=0;c<l;c++)a[c]=arguments[c+2];r.children=a}return{$$typeof:Rh,type:t.type,key:i,ref:s,props:r,_owner:o}};je.createContext=function(t){return t={$$typeof:JN,_currentValue:t,_currentValue2:t,_threadCount:0,Provider:null,Consumer:null,_defaultValue:null,_globalName:null},t.Provider={$$typeof:qN,_context:t},t.Consumer=t};je.createElement=GI;je.createFactory=function(t){var e=GI.bind(null,t);return e.type=t,e};je.createRef=function(){return{current:null}};je.forwardRef=function(t){return{$$typeof:QN,render:t}};je.isValidElement=Ex;je.lazy=function(t){return{$$typeof:nj,_payload:{_status:-1,_result:t},_init:oj}};je.memo=function(t,e){return{$$typeof:tj,type:t,compare:e===void 0?null:e}};je.startTransition=function(t){var e=bg.transition;bg.transition={};try{t()}finally{bg.transition=e}};je.unstable_act=BI;je.useCallback=function(t,e){return Hn.current.useCallback(t,e)};je.useContext=function(t){return Hn.current.useContext(t)};je.useDebugValue=function(){};je.useDeferredValue=function(t){return Hn.current.useDeferredValue(t)};je.useEffect=function(t,e){return Hn.current.useEffect(t,e)};je.useId=function(){return Hn.current.useId()};je.useImperativeHandle=function(t,e,n){return Hn.current.useImperativeHandle(t,e,n)};je.useInsertionEffect=function(t,e){return Hn.current.useInsertionEffect(t,e)};je.useLayoutEffect=function(t,e){return Hn.current.useLayoutEffect(t,e)};je.useMemo=function(t,e){return Hn.current.useMemo(t,e)};je.useReducer=function(t,e,n){return Hn.current.useReducer(t,e,n)};je.useRef=function(t){return Hn.current.useRef(t)};je.useState=function(t){return Hn.current.useState(t)};je.useSyncExternalStore=function(t,e,n){return Hn.current.useSyncExternalStore(t,e,n)};je.useTransition=function(){return Hn.current.useTransition()};je.version="18.3.1";kI.exports=je;var K=kI.exports;const VI=Za(K);/**
 * @license React
 * react-jsx-runtime.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var lj=K,cj=Symbol.for("react.element"),uj=Symbol.for("react.fragment"),dj=Object.prototype.hasOwnProperty,hj=lj.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED.ReactCurrentOwner,fj={key:!0,ref:!0,__self:!0,__source:!0};function WI(t,e,n){var r,i={},s=null,o=null;n!==void 0&&(s=""+n),e.key!==void 0&&(s=""+e.key),e.ref!==void 0&&(o=e.ref);for(r in e)dj.call(e,r)&&!fj.hasOwnProperty(r)&&(i[r]=e[r]);if(t&&t.defaultProps)for(r in e=t.defaultProps,e)i[r]===void 0&&(i[r]=e[r]);return{$$typeof:cj,type:t,key:s,ref:o,props:i,_owner:hj.current}}Im.Fragment=uj;Im.jsx=WI;Im.jsxs=WI;LI.exports=Im;var E=LI.exports,HI={exports:{}},Sr={},KI={exports:{}},YI={};/**
 * @license React
 * scheduler.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */(function(t){function e(U,B){var N=U.length;U.push(B);e:for(;0<N;){var O=N-1>>>1,$=U[O];if(0<i($,B))U[O]=B,U[N]=$,N=O;else break e}}function n(U){return U.length===0?null:U[0]}function r(U){if(U.length===0)return null;var B=U[0],N=U.pop();if(N!==B){U[0]=N;e:for(var O=0,$=U.length,G=$>>>1;O<G;){var R=2*(O+1)-1,L=U[R],W=R+1,te=U[W];if(0>i(L,N))W<$&&0>i(te,L)?(U[O]=te,U[W]=N,O=W):(U[O]=L,U[R]=N,O=R);else if(W<$&&0>i(te,N))U[O]=te,U[W]=N,O=W;else break e}}return B}function i(U,B){var N=U.sortIndex-B.sortIndex;return N!==0?N:U.id-B.id}if(typeof performance=="object"&&typeof performance.now=="function"){var s=performance;t.unstable_now=function(){return s.now()}}else{var o=Date,a=o.now();t.unstable_now=function(){return o.now()-a}}var l=[],c=[],u=1,d=null,h=3,f=!1,p=!1,m=!1,_=typeof setTimeout=="function"?setTimeout:null,g=typeof clearTimeout=="function"?clearTimeout:null,y=typeof setImmediate<"u"?setImmediate:null;typeof navigator<"u"&&navigator.scheduling!==void 0&&navigator.scheduling.isInputPending!==void 0&&navigator.scheduling.isInputPending.bind(navigator.scheduling);function v(U){for(var B=n(c);B!==null;){if(B.callback===null)r(c);else if(B.startTime<=U)r(c),B.sortIndex=B.expirationTime,e(l,B);else break;B=n(c)}}function w(U){if(m=!1,v(U),!p)if(n(l)!==null)p=!0,V(x);else{var B=n(c);B!==null&&H(w,B.startTime-U)}}function x(U,B){p=!1,m&&(m=!1,g(T),T=-1),f=!0;var N=h;try{for(v(B),d=n(l);d!==null&&(!(d.expirationTime>B)||U&&!k());){var O=d.callback;if(typeof O=="function"){d.callback=null,h=d.priorityLevel;var $=O(d.expirationTime<=B);B=t.unstable_now(),typeof $=="function"?d.callback=$:d===n(l)&&r(l),v(B)}else r(l);d=n(l)}if(d!==null)var G=!0;else{var R=n(c);R!==null&&H(w,R.startTime-B),G=!1}return G}finally{d=null,h=N,f=!1}}var S=!1,C=null,T=-1,P=5,F=-1;function k(){return!(t.unstable_now()-F<P)}function A(){if(C!==null){var U=t.unstable_now();F=U;var B=!0;try{B=C(!0,U)}finally{B?M():(S=!1,C=null)}}else S=!1}var M;if(typeof y=="function")M=function(){y(A)};else if(typeof MessageChannel<"u"){var b=new MessageChannel,j=b.port2;b.port1.onmessage=A,M=function(){j.postMessage(null)}}else M=function(){_(A,0)};function V(U){C=U,S||(S=!0,M())}function H(U,B){T=_(function(){U(t.unstable_now())},B)}t.unstable_IdlePriority=5,t.unstable_ImmediatePriority=1,t.unstable_LowPriority=4,t.unstable_NormalPriority=3,t.unstable_Profiling=null,t.unstable_UserBlockingPriority=2,t.unstable_cancelCallback=function(U){U.callback=null},t.unstable_continueExecution=function(){p||f||(p=!0,V(x))},t.unstable_forceFrameRate=function(U){0>U||125<U?console.error("forceFrameRate takes a positive int between 0 and 125, forcing frame rates higher than 125 fps is not supported"):P=0<U?Math.floor(1e3/U):5},t.unstable_getCurrentPriorityLevel=function(){return h},t.unstable_getFirstCallbackNode=function(){return n(l)},t.unstable_next=function(U){switch(h){case 1:case 2:case 3:var B=3;break;default:B=h}var N=h;h=B;try{return U()}finally{h=N}},t.unstable_pauseExecution=function(){},t.unstable_requestPaint=function(){},t.unstable_runWithPriority=function(U,B){switch(U){case 1:case 2:case 3:case 4:case 5:break;default:U=3}var N=h;h=U;try{return B()}finally{h=N}},t.unstable_scheduleCallback=function(U,B,N){var O=t.unstable_now();switch(typeof N=="object"&&N!==null?(N=N.delay,N=typeof N=="number"&&0<N?O+N:O):N=O,U){case 1:var $=-1;break;case 2:$=250;break;case 5:$=1073741823;break;case 4:$=1e4;break;default:$=5e3}return $=N+$,U={id:u++,callback:B,priorityLevel:U,startTime:N,expirationTime:$,sortIndex:-1},N>O?(U.sortIndex=N,e(c,U),n(l)===null&&U===n(c)&&(m?(g(T),T=-1):m=!0,H(w,N-O))):(U.sortIndex=$,e(l,U),p||f||(p=!0,V(x))),U},t.unstable_shouldYield=k,t.unstable_wrapCallback=function(U){var B=h;return function(){var N=h;h=B;try{return U.apply(this,arguments)}finally{h=N}}}})(YI);KI.exports=YI;var gj=KI.exports;/**
 * @license React
 * react-dom.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var pj=K,xr=gj;function oe(t){for(var e="https://reactjs.org/docs/error-decoder.html?invariant="+t,n=1;n<arguments.length;n++)e+="&args[]="+encodeURIComponent(arguments[n]);return"Minified React error #"+t+"; visit "+e+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}var XI=new Set,jd={};function qa(t,e){Tc(t,e),Tc(t+"Capture",e)}function Tc(t,e){for(jd[t]=e,t=0;t<e.length;t++)XI.add(e[t])}var $s=!(typeof window>"u"||typeof window.document>"u"||typeof window.document.createElement>"u"),hv=Object.prototype.hasOwnProperty,mj=/^[:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD][:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD\-.0-9\u00B7\u0300-\u036F\u203F-\u2040]*$/,Yb={},Xb={};function yj(t){return hv.call(Xb,t)?!0:hv.call(Yb,t)?!1:mj.test(t)?Xb[t]=!0:(Yb[t]=!0,!1)}function _j(t,e,n,r){if(n!==null&&n.type===0)return!1;switch(typeof e){case"function":case"symbol":return!0;case"boolean":return r?!1:n!==null?!n.acceptsBooleans:(t=t.toLowerCase().slice(0,5),t!=="data-"&&t!=="aria-");default:return!1}}function vj(t,e,n,r){if(e===null||typeof e>"u"||_j(t,e,n,r))return!0;if(r)return!1;if(n!==null)switch(n.type){case 3:return!e;case 4:return e===!1;case 5:return isNaN(e);case 6:return isNaN(e)||1>e}return!1}function Kn(t,e,n,r,i,s,o){this.acceptsBooleans=e===2||e===3||e===4,this.attributeName=r,this.attributeNamespace=i,this.mustUseProperty=n,this.propertyName=t,this.type=e,this.sanitizeURL=s,this.removeEmptyString=o}var bn={};"children dangerouslySetInnerHTML defaultValue defaultChecked innerHTML suppressContentEditableWarning suppressHydrationWarning style".split(" ").forEach(function(t){bn[t]=new Kn(t,0,!1,t,null,!1,!1)});[["acceptCharset","accept-charset"],["className","class"],["htmlFor","for"],["httpEquiv","http-equiv"]].forEach(function(t){var e=t[0];bn[e]=new Kn(e,1,!1,t[1],null,!1,!1)});["contentEditable","draggable","spellCheck","value"].forEach(function(t){bn[t]=new Kn(t,2,!1,t.toLowerCase(),null,!1,!1)});["autoReverse","externalResourcesRequired","focusable","preserveAlpha"].forEach(function(t){bn[t]=new Kn(t,2,!1,t,null,!1,!1)});"allowFullScreen async autoFocus autoPlay controls default defer disabled disablePictureInPicture disableRemotePlayback formNoValidate hidden loop noModule noValidate open playsInline readOnly required reversed scoped seamless itemScope".split(" ").forEach(function(t){bn[t]=new Kn(t,3,!1,t.toLowerCase(),null,!1,!1)});["checked","multiple","muted","selected"].forEach(function(t){bn[t]=new Kn(t,3,!0,t,null,!1,!1)});["capture","download"].forEach(function(t){bn[t]=new Kn(t,4,!1,t,null,!1,!1)});["cols","rows","size","span"].forEach(function(t){bn[t]=new Kn(t,6,!1,t,null,!1,!1)});["rowSpan","start"].forEach(function(t){bn[t]=new Kn(t,5,!1,t.toLowerCase(),null,!1,!1)});var Sx=/[\-:]([a-z])/g;function bx(t){return t[1].toUpperCase()}"accent-height alignment-baseline arabic-form baseline-shift cap-height clip-path clip-rule color-interpolation color-interpolation-filters color-profile color-rendering dominant-baseline enable-background fill-opacity fill-rule flood-color flood-opacity font-family font-size font-size-adjust font-stretch font-style font-variant font-weight glyph-name glyph-orientation-horizontal glyph-orientation-vertical horiz-adv-x horiz-origin-x image-rendering letter-spacing lighting-color marker-end marker-mid marker-start overline-position overline-thickness paint-order panose-1 pointer-events rendering-intent shape-rendering stop-color stop-opacity strikethrough-position strikethrough-thickness stroke-dasharray stroke-dashoffset stroke-linecap stroke-linejoin stroke-miterlimit stroke-opacity stroke-width text-anchor text-decoration text-rendering underline-position underline-thickness unicode-bidi unicode-range units-per-em v-alphabetic v-hanging v-ideographic v-mathematical vector-effect vert-adv-y vert-origin-x vert-origin-y word-spacing writing-mode xmlns:xlink x-height".split(" ").forEach(function(t){var e=t.replace(Sx,bx);bn[e]=new Kn(e,1,!1,t,null,!1,!1)});"xlink:actuate xlink:arcrole xlink:role xlink:show xlink:title xlink:type".split(" ").forEach(function(t){var e=t.replace(Sx,bx);bn[e]=new Kn(e,1,!1,t,"http://www.w3.org/1999/xlink",!1,!1)});["xml:base","xml:lang","xml:space"].forEach(function(t){var e=t.replace(Sx,bx);bn[e]=new Kn(e,1,!1,t,"http://www.w3.org/XML/1998/namespace",!1,!1)});["tabIndex","crossOrigin"].forEach(function(t){bn[t]=new Kn(t,1,!1,t.toLowerCase(),null,!1,!1)});bn.xlinkHref=new Kn("xlinkHref",1,!1,"xlink:href","http://www.w3.org/1999/xlink",!0,!1);["src","href","action","formAction"].forEach(function(t){bn[t]=new Kn(t,1,!1,t.toLowerCase(),null,!0,!0)});function Cx(t,e,n,r){var i=bn.hasOwnProperty(e)?bn[e]:null;(i!==null?i.type!==0:r||!(2<e.length)||e[0]!=="o"&&e[0]!=="O"||e[1]!=="n"&&e[1]!=="N")&&(vj(e,n,i,r)&&(n=null),r||i===null?yj(e)&&(n===null?t.removeAttribute(e):t.setAttribute(e,""+n)):i.mustUseProperty?t[i.propertyName]=n===null?i.type===3?!1:"":n:(e=i.attributeName,r=i.attributeNamespace,n===null?t.removeAttribute(e):(i=i.type,n=i===3||i===4&&n===!0?"":""+n,r?t.setAttributeNS(r,e,n):t.setAttribute(e,n))))}var Gs=pj.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED,df=Symbol.for("react.element"),Ul=Symbol.for("react.portal"),Gl=Symbol.for("react.fragment"),Tx=Symbol.for("react.strict_mode"),fv=Symbol.for("react.profiler"),ZI=Symbol.for("react.provider"),qI=Symbol.for("react.context"),Px=Symbol.for("react.forward_ref"),gv=Symbol.for("react.suspense"),pv=Symbol.for("react.suspense_list"),Rx=Symbol.for("react.memo"),co=Symbol.for("react.lazy"),JI=Symbol.for("react.offscreen"),Zb=Symbol.iterator;function Au(t){return t===null||typeof t!="object"?null:(t=Zb&&t[Zb]||t["@@iterator"],typeof t=="function"?t:null)}var Mt=Object.assign,y_;function nd(t){if(y_===void 0)try{throw Error()}catch(n){var e=n.stack.trim().match(/\n( *(at )?)/);y_=e&&e[1]||""}return`
`+y_+t}var __=!1;function v_(t,e){if(!t||__)return"";__=!0;var n=Error.prepareStackTrace;Error.prepareStackTrace=void 0;try{if(e)if(e=function(){throw Error()},Object.defineProperty(e.prototype,"props",{set:function(){throw Error()}}),typeof Reflect=="object"&&Reflect.construct){try{Reflect.construct(e,[])}catch(c){var r=c}Reflect.construct(t,[],e)}else{try{e.call()}catch(c){r=c}t.call(e.prototype)}else{try{throw Error()}catch(c){r=c}t()}}catch(c){if(c&&r&&typeof c.stack=="string"){for(var i=c.stack.split(`
`),s=r.stack.split(`
`),o=i.length-1,a=s.length-1;1<=o&&0<=a&&i[o]!==s[a];)a--;for(;1<=o&&0<=a;o--,a--)if(i[o]!==s[a]){if(o!==1||a!==1)do if(o--,a--,0>a||i[o]!==s[a]){var l=`
`+i[o].replace(" at new "," at ");return t.displayName&&l.includes("<anonymous>")&&(l=l.replace("<anonymous>",t.displayName)),l}while(1<=o&&0<=a);break}}}finally{__=!1,Error.prepareStackTrace=n}return(t=t?t.displayName||t.name:"")?nd(t):""}function wj(t){switch(t.tag){case 5:return nd(t.type);case 16:return nd("Lazy");case 13:return nd("Suspense");case 19:return nd("SuspenseList");case 0:case 2:case 15:return t=v_(t.type,!1),t;case 11:return t=v_(t.type.render,!1),t;case 1:return t=v_(t.type,!0),t;default:return""}}function mv(t){if(t==null)return null;if(typeof t=="function")return t.displayName||t.name||null;if(typeof t=="string")return t;switch(t){case Gl:return"Fragment";case Ul:return"Portal";case fv:return"Profiler";case Tx:return"StrictMode";case gv:return"Suspense";case pv:return"SuspenseList"}if(typeof t=="object")switch(t.$$typeof){case qI:return(t.displayName||"Context")+".Consumer";case ZI:return(t._context.displayName||"Context")+".Provider";case Px:var e=t.render;return t=t.displayName,t||(t=e.displayName||e.name||"",t=t!==""?"ForwardRef("+t+")":"ForwardRef"),t;case Rx:return e=t.displayName||null,e!==null?e:mv(t.type)||"Memo";case co:e=t._payload,t=t._init;try{return mv(t(e))}catch{}}return null}function xj(t){var e=t.type;switch(t.tag){case 24:return"Cache";case 9:return(e.displayName||"Context")+".Consumer";case 10:return(e._context.displayName||"Context")+".Provider";case 18:return"DehydratedFragment";case 11:return t=e.render,t=t.displayName||t.name||"",e.displayName||(t!==""?"ForwardRef("+t+")":"ForwardRef");case 7:return"Fragment";case 5:return e;case 4:return"Portal";case 3:return"Root";case 6:return"Text";case 16:return mv(e);case 8:return e===Tx?"StrictMode":"Mode";case 22:return"Offscreen";case 12:return"Profiler";case 21:return"Scope";case 13:return"Suspense";case 19:return"SuspenseList";case 25:return"TracingMarker";case 1:case 0:case 17:case 2:case 14:case 15:if(typeof e=="function")return e.displayName||e.name||null;if(typeof e=="string")return e}return null}function No(t){switch(typeof t){case"boolean":case"number":case"string":case"undefined":return t;case"object":return t;default:return""}}function QI(t){var e=t.type;return(t=t.nodeName)&&t.toLowerCase()==="input"&&(e==="checkbox"||e==="radio")}function Ej(t){var e=QI(t)?"checked":"value",n=Object.getOwnPropertyDescriptor(t.constructor.prototype,e),r=""+t[e];if(!t.hasOwnProperty(e)&&typeof n<"u"&&typeof n.get=="function"&&typeof n.set=="function"){var i=n.get,s=n.set;return Object.defineProperty(t,e,{configurable:!0,get:function(){return i.call(this)},set:function(o){r=""+o,s.call(this,o)}}),Object.defineProperty(t,e,{enumerable:n.enumerable}),{getValue:function(){return r},setValue:function(o){r=""+o},stopTracking:function(){t._valueTracker=null,delete t[e]}}}}function hf(t){t._valueTracker||(t._valueTracker=Ej(t))}function eA(t){if(!t)return!1;var e=t._valueTracker;if(!e)return!0;var n=e.getValue(),r="";return t&&(r=QI(t)?t.checked?"true":"false":t.value),t=r,t!==n?(e.setValue(t),!0):!1}function np(t){if(t=t||(typeof document<"u"?document:void 0),typeof t>"u")return null;try{return t.activeElement||t.body}catch{return t.body}}function yv(t,e){var n=e.checked;return Mt({},e,{defaultChecked:void 0,defaultValue:void 0,value:void 0,checked:n??t._wrapperState.initialChecked})}function qb(t,e){var n=e.defaultValue==null?"":e.defaultValue,r=e.checked!=null?e.checked:e.defaultChecked;n=No(e.value!=null?e.value:n),t._wrapperState={initialChecked:r,initialValue:n,controlled:e.type==="checkbox"||e.type==="radio"?e.checked!=null:e.value!=null}}function tA(t,e){e=e.checked,e!=null&&Cx(t,"checked",e,!1)}function _v(t,e){tA(t,e);var n=No(e.value),r=e.type;if(n!=null)r==="number"?(n===0&&t.value===""||t.value!=n)&&(t.value=""+n):t.value!==""+n&&(t.value=""+n);else if(r==="submit"||r==="reset"){t.removeAttribute("value");return}e.hasOwnProperty("value")?vv(t,e.type,n):e.hasOwnProperty("defaultValue")&&vv(t,e.type,No(e.defaultValue)),e.checked==null&&e.defaultChecked!=null&&(t.defaultChecked=!!e.defaultChecked)}function Jb(t,e,n){if(e.hasOwnProperty("value")||e.hasOwnProperty("defaultValue")){var r=e.type;if(!(r!=="submit"&&r!=="reset"||e.value!==void 0&&e.value!==null))return;e=""+t._wrapperState.initialValue,n||e===t.value||(t.value=e),t.defaultValue=e}n=t.name,n!==""&&(t.name=""),t.defaultChecked=!!t._wrapperState.initialChecked,n!==""&&(t.name=n)}function vv(t,e,n){(e!=="number"||np(t.ownerDocument)!==t)&&(n==null?t.defaultValue=""+t._wrapperState.initialValue:t.defaultValue!==""+n&&(t.defaultValue=""+n))}var rd=Array.isArray;function ac(t,e,n,r){if(t=t.options,e){e={};for(var i=0;i<n.length;i++)e["$"+n[i]]=!0;for(n=0;n<t.length;n++)i=e.hasOwnProperty("$"+t[n].value),t[n].selected!==i&&(t[n].selected=i),i&&r&&(t[n].defaultSelected=!0)}else{for(n=""+No(n),e=null,i=0;i<t.length;i++){if(t[i].value===n){t[i].selected=!0,r&&(t[i].defaultSelected=!0);return}e!==null||t[i].disabled||(e=t[i])}e!==null&&(e.selected=!0)}}function wv(t,e){if(e.dangerouslySetInnerHTML!=null)throw Error(oe(91));return Mt({},e,{value:void 0,defaultValue:void 0,children:""+t._wrapperState.initialValue})}function Qb(t,e){var n=e.value;if(n==null){if(n=e.children,e=e.defaultValue,n!=null){if(e!=null)throw Error(oe(92));if(rd(n)){if(1<n.length)throw Error(oe(93));n=n[0]}e=n}e==null&&(e=""),n=e}t._wrapperState={initialValue:No(n)}}function nA(t,e){var n=No(e.value),r=No(e.defaultValue);n!=null&&(n=""+n,n!==t.value&&(t.value=n),e.defaultValue==null&&t.defaultValue!==n&&(t.defaultValue=n)),r!=null&&(t.defaultValue=""+r)}function eC(t){var e=t.textContent;e===t._wrapperState.initialValue&&e!==""&&e!==null&&(t.value=e)}function rA(t){switch(t){case"svg":return"http://www.w3.org/2000/svg";case"math":return"http://www.w3.org/1998/Math/MathML";default:return"http://www.w3.org/1999/xhtml"}}function xv(t,e){return t==null||t==="http://www.w3.org/1999/xhtml"?rA(e):t==="http://www.w3.org/2000/svg"&&e==="foreignObject"?"http://www.w3.org/1999/xhtml":t}var ff,iA=function(t){return typeof MSApp<"u"&&MSApp.execUnsafeLocalFunction?function(e,n,r,i){MSApp.execUnsafeLocalFunction(function(){return t(e,n,r,i)})}:t}(function(t,e){if(t.namespaceURI!=="http://www.w3.org/2000/svg"||"innerHTML"in t)t.innerHTML=e;else{for(ff=ff||document.createElement("div"),ff.innerHTML="<svg>"+e.valueOf().toString()+"</svg>",e=ff.firstChild;t.firstChild;)t.removeChild(t.firstChild);for(;e.firstChild;)t.appendChild(e.firstChild)}});function zd(t,e){if(e){var n=t.firstChild;if(n&&n===t.lastChild&&n.nodeType===3){n.nodeValue=e;return}}t.textContent=e}var hd={animationIterationCount:!0,aspectRatio:!0,borderImageOutset:!0,borderImageSlice:!0,borderImageWidth:!0,boxFlex:!0,boxFlexGroup:!0,boxOrdinalGroup:!0,columnCount:!0,columns:!0,flex:!0,flexGrow:!0,flexPositive:!0,flexShrink:!0,flexNegative:!0,flexOrder:!0,gridArea:!0,gridRow:!0,gridRowEnd:!0,gridRowSpan:!0,gridRowStart:!0,gridColumn:!0,gridColumnEnd:!0,gridColumnSpan:!0,gridColumnStart:!0,fontWeight:!0,lineClamp:!0,lineHeight:!0,opacity:!0,order:!0,orphans:!0,tabSize:!0,widows:!0,zIndex:!0,zoom:!0,fillOpacity:!0,floodOpacity:!0,stopOpacity:!0,strokeDasharray:!0,strokeDashoffset:!0,strokeMiterlimit:!0,strokeOpacity:!0,strokeWidth:!0},Sj=["Webkit","ms","Moz","O"];Object.keys(hd).forEach(function(t){Sj.forEach(function(e){e=e+t.charAt(0).toUpperCase()+t.substring(1),hd[e]=hd[t]})});function sA(t,e,n){return e==null||typeof e=="boolean"||e===""?"":n||typeof e!="number"||e===0||hd.hasOwnProperty(t)&&hd[t]?(""+e).trim():e+"px"}function oA(t,e){t=t.style;for(var n in e)if(e.hasOwnProperty(n)){var r=n.indexOf("--")===0,i=sA(n,e[n],r);n==="float"&&(n="cssFloat"),r?t.setProperty(n,i):t[n]=i}}var bj=Mt({menuitem:!0},{area:!0,base:!0,br:!0,col:!0,embed:!0,hr:!0,img:!0,input:!0,keygen:!0,link:!0,meta:!0,param:!0,source:!0,track:!0,wbr:!0});function Ev(t,e){if(e){if(bj[t]&&(e.children!=null||e.dangerouslySetInnerHTML!=null))throw Error(oe(137,t));if(e.dangerouslySetInnerHTML!=null){if(e.children!=null)throw Error(oe(60));if(typeof e.dangerouslySetInnerHTML!="object"||!("__html"in e.dangerouslySetInnerHTML))throw Error(oe(61))}if(e.style!=null&&typeof e.style!="object")throw Error(oe(62))}}function Sv(t,e){if(t.indexOf("-")===-1)return typeof e.is=="string";switch(t){case"annotation-xml":case"color-profile":case"font-face":case"font-face-src":case"font-face-uri":case"font-face-format":case"font-face-name":case"missing-glyph":return!1;default:return!0}}var bv=null;function Ix(t){return t=t.target||t.srcElement||window,t.correspondingUseElement&&(t=t.correspondingUseElement),t.nodeType===3?t.parentNode:t}var Cv=null,lc=null,cc=null;function tC(t){if(t=Fh(t)){if(typeof Cv!="function")throw Error(oe(280));var e=t.stateNode;e&&(e=Lm(e),Cv(t.stateNode,t.type,e))}}function aA(t){lc?cc?cc.push(t):cc=[t]:lc=t}function lA(){if(lc){var t=lc,e=cc;if(cc=lc=null,tC(t),e)for(t=0;t<e.length;t++)tC(e[t])}}function cA(t,e){return t(e)}function uA(){}var w_=!1;function dA(t,e,n){if(w_)return t(e,n);w_=!0;try{return cA(t,e,n)}finally{w_=!1,(lc!==null||cc!==null)&&(uA(),lA())}}function Ud(t,e){var n=t.stateNode;if(n===null)return null;var r=Lm(n);if(r===null)return null;n=r[e];e:switch(e){case"onClick":case"onClickCapture":case"onDoubleClick":case"onDoubleClickCapture":case"onMouseDown":case"onMouseDownCapture":case"onMouseMove":case"onMouseMoveCapture":case"onMouseUp":case"onMouseUpCapture":case"onMouseEnter":(r=!r.disabled)||(t=t.type,r=!(t==="button"||t==="input"||t==="select"||t==="textarea")),t=!r;break e;default:t=!1}if(t)return null;if(n&&typeof n!="function")throw Error(oe(231,e,typeof n));return n}var Tv=!1;if($s)try{var Fu={};Object.defineProperty(Fu,"passive",{get:function(){Tv=!0}}),window.addEventListener("test",Fu,Fu),window.removeEventListener("test",Fu,Fu)}catch{Tv=!1}function Cj(t,e,n,r,i,s,o,a,l){var c=Array.prototype.slice.call(arguments,3);try{e.apply(n,c)}catch(u){this.onError(u)}}var fd=!1,rp=null,ip=!1,Pv=null,Tj={onError:function(t){fd=!0,rp=t}};function Pj(t,e,n,r,i,s,o,a,l){fd=!1,rp=null,Cj.apply(Tj,arguments)}function Rj(t,e,n,r,i,s,o,a,l){if(Pj.apply(this,arguments),fd){if(fd){var c=rp;fd=!1,rp=null}else throw Error(oe(198));ip||(ip=!0,Pv=c)}}function Ja(t){var e=t,n=t;if(t.alternate)for(;e.return;)e=e.return;else{t=e;do e=t,e.flags&4098&&(n=e.return),t=e.return;while(t)}return e.tag===3?n:null}function hA(t){if(t.tag===13){var e=t.memoizedState;if(e===null&&(t=t.alternate,t!==null&&(e=t.memoizedState)),e!==null)return e.dehydrated}return null}function nC(t){if(Ja(t)!==t)throw Error(oe(188))}function Ij(t){var e=t.alternate;if(!e){if(e=Ja(t),e===null)throw Error(oe(188));return e!==t?null:t}for(var n=t,r=e;;){var i=n.return;if(i===null)break;var s=i.alternate;if(s===null){if(r=i.return,r!==null){n=r;continue}break}if(i.child===s.child){for(s=i.child;s;){if(s===n)return nC(i),t;if(s===r)return nC(i),e;s=s.sibling}throw Error(oe(188))}if(n.return!==r.return)n=i,r=s;else{for(var o=!1,a=i.child;a;){if(a===n){o=!0,n=i,r=s;break}if(a===r){o=!0,r=i,n=s;break}a=a.sibling}if(!o){for(a=s.child;a;){if(a===n){o=!0,n=s,r=i;break}if(a===r){o=!0,r=s,n=i;break}a=a.sibling}if(!o)throw Error(oe(189))}}if(n.alternate!==r)throw Error(oe(190))}if(n.tag!==3)throw Error(oe(188));return n.stateNode.current===n?t:e}function fA(t){return t=Ij(t),t!==null?gA(t):null}function gA(t){if(t.tag===5||t.tag===6)return t;for(t=t.child;t!==null;){var e=gA(t);if(e!==null)return e;t=t.sibling}return null}var pA=xr.unstable_scheduleCallback,rC=xr.unstable_cancelCallback,Aj=xr.unstable_shouldYield,Fj=xr.unstable_requestPaint,Ut=xr.unstable_now,Oj=xr.unstable_getCurrentPriorityLevel,Ax=xr.unstable_ImmediatePriority,mA=xr.unstable_UserBlockingPriority,sp=xr.unstable_NormalPriority,$j=xr.unstable_LowPriority,yA=xr.unstable_IdlePriority,Am=null,Vi=null;function Lj(t){if(Vi&&typeof Vi.onCommitFiberRoot=="function")try{Vi.onCommitFiberRoot(Am,t,void 0,(t.current.flags&128)===128)}catch{}}var mi=Math.clz32?Math.clz32:Dj,kj=Math.log,Mj=Math.LN2;function Dj(t){return t>>>=0,t===0?32:31-(kj(t)/Mj|0)|0}var gf=64,pf=4194304;function id(t){switch(t&-t){case 1:return 1;case 2:return 2;case 4:return 4;case 8:return 8;case 16:return 16;case 32:return 32;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return t&4194240;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return t&130023424;case 134217728:return 134217728;case 268435456:return 268435456;case 536870912:return 536870912;case 1073741824:return 1073741824;default:return t}}function op(t,e){var n=t.pendingLanes;if(n===0)return 0;var r=0,i=t.suspendedLanes,s=t.pingedLanes,o=n&268435455;if(o!==0){var a=o&~i;a!==0?r=id(a):(s&=o,s!==0&&(r=id(s)))}else o=n&~i,o!==0?r=id(o):s!==0&&(r=id(s));if(r===0)return 0;if(e!==0&&e!==r&&!(e&i)&&(i=r&-r,s=e&-e,i>=s||i===16&&(s&4194240)!==0))return e;if(r&4&&(r|=n&16),e=t.entangledLanes,e!==0)for(t=t.entanglements,e&=r;0<e;)n=31-mi(e),i=1<<n,r|=t[n],e&=~i;return r}function Nj(t,e){switch(t){case 1:case 2:case 4:return e+250;case 8:case 16:case 32:case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return e+5e3;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return-1;case 134217728:case 268435456:case 536870912:case 1073741824:return-1;default:return-1}}function jj(t,e){for(var n=t.suspendedLanes,r=t.pingedLanes,i=t.expirationTimes,s=t.pendingLanes;0<s;){var o=31-mi(s),a=1<<o,l=i[o];l===-1?(!(a&n)||a&r)&&(i[o]=Nj(a,e)):l<=e&&(t.expiredLanes|=a),s&=~a}}function Rv(t){return t=t.pendingLanes&-1073741825,t!==0?t:t&1073741824?1073741824:0}function _A(){var t=gf;return gf<<=1,!(gf&4194240)&&(gf=64),t}function x_(t){for(var e=[],n=0;31>n;n++)e.push(t);return e}function Ih(t,e,n){t.pendingLanes|=e,e!==536870912&&(t.suspendedLanes=0,t.pingedLanes=0),t=t.eventTimes,e=31-mi(e),t[e]=n}function zj(t,e){var n=t.pendingLanes&~e;t.pendingLanes=e,t.suspendedLanes=0,t.pingedLanes=0,t.expiredLanes&=e,t.mutableReadLanes&=e,t.entangledLanes&=e,e=t.entanglements;var r=t.eventTimes;for(t=t.expirationTimes;0<n;){var i=31-mi(n),s=1<<i;e[i]=0,r[i]=-1,t[i]=-1,n&=~s}}function Fx(t,e){var n=t.entangledLanes|=e;for(t=t.entanglements;n;){var r=31-mi(n),i=1<<r;i&e|t[r]&e&&(t[r]|=e),n&=~i}}var st=0;function vA(t){return t&=-t,1<t?4<t?t&268435455?16:536870912:4:1}var wA,Ox,xA,EA,SA,Iv=!1,mf=[],To=null,Po=null,Ro=null,Gd=new Map,Bd=new Map,fo=[],Uj="mousedown mouseup touchcancel touchend touchstart auxclick dblclick pointercancel pointerdown pointerup dragend dragstart drop compositionend compositionstart keydown keypress keyup input textInput copy cut paste click change contextmenu reset submit".split(" ");function iC(t,e){switch(t){case"focusin":case"focusout":To=null;break;case"dragenter":case"dragleave":Po=null;break;case"mouseover":case"mouseout":Ro=null;break;case"pointerover":case"pointerout":Gd.delete(e.pointerId);break;case"gotpointercapture":case"lostpointercapture":Bd.delete(e.pointerId)}}function Ou(t,e,n,r,i,s){return t===null||t.nativeEvent!==s?(t={blockedOn:e,domEventName:n,eventSystemFlags:r,nativeEvent:s,targetContainers:[i]},e!==null&&(e=Fh(e),e!==null&&Ox(e)),t):(t.eventSystemFlags|=r,e=t.targetContainers,i!==null&&e.indexOf(i)===-1&&e.push(i),t)}function Gj(t,e,n,r,i){switch(e){case"focusin":return To=Ou(To,t,e,n,r,i),!0;case"dragenter":return Po=Ou(Po,t,e,n,r,i),!0;case"mouseover":return Ro=Ou(Ro,t,e,n,r,i),!0;case"pointerover":var s=i.pointerId;return Gd.set(s,Ou(Gd.get(s)||null,t,e,n,r,i)),!0;case"gotpointercapture":return s=i.pointerId,Bd.set(s,Ou(Bd.get(s)||null,t,e,n,r,i)),!0}return!1}function bA(t){var e=xa(t.target);if(e!==null){var n=Ja(e);if(n!==null){if(e=n.tag,e===13){if(e=hA(n),e!==null){t.blockedOn=e,SA(t.priority,function(){xA(n)});return}}else if(e===3&&n.stateNode.current.memoizedState.isDehydrated){t.blockedOn=n.tag===3?n.stateNode.containerInfo:null;return}}}t.blockedOn=null}function Cg(t){if(t.blockedOn!==null)return!1;for(var e=t.targetContainers;0<e.length;){var n=Av(t.domEventName,t.eventSystemFlags,e[0],t.nativeEvent);if(n===null){n=t.nativeEvent;var r=new n.constructor(n.type,n);bv=r,n.target.dispatchEvent(r),bv=null}else return e=Fh(n),e!==null&&Ox(e),t.blockedOn=n,!1;e.shift()}return!0}function sC(t,e,n){Cg(t)&&n.delete(e)}function Bj(){Iv=!1,To!==null&&Cg(To)&&(To=null),Po!==null&&Cg(Po)&&(Po=null),Ro!==null&&Cg(Ro)&&(Ro=null),Gd.forEach(sC),Bd.forEach(sC)}function $u(t,e){t.blockedOn===e&&(t.blockedOn=null,Iv||(Iv=!0,xr.unstable_scheduleCallback(xr.unstable_NormalPriority,Bj)))}function Vd(t){function e(i){return $u(i,t)}if(0<mf.length){$u(mf[0],t);for(var n=1;n<mf.length;n++){var r=mf[n];r.blockedOn===t&&(r.blockedOn=null)}}for(To!==null&&$u(To,t),Po!==null&&$u(Po,t),Ro!==null&&$u(Ro,t),Gd.forEach(e),Bd.forEach(e),n=0;n<fo.length;n++)r=fo[n],r.blockedOn===t&&(r.blockedOn=null);for(;0<fo.length&&(n=fo[0],n.blockedOn===null);)bA(n),n.blockedOn===null&&fo.shift()}var uc=Gs.ReactCurrentBatchConfig,ap=!0;function Vj(t,e,n,r){var i=st,s=uc.transition;uc.transition=null;try{st=1,$x(t,e,n,r)}finally{st=i,uc.transition=s}}function Wj(t,e,n,r){var i=st,s=uc.transition;uc.transition=null;try{st=4,$x(t,e,n,r)}finally{st=i,uc.transition=s}}function $x(t,e,n,r){if(ap){var i=Av(t,e,n,r);if(i===null)F_(t,e,r,lp,n),iC(t,r);else if(Gj(i,t,e,n,r))r.stopPropagation();else if(iC(t,r),e&4&&-1<Uj.indexOf(t)){for(;i!==null;){var s=Fh(i);if(s!==null&&wA(s),s=Av(t,e,n,r),s===null&&F_(t,e,r,lp,n),s===i)break;i=s}i!==null&&r.stopPropagation()}else F_(t,e,r,null,n)}}var lp=null;function Av(t,e,n,r){if(lp=null,t=Ix(r),t=xa(t),t!==null)if(e=Ja(t),e===null)t=null;else if(n=e.tag,n===13){if(t=hA(e),t!==null)return t;t=null}else if(n===3){if(e.stateNode.current.memoizedState.isDehydrated)return e.tag===3?e.stateNode.containerInfo:null;t=null}else e!==t&&(t=null);return lp=t,null}function CA(t){switch(t){case"cancel":case"click":case"close":case"contextmenu":case"copy":case"cut":case"auxclick":case"dblclick":case"dragend":case"dragstart":case"drop":case"focusin":case"focusout":case"input":case"invalid":case"keydown":case"keypress":case"keyup":case"mousedown":case"mouseup":case"paste":case"pause":case"play":case"pointercancel":case"pointerdown":case"pointerup":case"ratechange":case"reset":case"resize":case"seeked":case"submit":case"touchcancel":case"touchend":case"touchstart":case"volumechange":case"change":case"selectionchange":case"textInput":case"compositionstart":case"compositionend":case"compositionupdate":case"beforeblur":case"afterblur":case"beforeinput":case"blur":case"fullscreenchange":case"focus":case"hashchange":case"popstate":case"select":case"selectstart":return 1;case"drag":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"mousemove":case"mouseout":case"mouseover":case"pointermove":case"pointerout":case"pointerover":case"scroll":case"toggle":case"touchmove":case"wheel":case"mouseenter":case"mouseleave":case"pointerenter":case"pointerleave":return 4;case"message":switch(Oj()){case Ax:return 1;case mA:return 4;case sp:case $j:return 16;case yA:return 536870912;default:return 16}default:return 16}}var mo=null,Lx=null,Tg=null;function TA(){if(Tg)return Tg;var t,e=Lx,n=e.length,r,i="value"in mo?mo.value:mo.textContent,s=i.length;for(t=0;t<n&&e[t]===i[t];t++);var o=n-t;for(r=1;r<=o&&e[n-r]===i[s-r];r++);return Tg=i.slice(t,1<r?1-r:void 0)}function Pg(t){var e=t.keyCode;return"charCode"in t?(t=t.charCode,t===0&&e===13&&(t=13)):t=e,t===10&&(t=13),32<=t||t===13?t:0}function yf(){return!0}function oC(){return!1}function br(t){function e(n,r,i,s,o){this._reactName=n,this._targetInst=i,this.type=r,this.nativeEvent=s,this.target=o,this.currentTarget=null;for(var a in t)t.hasOwnProperty(a)&&(n=t[a],this[a]=n?n(s):s[a]);return this.isDefaultPrevented=(s.defaultPrevented!=null?s.defaultPrevented:s.returnValue===!1)?yf:oC,this.isPropagationStopped=oC,this}return Mt(e.prototype,{preventDefault:function(){this.defaultPrevented=!0;var n=this.nativeEvent;n&&(n.preventDefault?n.preventDefault():typeof n.returnValue!="unknown"&&(n.returnValue=!1),this.isDefaultPrevented=yf)},stopPropagation:function(){var n=this.nativeEvent;n&&(n.stopPropagation?n.stopPropagation():typeof n.cancelBubble!="unknown"&&(n.cancelBubble=!0),this.isPropagationStopped=yf)},persist:function(){},isPersistent:yf}),e}var Qc={eventPhase:0,bubbles:0,cancelable:0,timeStamp:function(t){return t.timeStamp||Date.now()},defaultPrevented:0,isTrusted:0},kx=br(Qc),Ah=Mt({},Qc,{view:0,detail:0}),Hj=br(Ah),E_,S_,Lu,Fm=Mt({},Ah,{screenX:0,screenY:0,clientX:0,clientY:0,pageX:0,pageY:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,getModifierState:Mx,button:0,buttons:0,relatedTarget:function(t){return t.relatedTarget===void 0?t.fromElement===t.srcElement?t.toElement:t.fromElement:t.relatedTarget},movementX:function(t){return"movementX"in t?t.movementX:(t!==Lu&&(Lu&&t.type==="mousemove"?(E_=t.screenX-Lu.screenX,S_=t.screenY-Lu.screenY):S_=E_=0,Lu=t),E_)},movementY:function(t){return"movementY"in t?t.movementY:S_}}),aC=br(Fm),Kj=Mt({},Fm,{dataTransfer:0}),Yj=br(Kj),Xj=Mt({},Ah,{relatedTarget:0}),b_=br(Xj),Zj=Mt({},Qc,{animationName:0,elapsedTime:0,pseudoElement:0}),qj=br(Zj),Jj=Mt({},Qc,{clipboardData:function(t){return"clipboardData"in t?t.clipboardData:window.clipboardData}}),Qj=br(Jj),e3=Mt({},Qc,{data:0}),lC=br(e3),t3={Esc:"Escape",Spacebar:" ",Left:"ArrowLeft",Up:"ArrowUp",Right:"ArrowRight",Down:"ArrowDown",Del:"Delete",Win:"OS",Menu:"ContextMenu",Apps:"ContextMenu",Scroll:"ScrollLock",MozPrintableKey:"Unidentified"},n3={8:"Backspace",9:"Tab",12:"Clear",13:"Enter",16:"Shift",17:"Control",18:"Alt",19:"Pause",20:"CapsLock",27:"Escape",32:" ",33:"PageUp",34:"PageDown",35:"End",36:"Home",37:"ArrowLeft",38:"ArrowUp",39:"ArrowRight",40:"ArrowDown",45:"Insert",46:"Delete",112:"F1",113:"F2",114:"F3",115:"F4",116:"F5",117:"F6",118:"F7",119:"F8",120:"F9",121:"F10",122:"F11",123:"F12",144:"NumLock",145:"ScrollLock",224:"Meta"},r3={Alt:"altKey",Control:"ctrlKey",Meta:"metaKey",Shift:"shiftKey"};function i3(t){var e=this.nativeEvent;return e.getModifierState?e.getModifierState(t):(t=r3[t])?!!e[t]:!1}function Mx(){return i3}var s3=Mt({},Ah,{key:function(t){if(t.key){var e=t3[t.key]||t.key;if(e!=="Unidentified")return e}return t.type==="keypress"?(t=Pg(t),t===13?"Enter":String.fromCharCode(t)):t.type==="keydown"||t.type==="keyup"?n3[t.keyCode]||"Unidentified":""},code:0,location:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,repeat:0,locale:0,getModifierState:Mx,charCode:function(t){return t.type==="keypress"?Pg(t):0},keyCode:function(t){return t.type==="keydown"||t.type==="keyup"?t.keyCode:0},which:function(t){return t.type==="keypress"?Pg(t):t.type==="keydown"||t.type==="keyup"?t.keyCode:0}}),o3=br(s3),a3=Mt({},Fm,{pointerId:0,width:0,height:0,pressure:0,tangentialPressure:0,tiltX:0,tiltY:0,twist:0,pointerType:0,isPrimary:0}),cC=br(a3),l3=Mt({},Ah,{touches:0,targetTouches:0,changedTouches:0,altKey:0,metaKey:0,ctrlKey:0,shiftKey:0,getModifierState:Mx}),c3=br(l3),u3=Mt({},Qc,{propertyName:0,elapsedTime:0,pseudoElement:0}),d3=br(u3),h3=Mt({},Fm,{deltaX:function(t){return"deltaX"in t?t.deltaX:"wheelDeltaX"in t?-t.wheelDeltaX:0},deltaY:function(t){return"deltaY"in t?t.deltaY:"wheelDeltaY"in t?-t.wheelDeltaY:"wheelDelta"in t?-t.wheelDelta:0},deltaZ:0,deltaMode:0}),f3=br(h3),g3=[9,13,27,32],Dx=$s&&"CompositionEvent"in window,gd=null;$s&&"documentMode"in document&&(gd=document.documentMode);var p3=$s&&"TextEvent"in window&&!gd,PA=$s&&(!Dx||gd&&8<gd&&11>=gd),uC=" ",dC=!1;function RA(t,e){switch(t){case"keyup":return g3.indexOf(e.keyCode)!==-1;case"keydown":return e.keyCode!==229;case"keypress":case"mousedown":case"focusout":return!0;default:return!1}}function IA(t){return t=t.detail,typeof t=="object"&&"data"in t?t.data:null}var Bl=!1;function m3(t,e){switch(t){case"compositionend":return IA(e);case"keypress":return e.which!==32?null:(dC=!0,uC);case"textInput":return t=e.data,t===uC&&dC?null:t;default:return null}}function y3(t,e){if(Bl)return t==="compositionend"||!Dx&&RA(t,e)?(t=TA(),Tg=Lx=mo=null,Bl=!1,t):null;switch(t){case"paste":return null;case"keypress":if(!(e.ctrlKey||e.altKey||e.metaKey)||e.ctrlKey&&e.altKey){if(e.char&&1<e.char.length)return e.char;if(e.which)return String.fromCharCode(e.which)}return null;case"compositionend":return PA&&e.locale!=="ko"?null:e.data;default:return null}}var _3={color:!0,date:!0,datetime:!0,"datetime-local":!0,email:!0,month:!0,number:!0,password:!0,range:!0,search:!0,tel:!0,text:!0,time:!0,url:!0,week:!0};function hC(t){var e=t&&t.nodeName&&t.nodeName.toLowerCase();return e==="input"?!!_3[t.type]:e==="textarea"}function AA(t,e,n,r){aA(r),e=cp(e,"onChange"),0<e.length&&(n=new kx("onChange","change",null,n,r),t.push({event:n,listeners:e}))}var pd=null,Wd=null;function v3(t){UA(t,0)}function Om(t){var e=Hl(t);if(eA(e))return t}function w3(t,e){if(t==="change")return e}var FA=!1;if($s){var C_;if($s){var T_="oninput"in document;if(!T_){var fC=document.createElement("div");fC.setAttribute("oninput","return;"),T_=typeof fC.oninput=="function"}C_=T_}else C_=!1;FA=C_&&(!document.documentMode||9<document.documentMode)}function gC(){pd&&(pd.detachEvent("onpropertychange",OA),Wd=pd=null)}function OA(t){if(t.propertyName==="value"&&Om(Wd)){var e=[];AA(e,Wd,t,Ix(t)),dA(v3,e)}}function x3(t,e,n){t==="focusin"?(gC(),pd=e,Wd=n,pd.attachEvent("onpropertychange",OA)):t==="focusout"&&gC()}function E3(t){if(t==="selectionchange"||t==="keyup"||t==="keydown")return Om(Wd)}function S3(t,e){if(t==="click")return Om(e)}function b3(t,e){if(t==="input"||t==="change")return Om(e)}function C3(t,e){return t===e&&(t!==0||1/t===1/e)||t!==t&&e!==e}var xi=typeof Object.is=="function"?Object.is:C3;function Hd(t,e){if(xi(t,e))return!0;if(typeof t!="object"||t===null||typeof e!="object"||e===null)return!1;var n=Object.keys(t),r=Object.keys(e);if(n.length!==r.length)return!1;for(r=0;r<n.length;r++){var i=n[r];if(!hv.call(e,i)||!xi(t[i],e[i]))return!1}return!0}function pC(t){for(;t&&t.firstChild;)t=t.firstChild;return t}function mC(t,e){var n=pC(t);t=0;for(var r;n;){if(n.nodeType===3){if(r=t+n.textContent.length,t<=e&&r>=e)return{node:n,offset:e-t};t=r}e:{for(;n;){if(n.nextSibling){n=n.nextSibling;break e}n=n.parentNode}n=void 0}n=pC(n)}}function $A(t,e){return t&&e?t===e?!0:t&&t.nodeType===3?!1:e&&e.nodeType===3?$A(t,e.parentNode):"contains"in t?t.contains(e):t.compareDocumentPosition?!!(t.compareDocumentPosition(e)&16):!1:!1}function LA(){for(var t=window,e=np();e instanceof t.HTMLIFrameElement;){try{var n=typeof e.contentWindow.location.href=="string"}catch{n=!1}if(n)t=e.contentWindow;else break;e=np(t.document)}return e}function Nx(t){var e=t&&t.nodeName&&t.nodeName.toLowerCase();return e&&(e==="input"&&(t.type==="text"||t.type==="search"||t.type==="tel"||t.type==="url"||t.type==="password")||e==="textarea"||t.contentEditable==="true")}function T3(t){var e=LA(),n=t.focusedElem,r=t.selectionRange;if(e!==n&&n&&n.ownerDocument&&$A(n.ownerDocument.documentElement,n)){if(r!==null&&Nx(n)){if(e=r.start,t=r.end,t===void 0&&(t=e),"selectionStart"in n)n.selectionStart=e,n.selectionEnd=Math.min(t,n.value.length);else if(t=(e=n.ownerDocument||document)&&e.defaultView||window,t.getSelection){t=t.getSelection();var i=n.textContent.length,s=Math.min(r.start,i);r=r.end===void 0?s:Math.min(r.end,i),!t.extend&&s>r&&(i=r,r=s,s=i),i=mC(n,s);var o=mC(n,r);i&&o&&(t.rangeCount!==1||t.anchorNode!==i.node||t.anchorOffset!==i.offset||t.focusNode!==o.node||t.focusOffset!==o.offset)&&(e=e.createRange(),e.setStart(i.node,i.offset),t.removeAllRanges(),s>r?(t.addRange(e),t.extend(o.node,o.offset)):(e.setEnd(o.node,o.offset),t.addRange(e)))}}for(e=[],t=n;t=t.parentNode;)t.nodeType===1&&e.push({element:t,left:t.scrollLeft,top:t.scrollTop});for(typeof n.focus=="function"&&n.focus(),n=0;n<e.length;n++)t=e[n],t.element.scrollLeft=t.left,t.element.scrollTop=t.top}}var P3=$s&&"documentMode"in document&&11>=document.documentMode,Vl=null,Fv=null,md=null,Ov=!1;function yC(t,e,n){var r=n.window===n?n.document:n.nodeType===9?n:n.ownerDocument;Ov||Vl==null||Vl!==np(r)||(r=Vl,"selectionStart"in r&&Nx(r)?r={start:r.selectionStart,end:r.selectionEnd}:(r=(r.ownerDocument&&r.ownerDocument.defaultView||window).getSelection(),r={anchorNode:r.anchorNode,anchorOffset:r.anchorOffset,focusNode:r.focusNode,focusOffset:r.focusOffset}),md&&Hd(md,r)||(md=r,r=cp(Fv,"onSelect"),0<r.length&&(e=new kx("onSelect","select",null,e,n),t.push({event:e,listeners:r}),e.target=Vl)))}function _f(t,e){var n={};return n[t.toLowerCase()]=e.toLowerCase(),n["Webkit"+t]="webkit"+e,n["Moz"+t]="moz"+e,n}var Wl={animationend:_f("Animation","AnimationEnd"),animationiteration:_f("Animation","AnimationIteration"),animationstart:_f("Animation","AnimationStart"),transitionend:_f("Transition","TransitionEnd")},P_={},kA={};$s&&(kA=document.createElement("div").style,"AnimationEvent"in window||(delete Wl.animationend.animation,delete Wl.animationiteration.animation,delete Wl.animationstart.animation),"TransitionEvent"in window||delete Wl.transitionend.transition);function $m(t){if(P_[t])return P_[t];if(!Wl[t])return t;var e=Wl[t],n;for(n in e)if(e.hasOwnProperty(n)&&n in kA)return P_[t]=e[n];return t}var MA=$m("animationend"),DA=$m("animationiteration"),NA=$m("animationstart"),jA=$m("transitionend"),zA=new Map,_C="abort auxClick cancel canPlay canPlayThrough click close contextMenu copy cut drag dragEnd dragEnter dragExit dragLeave dragOver dragStart drop durationChange emptied encrypted ended error gotPointerCapture input invalid keyDown keyPress keyUp load loadedData loadedMetadata loadStart lostPointerCapture mouseDown mouseMove mouseOut mouseOver mouseUp paste pause play playing pointerCancel pointerDown pointerMove pointerOut pointerOver pointerUp progress rateChange reset resize seeked seeking stalled submit suspend timeUpdate touchCancel touchEnd touchStart volumeChange scroll toggle touchMove waiting wheel".split(" ");function Ko(t,e){zA.set(t,e),qa(e,[t])}for(var R_=0;R_<_C.length;R_++){var I_=_C[R_],R3=I_.toLowerCase(),I3=I_[0].toUpperCase()+I_.slice(1);Ko(R3,"on"+I3)}Ko(MA,"onAnimationEnd");Ko(DA,"onAnimationIteration");Ko(NA,"onAnimationStart");Ko("dblclick","onDoubleClick");Ko("focusin","onFocus");Ko("focusout","onBlur");Ko(jA,"onTransitionEnd");Tc("onMouseEnter",["mouseout","mouseover"]);Tc("onMouseLeave",["mouseout","mouseover"]);Tc("onPointerEnter",["pointerout","pointerover"]);Tc("onPointerLeave",["pointerout","pointerover"]);qa("onChange","change click focusin focusout input keydown keyup selectionchange".split(" "));qa("onSelect","focusout contextmenu dragend focusin keydown keyup mousedown mouseup selectionchange".split(" "));qa("onBeforeInput",["compositionend","keypress","textInput","paste"]);qa("onCompositionEnd","compositionend focusout keydown keypress keyup mousedown".split(" "));qa("onCompositionStart","compositionstart focusout keydown keypress keyup mousedown".split(" "));qa("onCompositionUpdate","compositionupdate focusout keydown keypress keyup mousedown".split(" "));var sd="abort canplay canplaythrough durationchange emptied encrypted ended error loadeddata loadedmetadata loadstart pause play playing progress ratechange resize seeked seeking stalled suspend timeupdate volumechange waiting".split(" "),A3=new Set("cancel close invalid load scroll toggle".split(" ").concat(sd));function vC(t,e,n){var r=t.type||"unknown-event";t.currentTarget=n,Rj(r,e,void 0,t),t.currentTarget=null}function UA(t,e){e=(e&4)!==0;for(var n=0;n<t.length;n++){var r=t[n],i=r.event;r=r.listeners;e:{var s=void 0;if(e)for(var o=r.length-1;0<=o;o--){var a=r[o],l=a.instance,c=a.currentTarget;if(a=a.listener,l!==s&&i.isPropagationStopped())break e;vC(i,a,c),s=l}else for(o=0;o<r.length;o++){if(a=r[o],l=a.instance,c=a.currentTarget,a=a.listener,l!==s&&i.isPropagationStopped())break e;vC(i,a,c),s=l}}}if(ip)throw t=Pv,ip=!1,Pv=null,t}function wt(t,e){var n=e[Dv];n===void 0&&(n=e[Dv]=new Set);var r=t+"__bubble";n.has(r)||(GA(e,t,2,!1),n.add(r))}function A_(t,e,n){var r=0;e&&(r|=4),GA(n,t,r,e)}var vf="_reactListening"+Math.random().toString(36).slice(2);function Kd(t){if(!t[vf]){t[vf]=!0,XI.forEach(function(n){n!=="selectionchange"&&(A3.has(n)||A_(n,!1,t),A_(n,!0,t))});var e=t.nodeType===9?t:t.ownerDocument;e===null||e[vf]||(e[vf]=!0,A_("selectionchange",!1,e))}}function GA(t,e,n,r){switch(CA(e)){case 1:var i=Vj;break;case 4:i=Wj;break;default:i=$x}n=i.bind(null,e,n,t),i=void 0,!Tv||e!=="touchstart"&&e!=="touchmove"&&e!=="wheel"||(i=!0),r?i!==void 0?t.addEventListener(e,n,{capture:!0,passive:i}):t.addEventListener(e,n,!0):i!==void 0?t.addEventListener(e,n,{passive:i}):t.addEventListener(e,n,!1)}function F_(t,e,n,r,i){var s=r;if(!(e&1)&&!(e&2)&&r!==null)e:for(;;){if(r===null)return;var o=r.tag;if(o===3||o===4){var a=r.stateNode.containerInfo;if(a===i||a.nodeType===8&&a.parentNode===i)break;if(o===4)for(o=r.return;o!==null;){var l=o.tag;if((l===3||l===4)&&(l=o.stateNode.containerInfo,l===i||l.nodeType===8&&l.parentNode===i))return;o=o.return}for(;a!==null;){if(o=xa(a),o===null)return;if(l=o.tag,l===5||l===6){r=s=o;continue e}a=a.parentNode}}r=r.return}dA(function(){var c=s,u=Ix(n),d=[];e:{var h=zA.get(t);if(h!==void 0){var f=kx,p=t;switch(t){case"keypress":if(Pg(n)===0)break e;case"keydown":case"keyup":f=o3;break;case"focusin":p="focus",f=b_;break;case"focusout":p="blur",f=b_;break;case"beforeblur":case"afterblur":f=b_;break;case"click":if(n.button===2)break e;case"auxclick":case"dblclick":case"mousedown":case"mousemove":case"mouseup":case"mouseout":case"mouseover":case"contextmenu":f=aC;break;case"drag":case"dragend":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"dragstart":case"drop":f=Yj;break;case"touchcancel":case"touchend":case"touchmove":case"touchstart":f=c3;break;case MA:case DA:case NA:f=qj;break;case jA:f=d3;break;case"scroll":f=Hj;break;case"wheel":f=f3;break;case"copy":case"cut":case"paste":f=Qj;break;case"gotpointercapture":case"lostpointercapture":case"pointercancel":case"pointerdown":case"pointermove":case"pointerout":case"pointerover":case"pointerup":f=cC}var m=(e&4)!==0,_=!m&&t==="scroll",g=m?h!==null?h+"Capture":null:h;m=[];for(var y=c,v;y!==null;){v=y;var w=v.stateNode;if(v.tag===5&&w!==null&&(v=w,g!==null&&(w=Ud(y,g),w!=null&&m.push(Yd(y,w,v)))),_)break;y=y.return}0<m.length&&(h=new f(h,p,null,n,u),d.push({event:h,listeners:m}))}}if(!(e&7)){e:{if(h=t==="mouseover"||t==="pointerover",f=t==="mouseout"||t==="pointerout",h&&n!==bv&&(p=n.relatedTarget||n.fromElement)&&(xa(p)||p[Ls]))break e;if((f||h)&&(h=u.window===u?u:(h=u.ownerDocument)?h.defaultView||h.parentWindow:window,f?(p=n.relatedTarget||n.toElement,f=c,p=p?xa(p):null,p!==null&&(_=Ja(p),p!==_||p.tag!==5&&p.tag!==6)&&(p=null)):(f=null,p=c),f!==p)){if(m=aC,w="onMouseLeave",g="onMouseEnter",y="mouse",(t==="pointerout"||t==="pointerover")&&(m=cC,w="onPointerLeave",g="onPointerEnter",y="pointer"),_=f==null?h:Hl(f),v=p==null?h:Hl(p),h=new m(w,y+"leave",f,n,u),h.target=_,h.relatedTarget=v,w=null,xa(u)===c&&(m=new m(g,y+"enter",p,n,u),m.target=v,m.relatedTarget=_,w=m),_=w,f&&p)t:{for(m=f,g=p,y=0,v=m;v;v=vl(v))y++;for(v=0,w=g;w;w=vl(w))v++;for(;0<y-v;)m=vl(m),y--;for(;0<v-y;)g=vl(g),v--;for(;y--;){if(m===g||g!==null&&m===g.alternate)break t;m=vl(m),g=vl(g)}m=null}else m=null;f!==null&&wC(d,h,f,m,!1),p!==null&&_!==null&&wC(d,_,p,m,!0)}}e:{if(h=c?Hl(c):window,f=h.nodeName&&h.nodeName.toLowerCase(),f==="select"||f==="input"&&h.type==="file")var x=w3;else if(hC(h))if(FA)x=b3;else{x=E3;var S=x3}else(f=h.nodeName)&&f.toLowerCase()==="input"&&(h.type==="checkbox"||h.type==="radio")&&(x=S3);if(x&&(x=x(t,c))){AA(d,x,n,u);break e}S&&S(t,h,c),t==="focusout"&&(S=h._wrapperState)&&S.controlled&&h.type==="number"&&vv(h,"number",h.value)}switch(S=c?Hl(c):window,t){case"focusin":(hC(S)||S.contentEditable==="true")&&(Vl=S,Fv=c,md=null);break;case"focusout":md=Fv=Vl=null;break;case"mousedown":Ov=!0;break;case"contextmenu":case"mouseup":case"dragend":Ov=!1,yC(d,n,u);break;case"selectionchange":if(P3)break;case"keydown":case"keyup":yC(d,n,u)}var C;if(Dx)e:{switch(t){case"compositionstart":var T="onCompositionStart";break e;case"compositionend":T="onCompositionEnd";break e;case"compositionupdate":T="onCompositionUpdate";break e}T=void 0}else Bl?RA(t,n)&&(T="onCompositionEnd"):t==="keydown"&&n.keyCode===229&&(T="onCompositionStart");T&&(PA&&n.locale!=="ko"&&(Bl||T!=="onCompositionStart"?T==="onCompositionEnd"&&Bl&&(C=TA()):(mo=u,Lx="value"in mo?mo.value:mo.textContent,Bl=!0)),S=cp(c,T),0<S.length&&(T=new lC(T,t,null,n,u),d.push({event:T,listeners:S}),C?T.data=C:(C=IA(n),C!==null&&(T.data=C)))),(C=p3?m3(t,n):y3(t,n))&&(c=cp(c,"onBeforeInput"),0<c.length&&(u=new lC("onBeforeInput","beforeinput",null,n,u),d.push({event:u,listeners:c}),u.data=C))}UA(d,e)})}function Yd(t,e,n){return{instance:t,listener:e,currentTarget:n}}function cp(t,e){for(var n=e+"Capture",r=[];t!==null;){var i=t,s=i.stateNode;i.tag===5&&s!==null&&(i=s,s=Ud(t,n),s!=null&&r.unshift(Yd(t,s,i)),s=Ud(t,e),s!=null&&r.push(Yd(t,s,i))),t=t.return}return r}function vl(t){if(t===null)return null;do t=t.return;while(t&&t.tag!==5);return t||null}function wC(t,e,n,r,i){for(var s=e._reactName,o=[];n!==null&&n!==r;){var a=n,l=a.alternate,c=a.stateNode;if(l!==null&&l===r)break;a.tag===5&&c!==null&&(a=c,i?(l=Ud(n,s),l!=null&&o.unshift(Yd(n,l,a))):i||(l=Ud(n,s),l!=null&&o.push(Yd(n,l,a)))),n=n.return}o.length!==0&&t.push({event:e,listeners:o})}var F3=/\r\n?/g,O3=/\u0000|\uFFFD/g;function xC(t){return(typeof t=="string"?t:""+t).replace(F3,`
`).replace(O3,"")}function wf(t,e,n){if(e=xC(e),xC(t)!==e&&n)throw Error(oe(425))}function up(){}var $v=null,Lv=null;function kv(t,e){return t==="textarea"||t==="noscript"||typeof e.children=="string"||typeof e.children=="number"||typeof e.dangerouslySetInnerHTML=="object"&&e.dangerouslySetInnerHTML!==null&&e.dangerouslySetInnerHTML.__html!=null}var Mv=typeof setTimeout=="function"?setTimeout:void 0,$3=typeof clearTimeout=="function"?clearTimeout:void 0,EC=typeof Promise=="function"?Promise:void 0,L3=typeof queueMicrotask=="function"?queueMicrotask:typeof EC<"u"?function(t){return EC.resolve(null).then(t).catch(k3)}:Mv;function k3(t){setTimeout(function(){throw t})}function O_(t,e){var n=e,r=0;do{var i=n.nextSibling;if(t.removeChild(n),i&&i.nodeType===8)if(n=i.data,n==="/$"){if(r===0){t.removeChild(i),Vd(e);return}r--}else n!=="$"&&n!=="$?"&&n!=="$!"||r++;n=i}while(n);Vd(e)}function Io(t){for(;t!=null;t=t.nextSibling){var e=t.nodeType;if(e===1||e===3)break;if(e===8){if(e=t.data,e==="$"||e==="$!"||e==="$?")break;if(e==="/$")return null}}return t}function SC(t){t=t.previousSibling;for(var e=0;t;){if(t.nodeType===8){var n=t.data;if(n==="$"||n==="$!"||n==="$?"){if(e===0)return t;e--}else n==="/$"&&e++}t=t.previousSibling}return null}var eu=Math.random().toString(36).slice(2),Li="__reactFiber$"+eu,Xd="__reactProps$"+eu,Ls="__reactContainer$"+eu,Dv="__reactEvents$"+eu,M3="__reactListeners$"+eu,D3="__reactHandles$"+eu;function xa(t){var e=t[Li];if(e)return e;for(var n=t.parentNode;n;){if(e=n[Ls]||n[Li]){if(n=e.alternate,e.child!==null||n!==null&&n.child!==null)for(t=SC(t);t!==null;){if(n=t[Li])return n;t=SC(t)}return e}t=n,n=t.parentNode}return null}function Fh(t){return t=t[Li]||t[Ls],!t||t.tag!==5&&t.tag!==6&&t.tag!==13&&t.tag!==3?null:t}function Hl(t){if(t.tag===5||t.tag===6)return t.stateNode;throw Error(oe(33))}function Lm(t){return t[Xd]||null}var Nv=[],Kl=-1;function Yo(t){return{current:t}}function Ct(t){0>Kl||(t.current=Nv[Kl],Nv[Kl]=null,Kl--)}function pt(t,e){Kl++,Nv[Kl]=t.current,t.current=e}var jo={},kn=Yo(jo),rr=Yo(!1),$a=jo;function Pc(t,e){var n=t.type.contextTypes;if(!n)return jo;var r=t.stateNode;if(r&&r.__reactInternalMemoizedUnmaskedChildContext===e)return r.__reactInternalMemoizedMaskedChildContext;var i={},s;for(s in n)i[s]=e[s];return r&&(t=t.stateNode,t.__reactInternalMemoizedUnmaskedChildContext=e,t.__reactInternalMemoizedMaskedChildContext=i),i}function ir(t){return t=t.childContextTypes,t!=null}function dp(){Ct(rr),Ct(kn)}function bC(t,e,n){if(kn.current!==jo)throw Error(oe(168));pt(kn,e),pt(rr,n)}function BA(t,e,n){var r=t.stateNode;if(e=e.childContextTypes,typeof r.getChildContext!="function")return n;r=r.getChildContext();for(var i in r)if(!(i in e))throw Error(oe(108,xj(t)||"Unknown",i));return Mt({},n,r)}function hp(t){return t=(t=t.stateNode)&&t.__reactInternalMemoizedMergedChildContext||jo,$a=kn.current,pt(kn,t),pt(rr,rr.current),!0}function CC(t,e,n){var r=t.stateNode;if(!r)throw Error(oe(169));n?(t=BA(t,e,$a),r.__reactInternalMemoizedMergedChildContext=t,Ct(rr),Ct(kn),pt(kn,t)):Ct(rr),pt(rr,n)}var ys=null,km=!1,$_=!1;function VA(t){ys===null?ys=[t]:ys.push(t)}function N3(t){km=!0,VA(t)}function Xo(){if(!$_&&ys!==null){$_=!0;var t=0,e=st;try{var n=ys;for(st=1;t<n.length;t++){var r=n[t];do r=r(!0);while(r!==null)}ys=null,km=!1}catch(i){throw ys!==null&&(ys=ys.slice(t+1)),pA(Ax,Xo),i}finally{st=e,$_=!1}}return null}var Yl=[],Xl=0,fp=null,gp=0,kr=[],Mr=0,La=null,ws=1,xs="";function ua(t,e){Yl[Xl++]=gp,Yl[Xl++]=fp,fp=t,gp=e}function WA(t,e,n){kr[Mr++]=ws,kr[Mr++]=xs,kr[Mr++]=La,La=t;var r=ws;t=xs;var i=32-mi(r)-1;r&=~(1<<i),n+=1;var s=32-mi(e)+i;if(30<s){var o=i-i%5;s=(r&(1<<o)-1).toString(32),r>>=o,i-=o,ws=1<<32-mi(e)+i|n<<i|r,xs=s+t}else ws=1<<s|n<<i|r,xs=t}function jx(t){t.return!==null&&(ua(t,1),WA(t,1,0))}function zx(t){for(;t===fp;)fp=Yl[--Xl],Yl[Xl]=null,gp=Yl[--Xl],Yl[Xl]=null;for(;t===La;)La=kr[--Mr],kr[Mr]=null,xs=kr[--Mr],kr[Mr]=null,ws=kr[--Mr],kr[Mr]=null}var vr=null,mr=null,Pt=!1,li=null;function HA(t,e){var n=Nr(5,null,null,0);n.elementType="DELETED",n.stateNode=e,n.return=t,e=t.deletions,e===null?(t.deletions=[n],t.flags|=16):e.push(n)}function TC(t,e){switch(t.tag){case 5:var n=t.type;return e=e.nodeType!==1||n.toLowerCase()!==e.nodeName.toLowerCase()?null:e,e!==null?(t.stateNode=e,vr=t,mr=Io(e.firstChild),!0):!1;case 6:return e=t.pendingProps===""||e.nodeType!==3?null:e,e!==null?(t.stateNode=e,vr=t,mr=null,!0):!1;case 13:return e=e.nodeType!==8?null:e,e!==null?(n=La!==null?{id:ws,overflow:xs}:null,t.memoizedState={dehydrated:e,treeContext:n,retryLane:1073741824},n=Nr(18,null,null,0),n.stateNode=e,n.return=t,t.child=n,vr=t,mr=null,!0):!1;default:return!1}}function jv(t){return(t.mode&1)!==0&&(t.flags&128)===0}function zv(t){if(Pt){var e=mr;if(e){var n=e;if(!TC(t,e)){if(jv(t))throw Error(oe(418));e=Io(n.nextSibling);var r=vr;e&&TC(t,e)?HA(r,n):(t.flags=t.flags&-4097|2,Pt=!1,vr=t)}}else{if(jv(t))throw Error(oe(418));t.flags=t.flags&-4097|2,Pt=!1,vr=t}}}function PC(t){for(t=t.return;t!==null&&t.tag!==5&&t.tag!==3&&t.tag!==13;)t=t.return;vr=t}function xf(t){if(t!==vr)return!1;if(!Pt)return PC(t),Pt=!0,!1;var e;if((e=t.tag!==3)&&!(e=t.tag!==5)&&(e=t.type,e=e!=="head"&&e!=="body"&&!kv(t.type,t.memoizedProps)),e&&(e=mr)){if(jv(t))throw KA(),Error(oe(418));for(;e;)HA(t,e),e=Io(e.nextSibling)}if(PC(t),t.tag===13){if(t=t.memoizedState,t=t!==null?t.dehydrated:null,!t)throw Error(oe(317));e:{for(t=t.nextSibling,e=0;t;){if(t.nodeType===8){var n=t.data;if(n==="/$"){if(e===0){mr=Io(t.nextSibling);break e}e--}else n!=="$"&&n!=="$!"&&n!=="$?"||e++}t=t.nextSibling}mr=null}}else mr=vr?Io(t.stateNode.nextSibling):null;return!0}function KA(){for(var t=mr;t;)t=Io(t.nextSibling)}function Rc(){mr=vr=null,Pt=!1}function Ux(t){li===null?li=[t]:li.push(t)}var j3=Gs.ReactCurrentBatchConfig;function ku(t,e,n){if(t=n.ref,t!==null&&typeof t!="function"&&typeof t!="object"){if(n._owner){if(n=n._owner,n){if(n.tag!==1)throw Error(oe(309));var r=n.stateNode}if(!r)throw Error(oe(147,t));var i=r,s=""+t;return e!==null&&e.ref!==null&&typeof e.ref=="function"&&e.ref._stringRef===s?e.ref:(e=function(o){var a=i.refs;o===null?delete a[s]:a[s]=o},e._stringRef=s,e)}if(typeof t!="string")throw Error(oe(284));if(!n._owner)throw Error(oe(290,t))}return t}function Ef(t,e){throw t=Object.prototype.toString.call(e),Error(oe(31,t==="[object Object]"?"object with keys {"+Object.keys(e).join(", ")+"}":t))}function RC(t){var e=t._init;return e(t._payload)}function YA(t){function e(g,y){if(t){var v=g.deletions;v===null?(g.deletions=[y],g.flags|=16):v.push(y)}}function n(g,y){if(!t)return null;for(;y!==null;)e(g,y),y=y.sibling;return null}function r(g,y){for(g=new Map;y!==null;)y.key!==null?g.set(y.key,y):g.set(y.index,y),y=y.sibling;return g}function i(g,y){return g=$o(g,y),g.index=0,g.sibling=null,g}function s(g,y,v){return g.index=v,t?(v=g.alternate,v!==null?(v=v.index,v<y?(g.flags|=2,y):v):(g.flags|=2,y)):(g.flags|=1048576,y)}function o(g){return t&&g.alternate===null&&(g.flags|=2),g}function a(g,y,v,w){return y===null||y.tag!==6?(y=z_(v,g.mode,w),y.return=g,y):(y=i(y,v),y.return=g,y)}function l(g,y,v,w){var x=v.type;return x===Gl?u(g,y,v.props.children,w,v.key):y!==null&&(y.elementType===x||typeof x=="object"&&x!==null&&x.$$typeof===co&&RC(x)===y.type)?(w=i(y,v.props),w.ref=ku(g,y,v),w.return=g,w):(w=Lg(v.type,v.key,v.props,null,g.mode,w),w.ref=ku(g,y,v),w.return=g,w)}function c(g,y,v,w){return y===null||y.tag!==4||y.stateNode.containerInfo!==v.containerInfo||y.stateNode.implementation!==v.implementation?(y=U_(v,g.mode,w),y.return=g,y):(y=i(y,v.children||[]),y.return=g,y)}function u(g,y,v,w,x){return y===null||y.tag!==7?(y=Fa(v,g.mode,w,x),y.return=g,y):(y=i(y,v),y.return=g,y)}function d(g,y,v){if(typeof y=="string"&&y!==""||typeof y=="number")return y=z_(""+y,g.mode,v),y.return=g,y;if(typeof y=="object"&&y!==null){switch(y.$$typeof){case df:return v=Lg(y.type,y.key,y.props,null,g.mode,v),v.ref=ku(g,null,y),v.return=g,v;case Ul:return y=U_(y,g.mode,v),y.return=g,y;case co:var w=y._init;return d(g,w(y._payload),v)}if(rd(y)||Au(y))return y=Fa(y,g.mode,v,null),y.return=g,y;Ef(g,y)}return null}function h(g,y,v,w){var x=y!==null?y.key:null;if(typeof v=="string"&&v!==""||typeof v=="number")return x!==null?null:a(g,y,""+v,w);if(typeof v=="object"&&v!==null){switch(v.$$typeof){case df:return v.key===x?l(g,y,v,w):null;case Ul:return v.key===x?c(g,y,v,w):null;case co:return x=v._init,h(g,y,x(v._payload),w)}if(rd(v)||Au(v))return x!==null?null:u(g,y,v,w,null);Ef(g,v)}return null}function f(g,y,v,w,x){if(typeof w=="string"&&w!==""||typeof w=="number")return g=g.get(v)||null,a(y,g,""+w,x);if(typeof w=="object"&&w!==null){switch(w.$$typeof){case df:return g=g.get(w.key===null?v:w.key)||null,l(y,g,w,x);case Ul:return g=g.get(w.key===null?v:w.key)||null,c(y,g,w,x);case co:var S=w._init;return f(g,y,v,S(w._payload),x)}if(rd(w)||Au(w))return g=g.get(v)||null,u(y,g,w,x,null);Ef(y,w)}return null}function p(g,y,v,w){for(var x=null,S=null,C=y,T=y=0,P=null;C!==null&&T<v.length;T++){C.index>T?(P=C,C=null):P=C.sibling;var F=h(g,C,v[T],w);if(F===null){C===null&&(C=P);break}t&&C&&F.alternate===null&&e(g,C),y=s(F,y,T),S===null?x=F:S.sibling=F,S=F,C=P}if(T===v.length)return n(g,C),Pt&&ua(g,T),x;if(C===null){for(;T<v.length;T++)C=d(g,v[T],w),C!==null&&(y=s(C,y,T),S===null?x=C:S.sibling=C,S=C);return Pt&&ua(g,T),x}for(C=r(g,C);T<v.length;T++)P=f(C,g,T,v[T],w),P!==null&&(t&&P.alternate!==null&&C.delete(P.key===null?T:P.key),y=s(P,y,T),S===null?x=P:S.sibling=P,S=P);return t&&C.forEach(function(k){return e(g,k)}),Pt&&ua(g,T),x}function m(g,y,v,w){var x=Au(v);if(typeof x!="function")throw Error(oe(150));if(v=x.call(v),v==null)throw Error(oe(151));for(var S=x=null,C=y,T=y=0,P=null,F=v.next();C!==null&&!F.done;T++,F=v.next()){C.index>T?(P=C,C=null):P=C.sibling;var k=h(g,C,F.value,w);if(k===null){C===null&&(C=P);break}t&&C&&k.alternate===null&&e(g,C),y=s(k,y,T),S===null?x=k:S.sibling=k,S=k,C=P}if(F.done)return n(g,C),Pt&&ua(g,T),x;if(C===null){for(;!F.done;T++,F=v.next())F=d(g,F.value,w),F!==null&&(y=s(F,y,T),S===null?x=F:S.sibling=F,S=F);return Pt&&ua(g,T),x}for(C=r(g,C);!F.done;T++,F=v.next())F=f(C,g,T,F.value,w),F!==null&&(t&&F.alternate!==null&&C.delete(F.key===null?T:F.key),y=s(F,y,T),S===null?x=F:S.sibling=F,S=F);return t&&C.forEach(function(A){return e(g,A)}),Pt&&ua(g,T),x}function _(g,y,v,w){if(typeof v=="object"&&v!==null&&v.type===Gl&&v.key===null&&(v=v.props.children),typeof v=="object"&&v!==null){switch(v.$$typeof){case df:e:{for(var x=v.key,S=y;S!==null;){if(S.key===x){if(x=v.type,x===Gl){if(S.tag===7){n(g,S.sibling),y=i(S,v.props.children),y.return=g,g=y;break e}}else if(S.elementType===x||typeof x=="object"&&x!==null&&x.$$typeof===co&&RC(x)===S.type){n(g,S.sibling),y=i(S,v.props),y.ref=ku(g,S,v),y.return=g,g=y;break e}n(g,S);break}else e(g,S);S=S.sibling}v.type===Gl?(y=Fa(v.props.children,g.mode,w,v.key),y.return=g,g=y):(w=Lg(v.type,v.key,v.props,null,g.mode,w),w.ref=ku(g,y,v),w.return=g,g=w)}return o(g);case Ul:e:{for(S=v.key;y!==null;){if(y.key===S)if(y.tag===4&&y.stateNode.containerInfo===v.containerInfo&&y.stateNode.implementation===v.implementation){n(g,y.sibling),y=i(y,v.children||[]),y.return=g,g=y;break e}else{n(g,y);break}else e(g,y);y=y.sibling}y=U_(v,g.mode,w),y.return=g,g=y}return o(g);case co:return S=v._init,_(g,y,S(v._payload),w)}if(rd(v))return p(g,y,v,w);if(Au(v))return m(g,y,v,w);Ef(g,v)}return typeof v=="string"&&v!==""||typeof v=="number"?(v=""+v,y!==null&&y.tag===6?(n(g,y.sibling),y=i(y,v),y.return=g,g=y):(n(g,y),y=z_(v,g.mode,w),y.return=g,g=y),o(g)):n(g,y)}return _}var Ic=YA(!0),XA=YA(!1),pp=Yo(null),mp=null,Zl=null,Gx=null;function Bx(){Gx=Zl=mp=null}function Vx(t){var e=pp.current;Ct(pp),t._currentValue=e}function Uv(t,e,n){for(;t!==null;){var r=t.alternate;if((t.childLanes&e)!==e?(t.childLanes|=e,r!==null&&(r.childLanes|=e)):r!==null&&(r.childLanes&e)!==e&&(r.childLanes|=e),t===n)break;t=t.return}}function dc(t,e){mp=t,Gx=Zl=null,t=t.dependencies,t!==null&&t.firstContext!==null&&(t.lanes&e&&(nr=!0),t.firstContext=null)}function Hr(t){var e=t._currentValue;if(Gx!==t)if(t={context:t,memoizedValue:e,next:null},Zl===null){if(mp===null)throw Error(oe(308));Zl=t,mp.dependencies={lanes:0,firstContext:t}}else Zl=Zl.next=t;return e}var Ea=null;function Wx(t){Ea===null?Ea=[t]:Ea.push(t)}function ZA(t,e,n,r){var i=e.interleaved;return i===null?(n.next=n,Wx(e)):(n.next=i.next,i.next=n),e.interleaved=n,ks(t,r)}function ks(t,e){t.lanes|=e;var n=t.alternate;for(n!==null&&(n.lanes|=e),n=t,t=t.return;t!==null;)t.childLanes|=e,n=t.alternate,n!==null&&(n.childLanes|=e),n=t,t=t.return;return n.tag===3?n.stateNode:null}var uo=!1;function Hx(t){t.updateQueue={baseState:t.memoizedState,firstBaseUpdate:null,lastBaseUpdate:null,shared:{pending:null,interleaved:null,lanes:0},effects:null}}function qA(t,e){t=t.updateQueue,e.updateQueue===t&&(e.updateQueue={baseState:t.baseState,firstBaseUpdate:t.firstBaseUpdate,lastBaseUpdate:t.lastBaseUpdate,shared:t.shared,effects:t.effects})}function Cs(t,e){return{eventTime:t,lane:e,tag:0,payload:null,callback:null,next:null}}function Ao(t,e,n){var r=t.updateQueue;if(r===null)return null;if(r=r.shared,Xe&2){var i=r.pending;return i===null?e.next=e:(e.next=i.next,i.next=e),r.pending=e,ks(t,n)}return i=r.interleaved,i===null?(e.next=e,Wx(r)):(e.next=i.next,i.next=e),r.interleaved=e,ks(t,n)}function Rg(t,e,n){if(e=e.updateQueue,e!==null&&(e=e.shared,(n&4194240)!==0)){var r=e.lanes;r&=t.pendingLanes,n|=r,e.lanes=n,Fx(t,n)}}function IC(t,e){var n=t.updateQueue,r=t.alternate;if(r!==null&&(r=r.updateQueue,n===r)){var i=null,s=null;if(n=n.firstBaseUpdate,n!==null){do{var o={eventTime:n.eventTime,lane:n.lane,tag:n.tag,payload:n.payload,callback:n.callback,next:null};s===null?i=s=o:s=s.next=o,n=n.next}while(n!==null);s===null?i=s=e:s=s.next=e}else i=s=e;n={baseState:r.baseState,firstBaseUpdate:i,lastBaseUpdate:s,shared:r.shared,effects:r.effects},t.updateQueue=n;return}t=n.lastBaseUpdate,t===null?n.firstBaseUpdate=e:t.next=e,n.lastBaseUpdate=e}function yp(t,e,n,r){var i=t.updateQueue;uo=!1;var s=i.firstBaseUpdate,o=i.lastBaseUpdate,a=i.shared.pending;if(a!==null){i.shared.pending=null;var l=a,c=l.next;l.next=null,o===null?s=c:o.next=c,o=l;var u=t.alternate;u!==null&&(u=u.updateQueue,a=u.lastBaseUpdate,a!==o&&(a===null?u.firstBaseUpdate=c:a.next=c,u.lastBaseUpdate=l))}if(s!==null){var d=i.baseState;o=0,u=c=l=null,a=s;do{var h=a.lane,f=a.eventTime;if((r&h)===h){u!==null&&(u=u.next={eventTime:f,lane:0,tag:a.tag,payload:a.payload,callback:a.callback,next:null});e:{var p=t,m=a;switch(h=e,f=n,m.tag){case 1:if(p=m.payload,typeof p=="function"){d=p.call(f,d,h);break e}d=p;break e;case 3:p.flags=p.flags&-65537|128;case 0:if(p=m.payload,h=typeof p=="function"?p.call(f,d,h):p,h==null)break e;d=Mt({},d,h);break e;case 2:uo=!0}}a.callback!==null&&a.lane!==0&&(t.flags|=64,h=i.effects,h===null?i.effects=[a]:h.push(a))}else f={eventTime:f,lane:h,tag:a.tag,payload:a.payload,callback:a.callback,next:null},u===null?(c=u=f,l=d):u=u.next=f,o|=h;if(a=a.next,a===null){if(a=i.shared.pending,a===null)break;h=a,a=h.next,h.next=null,i.lastBaseUpdate=h,i.shared.pending=null}}while(!0);if(u===null&&(l=d),i.baseState=l,i.firstBaseUpdate=c,i.lastBaseUpdate=u,e=i.shared.interleaved,e!==null){i=e;do o|=i.lane,i=i.next;while(i!==e)}else s===null&&(i.shared.lanes=0);Ma|=o,t.lanes=o,t.memoizedState=d}}function AC(t,e,n){if(t=e.effects,e.effects=null,t!==null)for(e=0;e<t.length;e++){var r=t[e],i=r.callback;if(i!==null){if(r.callback=null,r=n,typeof i!="function")throw Error(oe(191,i));i.call(r)}}}var Oh={},Wi=Yo(Oh),Zd=Yo(Oh),qd=Yo(Oh);function Sa(t){if(t===Oh)throw Error(oe(174));return t}function Kx(t,e){switch(pt(qd,e),pt(Zd,t),pt(Wi,Oh),t=e.nodeType,t){case 9:case 11:e=(e=e.documentElement)?e.namespaceURI:xv(null,"");break;default:t=t===8?e.parentNode:e,e=t.namespaceURI||null,t=t.tagName,e=xv(e,t)}Ct(Wi),pt(Wi,e)}function Ac(){Ct(Wi),Ct(Zd),Ct(qd)}function JA(t){Sa(qd.current);var e=Sa(Wi.current),n=xv(e,t.type);e!==n&&(pt(Zd,t),pt(Wi,n))}function Yx(t){Zd.current===t&&(Ct(Wi),Ct(Zd))}var Ft=Yo(0);function _p(t){for(var e=t;e!==null;){if(e.tag===13){var n=e.memoizedState;if(n!==null&&(n=n.dehydrated,n===null||n.data==="$?"||n.data==="$!"))return e}else if(e.tag===19&&e.memoizedProps.revealOrder!==void 0){if(e.flags&128)return e}else if(e.child!==null){e.child.return=e,e=e.child;continue}if(e===t)break;for(;e.sibling===null;){if(e.return===null||e.return===t)return null;e=e.return}e.sibling.return=e.return,e=e.sibling}return null}var L_=[];function Xx(){for(var t=0;t<L_.length;t++)L_[t]._workInProgressVersionPrimary=null;L_.length=0}var Ig=Gs.ReactCurrentDispatcher,k_=Gs.ReactCurrentBatchConfig,ka=0,kt=null,Zt=null,cn=null,vp=!1,yd=!1,Jd=0,z3=0;function Pn(){throw Error(oe(321))}function Zx(t,e){if(e===null)return!1;for(var n=0;n<e.length&&n<t.length;n++)if(!xi(t[n],e[n]))return!1;return!0}function qx(t,e,n,r,i,s){if(ka=s,kt=e,e.memoizedState=null,e.updateQueue=null,e.lanes=0,Ig.current=t===null||t.memoizedState===null?V3:W3,t=n(r,i),yd){s=0;do{if(yd=!1,Jd=0,25<=s)throw Error(oe(301));s+=1,cn=Zt=null,e.updateQueue=null,Ig.current=H3,t=n(r,i)}while(yd)}if(Ig.current=wp,e=Zt!==null&&Zt.next!==null,ka=0,cn=Zt=kt=null,vp=!1,e)throw Error(oe(300));return t}function Jx(){var t=Jd!==0;return Jd=0,t}function Oi(){var t={memoizedState:null,baseState:null,baseQueue:null,queue:null,next:null};return cn===null?kt.memoizedState=cn=t:cn=cn.next=t,cn}function Kr(){if(Zt===null){var t=kt.alternate;t=t!==null?t.memoizedState:null}else t=Zt.next;var e=cn===null?kt.memoizedState:cn.next;if(e!==null)cn=e,Zt=t;else{if(t===null)throw Error(oe(310));Zt=t,t={memoizedState:Zt.memoizedState,baseState:Zt.baseState,baseQueue:Zt.baseQueue,queue:Zt.queue,next:null},cn===null?kt.memoizedState=cn=t:cn=cn.next=t}return cn}function Qd(t,e){return typeof e=="function"?e(t):e}function M_(t){var e=Kr(),n=e.queue;if(n===null)throw Error(oe(311));n.lastRenderedReducer=t;var r=Zt,i=r.baseQueue,s=n.pending;if(s!==null){if(i!==null){var o=i.next;i.next=s.next,s.next=o}r.baseQueue=i=s,n.pending=null}if(i!==null){s=i.next,r=r.baseState;var a=o=null,l=null,c=s;do{var u=c.lane;if((ka&u)===u)l!==null&&(l=l.next={lane:0,action:c.action,hasEagerState:c.hasEagerState,eagerState:c.eagerState,next:null}),r=c.hasEagerState?c.eagerState:t(r,c.action);else{var d={lane:u,action:c.action,hasEagerState:c.hasEagerState,eagerState:c.eagerState,next:null};l===null?(a=l=d,o=r):l=l.next=d,kt.lanes|=u,Ma|=u}c=c.next}while(c!==null&&c!==s);l===null?o=r:l.next=a,xi(r,e.memoizedState)||(nr=!0),e.memoizedState=r,e.baseState=o,e.baseQueue=l,n.lastRenderedState=r}if(t=n.interleaved,t!==null){i=t;do s=i.lane,kt.lanes|=s,Ma|=s,i=i.next;while(i!==t)}else i===null&&(n.lanes=0);return[e.memoizedState,n.dispatch]}function D_(t){var e=Kr(),n=e.queue;if(n===null)throw Error(oe(311));n.lastRenderedReducer=t;var r=n.dispatch,i=n.pending,s=e.memoizedState;if(i!==null){n.pending=null;var o=i=i.next;do s=t(s,o.action),o=o.next;while(o!==i);xi(s,e.memoizedState)||(nr=!0),e.memoizedState=s,e.baseQueue===null&&(e.baseState=s),n.lastRenderedState=s}return[s,r]}function QA(){}function eF(t,e){var n=kt,r=Kr(),i=e(),s=!xi(r.memoizedState,i);if(s&&(r.memoizedState=i,nr=!0),r=r.queue,Qx(rF.bind(null,n,r,t),[t]),r.getSnapshot!==e||s||cn!==null&&cn.memoizedState.tag&1){if(n.flags|=2048,eh(9,nF.bind(null,n,r,i,e),void 0,null),fn===null)throw Error(oe(349));ka&30||tF(n,e,i)}return i}function tF(t,e,n){t.flags|=16384,t={getSnapshot:e,value:n},e=kt.updateQueue,e===null?(e={lastEffect:null,stores:null},kt.updateQueue=e,e.stores=[t]):(n=e.stores,n===null?e.stores=[t]:n.push(t))}function nF(t,e,n,r){e.value=n,e.getSnapshot=r,iF(e)&&sF(t)}function rF(t,e,n){return n(function(){iF(e)&&sF(t)})}function iF(t){var e=t.getSnapshot;t=t.value;try{var n=e();return!xi(t,n)}catch{return!0}}function sF(t){var e=ks(t,1);e!==null&&yi(e,t,1,-1)}function FC(t){var e=Oi();return typeof t=="function"&&(t=t()),e.memoizedState=e.baseState=t,t={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:Qd,lastRenderedState:t},e.queue=t,t=t.dispatch=B3.bind(null,kt,t),[e.memoizedState,t]}function eh(t,e,n,r){return t={tag:t,create:e,destroy:n,deps:r,next:null},e=kt.updateQueue,e===null?(e={lastEffect:null,stores:null},kt.updateQueue=e,e.lastEffect=t.next=t):(n=e.lastEffect,n===null?e.lastEffect=t.next=t:(r=n.next,n.next=t,t.next=r,e.lastEffect=t)),t}function oF(){return Kr().memoizedState}function Ag(t,e,n,r){var i=Oi();kt.flags|=t,i.memoizedState=eh(1|e,n,void 0,r===void 0?null:r)}function Mm(t,e,n,r){var i=Kr();r=r===void 0?null:r;var s=void 0;if(Zt!==null){var o=Zt.memoizedState;if(s=o.destroy,r!==null&&Zx(r,o.deps)){i.memoizedState=eh(e,n,s,r);return}}kt.flags|=t,i.memoizedState=eh(1|e,n,s,r)}function OC(t,e){return Ag(8390656,8,t,e)}function Qx(t,e){return Mm(2048,8,t,e)}function aF(t,e){return Mm(4,2,t,e)}function lF(t,e){return Mm(4,4,t,e)}function cF(t,e){if(typeof e=="function")return t=t(),e(t),function(){e(null)};if(e!=null)return t=t(),e.current=t,function(){e.current=null}}function uF(t,e,n){return n=n!=null?n.concat([t]):null,Mm(4,4,cF.bind(null,e,t),n)}function e1(){}function dF(t,e){var n=Kr();e=e===void 0?null:e;var r=n.memoizedState;return r!==null&&e!==null&&Zx(e,r[1])?r[0]:(n.memoizedState=[t,e],t)}function hF(t,e){var n=Kr();e=e===void 0?null:e;var r=n.memoizedState;return r!==null&&e!==null&&Zx(e,r[1])?r[0]:(t=t(),n.memoizedState=[t,e],t)}function fF(t,e,n){return ka&21?(xi(n,e)||(n=_A(),kt.lanes|=n,Ma|=n,t.baseState=!0),e):(t.baseState&&(t.baseState=!1,nr=!0),t.memoizedState=n)}function U3(t,e){var n=st;st=n!==0&&4>n?n:4,t(!0);var r=k_.transition;k_.transition={};try{t(!1),e()}finally{st=n,k_.transition=r}}function gF(){return Kr().memoizedState}function G3(t,e,n){var r=Oo(t);if(n={lane:r,action:n,hasEagerState:!1,eagerState:null,next:null},pF(t))mF(e,n);else if(n=ZA(t,e,n,r),n!==null){var i=Vn();yi(n,t,r,i),yF(n,e,r)}}function B3(t,e,n){var r=Oo(t),i={lane:r,action:n,hasEagerState:!1,eagerState:null,next:null};if(pF(t))mF(e,i);else{var s=t.alternate;if(t.lanes===0&&(s===null||s.lanes===0)&&(s=e.lastRenderedReducer,s!==null))try{var o=e.lastRenderedState,a=s(o,n);if(i.hasEagerState=!0,i.eagerState=a,xi(a,o)){var l=e.interleaved;l===null?(i.next=i,Wx(e)):(i.next=l.next,l.next=i),e.interleaved=i;return}}catch{}finally{}n=ZA(t,e,i,r),n!==null&&(i=Vn(),yi(n,t,r,i),yF(n,e,r))}}function pF(t){var e=t.alternate;return t===kt||e!==null&&e===kt}function mF(t,e){yd=vp=!0;var n=t.pending;n===null?e.next=e:(e.next=n.next,n.next=e),t.pending=e}function yF(t,e,n){if(n&4194240){var r=e.lanes;r&=t.pendingLanes,n|=r,e.lanes=n,Fx(t,n)}}var wp={readContext:Hr,useCallback:Pn,useContext:Pn,useEffect:Pn,useImperativeHandle:Pn,useInsertionEffect:Pn,useLayoutEffect:Pn,useMemo:Pn,useReducer:Pn,useRef:Pn,useState:Pn,useDebugValue:Pn,useDeferredValue:Pn,useTransition:Pn,useMutableSource:Pn,useSyncExternalStore:Pn,useId:Pn,unstable_isNewReconciler:!1},V3={readContext:Hr,useCallback:function(t,e){return Oi().memoizedState=[t,e===void 0?null:e],t},useContext:Hr,useEffect:OC,useImperativeHandle:function(t,e,n){return n=n!=null?n.concat([t]):null,Ag(4194308,4,cF.bind(null,e,t),n)},useLayoutEffect:function(t,e){return Ag(4194308,4,t,e)},useInsertionEffect:function(t,e){return Ag(4,2,t,e)},useMemo:function(t,e){var n=Oi();return e=e===void 0?null:e,t=t(),n.memoizedState=[t,e],t},useReducer:function(t,e,n){var r=Oi();return e=n!==void 0?n(e):e,r.memoizedState=r.baseState=e,t={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:t,lastRenderedState:e},r.queue=t,t=t.dispatch=G3.bind(null,kt,t),[r.memoizedState,t]},useRef:function(t){var e=Oi();return t={current:t},e.memoizedState=t},useState:FC,useDebugValue:e1,useDeferredValue:function(t){return Oi().memoizedState=t},useTransition:function(){var t=FC(!1),e=t[0];return t=U3.bind(null,t[1]),Oi().memoizedState=t,[e,t]},useMutableSource:function(){},useSyncExternalStore:function(t,e,n){var r=kt,i=Oi();if(Pt){if(n===void 0)throw Error(oe(407));n=n()}else{if(n=e(),fn===null)throw Error(oe(349));ka&30||tF(r,e,n)}i.memoizedState=n;var s={value:n,getSnapshot:e};return i.queue=s,OC(rF.bind(null,r,s,t),[t]),r.flags|=2048,eh(9,nF.bind(null,r,s,n,e),void 0,null),n},useId:function(){var t=Oi(),e=fn.identifierPrefix;if(Pt){var n=xs,r=ws;n=(r&~(1<<32-mi(r)-1)).toString(32)+n,e=":"+e+"R"+n,n=Jd++,0<n&&(e+="H"+n.toString(32)),e+=":"}else n=z3++,e=":"+e+"r"+n.toString(32)+":";return t.memoizedState=e},unstable_isNewReconciler:!1},W3={readContext:Hr,useCallback:dF,useContext:Hr,useEffect:Qx,useImperativeHandle:uF,useInsertionEffect:aF,useLayoutEffect:lF,useMemo:hF,useReducer:M_,useRef:oF,useState:function(){return M_(Qd)},useDebugValue:e1,useDeferredValue:function(t){var e=Kr();return fF(e,Zt.memoizedState,t)},useTransition:function(){var t=M_(Qd)[0],e=Kr().memoizedState;return[t,e]},useMutableSource:QA,useSyncExternalStore:eF,useId:gF,unstable_isNewReconciler:!1},H3={readContext:Hr,useCallback:dF,useContext:Hr,useEffect:Qx,useImperativeHandle:uF,useInsertionEffect:aF,useLayoutEffect:lF,useMemo:hF,useReducer:D_,useRef:oF,useState:function(){return D_(Qd)},useDebugValue:e1,useDeferredValue:function(t){var e=Kr();return Zt===null?e.memoizedState=t:fF(e,Zt.memoizedState,t)},useTransition:function(){var t=D_(Qd)[0],e=Kr().memoizedState;return[t,e]},useMutableSource:QA,useSyncExternalStore:eF,useId:gF,unstable_isNewReconciler:!1};function oi(t,e){if(t&&t.defaultProps){e=Mt({},e),t=t.defaultProps;for(var n in t)e[n]===void 0&&(e[n]=t[n]);return e}return e}function Gv(t,e,n,r){e=t.memoizedState,n=n(r,e),n=n==null?e:Mt({},e,n),t.memoizedState=n,t.lanes===0&&(t.updateQueue.baseState=n)}var Dm={isMounted:function(t){return(t=t._reactInternals)?Ja(t)===t:!1},enqueueSetState:function(t,e,n){t=t._reactInternals;var r=Vn(),i=Oo(t),s=Cs(r,i);s.payload=e,n!=null&&(s.callback=n),e=Ao(t,s,i),e!==null&&(yi(e,t,i,r),Rg(e,t,i))},enqueueReplaceState:function(t,e,n){t=t._reactInternals;var r=Vn(),i=Oo(t),s=Cs(r,i);s.tag=1,s.payload=e,n!=null&&(s.callback=n),e=Ao(t,s,i),e!==null&&(yi(e,t,i,r),Rg(e,t,i))},enqueueForceUpdate:function(t,e){t=t._reactInternals;var n=Vn(),r=Oo(t),i=Cs(n,r);i.tag=2,e!=null&&(i.callback=e),e=Ao(t,i,r),e!==null&&(yi(e,t,r,n),Rg(e,t,r))}};function $C(t,e,n,r,i,s,o){return t=t.stateNode,typeof t.shouldComponentUpdate=="function"?t.shouldComponentUpdate(r,s,o):e.prototype&&e.prototype.isPureReactComponent?!Hd(n,r)||!Hd(i,s):!0}function _F(t,e,n){var r=!1,i=jo,s=e.contextType;return typeof s=="object"&&s!==null?s=Hr(s):(i=ir(e)?$a:kn.current,r=e.contextTypes,s=(r=r!=null)?Pc(t,i):jo),e=new e(n,s),t.memoizedState=e.state!==null&&e.state!==void 0?e.state:null,e.updater=Dm,t.stateNode=e,e._reactInternals=t,r&&(t=t.stateNode,t.__reactInternalMemoizedUnmaskedChildContext=i,t.__reactInternalMemoizedMaskedChildContext=s),e}function LC(t,e,n,r){t=e.state,typeof e.componentWillReceiveProps=="function"&&e.componentWillReceiveProps(n,r),typeof e.UNSAFE_componentWillReceiveProps=="function"&&e.UNSAFE_componentWillReceiveProps(n,r),e.state!==t&&Dm.enqueueReplaceState(e,e.state,null)}function Bv(t,e,n,r){var i=t.stateNode;i.props=n,i.state=t.memoizedState,i.refs={},Hx(t);var s=e.contextType;typeof s=="object"&&s!==null?i.context=Hr(s):(s=ir(e)?$a:kn.current,i.context=Pc(t,s)),i.state=t.memoizedState,s=e.getDerivedStateFromProps,typeof s=="function"&&(Gv(t,e,s,n),i.state=t.memoizedState),typeof e.getDerivedStateFromProps=="function"||typeof i.getSnapshotBeforeUpdate=="function"||typeof i.UNSAFE_componentWillMount!="function"&&typeof i.componentWillMount!="function"||(e=i.state,typeof i.componentWillMount=="function"&&i.componentWillMount(),typeof i.UNSAFE_componentWillMount=="function"&&i.UNSAFE_componentWillMount(),e!==i.state&&Dm.enqueueReplaceState(i,i.state,null),yp(t,n,i,r),i.state=t.memoizedState),typeof i.componentDidMount=="function"&&(t.flags|=4194308)}function Fc(t,e){try{var n="",r=e;do n+=wj(r),r=r.return;while(r);var i=n}catch(s){i=`
Error generating stack: `+s.message+`
`+s.stack}return{value:t,source:e,stack:i,digest:null}}function N_(t,e,n){return{value:t,source:null,stack:n??null,digest:e??null}}function Vv(t,e){try{console.error(e.value)}catch(n){setTimeout(function(){throw n})}}var K3=typeof WeakMap=="function"?WeakMap:Map;function vF(t,e,n){n=Cs(-1,n),n.tag=3,n.payload={element:null};var r=e.value;return n.callback=function(){Ep||(Ep=!0,ew=r),Vv(t,e)},n}function wF(t,e,n){n=Cs(-1,n),n.tag=3;var r=t.type.getDerivedStateFromError;if(typeof r=="function"){var i=e.value;n.payload=function(){return r(i)},n.callback=function(){Vv(t,e)}}var s=t.stateNode;return s!==null&&typeof s.componentDidCatch=="function"&&(n.callback=function(){Vv(t,e),typeof r!="function"&&(Fo===null?Fo=new Set([this]):Fo.add(this));var o=e.stack;this.componentDidCatch(e.value,{componentStack:o!==null?o:""})}),n}function kC(t,e,n){var r=t.pingCache;if(r===null){r=t.pingCache=new K3;var i=new Set;r.set(e,i)}else i=r.get(e),i===void 0&&(i=new Set,r.set(e,i));i.has(n)||(i.add(n),t=a5.bind(null,t,e,n),e.then(t,t))}function MC(t){do{var e;if((e=t.tag===13)&&(e=t.memoizedState,e=e!==null?e.dehydrated!==null:!0),e)return t;t=t.return}while(t!==null);return null}function DC(t,e,n,r,i){return t.mode&1?(t.flags|=65536,t.lanes=i,t):(t===e?t.flags|=65536:(t.flags|=128,n.flags|=131072,n.flags&=-52805,n.tag===1&&(n.alternate===null?n.tag=17:(e=Cs(-1,1),e.tag=2,Ao(n,e,1))),n.lanes|=1),t)}var Y3=Gs.ReactCurrentOwner,nr=!1;function jn(t,e,n,r){e.child=t===null?XA(e,null,n,r):Ic(e,t.child,n,r)}function NC(t,e,n,r,i){n=n.render;var s=e.ref;return dc(e,i),r=qx(t,e,n,r,s,i),n=Jx(),t!==null&&!nr?(e.updateQueue=t.updateQueue,e.flags&=-2053,t.lanes&=~i,Ms(t,e,i)):(Pt&&n&&jx(e),e.flags|=1,jn(t,e,r,i),e.child)}function jC(t,e,n,r,i){if(t===null){var s=n.type;return typeof s=="function"&&!l1(s)&&s.defaultProps===void 0&&n.compare===null&&n.defaultProps===void 0?(e.tag=15,e.type=s,xF(t,e,s,r,i)):(t=Lg(n.type,null,r,e,e.mode,i),t.ref=e.ref,t.return=e,e.child=t)}if(s=t.child,!(t.lanes&i)){var o=s.memoizedProps;if(n=n.compare,n=n!==null?n:Hd,n(o,r)&&t.ref===e.ref)return Ms(t,e,i)}return e.flags|=1,t=$o(s,r),t.ref=e.ref,t.return=e,e.child=t}function xF(t,e,n,r,i){if(t!==null){var s=t.memoizedProps;if(Hd(s,r)&&t.ref===e.ref)if(nr=!1,e.pendingProps=r=s,(t.lanes&i)!==0)t.flags&131072&&(nr=!0);else return e.lanes=t.lanes,Ms(t,e,i)}return Wv(t,e,n,r,i)}function EF(t,e,n){var r=e.pendingProps,i=r.children,s=t!==null?t.memoizedState:null;if(r.mode==="hidden")if(!(e.mode&1))e.memoizedState={baseLanes:0,cachePool:null,transitions:null},pt(Jl,hr),hr|=n;else{if(!(n&1073741824))return t=s!==null?s.baseLanes|n:n,e.lanes=e.childLanes=1073741824,e.memoizedState={baseLanes:t,cachePool:null,transitions:null},e.updateQueue=null,pt(Jl,hr),hr|=t,null;e.memoizedState={baseLanes:0,cachePool:null,transitions:null},r=s!==null?s.baseLanes:n,pt(Jl,hr),hr|=r}else s!==null?(r=s.baseLanes|n,e.memoizedState=null):r=n,pt(Jl,hr),hr|=r;return jn(t,e,i,n),e.child}function SF(t,e){var n=e.ref;(t===null&&n!==null||t!==null&&t.ref!==n)&&(e.flags|=512,e.flags|=2097152)}function Wv(t,e,n,r,i){var s=ir(n)?$a:kn.current;return s=Pc(e,s),dc(e,i),n=qx(t,e,n,r,s,i),r=Jx(),t!==null&&!nr?(e.updateQueue=t.updateQueue,e.flags&=-2053,t.lanes&=~i,Ms(t,e,i)):(Pt&&r&&jx(e),e.flags|=1,jn(t,e,n,i),e.child)}function zC(t,e,n,r,i){if(ir(n)){var s=!0;hp(e)}else s=!1;if(dc(e,i),e.stateNode===null)Fg(t,e),_F(e,n,r),Bv(e,n,r,i),r=!0;else if(t===null){var o=e.stateNode,a=e.memoizedProps;o.props=a;var l=o.context,c=n.contextType;typeof c=="object"&&c!==null?c=Hr(c):(c=ir(n)?$a:kn.current,c=Pc(e,c));var u=n.getDerivedStateFromProps,d=typeof u=="function"||typeof o.getSnapshotBeforeUpdate=="function";d||typeof o.UNSAFE_componentWillReceiveProps!="function"&&typeof o.componentWillReceiveProps!="function"||(a!==r||l!==c)&&LC(e,o,r,c),uo=!1;var h=e.memoizedState;o.state=h,yp(e,r,o,i),l=e.memoizedState,a!==r||h!==l||rr.current||uo?(typeof u=="function"&&(Gv(e,n,u,r),l=e.memoizedState),(a=uo||$C(e,n,a,r,h,l,c))?(d||typeof o.UNSAFE_componentWillMount!="function"&&typeof o.componentWillMount!="function"||(typeof o.componentWillMount=="function"&&o.componentWillMount(),typeof o.UNSAFE_componentWillMount=="function"&&o.UNSAFE_componentWillMount()),typeof o.componentDidMount=="function"&&(e.flags|=4194308)):(typeof o.componentDidMount=="function"&&(e.flags|=4194308),e.memoizedProps=r,e.memoizedState=l),o.props=r,o.state=l,o.context=c,r=a):(typeof o.componentDidMount=="function"&&(e.flags|=4194308),r=!1)}else{o=e.stateNode,qA(t,e),a=e.memoizedProps,c=e.type===e.elementType?a:oi(e.type,a),o.props=c,d=e.pendingProps,h=o.context,l=n.contextType,typeof l=="object"&&l!==null?l=Hr(l):(l=ir(n)?$a:kn.current,l=Pc(e,l));var f=n.getDerivedStateFromProps;(u=typeof f=="function"||typeof o.getSnapshotBeforeUpdate=="function")||typeof o.UNSAFE_componentWillReceiveProps!="function"&&typeof o.componentWillReceiveProps!="function"||(a!==d||h!==l)&&LC(e,o,r,l),uo=!1,h=e.memoizedState,o.state=h,yp(e,r,o,i);var p=e.memoizedState;a!==d||h!==p||rr.current||uo?(typeof f=="function"&&(Gv(e,n,f,r),p=e.memoizedState),(c=uo||$C(e,n,c,r,h,p,l)||!1)?(u||typeof o.UNSAFE_componentWillUpdate!="function"&&typeof o.componentWillUpdate!="function"||(typeof o.componentWillUpdate=="function"&&o.componentWillUpdate(r,p,l),typeof o.UNSAFE_componentWillUpdate=="function"&&o.UNSAFE_componentWillUpdate(r,p,l)),typeof o.componentDidUpdate=="function"&&(e.flags|=4),typeof o.getSnapshotBeforeUpdate=="function"&&(e.flags|=1024)):(typeof o.componentDidUpdate!="function"||a===t.memoizedProps&&h===t.memoizedState||(e.flags|=4),typeof o.getSnapshotBeforeUpdate!="function"||a===t.memoizedProps&&h===t.memoizedState||(e.flags|=1024),e.memoizedProps=r,e.memoizedState=p),o.props=r,o.state=p,o.context=l,r=c):(typeof o.componentDidUpdate!="function"||a===t.memoizedProps&&h===t.memoizedState||(e.flags|=4),typeof o.getSnapshotBeforeUpdate!="function"||a===t.memoizedProps&&h===t.memoizedState||(e.flags|=1024),r=!1)}return Hv(t,e,n,r,s,i)}function Hv(t,e,n,r,i,s){SF(t,e);var o=(e.flags&128)!==0;if(!r&&!o)return i&&CC(e,n,!1),Ms(t,e,s);r=e.stateNode,Y3.current=e;var a=o&&typeof n.getDerivedStateFromError!="function"?null:r.render();return e.flags|=1,t!==null&&o?(e.child=Ic(e,t.child,null,s),e.child=Ic(e,null,a,s)):jn(t,e,a,s),e.memoizedState=r.state,i&&CC(e,n,!0),e.child}function bF(t){var e=t.stateNode;e.pendingContext?bC(t,e.pendingContext,e.pendingContext!==e.context):e.context&&bC(t,e.context,!1),Kx(t,e.containerInfo)}function UC(t,e,n,r,i){return Rc(),Ux(i),e.flags|=256,jn(t,e,n,r),e.child}var Kv={dehydrated:null,treeContext:null,retryLane:0};function Yv(t){return{baseLanes:t,cachePool:null,transitions:null}}function CF(t,e,n){var r=e.pendingProps,i=Ft.current,s=!1,o=(e.flags&128)!==0,a;if((a=o)||(a=t!==null&&t.memoizedState===null?!1:(i&2)!==0),a?(s=!0,e.flags&=-129):(t===null||t.memoizedState!==null)&&(i|=1),pt(Ft,i&1),t===null)return zv(e),t=e.memoizedState,t!==null&&(t=t.dehydrated,t!==null)?(e.mode&1?t.data==="$!"?e.lanes=8:e.lanes=1073741824:e.lanes=1,null):(o=r.children,t=r.fallback,s?(r=e.mode,s=e.child,o={mode:"hidden",children:o},!(r&1)&&s!==null?(s.childLanes=0,s.pendingProps=o):s=zm(o,r,0,null),t=Fa(t,r,n,null),s.return=e,t.return=e,s.sibling=t,e.child=s,e.child.memoizedState=Yv(n),e.memoizedState=Kv,t):t1(e,o));if(i=t.memoizedState,i!==null&&(a=i.dehydrated,a!==null))return X3(t,e,o,r,a,i,n);if(s){s=r.fallback,o=e.mode,i=t.child,a=i.sibling;var l={mode:"hidden",children:r.children};return!(o&1)&&e.child!==i?(r=e.child,r.childLanes=0,r.pendingProps=l,e.deletions=null):(r=$o(i,l),r.subtreeFlags=i.subtreeFlags&14680064),a!==null?s=$o(a,s):(s=Fa(s,o,n,null),s.flags|=2),s.return=e,r.return=e,r.sibling=s,e.child=r,r=s,s=e.child,o=t.child.memoizedState,o=o===null?Yv(n):{baseLanes:o.baseLanes|n,cachePool:null,transitions:o.transitions},s.memoizedState=o,s.childLanes=t.childLanes&~n,e.memoizedState=Kv,r}return s=t.child,t=s.sibling,r=$o(s,{mode:"visible",children:r.children}),!(e.mode&1)&&(r.lanes=n),r.return=e,r.sibling=null,t!==null&&(n=e.deletions,n===null?(e.deletions=[t],e.flags|=16):n.push(t)),e.child=r,e.memoizedState=null,r}function t1(t,e){return e=zm({mode:"visible",children:e},t.mode,0,null),e.return=t,t.child=e}function Sf(t,e,n,r){return r!==null&&Ux(r),Ic(e,t.child,null,n),t=t1(e,e.pendingProps.children),t.flags|=2,e.memoizedState=null,t}function X3(t,e,n,r,i,s,o){if(n)return e.flags&256?(e.flags&=-257,r=N_(Error(oe(422))),Sf(t,e,o,r)):e.memoizedState!==null?(e.child=t.child,e.flags|=128,null):(s=r.fallback,i=e.mode,r=zm({mode:"visible",children:r.children},i,0,null),s=Fa(s,i,o,null),s.flags|=2,r.return=e,s.return=e,r.sibling=s,e.child=r,e.mode&1&&Ic(e,t.child,null,o),e.child.memoizedState=Yv(o),e.memoizedState=Kv,s);if(!(e.mode&1))return Sf(t,e,o,null);if(i.data==="$!"){if(r=i.nextSibling&&i.nextSibling.dataset,r)var a=r.dgst;return r=a,s=Error(oe(419)),r=N_(s,r,void 0),Sf(t,e,o,r)}if(a=(o&t.childLanes)!==0,nr||a){if(r=fn,r!==null){switch(o&-o){case 4:i=2;break;case 16:i=8;break;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:i=32;break;case 536870912:i=268435456;break;default:i=0}i=i&(r.suspendedLanes|o)?0:i,i!==0&&i!==s.retryLane&&(s.retryLane=i,ks(t,i),yi(r,t,i,-1))}return a1(),r=N_(Error(oe(421))),Sf(t,e,o,r)}return i.data==="$?"?(e.flags|=128,e.child=t.child,e=l5.bind(null,t),i._reactRetry=e,null):(t=s.treeContext,mr=Io(i.nextSibling),vr=e,Pt=!0,li=null,t!==null&&(kr[Mr++]=ws,kr[Mr++]=xs,kr[Mr++]=La,ws=t.id,xs=t.overflow,La=e),e=t1(e,r.children),e.flags|=4096,e)}function GC(t,e,n){t.lanes|=e;var r=t.alternate;r!==null&&(r.lanes|=e),Uv(t.return,e,n)}function j_(t,e,n,r,i){var s=t.memoizedState;s===null?t.memoizedState={isBackwards:e,rendering:null,renderingStartTime:0,last:r,tail:n,tailMode:i}:(s.isBackwards=e,s.rendering=null,s.renderingStartTime=0,s.last=r,s.tail=n,s.tailMode=i)}function TF(t,e,n){var r=e.pendingProps,i=r.revealOrder,s=r.tail;if(jn(t,e,r.children,n),r=Ft.current,r&2)r=r&1|2,e.flags|=128;else{if(t!==null&&t.flags&128)e:for(t=e.child;t!==null;){if(t.tag===13)t.memoizedState!==null&&GC(t,n,e);else if(t.tag===19)GC(t,n,e);else if(t.child!==null){t.child.return=t,t=t.child;continue}if(t===e)break e;for(;t.sibling===null;){if(t.return===null||t.return===e)break e;t=t.return}t.sibling.return=t.return,t=t.sibling}r&=1}if(pt(Ft,r),!(e.mode&1))e.memoizedState=null;else switch(i){case"forwards":for(n=e.child,i=null;n!==null;)t=n.alternate,t!==null&&_p(t)===null&&(i=n),n=n.sibling;n=i,n===null?(i=e.child,e.child=null):(i=n.sibling,n.sibling=null),j_(e,!1,i,n,s);break;case"backwards":for(n=null,i=e.child,e.child=null;i!==null;){if(t=i.alternate,t!==null&&_p(t)===null){e.child=i;break}t=i.sibling,i.sibling=n,n=i,i=t}j_(e,!0,n,null,s);break;case"together":j_(e,!1,null,null,void 0);break;default:e.memoizedState=null}return e.child}function Fg(t,e){!(e.mode&1)&&t!==null&&(t.alternate=null,e.alternate=null,e.flags|=2)}function Ms(t,e,n){if(t!==null&&(e.dependencies=t.dependencies),Ma|=e.lanes,!(n&e.childLanes))return null;if(t!==null&&e.child!==t.child)throw Error(oe(153));if(e.child!==null){for(t=e.child,n=$o(t,t.pendingProps),e.child=n,n.return=e;t.sibling!==null;)t=t.sibling,n=n.sibling=$o(t,t.pendingProps),n.return=e;n.sibling=null}return e.child}function Z3(t,e,n){switch(e.tag){case 3:bF(e),Rc();break;case 5:JA(e);break;case 1:ir(e.type)&&hp(e);break;case 4:Kx(e,e.stateNode.containerInfo);break;case 10:var r=e.type._context,i=e.memoizedProps.value;pt(pp,r._currentValue),r._currentValue=i;break;case 13:if(r=e.memoizedState,r!==null)return r.dehydrated!==null?(pt(Ft,Ft.current&1),e.flags|=128,null):n&e.child.childLanes?CF(t,e,n):(pt(Ft,Ft.current&1),t=Ms(t,e,n),t!==null?t.sibling:null);pt(Ft,Ft.current&1);break;case 19:if(r=(n&e.childLanes)!==0,t.flags&128){if(r)return TF(t,e,n);e.flags|=128}if(i=e.memoizedState,i!==null&&(i.rendering=null,i.tail=null,i.lastEffect=null),pt(Ft,Ft.current),r)break;return null;case 22:case 23:return e.lanes=0,EF(t,e,n)}return Ms(t,e,n)}var PF,Xv,RF,IF;PF=function(t,e){for(var n=e.child;n!==null;){if(n.tag===5||n.tag===6)t.appendChild(n.stateNode);else if(n.tag!==4&&n.child!==null){n.child.return=n,n=n.child;continue}if(n===e)break;for(;n.sibling===null;){if(n.return===null||n.return===e)return;n=n.return}n.sibling.return=n.return,n=n.sibling}};Xv=function(){};RF=function(t,e,n,r){var i=t.memoizedProps;if(i!==r){t=e.stateNode,Sa(Wi.current);var s=null;switch(n){case"input":i=yv(t,i),r=yv(t,r),s=[];break;case"select":i=Mt({},i,{value:void 0}),r=Mt({},r,{value:void 0}),s=[];break;case"textarea":i=wv(t,i),r=wv(t,r),s=[];break;default:typeof i.onClick!="function"&&typeof r.onClick=="function"&&(t.onclick=up)}Ev(n,r);var o;n=null;for(c in i)if(!r.hasOwnProperty(c)&&i.hasOwnProperty(c)&&i[c]!=null)if(c==="style"){var a=i[c];for(o in a)a.hasOwnProperty(o)&&(n||(n={}),n[o]="")}else c!=="dangerouslySetInnerHTML"&&c!=="children"&&c!=="suppressContentEditableWarning"&&c!=="suppressHydrationWarning"&&c!=="autoFocus"&&(jd.hasOwnProperty(c)?s||(s=[]):(s=s||[]).push(c,null));for(c in r){var l=r[c];if(a=i!=null?i[c]:void 0,r.hasOwnProperty(c)&&l!==a&&(l!=null||a!=null))if(c==="style")if(a){for(o in a)!a.hasOwnProperty(o)||l&&l.hasOwnProperty(o)||(n||(n={}),n[o]="");for(o in l)l.hasOwnProperty(o)&&a[o]!==l[o]&&(n||(n={}),n[o]=l[o])}else n||(s||(s=[]),s.push(c,n)),n=l;else c==="dangerouslySetInnerHTML"?(l=l?l.__html:void 0,a=a?a.__html:void 0,l!=null&&a!==l&&(s=s||[]).push(c,l)):c==="children"?typeof l!="string"&&typeof l!="number"||(s=s||[]).push(c,""+l):c!=="suppressContentEditableWarning"&&c!=="suppressHydrationWarning"&&(jd.hasOwnProperty(c)?(l!=null&&c==="onScroll"&&wt("scroll",t),s||a===l||(s=[])):(s=s||[]).push(c,l))}n&&(s=s||[]).push("style",n);var c=s;(e.updateQueue=c)&&(e.flags|=4)}};IF=function(t,e,n,r){n!==r&&(e.flags|=4)};function Mu(t,e){if(!Pt)switch(t.tailMode){case"hidden":e=t.tail;for(var n=null;e!==null;)e.alternate!==null&&(n=e),e=e.sibling;n===null?t.tail=null:n.sibling=null;break;case"collapsed":n=t.tail;for(var r=null;n!==null;)n.alternate!==null&&(r=n),n=n.sibling;r===null?e||t.tail===null?t.tail=null:t.tail.sibling=null:r.sibling=null}}function Rn(t){var e=t.alternate!==null&&t.alternate.child===t.child,n=0,r=0;if(e)for(var i=t.child;i!==null;)n|=i.lanes|i.childLanes,r|=i.subtreeFlags&14680064,r|=i.flags&14680064,i.return=t,i=i.sibling;else for(i=t.child;i!==null;)n|=i.lanes|i.childLanes,r|=i.subtreeFlags,r|=i.flags,i.return=t,i=i.sibling;return t.subtreeFlags|=r,t.childLanes=n,e}function q3(t,e,n){var r=e.pendingProps;switch(zx(e),e.tag){case 2:case 16:case 15:case 0:case 11:case 7:case 8:case 12:case 9:case 14:return Rn(e),null;case 1:return ir(e.type)&&dp(),Rn(e),null;case 3:return r=e.stateNode,Ac(),Ct(rr),Ct(kn),Xx(),r.pendingContext&&(r.context=r.pendingContext,r.pendingContext=null),(t===null||t.child===null)&&(xf(e)?e.flags|=4:t===null||t.memoizedState.isDehydrated&&!(e.flags&256)||(e.flags|=1024,li!==null&&(rw(li),li=null))),Xv(t,e),Rn(e),null;case 5:Yx(e);var i=Sa(qd.current);if(n=e.type,t!==null&&e.stateNode!=null)RF(t,e,n,r,i),t.ref!==e.ref&&(e.flags|=512,e.flags|=2097152);else{if(!r){if(e.stateNode===null)throw Error(oe(166));return Rn(e),null}if(t=Sa(Wi.current),xf(e)){r=e.stateNode,n=e.type;var s=e.memoizedProps;switch(r[Li]=e,r[Xd]=s,t=(e.mode&1)!==0,n){case"dialog":wt("cancel",r),wt("close",r);break;case"iframe":case"object":case"embed":wt("load",r);break;case"video":case"audio":for(i=0;i<sd.length;i++)wt(sd[i],r);break;case"source":wt("error",r);break;case"img":case"image":case"link":wt("error",r),wt("load",r);break;case"details":wt("toggle",r);break;case"input":qb(r,s),wt("invalid",r);break;case"select":r._wrapperState={wasMultiple:!!s.multiple},wt("invalid",r);break;case"textarea":Qb(r,s),wt("invalid",r)}Ev(n,s),i=null;for(var o in s)if(s.hasOwnProperty(o)){var a=s[o];o==="children"?typeof a=="string"?r.textContent!==a&&(s.suppressHydrationWarning!==!0&&wf(r.textContent,a,t),i=["children",a]):typeof a=="number"&&r.textContent!==""+a&&(s.suppressHydrationWarning!==!0&&wf(r.textContent,a,t),i=["children",""+a]):jd.hasOwnProperty(o)&&a!=null&&o==="onScroll"&&wt("scroll",r)}switch(n){case"input":hf(r),Jb(r,s,!0);break;case"textarea":hf(r),eC(r);break;case"select":case"option":break;default:typeof s.onClick=="function"&&(r.onclick=up)}r=i,e.updateQueue=r,r!==null&&(e.flags|=4)}else{o=i.nodeType===9?i:i.ownerDocument,t==="http://www.w3.org/1999/xhtml"&&(t=rA(n)),t==="http://www.w3.org/1999/xhtml"?n==="script"?(t=o.createElement("div"),t.innerHTML="<script><\/script>",t=t.removeChild(t.firstChild)):typeof r.is=="string"?t=o.createElement(n,{is:r.is}):(t=o.createElement(n),n==="select"&&(o=t,r.multiple?o.multiple=!0:r.size&&(o.size=r.size))):t=o.createElementNS(t,n),t[Li]=e,t[Xd]=r,PF(t,e,!1,!1),e.stateNode=t;e:{switch(o=Sv(n,r),n){case"dialog":wt("cancel",t),wt("close",t),i=r;break;case"iframe":case"object":case"embed":wt("load",t),i=r;break;case"video":case"audio":for(i=0;i<sd.length;i++)wt(sd[i],t);i=r;break;case"source":wt("error",t),i=r;break;case"img":case"image":case"link":wt("error",t),wt("load",t),i=r;break;case"details":wt("toggle",t),i=r;break;case"input":qb(t,r),i=yv(t,r),wt("invalid",t);break;case"option":i=r;break;case"select":t._wrapperState={wasMultiple:!!r.multiple},i=Mt({},r,{value:void 0}),wt("invalid",t);break;case"textarea":Qb(t,r),i=wv(t,r),wt("invalid",t);break;default:i=r}Ev(n,i),a=i;for(s in a)if(a.hasOwnProperty(s)){var l=a[s];s==="style"?oA(t,l):s==="dangerouslySetInnerHTML"?(l=l?l.__html:void 0,l!=null&&iA(t,l)):s==="children"?typeof l=="string"?(n!=="textarea"||l!=="")&&zd(t,l):typeof l=="number"&&zd(t,""+l):s!=="suppressContentEditableWarning"&&s!=="suppressHydrationWarning"&&s!=="autoFocus"&&(jd.hasOwnProperty(s)?l!=null&&s==="onScroll"&&wt("scroll",t):l!=null&&Cx(t,s,l,o))}switch(n){case"input":hf(t),Jb(t,r,!1);break;case"textarea":hf(t),eC(t);break;case"option":r.value!=null&&t.setAttribute("value",""+No(r.value));break;case"select":t.multiple=!!r.multiple,s=r.value,s!=null?ac(t,!!r.multiple,s,!1):r.defaultValue!=null&&ac(t,!!r.multiple,r.defaultValue,!0);break;default:typeof i.onClick=="function"&&(t.onclick=up)}switch(n){case"button":case"input":case"select":case"textarea":r=!!r.autoFocus;break e;case"img":r=!0;break e;default:r=!1}}r&&(e.flags|=4)}e.ref!==null&&(e.flags|=512,e.flags|=2097152)}return Rn(e),null;case 6:if(t&&e.stateNode!=null)IF(t,e,t.memoizedProps,r);else{if(typeof r!="string"&&e.stateNode===null)throw Error(oe(166));if(n=Sa(qd.current),Sa(Wi.current),xf(e)){if(r=e.stateNode,n=e.memoizedProps,r[Li]=e,(s=r.nodeValue!==n)&&(t=vr,t!==null))switch(t.tag){case 3:wf(r.nodeValue,n,(t.mode&1)!==0);break;case 5:t.memoizedProps.suppressHydrationWarning!==!0&&wf(r.nodeValue,n,(t.mode&1)!==0)}s&&(e.flags|=4)}else r=(n.nodeType===9?n:n.ownerDocument).createTextNode(r),r[Li]=e,e.stateNode=r}return Rn(e),null;case 13:if(Ct(Ft),r=e.memoizedState,t===null||t.memoizedState!==null&&t.memoizedState.dehydrated!==null){if(Pt&&mr!==null&&e.mode&1&&!(e.flags&128))KA(),Rc(),e.flags|=98560,s=!1;else if(s=xf(e),r!==null&&r.dehydrated!==null){if(t===null){if(!s)throw Error(oe(318));if(s=e.memoizedState,s=s!==null?s.dehydrated:null,!s)throw Error(oe(317));s[Li]=e}else Rc(),!(e.flags&128)&&(e.memoizedState=null),e.flags|=4;Rn(e),s=!1}else li!==null&&(rw(li),li=null),s=!0;if(!s)return e.flags&65536?e:null}return e.flags&128?(e.lanes=n,e):(r=r!==null,r!==(t!==null&&t.memoizedState!==null)&&r&&(e.child.flags|=8192,e.mode&1&&(t===null||Ft.current&1?tn===0&&(tn=3):a1())),e.updateQueue!==null&&(e.flags|=4),Rn(e),null);case 4:return Ac(),Xv(t,e),t===null&&Kd(e.stateNode.containerInfo),Rn(e),null;case 10:return Vx(e.type._context),Rn(e),null;case 17:return ir(e.type)&&dp(),Rn(e),null;case 19:if(Ct(Ft),s=e.memoizedState,s===null)return Rn(e),null;if(r=(e.flags&128)!==0,o=s.rendering,o===null)if(r)Mu(s,!1);else{if(tn!==0||t!==null&&t.flags&128)for(t=e.child;t!==null;){if(o=_p(t),o!==null){for(e.flags|=128,Mu(s,!1),r=o.updateQueue,r!==null&&(e.updateQueue=r,e.flags|=4),e.subtreeFlags=0,r=n,n=e.child;n!==null;)s=n,t=r,s.flags&=14680066,o=s.alternate,o===null?(s.childLanes=0,s.lanes=t,s.child=null,s.subtreeFlags=0,s.memoizedProps=null,s.memoizedState=null,s.updateQueue=null,s.dependencies=null,s.stateNode=null):(s.childLanes=o.childLanes,s.lanes=o.lanes,s.child=o.child,s.subtreeFlags=0,s.deletions=null,s.memoizedProps=o.memoizedProps,s.memoizedState=o.memoizedState,s.updateQueue=o.updateQueue,s.type=o.type,t=o.dependencies,s.dependencies=t===null?null:{lanes:t.lanes,firstContext:t.firstContext}),n=n.sibling;return pt(Ft,Ft.current&1|2),e.child}t=t.sibling}s.tail!==null&&Ut()>Oc&&(e.flags|=128,r=!0,Mu(s,!1),e.lanes=4194304)}else{if(!r)if(t=_p(o),t!==null){if(e.flags|=128,r=!0,n=t.updateQueue,n!==null&&(e.updateQueue=n,e.flags|=4),Mu(s,!0),s.tail===null&&s.tailMode==="hidden"&&!o.alternate&&!Pt)return Rn(e),null}else 2*Ut()-s.renderingStartTime>Oc&&n!==1073741824&&(e.flags|=128,r=!0,Mu(s,!1),e.lanes=4194304);s.isBackwards?(o.sibling=e.child,e.child=o):(n=s.last,n!==null?n.sibling=o:e.child=o,s.last=o)}return s.tail!==null?(e=s.tail,s.rendering=e,s.tail=e.sibling,s.renderingStartTime=Ut(),e.sibling=null,n=Ft.current,pt(Ft,r?n&1|2:n&1),e):(Rn(e),null);case 22:case 23:return o1(),r=e.memoizedState!==null,t!==null&&t.memoizedState!==null!==r&&(e.flags|=8192),r&&e.mode&1?hr&1073741824&&(Rn(e),e.subtreeFlags&6&&(e.flags|=8192)):Rn(e),null;case 24:return null;case 25:return null}throw Error(oe(156,e.tag))}function J3(t,e){switch(zx(e),e.tag){case 1:return ir(e.type)&&dp(),t=e.flags,t&65536?(e.flags=t&-65537|128,e):null;case 3:return Ac(),Ct(rr),Ct(kn),Xx(),t=e.flags,t&65536&&!(t&128)?(e.flags=t&-65537|128,e):null;case 5:return Yx(e),null;case 13:if(Ct(Ft),t=e.memoizedState,t!==null&&t.dehydrated!==null){if(e.alternate===null)throw Error(oe(340));Rc()}return t=e.flags,t&65536?(e.flags=t&-65537|128,e):null;case 19:return Ct(Ft),null;case 4:return Ac(),null;case 10:return Vx(e.type._context),null;case 22:case 23:return o1(),null;case 24:return null;default:return null}}var bf=!1,On=!1,Q3=typeof WeakSet=="function"?WeakSet:Set,me=null;function ql(t,e){var n=t.ref;if(n!==null)if(typeof n=="function")try{n(null)}catch(r){Nt(t,e,r)}else n.current=null}function Zv(t,e,n){try{n()}catch(r){Nt(t,e,r)}}var BC=!1;function e5(t,e){if($v=ap,t=LA(),Nx(t)){if("selectionStart"in t)var n={start:t.selectionStart,end:t.selectionEnd};else e:{n=(n=t.ownerDocument)&&n.defaultView||window;var r=n.getSelection&&n.getSelection();if(r&&r.rangeCount!==0){n=r.anchorNode;var i=r.anchorOffset,s=r.focusNode;r=r.focusOffset;try{n.nodeType,s.nodeType}catch{n=null;break e}var o=0,a=-1,l=-1,c=0,u=0,d=t,h=null;t:for(;;){for(var f;d!==n||i!==0&&d.nodeType!==3||(a=o+i),d!==s||r!==0&&d.nodeType!==3||(l=o+r),d.nodeType===3&&(o+=d.nodeValue.length),(f=d.firstChild)!==null;)h=d,d=f;for(;;){if(d===t)break t;if(h===n&&++c===i&&(a=o),h===s&&++u===r&&(l=o),(f=d.nextSibling)!==null)break;d=h,h=d.parentNode}d=f}n=a===-1||l===-1?null:{start:a,end:l}}else n=null}n=n||{start:0,end:0}}else n=null;for(Lv={focusedElem:t,selectionRange:n},ap=!1,me=e;me!==null;)if(e=me,t=e.child,(e.subtreeFlags&1028)!==0&&t!==null)t.return=e,me=t;else for(;me!==null;){e=me;try{var p=e.alternate;if(e.flags&1024)switch(e.tag){case 0:case 11:case 15:break;case 1:if(p!==null){var m=p.memoizedProps,_=p.memoizedState,g=e.stateNode,y=g.getSnapshotBeforeUpdate(e.elementType===e.type?m:oi(e.type,m),_);g.__reactInternalSnapshotBeforeUpdate=y}break;case 3:var v=e.stateNode.containerInfo;v.nodeType===1?v.textContent="":v.nodeType===9&&v.documentElement&&v.removeChild(v.documentElement);break;case 5:case 6:case 4:case 17:break;default:throw Error(oe(163))}}catch(w){Nt(e,e.return,w)}if(t=e.sibling,t!==null){t.return=e.return,me=t;break}me=e.return}return p=BC,BC=!1,p}function _d(t,e,n){var r=e.updateQueue;if(r=r!==null?r.lastEffect:null,r!==null){var i=r=r.next;do{if((i.tag&t)===t){var s=i.destroy;i.destroy=void 0,s!==void 0&&Zv(e,n,s)}i=i.next}while(i!==r)}}function Nm(t,e){if(e=e.updateQueue,e=e!==null?e.lastEffect:null,e!==null){var n=e=e.next;do{if((n.tag&t)===t){var r=n.create;n.destroy=r()}n=n.next}while(n!==e)}}function qv(t){var e=t.ref;if(e!==null){var n=t.stateNode;switch(t.tag){case 5:t=n;break;default:t=n}typeof e=="function"?e(t):e.current=t}}function AF(t){var e=t.alternate;e!==null&&(t.alternate=null,AF(e)),t.child=null,t.deletions=null,t.sibling=null,t.tag===5&&(e=t.stateNode,e!==null&&(delete e[Li],delete e[Xd],delete e[Dv],delete e[M3],delete e[D3])),t.stateNode=null,t.return=null,t.dependencies=null,t.memoizedProps=null,t.memoizedState=null,t.pendingProps=null,t.stateNode=null,t.updateQueue=null}function FF(t){return t.tag===5||t.tag===3||t.tag===4}function VC(t){e:for(;;){for(;t.sibling===null;){if(t.return===null||FF(t.return))return null;t=t.return}for(t.sibling.return=t.return,t=t.sibling;t.tag!==5&&t.tag!==6&&t.tag!==18;){if(t.flags&2||t.child===null||t.tag===4)continue e;t.child.return=t,t=t.child}if(!(t.flags&2))return t.stateNode}}function Jv(t,e,n){var r=t.tag;if(r===5||r===6)t=t.stateNode,e?n.nodeType===8?n.parentNode.insertBefore(t,e):n.insertBefore(t,e):(n.nodeType===8?(e=n.parentNode,e.insertBefore(t,n)):(e=n,e.appendChild(t)),n=n._reactRootContainer,n!=null||e.onclick!==null||(e.onclick=up));else if(r!==4&&(t=t.child,t!==null))for(Jv(t,e,n),t=t.sibling;t!==null;)Jv(t,e,n),t=t.sibling}function Qv(t,e,n){var r=t.tag;if(r===5||r===6)t=t.stateNode,e?n.insertBefore(t,e):n.appendChild(t);else if(r!==4&&(t=t.child,t!==null))for(Qv(t,e,n),t=t.sibling;t!==null;)Qv(t,e,n),t=t.sibling}var yn=null,ai=!1;function Js(t,e,n){for(n=n.child;n!==null;)OF(t,e,n),n=n.sibling}function OF(t,e,n){if(Vi&&typeof Vi.onCommitFiberUnmount=="function")try{Vi.onCommitFiberUnmount(Am,n)}catch{}switch(n.tag){case 5:On||ql(n,e);case 6:var r=yn,i=ai;yn=null,Js(t,e,n),yn=r,ai=i,yn!==null&&(ai?(t=yn,n=n.stateNode,t.nodeType===8?t.parentNode.removeChild(n):t.removeChild(n)):yn.removeChild(n.stateNode));break;case 18:yn!==null&&(ai?(t=yn,n=n.stateNode,t.nodeType===8?O_(t.parentNode,n):t.nodeType===1&&O_(t,n),Vd(t)):O_(yn,n.stateNode));break;case 4:r=yn,i=ai,yn=n.stateNode.containerInfo,ai=!0,Js(t,e,n),yn=r,ai=i;break;case 0:case 11:case 14:case 15:if(!On&&(r=n.updateQueue,r!==null&&(r=r.lastEffect,r!==null))){i=r=r.next;do{var s=i,o=s.destroy;s=s.tag,o!==void 0&&(s&2||s&4)&&Zv(n,e,o),i=i.next}while(i!==r)}Js(t,e,n);break;case 1:if(!On&&(ql(n,e),r=n.stateNode,typeof r.componentWillUnmount=="function"))try{r.props=n.memoizedProps,r.state=n.memoizedState,r.componentWillUnmount()}catch(a){Nt(n,e,a)}Js(t,e,n);break;case 21:Js(t,e,n);break;case 22:n.mode&1?(On=(r=On)||n.memoizedState!==null,Js(t,e,n),On=r):Js(t,e,n);break;default:Js(t,e,n)}}function WC(t){var e=t.updateQueue;if(e!==null){t.updateQueue=null;var n=t.stateNode;n===null&&(n=t.stateNode=new Q3),e.forEach(function(r){var i=c5.bind(null,t,r);n.has(r)||(n.add(r),r.then(i,i))})}}function ni(t,e){var n=e.deletions;if(n!==null)for(var r=0;r<n.length;r++){var i=n[r];try{var s=t,o=e,a=o;e:for(;a!==null;){switch(a.tag){case 5:yn=a.stateNode,ai=!1;break e;case 3:yn=a.stateNode.containerInfo,ai=!0;break e;case 4:yn=a.stateNode.containerInfo,ai=!0;break e}a=a.return}if(yn===null)throw Error(oe(160));OF(s,o,i),yn=null,ai=!1;var l=i.alternate;l!==null&&(l.return=null),i.return=null}catch(c){Nt(i,e,c)}}if(e.subtreeFlags&12854)for(e=e.child;e!==null;)$F(e,t),e=e.sibling}function $F(t,e){var n=t.alternate,r=t.flags;switch(t.tag){case 0:case 11:case 14:case 15:if(ni(e,t),Ii(t),r&4){try{_d(3,t,t.return),Nm(3,t)}catch(m){Nt(t,t.return,m)}try{_d(5,t,t.return)}catch(m){Nt(t,t.return,m)}}break;case 1:ni(e,t),Ii(t),r&512&&n!==null&&ql(n,n.return);break;case 5:if(ni(e,t),Ii(t),r&512&&n!==null&&ql(n,n.return),t.flags&32){var i=t.stateNode;try{zd(i,"")}catch(m){Nt(t,t.return,m)}}if(r&4&&(i=t.stateNode,i!=null)){var s=t.memoizedProps,o=n!==null?n.memoizedProps:s,a=t.type,l=t.updateQueue;if(t.updateQueue=null,l!==null)try{a==="input"&&s.type==="radio"&&s.name!=null&&tA(i,s),Sv(a,o);var c=Sv(a,s);for(o=0;o<l.length;o+=2){var u=l[o],d=l[o+1];u==="style"?oA(i,d):u==="dangerouslySetInnerHTML"?iA(i,d):u==="children"?zd(i,d):Cx(i,u,d,c)}switch(a){case"input":_v(i,s);break;case"textarea":nA(i,s);break;case"select":var h=i._wrapperState.wasMultiple;i._wrapperState.wasMultiple=!!s.multiple;var f=s.value;f!=null?ac(i,!!s.multiple,f,!1):h!==!!s.multiple&&(s.defaultValue!=null?ac(i,!!s.multiple,s.defaultValue,!0):ac(i,!!s.multiple,s.multiple?[]:"",!1))}i[Xd]=s}catch(m){Nt(t,t.return,m)}}break;case 6:if(ni(e,t),Ii(t),r&4){if(t.stateNode===null)throw Error(oe(162));i=t.stateNode,s=t.memoizedProps;try{i.nodeValue=s}catch(m){Nt(t,t.return,m)}}break;case 3:if(ni(e,t),Ii(t),r&4&&n!==null&&n.memoizedState.isDehydrated)try{Vd(e.containerInfo)}catch(m){Nt(t,t.return,m)}break;case 4:ni(e,t),Ii(t);break;case 13:ni(e,t),Ii(t),i=t.child,i.flags&8192&&(s=i.memoizedState!==null,i.stateNode.isHidden=s,!s||i.alternate!==null&&i.alternate.memoizedState!==null||(i1=Ut())),r&4&&WC(t);break;case 22:if(u=n!==null&&n.memoizedState!==null,t.mode&1?(On=(c=On)||u,ni(e,t),On=c):ni(e,t),Ii(t),r&8192){if(c=t.memoizedState!==null,(t.stateNode.isHidden=c)&&!u&&t.mode&1)for(me=t,u=t.child;u!==null;){for(d=me=u;me!==null;){switch(h=me,f=h.child,h.tag){case 0:case 11:case 14:case 15:_d(4,h,h.return);break;case 1:ql(h,h.return);var p=h.stateNode;if(typeof p.componentWillUnmount=="function"){r=h,n=h.return;try{e=r,p.props=e.memoizedProps,p.state=e.memoizedState,p.componentWillUnmount()}catch(m){Nt(r,n,m)}}break;case 5:ql(h,h.return);break;case 22:if(h.memoizedState!==null){KC(d);continue}}f!==null?(f.return=h,me=f):KC(d)}u=u.sibling}e:for(u=null,d=t;;){if(d.tag===5){if(u===null){u=d;try{i=d.stateNode,c?(s=i.style,typeof s.setProperty=="function"?s.setProperty("display","none","important"):s.display="none"):(a=d.stateNode,l=d.memoizedProps.style,o=l!=null&&l.hasOwnProperty("display")?l.display:null,a.style.display=sA("display",o))}catch(m){Nt(t,t.return,m)}}}else if(d.tag===6){if(u===null)try{d.stateNode.nodeValue=c?"":d.memoizedProps}catch(m){Nt(t,t.return,m)}}else if((d.tag!==22&&d.tag!==23||d.memoizedState===null||d===t)&&d.child!==null){d.child.return=d,d=d.child;continue}if(d===t)break e;for(;d.sibling===null;){if(d.return===null||d.return===t)break e;u===d&&(u=null),d=d.return}u===d&&(u=null),d.sibling.return=d.return,d=d.sibling}}break;case 19:ni(e,t),Ii(t),r&4&&WC(t);break;case 21:break;default:ni(e,t),Ii(t)}}function Ii(t){var e=t.flags;if(e&2){try{e:{for(var n=t.return;n!==null;){if(FF(n)){var r=n;break e}n=n.return}throw Error(oe(160))}switch(r.tag){case 5:var i=r.stateNode;r.flags&32&&(zd(i,""),r.flags&=-33);var s=VC(t);Qv(t,s,i);break;case 3:case 4:var o=r.stateNode.containerInfo,a=VC(t);Jv(t,a,o);break;default:throw Error(oe(161))}}catch(l){Nt(t,t.return,l)}t.flags&=-3}e&4096&&(t.flags&=-4097)}function t5(t,e,n){me=t,LF(t)}function LF(t,e,n){for(var r=(t.mode&1)!==0;me!==null;){var i=me,s=i.child;if(i.tag===22&&r){var o=i.memoizedState!==null||bf;if(!o){var a=i.alternate,l=a!==null&&a.memoizedState!==null||On;a=bf;var c=On;if(bf=o,(On=l)&&!c)for(me=i;me!==null;)o=me,l=o.child,o.tag===22&&o.memoizedState!==null?YC(i):l!==null?(l.return=o,me=l):YC(i);for(;s!==null;)me=s,LF(s),s=s.sibling;me=i,bf=a,On=c}HC(t)}else i.subtreeFlags&8772&&s!==null?(s.return=i,me=s):HC(t)}}function HC(t){for(;me!==null;){var e=me;if(e.flags&8772){var n=e.alternate;try{if(e.flags&8772)switch(e.tag){case 0:case 11:case 15:On||Nm(5,e);break;case 1:var r=e.stateNode;if(e.flags&4&&!On)if(n===null)r.componentDidMount();else{var i=e.elementType===e.type?n.memoizedProps:oi(e.type,n.memoizedProps);r.componentDidUpdate(i,n.memoizedState,r.__reactInternalSnapshotBeforeUpdate)}var s=e.updateQueue;s!==null&&AC(e,s,r);break;case 3:var o=e.updateQueue;if(o!==null){if(n=null,e.child!==null)switch(e.child.tag){case 5:n=e.child.stateNode;break;case 1:n=e.child.stateNode}AC(e,o,n)}break;case 5:var a=e.stateNode;if(n===null&&e.flags&4){n=a;var l=e.memoizedProps;switch(e.type){case"button":case"input":case"select":case"textarea":l.autoFocus&&n.focus();break;case"img":l.src&&(n.src=l.src)}}break;case 6:break;case 4:break;case 12:break;case 13:if(e.memoizedState===null){var c=e.alternate;if(c!==null){var u=c.memoizedState;if(u!==null){var d=u.dehydrated;d!==null&&Vd(d)}}}break;case 19:case 17:case 21:case 22:case 23:case 25:break;default:throw Error(oe(163))}On||e.flags&512&&qv(e)}catch(h){Nt(e,e.return,h)}}if(e===t){me=null;break}if(n=e.sibling,n!==null){n.return=e.return,me=n;break}me=e.return}}function KC(t){for(;me!==null;){var e=me;if(e===t){me=null;break}var n=e.sibling;if(n!==null){n.return=e.return,me=n;break}me=e.return}}function YC(t){for(;me!==null;){var e=me;try{switch(e.tag){case 0:case 11:case 15:var n=e.return;try{Nm(4,e)}catch(l){Nt(e,n,l)}break;case 1:var r=e.stateNode;if(typeof r.componentDidMount=="function"){var i=e.return;try{r.componentDidMount()}catch(l){Nt(e,i,l)}}var s=e.return;try{qv(e)}catch(l){Nt(e,s,l)}break;case 5:var o=e.return;try{qv(e)}catch(l){Nt(e,o,l)}}}catch(l){Nt(e,e.return,l)}if(e===t){me=null;break}var a=e.sibling;if(a!==null){a.return=e.return,me=a;break}me=e.return}}var n5=Math.ceil,xp=Gs.ReactCurrentDispatcher,n1=Gs.ReactCurrentOwner,Br=Gs.ReactCurrentBatchConfig,Xe=0,fn=null,Yt=null,En=0,hr=0,Jl=Yo(0),tn=0,th=null,Ma=0,jm=0,r1=0,vd=null,Jn=null,i1=0,Oc=1/0,gs=null,Ep=!1,ew=null,Fo=null,Cf=!1,yo=null,Sp=0,wd=0,tw=null,Og=-1,$g=0;function Vn(){return Xe&6?Ut():Og!==-1?Og:Og=Ut()}function Oo(t){return t.mode&1?Xe&2&&En!==0?En&-En:j3.transition!==null?($g===0&&($g=_A()),$g):(t=st,t!==0||(t=window.event,t=t===void 0?16:CA(t.type)),t):1}function yi(t,e,n,r){if(50<wd)throw wd=0,tw=null,Error(oe(185));Ih(t,n,r),(!(Xe&2)||t!==fn)&&(t===fn&&(!(Xe&2)&&(jm|=n),tn===4&&go(t,En)),sr(t,r),n===1&&Xe===0&&!(e.mode&1)&&(Oc=Ut()+500,km&&Xo()))}function sr(t,e){var n=t.callbackNode;jj(t,e);var r=op(t,t===fn?En:0);if(r===0)n!==null&&rC(n),t.callbackNode=null,t.callbackPriority=0;else if(e=r&-r,t.callbackPriority!==e){if(n!=null&&rC(n),e===1)t.tag===0?N3(XC.bind(null,t)):VA(XC.bind(null,t)),L3(function(){!(Xe&6)&&Xo()}),n=null;else{switch(vA(r)){case 1:n=Ax;break;case 4:n=mA;break;case 16:n=sp;break;case 536870912:n=yA;break;default:n=sp}n=GF(n,kF.bind(null,t))}t.callbackPriority=e,t.callbackNode=n}}function kF(t,e){if(Og=-1,$g=0,Xe&6)throw Error(oe(327));var n=t.callbackNode;if(hc()&&t.callbackNode!==n)return null;var r=op(t,t===fn?En:0);if(r===0)return null;if(r&30||r&t.expiredLanes||e)e=bp(t,r);else{e=r;var i=Xe;Xe|=2;var s=DF();(fn!==t||En!==e)&&(gs=null,Oc=Ut()+500,Aa(t,e));do try{s5();break}catch(a){MF(t,a)}while(!0);Bx(),xp.current=s,Xe=i,Yt!==null?e=0:(fn=null,En=0,e=tn)}if(e!==0){if(e===2&&(i=Rv(t),i!==0&&(r=i,e=nw(t,i))),e===1)throw n=th,Aa(t,0),go(t,r),sr(t,Ut()),n;if(e===6)go(t,r);else{if(i=t.current.alternate,!(r&30)&&!r5(i)&&(e=bp(t,r),e===2&&(s=Rv(t),s!==0&&(r=s,e=nw(t,s))),e===1))throw n=th,Aa(t,0),go(t,r),sr(t,Ut()),n;switch(t.finishedWork=i,t.finishedLanes=r,e){case 0:case 1:throw Error(oe(345));case 2:da(t,Jn,gs);break;case 3:if(go(t,r),(r&130023424)===r&&(e=i1+500-Ut(),10<e)){if(op(t,0)!==0)break;if(i=t.suspendedLanes,(i&r)!==r){Vn(),t.pingedLanes|=t.suspendedLanes&i;break}t.timeoutHandle=Mv(da.bind(null,t,Jn,gs),e);break}da(t,Jn,gs);break;case 4:if(go(t,r),(r&4194240)===r)break;for(e=t.eventTimes,i=-1;0<r;){var o=31-mi(r);s=1<<o,o=e[o],o>i&&(i=o),r&=~s}if(r=i,r=Ut()-r,r=(120>r?120:480>r?480:1080>r?1080:1920>r?1920:3e3>r?3e3:4320>r?4320:1960*n5(r/1960))-r,10<r){t.timeoutHandle=Mv(da.bind(null,t,Jn,gs),r);break}da(t,Jn,gs);break;case 5:da(t,Jn,gs);break;default:throw Error(oe(329))}}}return sr(t,Ut()),t.callbackNode===n?kF.bind(null,t):null}function nw(t,e){var n=vd;return t.current.memoizedState.isDehydrated&&(Aa(t,e).flags|=256),t=bp(t,e),t!==2&&(e=Jn,Jn=n,e!==null&&rw(e)),t}function rw(t){Jn===null?Jn=t:Jn.push.apply(Jn,t)}function r5(t){for(var e=t;;){if(e.flags&16384){var n=e.updateQueue;if(n!==null&&(n=n.stores,n!==null))for(var r=0;r<n.length;r++){var i=n[r],s=i.getSnapshot;i=i.value;try{if(!xi(s(),i))return!1}catch{return!1}}}if(n=e.child,e.subtreeFlags&16384&&n!==null)n.return=e,e=n;else{if(e===t)break;for(;e.sibling===null;){if(e.return===null||e.return===t)return!0;e=e.return}e.sibling.return=e.return,e=e.sibling}}return!0}function go(t,e){for(e&=~r1,e&=~jm,t.suspendedLanes|=e,t.pingedLanes&=~e,t=t.expirationTimes;0<e;){var n=31-mi(e),r=1<<n;t[n]=-1,e&=~r}}function XC(t){if(Xe&6)throw Error(oe(327));hc();var e=op(t,0);if(!(e&1))return sr(t,Ut()),null;var n=bp(t,e);if(t.tag!==0&&n===2){var r=Rv(t);r!==0&&(e=r,n=nw(t,r))}if(n===1)throw n=th,Aa(t,0),go(t,e),sr(t,Ut()),n;if(n===6)throw Error(oe(345));return t.finishedWork=t.current.alternate,t.finishedLanes=e,da(t,Jn,gs),sr(t,Ut()),null}function s1(t,e){var n=Xe;Xe|=1;try{return t(e)}finally{Xe=n,Xe===0&&(Oc=Ut()+500,km&&Xo())}}function Da(t){yo!==null&&yo.tag===0&&!(Xe&6)&&hc();var e=Xe;Xe|=1;var n=Br.transition,r=st;try{if(Br.transition=null,st=1,t)return t()}finally{st=r,Br.transition=n,Xe=e,!(Xe&6)&&Xo()}}function o1(){hr=Jl.current,Ct(Jl)}function Aa(t,e){t.finishedWork=null,t.finishedLanes=0;var n=t.timeoutHandle;if(n!==-1&&(t.timeoutHandle=-1,$3(n)),Yt!==null)for(n=Yt.return;n!==null;){var r=n;switch(zx(r),r.tag){case 1:r=r.type.childContextTypes,r!=null&&dp();break;case 3:Ac(),Ct(rr),Ct(kn),Xx();break;case 5:Yx(r);break;case 4:Ac();break;case 13:Ct(Ft);break;case 19:Ct(Ft);break;case 10:Vx(r.type._context);break;case 22:case 23:o1()}n=n.return}if(fn=t,Yt=t=$o(t.current,null),En=hr=e,tn=0,th=null,r1=jm=Ma=0,Jn=vd=null,Ea!==null){for(e=0;e<Ea.length;e++)if(n=Ea[e],r=n.interleaved,r!==null){n.interleaved=null;var i=r.next,s=n.pending;if(s!==null){var o=s.next;s.next=i,r.next=o}n.pending=r}Ea=null}return t}function MF(t,e){do{var n=Yt;try{if(Bx(),Ig.current=wp,vp){for(var r=kt.memoizedState;r!==null;){var i=r.queue;i!==null&&(i.pending=null),r=r.next}vp=!1}if(ka=0,cn=Zt=kt=null,yd=!1,Jd=0,n1.current=null,n===null||n.return===null){tn=1,th=e,Yt=null;break}e:{var s=t,o=n.return,a=n,l=e;if(e=En,a.flags|=32768,l!==null&&typeof l=="object"&&typeof l.then=="function"){var c=l,u=a,d=u.tag;if(!(u.mode&1)&&(d===0||d===11||d===15)){var h=u.alternate;h?(u.updateQueue=h.updateQueue,u.memoizedState=h.memoizedState,u.lanes=h.lanes):(u.updateQueue=null,u.memoizedState=null)}var f=MC(o);if(f!==null){f.flags&=-257,DC(f,o,a,s,e),f.mode&1&&kC(s,c,e),e=f,l=c;var p=e.updateQueue;if(p===null){var m=new Set;m.add(l),e.updateQueue=m}else p.add(l);break e}else{if(!(e&1)){kC(s,c,e),a1();break e}l=Error(oe(426))}}else if(Pt&&a.mode&1){var _=MC(o);if(_!==null){!(_.flags&65536)&&(_.flags|=256),DC(_,o,a,s,e),Ux(Fc(l,a));break e}}s=l=Fc(l,a),tn!==4&&(tn=2),vd===null?vd=[s]:vd.push(s),s=o;do{switch(s.tag){case 3:s.flags|=65536,e&=-e,s.lanes|=e;var g=vF(s,l,e);IC(s,g);break e;case 1:a=l;var y=s.type,v=s.stateNode;if(!(s.flags&128)&&(typeof y.getDerivedStateFromError=="function"||v!==null&&typeof v.componentDidCatch=="function"&&(Fo===null||!Fo.has(v)))){s.flags|=65536,e&=-e,s.lanes|=e;var w=wF(s,a,e);IC(s,w);break e}}s=s.return}while(s!==null)}jF(n)}catch(x){e=x,Yt===n&&n!==null&&(Yt=n=n.return);continue}break}while(!0)}function DF(){var t=xp.current;return xp.current=wp,t===null?wp:t}function a1(){(tn===0||tn===3||tn===2)&&(tn=4),fn===null||!(Ma&268435455)&&!(jm&268435455)||go(fn,En)}function bp(t,e){var n=Xe;Xe|=2;var r=DF();(fn!==t||En!==e)&&(gs=null,Aa(t,e));do try{i5();break}catch(i){MF(t,i)}while(!0);if(Bx(),Xe=n,xp.current=r,Yt!==null)throw Error(oe(261));return fn=null,En=0,tn}function i5(){for(;Yt!==null;)NF(Yt)}function s5(){for(;Yt!==null&&!Aj();)NF(Yt)}function NF(t){var e=UF(t.alternate,t,hr);t.memoizedProps=t.pendingProps,e===null?jF(t):Yt=e,n1.current=null}function jF(t){var e=t;do{var n=e.alternate;if(t=e.return,e.flags&32768){if(n=J3(n,e),n!==null){n.flags&=32767,Yt=n;return}if(t!==null)t.flags|=32768,t.subtreeFlags=0,t.deletions=null;else{tn=6,Yt=null;return}}else if(n=q3(n,e,hr),n!==null){Yt=n;return}if(e=e.sibling,e!==null){Yt=e;return}Yt=e=t}while(e!==null);tn===0&&(tn=5)}function da(t,e,n){var r=st,i=Br.transition;try{Br.transition=null,st=1,o5(t,e,n,r)}finally{Br.transition=i,st=r}return null}function o5(t,e,n,r){do hc();while(yo!==null);if(Xe&6)throw Error(oe(327));n=t.finishedWork;var i=t.finishedLanes;if(n===null)return null;if(t.finishedWork=null,t.finishedLanes=0,n===t.current)throw Error(oe(177));t.callbackNode=null,t.callbackPriority=0;var s=n.lanes|n.childLanes;if(zj(t,s),t===fn&&(Yt=fn=null,En=0),!(n.subtreeFlags&2064)&&!(n.flags&2064)||Cf||(Cf=!0,GF(sp,function(){return hc(),null})),s=(n.flags&15990)!==0,n.subtreeFlags&15990||s){s=Br.transition,Br.transition=null;var o=st;st=1;var a=Xe;Xe|=4,n1.current=null,e5(t,n),$F(n,t),T3(Lv),ap=!!$v,Lv=$v=null,t.current=n,t5(n),Fj(),Xe=a,st=o,Br.transition=s}else t.current=n;if(Cf&&(Cf=!1,yo=t,Sp=i),s=t.pendingLanes,s===0&&(Fo=null),Lj(n.stateNode),sr(t,Ut()),e!==null)for(r=t.onRecoverableError,n=0;n<e.length;n++)i=e[n],r(i.value,{componentStack:i.stack,digest:i.digest});if(Ep)throw Ep=!1,t=ew,ew=null,t;return Sp&1&&t.tag!==0&&hc(),s=t.pendingLanes,s&1?t===tw?wd++:(wd=0,tw=t):wd=0,Xo(),null}function hc(){if(yo!==null){var t=vA(Sp),e=Br.transition,n=st;try{if(Br.transition=null,st=16>t?16:t,yo===null)var r=!1;else{if(t=yo,yo=null,Sp=0,Xe&6)throw Error(oe(331));var i=Xe;for(Xe|=4,me=t.current;me!==null;){var s=me,o=s.child;if(me.flags&16){var a=s.deletions;if(a!==null){for(var l=0;l<a.length;l++){var c=a[l];for(me=c;me!==null;){var u=me;switch(u.tag){case 0:case 11:case 15:_d(8,u,s)}var d=u.child;if(d!==null)d.return=u,me=d;else for(;me!==null;){u=me;var h=u.sibling,f=u.return;if(AF(u),u===c){me=null;break}if(h!==null){h.return=f,me=h;break}me=f}}}var p=s.alternate;if(p!==null){var m=p.child;if(m!==null){p.child=null;do{var _=m.sibling;m.sibling=null,m=_}while(m!==null)}}me=s}}if(s.subtreeFlags&2064&&o!==null)o.return=s,me=o;else e:for(;me!==null;){if(s=me,s.flags&2048)switch(s.tag){case 0:case 11:case 15:_d(9,s,s.return)}var g=s.sibling;if(g!==null){g.return=s.return,me=g;break e}me=s.return}}var y=t.current;for(me=y;me!==null;){o=me;var v=o.child;if(o.subtreeFlags&2064&&v!==null)v.return=o,me=v;else e:for(o=y;me!==null;){if(a=me,a.flags&2048)try{switch(a.tag){case 0:case 11:case 15:Nm(9,a)}}catch(x){Nt(a,a.return,x)}if(a===o){me=null;break e}var w=a.sibling;if(w!==null){w.return=a.return,me=w;break e}me=a.return}}if(Xe=i,Xo(),Vi&&typeof Vi.onPostCommitFiberRoot=="function")try{Vi.onPostCommitFiberRoot(Am,t)}catch{}r=!0}return r}finally{st=n,Br.transition=e}}return!1}function ZC(t,e,n){e=Fc(n,e),e=vF(t,e,1),t=Ao(t,e,1),e=Vn(),t!==null&&(Ih(t,1,e),sr(t,e))}function Nt(t,e,n){if(t.tag===3)ZC(t,t,n);else for(;e!==null;){if(e.tag===3){ZC(e,t,n);break}else if(e.tag===1){var r=e.stateNode;if(typeof e.type.getDerivedStateFromError=="function"||typeof r.componentDidCatch=="function"&&(Fo===null||!Fo.has(r))){t=Fc(n,t),t=wF(e,t,1),e=Ao(e,t,1),t=Vn(),e!==null&&(Ih(e,1,t),sr(e,t));break}}e=e.return}}function a5(t,e,n){var r=t.pingCache;r!==null&&r.delete(e),e=Vn(),t.pingedLanes|=t.suspendedLanes&n,fn===t&&(En&n)===n&&(tn===4||tn===3&&(En&130023424)===En&&500>Ut()-i1?Aa(t,0):r1|=n),sr(t,e)}function zF(t,e){e===0&&(t.mode&1?(e=pf,pf<<=1,!(pf&130023424)&&(pf=4194304)):e=1);var n=Vn();t=ks(t,e),t!==null&&(Ih(t,e,n),sr(t,n))}function l5(t){var e=t.memoizedState,n=0;e!==null&&(n=e.retryLane),zF(t,n)}function c5(t,e){var n=0;switch(t.tag){case 13:var r=t.stateNode,i=t.memoizedState;i!==null&&(n=i.retryLane);break;case 19:r=t.stateNode;break;default:throw Error(oe(314))}r!==null&&r.delete(e),zF(t,n)}var UF;UF=function(t,e,n){if(t!==null)if(t.memoizedProps!==e.pendingProps||rr.current)nr=!0;else{if(!(t.lanes&n)&&!(e.flags&128))return nr=!1,Z3(t,e,n);nr=!!(t.flags&131072)}else nr=!1,Pt&&e.flags&1048576&&WA(e,gp,e.index);switch(e.lanes=0,e.tag){case 2:var r=e.type;Fg(t,e),t=e.pendingProps;var i=Pc(e,kn.current);dc(e,n),i=qx(null,e,r,t,i,n);var s=Jx();return e.flags|=1,typeof i=="object"&&i!==null&&typeof i.render=="function"&&i.$$typeof===void 0?(e.tag=1,e.memoizedState=null,e.updateQueue=null,ir(r)?(s=!0,hp(e)):s=!1,e.memoizedState=i.state!==null&&i.state!==void 0?i.state:null,Hx(e),i.updater=Dm,e.stateNode=i,i._reactInternals=e,Bv(e,r,t,n),e=Hv(null,e,r,!0,s,n)):(e.tag=0,Pt&&s&&jx(e),jn(null,e,i,n),e=e.child),e;case 16:r=e.elementType;e:{switch(Fg(t,e),t=e.pendingProps,i=r._init,r=i(r._payload),e.type=r,i=e.tag=d5(r),t=oi(r,t),i){case 0:e=Wv(null,e,r,t,n);break e;case 1:e=zC(null,e,r,t,n);break e;case 11:e=NC(null,e,r,t,n);break e;case 14:e=jC(null,e,r,oi(r.type,t),n);break e}throw Error(oe(306,r,""))}return e;case 0:return r=e.type,i=e.pendingProps,i=e.elementType===r?i:oi(r,i),Wv(t,e,r,i,n);case 1:return r=e.type,i=e.pendingProps,i=e.elementType===r?i:oi(r,i),zC(t,e,r,i,n);case 3:e:{if(bF(e),t===null)throw Error(oe(387));r=e.pendingProps,s=e.memoizedState,i=s.element,qA(t,e),yp(e,r,null,n);var o=e.memoizedState;if(r=o.element,s.isDehydrated)if(s={element:r,isDehydrated:!1,cache:o.cache,pendingSuspenseBoundaries:o.pendingSuspenseBoundaries,transitions:o.transitions},e.updateQueue.baseState=s,e.memoizedState=s,e.flags&256){i=Fc(Error(oe(423)),e),e=UC(t,e,r,n,i);break e}else if(r!==i){i=Fc(Error(oe(424)),e),e=UC(t,e,r,n,i);break e}else for(mr=Io(e.stateNode.containerInfo.firstChild),vr=e,Pt=!0,li=null,n=XA(e,null,r,n),e.child=n;n;)n.flags=n.flags&-3|4096,n=n.sibling;else{if(Rc(),r===i){e=Ms(t,e,n);break e}jn(t,e,r,n)}e=e.child}return e;case 5:return JA(e),t===null&&zv(e),r=e.type,i=e.pendingProps,s=t!==null?t.memoizedProps:null,o=i.children,kv(r,i)?o=null:s!==null&&kv(r,s)&&(e.flags|=32),SF(t,e),jn(t,e,o,n),e.child;case 6:return t===null&&zv(e),null;case 13:return CF(t,e,n);case 4:return Kx(e,e.stateNode.containerInfo),r=e.pendingProps,t===null?e.child=Ic(e,null,r,n):jn(t,e,r,n),e.child;case 11:return r=e.type,i=e.pendingProps,i=e.elementType===r?i:oi(r,i),NC(t,e,r,i,n);case 7:return jn(t,e,e.pendingProps,n),e.child;case 8:return jn(t,e,e.pendingProps.children,n),e.child;case 12:return jn(t,e,e.pendingProps.children,n),e.child;case 10:e:{if(r=e.type._context,i=e.pendingProps,s=e.memoizedProps,o=i.value,pt(pp,r._currentValue),r._currentValue=o,s!==null)if(xi(s.value,o)){if(s.children===i.children&&!rr.current){e=Ms(t,e,n);break e}}else for(s=e.child,s!==null&&(s.return=e);s!==null;){var a=s.dependencies;if(a!==null){o=s.child;for(var l=a.firstContext;l!==null;){if(l.context===r){if(s.tag===1){l=Cs(-1,n&-n),l.tag=2;var c=s.updateQueue;if(c!==null){c=c.shared;var u=c.pending;u===null?l.next=l:(l.next=u.next,u.next=l),c.pending=l}}s.lanes|=n,l=s.alternate,l!==null&&(l.lanes|=n),Uv(s.return,n,e),a.lanes|=n;break}l=l.next}}else if(s.tag===10)o=s.type===e.type?null:s.child;else if(s.tag===18){if(o=s.return,o===null)throw Error(oe(341));o.lanes|=n,a=o.alternate,a!==null&&(a.lanes|=n),Uv(o,n,e),o=s.sibling}else o=s.child;if(o!==null)o.return=s;else for(o=s;o!==null;){if(o===e){o=null;break}if(s=o.sibling,s!==null){s.return=o.return,o=s;break}o=o.return}s=o}jn(t,e,i.children,n),e=e.child}return e;case 9:return i=e.type,r=e.pendingProps.children,dc(e,n),i=Hr(i),r=r(i),e.flags|=1,jn(t,e,r,n),e.child;case 14:return r=e.type,i=oi(r,e.pendingProps),i=oi(r.type,i),jC(t,e,r,i,n);case 15:return xF(t,e,e.type,e.pendingProps,n);case 17:return r=e.type,i=e.pendingProps,i=e.elementType===r?i:oi(r,i),Fg(t,e),e.tag=1,ir(r)?(t=!0,hp(e)):t=!1,dc(e,n),_F(e,r,i),Bv(e,r,i,n),Hv(null,e,r,!0,t,n);case 19:return TF(t,e,n);case 22:return EF(t,e,n)}throw Error(oe(156,e.tag))};function GF(t,e){return pA(t,e)}function u5(t,e,n,r){this.tag=t,this.key=n,this.sibling=this.child=this.return=this.stateNode=this.type=this.elementType=null,this.index=0,this.ref=null,this.pendingProps=e,this.dependencies=this.memoizedState=this.updateQueue=this.memoizedProps=null,this.mode=r,this.subtreeFlags=this.flags=0,this.deletions=null,this.childLanes=this.lanes=0,this.alternate=null}function Nr(t,e,n,r){return new u5(t,e,n,r)}function l1(t){return t=t.prototype,!(!t||!t.isReactComponent)}function d5(t){if(typeof t=="function")return l1(t)?1:0;if(t!=null){if(t=t.$$typeof,t===Px)return 11;if(t===Rx)return 14}return 2}function $o(t,e){var n=t.alternate;return n===null?(n=Nr(t.tag,e,t.key,t.mode),n.elementType=t.elementType,n.type=t.type,n.stateNode=t.stateNode,n.alternate=t,t.alternate=n):(n.pendingProps=e,n.type=t.type,n.flags=0,n.subtreeFlags=0,n.deletions=null),n.flags=t.flags&14680064,n.childLanes=t.childLanes,n.lanes=t.lanes,n.child=t.child,n.memoizedProps=t.memoizedProps,n.memoizedState=t.memoizedState,n.updateQueue=t.updateQueue,e=t.dependencies,n.dependencies=e===null?null:{lanes:e.lanes,firstContext:e.firstContext},n.sibling=t.sibling,n.index=t.index,n.ref=t.ref,n}function Lg(t,e,n,r,i,s){var o=2;if(r=t,typeof t=="function")l1(t)&&(o=1);else if(typeof t=="string")o=5;else e:switch(t){case Gl:return Fa(n.children,i,s,e);case Tx:o=8,i|=8;break;case fv:return t=Nr(12,n,e,i|2),t.elementType=fv,t.lanes=s,t;case gv:return t=Nr(13,n,e,i),t.elementType=gv,t.lanes=s,t;case pv:return t=Nr(19,n,e,i),t.elementType=pv,t.lanes=s,t;case JI:return zm(n,i,s,e);default:if(typeof t=="object"&&t!==null)switch(t.$$typeof){case ZI:o=10;break e;case qI:o=9;break e;case Px:o=11;break e;case Rx:o=14;break e;case co:o=16,r=null;break e}throw Error(oe(130,t==null?t:typeof t,""))}return e=Nr(o,n,e,i),e.elementType=t,e.type=r,e.lanes=s,e}function Fa(t,e,n,r){return t=Nr(7,t,r,e),t.lanes=n,t}function zm(t,e,n,r){return t=Nr(22,t,r,e),t.elementType=JI,t.lanes=n,t.stateNode={isHidden:!1},t}function z_(t,e,n){return t=Nr(6,t,null,e),t.lanes=n,t}function U_(t,e,n){return e=Nr(4,t.children!==null?t.children:[],t.key,e),e.lanes=n,e.stateNode={containerInfo:t.containerInfo,pendingChildren:null,implementation:t.implementation},e}function h5(t,e,n,r,i){this.tag=e,this.containerInfo=t,this.finishedWork=this.pingCache=this.current=this.pendingChildren=null,this.timeoutHandle=-1,this.callbackNode=this.pendingContext=this.context=null,this.callbackPriority=0,this.eventTimes=x_(0),this.expirationTimes=x_(-1),this.entangledLanes=this.finishedLanes=this.mutableReadLanes=this.expiredLanes=this.pingedLanes=this.suspendedLanes=this.pendingLanes=0,this.entanglements=x_(0),this.identifierPrefix=r,this.onRecoverableError=i,this.mutableSourceEagerHydrationData=null}function c1(t,e,n,r,i,s,o,a,l){return t=new h5(t,e,n,a,l),e===1?(e=1,s===!0&&(e|=8)):e=0,s=Nr(3,null,null,e),t.current=s,s.stateNode=t,s.memoizedState={element:r,isDehydrated:n,cache:null,transitions:null,pendingSuspenseBoundaries:null},Hx(s),t}function f5(t,e,n){var r=3<arguments.length&&arguments[3]!==void 0?arguments[3]:null;return{$$typeof:Ul,key:r==null?null:""+r,children:t,containerInfo:e,implementation:n}}function BF(t){if(!t)return jo;t=t._reactInternals;e:{if(Ja(t)!==t||t.tag!==1)throw Error(oe(170));var e=t;do{switch(e.tag){case 3:e=e.stateNode.context;break e;case 1:if(ir(e.type)){e=e.stateNode.__reactInternalMemoizedMergedChildContext;break e}}e=e.return}while(e!==null);throw Error(oe(171))}if(t.tag===1){var n=t.type;if(ir(n))return BA(t,n,e)}return e}function VF(t,e,n,r,i,s,o,a,l){return t=c1(n,r,!0,t,i,s,o,a,l),t.context=BF(null),n=t.current,r=Vn(),i=Oo(n),s=Cs(r,i),s.callback=e??null,Ao(n,s,i),t.current.lanes=i,Ih(t,i,r),sr(t,r),t}function Um(t,e,n,r){var i=e.current,s=Vn(),o=Oo(i);return n=BF(n),e.context===null?e.context=n:e.pendingContext=n,e=Cs(s,o),e.payload={element:t},r=r===void 0?null:r,r!==null&&(e.callback=r),t=Ao(i,e,o),t!==null&&(yi(t,i,o,s),Rg(t,i,o)),o}function Cp(t){if(t=t.current,!t.child)return null;switch(t.child.tag){case 5:return t.child.stateNode;default:return t.child.stateNode}}function qC(t,e){if(t=t.memoizedState,t!==null&&t.dehydrated!==null){var n=t.retryLane;t.retryLane=n!==0&&n<e?n:e}}function u1(t,e){qC(t,e),(t=t.alternate)&&qC(t,e)}function g5(){return null}var WF=typeof reportError=="function"?reportError:function(t){console.error(t)};function d1(t){this._internalRoot=t}Gm.prototype.render=d1.prototype.render=function(t){var e=this._internalRoot;if(e===null)throw Error(oe(409));Um(t,e,null,null)};Gm.prototype.unmount=d1.prototype.unmount=function(){var t=this._internalRoot;if(t!==null){this._internalRoot=null;var e=t.containerInfo;Da(function(){Um(null,t,null,null)}),e[Ls]=null}};function Gm(t){this._internalRoot=t}Gm.prototype.unstable_scheduleHydration=function(t){if(t){var e=EA();t={blockedOn:null,target:t,priority:e};for(var n=0;n<fo.length&&e!==0&&e<fo[n].priority;n++);fo.splice(n,0,t),n===0&&bA(t)}};function h1(t){return!(!t||t.nodeType!==1&&t.nodeType!==9&&t.nodeType!==11)}function Bm(t){return!(!t||t.nodeType!==1&&t.nodeType!==9&&t.nodeType!==11&&(t.nodeType!==8||t.nodeValue!==" react-mount-point-unstable "))}function JC(){}function p5(t,e,n,r,i){if(i){if(typeof r=="function"){var s=r;r=function(){var c=Cp(o);s.call(c)}}var o=VF(e,r,t,0,null,!1,!1,"",JC);return t._reactRootContainer=o,t[Ls]=o.current,Kd(t.nodeType===8?t.parentNode:t),Da(),o}for(;i=t.lastChild;)t.removeChild(i);if(typeof r=="function"){var a=r;r=function(){var c=Cp(l);a.call(c)}}var l=c1(t,0,!1,null,null,!1,!1,"",JC);return t._reactRootContainer=l,t[Ls]=l.current,Kd(t.nodeType===8?t.parentNode:t),Da(function(){Um(e,l,n,r)}),l}function Vm(t,e,n,r,i){var s=n._reactRootContainer;if(s){var o=s;if(typeof i=="function"){var a=i;i=function(){var l=Cp(o);a.call(l)}}Um(e,o,t,i)}else o=p5(n,e,t,i,r);return Cp(o)}wA=function(t){switch(t.tag){case 3:var e=t.stateNode;if(e.current.memoizedState.isDehydrated){var n=id(e.pendingLanes);n!==0&&(Fx(e,n|1),sr(e,Ut()),!(Xe&6)&&(Oc=Ut()+500,Xo()))}break;case 13:Da(function(){var r=ks(t,1);if(r!==null){var i=Vn();yi(r,t,1,i)}}),u1(t,1)}};Ox=function(t){if(t.tag===13){var e=ks(t,134217728);if(e!==null){var n=Vn();yi(e,t,134217728,n)}u1(t,134217728)}};xA=function(t){if(t.tag===13){var e=Oo(t),n=ks(t,e);if(n!==null){var r=Vn();yi(n,t,e,r)}u1(t,e)}};EA=function(){return st};SA=function(t,e){var n=st;try{return st=t,e()}finally{st=n}};Cv=function(t,e,n){switch(e){case"input":if(_v(t,n),e=n.name,n.type==="radio"&&e!=null){for(n=t;n.parentNode;)n=n.parentNode;for(n=n.querySelectorAll("input[name="+JSON.stringify(""+e)+'][type="radio"]'),e=0;e<n.length;e++){var r=n[e];if(r!==t&&r.form===t.form){var i=Lm(r);if(!i)throw Error(oe(90));eA(r),_v(r,i)}}}break;case"textarea":nA(t,n);break;case"select":e=n.value,e!=null&&ac(t,!!n.multiple,e,!1)}};cA=s1;uA=Da;var m5={usingClientEntryPoint:!1,Events:[Fh,Hl,Lm,aA,lA,s1]},Du={findFiberByHostInstance:xa,bundleType:0,version:"18.3.1",rendererPackageName:"react-dom"},y5={bundleType:Du.bundleType,version:Du.version,rendererPackageName:Du.rendererPackageName,rendererConfig:Du.rendererConfig,overrideHookState:null,overrideHookStateDeletePath:null,overrideHookStateRenamePath:null,overrideProps:null,overridePropsDeletePath:null,overridePropsRenamePath:null,setErrorHandler:null,setSuspenseHandler:null,scheduleUpdate:null,currentDispatcherRef:Gs.ReactCurrentDispatcher,findHostInstanceByFiber:function(t){return t=fA(t),t===null?null:t.stateNode},findFiberByHostInstance:Du.findFiberByHostInstance||g5,findHostInstancesForRefresh:null,scheduleRefresh:null,scheduleRoot:null,setRefreshHandler:null,getCurrentFiber:null,reconcilerVersion:"18.3.1-next-f1338f8080-20240426"};if(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__<"u"){var Tf=__REACT_DEVTOOLS_GLOBAL_HOOK__;if(!Tf.isDisabled&&Tf.supportsFiber)try{Am=Tf.inject(y5),Vi=Tf}catch{}}Sr.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=m5;Sr.createPortal=function(t,e){var n=2<arguments.length&&arguments[2]!==void 0?arguments[2]:null;if(!h1(e))throw Error(oe(200));return f5(t,e,null,n)};Sr.createRoot=function(t,e){if(!h1(t))throw Error(oe(299));var n=!1,r="",i=WF;return e!=null&&(e.unstable_strictMode===!0&&(n=!0),e.identifierPrefix!==void 0&&(r=e.identifierPrefix),e.onRecoverableError!==void 0&&(i=e.onRecoverableError)),e=c1(t,1,!1,null,null,n,!1,r,i),t[Ls]=e.current,Kd(t.nodeType===8?t.parentNode:t),new d1(e)};Sr.findDOMNode=function(t){if(t==null)return null;if(t.nodeType===1)return t;var e=t._reactInternals;if(e===void 0)throw typeof t.render=="function"?Error(oe(188)):(t=Object.keys(t).join(","),Error(oe(268,t)));return t=fA(e),t=t===null?null:t.stateNode,t};Sr.flushSync=function(t){return Da(t)};Sr.hydrate=function(t,e,n){if(!Bm(e))throw Error(oe(200));return Vm(null,t,e,!0,n)};Sr.hydrateRoot=function(t,e,n){if(!h1(t))throw Error(oe(405));var r=n!=null&&n.hydratedSources||null,i=!1,s="",o=WF;if(n!=null&&(n.unstable_strictMode===!0&&(i=!0),n.identifierPrefix!==void 0&&(s=n.identifierPrefix),n.onRecoverableError!==void 0&&(o=n.onRecoverableError)),e=VF(e,null,t,1,n??null,i,!1,s,o),t[Ls]=e.current,Kd(t),r)for(t=0;t<r.length;t++)n=r[t],i=n._getVersion,i=i(n._source),e.mutableSourceEagerHydrationData==null?e.mutableSourceEagerHydrationData=[n,i]:e.mutableSourceEagerHydrationData.push(n,i);return new Gm(e)};Sr.render=function(t,e,n){if(!Bm(e))throw Error(oe(200));return Vm(null,t,e,!1,n)};Sr.unmountComponentAtNode=function(t){if(!Bm(t))throw Error(oe(40));return t._reactRootContainer?(Da(function(){Vm(null,null,t,!1,function(){t._reactRootContainer=null,t[Ls]=null})}),!0):!1};Sr.unstable_batchedUpdates=s1;Sr.unstable_renderSubtreeIntoContainer=function(t,e,n,r){if(!Bm(n))throw Error(oe(200));if(t==null||t._reactInternals===void 0)throw Error(oe(38));return Vm(t,e,n,!1,r)};Sr.version="18.3.1-next-f1338f8080-20240426";function HF(){if(!(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__>"u"||typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE!="function"))try{__REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE(HF)}catch(t){console.error(t)}}HF(),HI.exports=Sr;var _5=HI.exports,KF,QC=_5;KF=QC.createRoot,QC.hydrateRoot;const v5="modulepreload",w5=function(t){return"/"+t},eT={},x5=function(e,n,r){let i=Promise.resolve();if(n&&n.length>0){document.getElementsByTagName("link");const o=document.querySelector("meta[property=csp-nonce]"),a=(o==null?void 0:o.nonce)||(o==null?void 0:o.getAttribute("nonce"));i=Promise.allSettled(n.map(l=>{if(l=w5(l),l in eT)return;eT[l]=!0;const c=l.endsWith(".css"),u=c?'[rel="stylesheet"]':"";if(document.querySelector(`link[href="${l}"]${u}`))return;const d=document.createElement("link");if(d.rel=c?"stylesheet":v5,c||(d.as="script"),d.crossOrigin="",d.href=l,a&&d.setAttribute("nonce",a),document.head.appendChild(d),c)return new Promise((h,f)=>{d.addEventListener("load",h),d.addEventListener("error",()=>f(new Error(`Unable to preload CSS for ${l}`)))})}))}function s(o){const a=new Event("vite:preloadError",{cancelable:!0});if(a.payload=o,window.dispatchEvent(a),!a.defaultPrevented)throw o}return i.then(o=>{for(const a of o||[])a.status==="rejected"&&s(a.reason);return e().catch(s)})},E5={},tT=t=>{let e;const n=new Set,r=(u,d)=>{const h=typeof u=="function"?u(e):u;if(!Object.is(h,e)){const f=e;e=d??(typeof h!="object"||h===null)?h:Object.assign({},e,h),n.forEach(p=>p(e,f))}},i=()=>e,l={setState:r,getState:i,getInitialState:()=>c,subscribe:u=>(n.add(u),()=>n.delete(u)),destroy:()=>{(E5?"production":void 0)!=="production"&&console.warn("[DEPRECATED] The `destroy` method will be unsupported in a future version. Instead use unsubscribe function returned by subscribe. Everything will be garbage-collected if store is garbage-collected."),n.clear()}},c=e=t(r,i,l);return l},f1=t=>t?tT(t):tT;var YF={exports:{}},XF={},ZF={exports:{}},qF={};/**
 * @license React
 * use-sync-external-store-shim.production.js
 *
 * Copyright (c) Meta Platforms, Inc. and affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var $c=K;function S5(t,e){return t===e&&(t!==0||1/t===1/e)||t!==t&&e!==e}var b5=typeof Object.is=="function"?Object.is:S5,C5=$c.useState,T5=$c.useEffect,P5=$c.useLayoutEffect,R5=$c.useDebugValue;function I5(t,e){var n=e(),r=C5({inst:{value:n,getSnapshot:e}}),i=r[0].inst,s=r[1];return P5(function(){i.value=n,i.getSnapshot=e,G_(i)&&s({inst:i})},[t,n,e]),T5(function(){return G_(i)&&s({inst:i}),t(function(){G_(i)&&s({inst:i})})},[t]),R5(n),n}function G_(t){var e=t.getSnapshot;t=t.value;try{var n=e();return!b5(t,n)}catch{return!0}}function A5(t,e){return e()}var F5=typeof window>"u"||typeof window.document>"u"||typeof window.document.createElement>"u"?A5:I5;qF.useSyncExternalStore=$c.useSyncExternalStore!==void 0?$c.useSyncExternalStore:F5;ZF.exports=qF;var O5=ZF.exports;/**
 * @license React
 * use-sync-external-store-shim/with-selector.production.js
 *
 * Copyright (c) Meta Platforms, Inc. and affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var Wm=K,$5=O5;function L5(t,e){return t===e&&(t!==0||1/t===1/e)||t!==t&&e!==e}var k5=typeof Object.is=="function"?Object.is:L5,M5=$5.useSyncExternalStore,D5=Wm.useRef,N5=Wm.useEffect,j5=Wm.useMemo,z5=Wm.useDebugValue;XF.useSyncExternalStoreWithSelector=function(t,e,n,r,i){var s=D5(null);if(s.current===null){var o={hasValue:!1,value:null};s.current=o}else o=s.current;s=j5(function(){function l(f){if(!c){if(c=!0,u=f,f=r(f),i!==void 0&&o.hasValue){var p=o.value;if(i(p,f))return d=p}return d=f}if(p=d,k5(u,f))return p;var m=r(f);return i!==void 0&&i(p,m)?(u=f,p):(u=f,d=m)}var c=!1,u,d,h=n===void 0?null:n;return[function(){return l(e())},h===null?void 0:function(){return l(h())}]},[e,n,r,i]);var a=M5(t,s[0],s[1]);return N5(function(){o.hasValue=!0,o.value=a},[a]),z5(a),a};YF.exports=XF;var U5=YF.exports;const G5=Za(U5),JF={},{useDebugValue:B5}=VI,{useSyncExternalStoreWithSelector:V5}=G5;let nT=!1;const W5=t=>t;function g1(t,e=W5,n){(JF?"production":void 0)!=="production"&&n&&!nT&&(console.warn("[DEPRECATED] Use `createWithEqualityFn` instead of `create` or use `useStoreWithEqualityFn` instead of `useStore`. They can be imported from 'zustand/traditional'. https://github.com/pmndrs/zustand/discussions/1937"),nT=!0);const r=V5(t.subscribe,t.getState,t.getServerState||t.getInitialState,e,n);return B5(r),r}const rT=t=>{(JF?"production":void 0)!=="production"&&typeof t!="function"&&console.warn("[DEPRECATED] Passing a vanilla store will be unsupported in a future version. Instead use `import { useStore } from 'zustand'`.");const e=typeof t=="function"?f1(t):t,n=(r,i)=>g1(e,r,i);return Object.assign(n,e),n},Qi=t=>t?rT(t):rT,ye={IDLE:0,LOADING:1,LOADED:2,ERROR:3,EMPTY:4},Na=typeof navigator<"u"&&typeof navigator.userAgent<"u"?navigator.userAgent.toLowerCase():"",H5=Na.includes("safari")&&!Na.includes("chrom"),K5=H5&&(Na.includes("version/15.4")||/cpu (os|iphone os) 15_4 like mac os x/.test(Na)),Y5=Na.includes("webkit")&&!Na.includes("edge"),QF=Na.includes("macintosh"),eO=typeof devicePixelRatio<"u"?devicePixelRatio:1,jr=typeof WorkerGlobalScope<"u"&&typeof OffscreenCanvas<"u"&&self instanceof WorkerGlobalScope,p1=typeof Image<"u"&&Image.prototype.decode,tO=typeof createImageBitmap=="function",nO=function(){let t=!1;try{const e=Object.defineProperty({},"passive",{get:function(){t=!0}});window.addEventListener("_",null,e),window.removeEventListener("_",null,e)}catch{}return t}();function Vt(t,e,n,r){let i;return n&&n.length?i=n.shift():jr?i=new class extends OffscreenCanvas{constructor(){super(...arguments);q(this,"style",{})}}(t??300,e??150):i=document.createElement("canvas"),t&&(i.width=t),e&&(i.height=e),i.getContext("2d",r)}let B_;function Tp(){return B_||(B_=Vt(1,1)),B_}function $h(t){const e=t.canvas;e.width=1,e.height=1,t.clearRect(0,0,1,1)}function X5(t){let e=t.offsetWidth;const n=getComputedStyle(t);return e+=parseInt(n.marginLeft,10)+parseInt(n.marginRight,10),e}function Z5(t){let e=t.offsetHeight;const n=getComputedStyle(t);return e+=parseInt(n.marginTop,10)+parseInt(n.marginBottom,10),e}function Pp(t,e){const n=e.parentNode;n&&n.replaceChild(t,e)}function rO(t){for(;t.lastChild;)t.lastChild.remove()}function q5(t,e){const n=t.childNodes;for(let r=0;;++r){const i=n[r],s=e[r];if(!i&&!s)break;if(i!==s){if(!i){t.appendChild(s);continue}if(!s){t.removeChild(i),--r;continue}t.insertBefore(s,i)}}}function iO(){return new Proxy({childNodes:[],appendChild:function(e){return this.childNodes.push(e),e},remove:function(){},removeChild:function(e){const n=this.childNodes.indexOf(e);if(n===-1)throw new Error("Node to remove was not found");return this.childNodes.splice(n,1),e},insertBefore:function(e,n){const r=this.childNodes.indexOf(n);if(r===-1)throw new Error("Reference node not found");return this.childNodes.splice(r,0,e),e},style:{}},{get(e,n,r){return n==="firstElementChild"?e.childNodes.length>0?e.childNodes[0]:null:Reflect.get(e,n,r)}})}function _o(t){return typeof HTMLCanvasElement<"u"&&t instanceof HTMLCanvasElement||typeof OffscreenCanvas<"u"&&t instanceof OffscreenCanvas}function ct(t,e,n){return Math.min(Math.max(t,e),n)}function J5(t,e,n,r,i,s){const o=i-n,a=s-r;if(o!==0||a!==0){const l=((t-n)*o+(e-r)*a)/(o*o+a*a);l>1?(n=i,r=s):l>0&&(n+=o*l,r+=a*l)}return Ts(t,e,n,r)}function Ts(t,e,n,r){const i=n-t,s=r-e;return i*i+s*s}function Q5(t){const e=t.length;for(let r=0;r<e;r++){let i=r,s=Math.abs(t[r][r]);for(let a=r+1;a<e;a++){const l=Math.abs(t[a][r]);l>s&&(s=l,i=a)}if(s===0)return null;const o=t[i];t[i]=t[r],t[r]=o;for(let a=r+1;a<e;a++){const l=-t[a][r]/t[r][r];for(let c=r;c<e+1;c++)r==c?t[a][c]=0:t[a][c]+=l*t[r][c]}}const n=new Array(e);for(let r=e-1;r>=0;r--){n[r]=t[r][e]/t[r][r];for(let i=r-1;i>=0;i--)t[i][e]-=t[i][r]*n[r]}return n}function Rp(t){return t*180/Math.PI}function or(t){return t*Math.PI/180}function Ps(t,e){const n=t%e;return n*e<0?n+e:n}function fr(t,e,n){return t+n*(e-t)}function tu(t,e){const n=Math.pow(10,e);return Math.round(t*n)/n}function Ip(t,e){return Math.round(tu(t,e))}function Ql(t,e){return Math.floor(tu(t,e))}function vo(t,e){return Math.ceil(tu(t,e))}function iw(t,e,n){if(t>=e&&t<n)return t;const r=n-e;return((t-e)%r+r)%r+e}const m1=[NaN,NaN,NaN,0];let V_;function e4(){return V_||(V_=Vt(1,1,void 0,{willReadFrequently:!0,desynchronized:!0})),V_}const t4=/^rgba?\(\s*(\d+%?)\s+(\d+%?)\s+(\d+%?)(?:\s*\/\s*(\d+%|\d*\.\d+|[01]))?\s*\)$/i,n4=/^rgba?\(\s*(\d+)\s*,\s*(\d+)\s*,\s*(\d+)(?:\s*,\s*(\d+%|\d*\.\d+|[01]))?\s*\)$/i,r4=/^rgba?\(\s*(\d+%)\s*,\s*(\d+%)\s*,\s*(\d+%)(?:\s*,\s*(\d+%|\d*\.\d+|[01]))?\s*\)$/i,i4=/^#([\da-f]{3,4}|[\da-f]{6}|[\da-f]{8})$/i;function Pf(t,e){return t.endsWith("%")?Number(t.substring(0,t.length-1))/e:Number(t)}function xd(t){throw new Error('failed to parse "'+t+'" as color')}function sO(t){if(t.toLowerCase().startsWith("rgb")){const s=t.match(n4)||t.match(t4)||t.match(r4);if(s){const o=s[4],a=100/255;return[ct(Pf(s[1],a)+.5|0,0,255),ct(Pf(s[2],a)+.5|0,0,255),ct(Pf(s[3],a)+.5|0,0,255),o!==void 0?ct(Pf(o,100),0,1):1]}xd(t)}if(t.startsWith("#")){if(i4.test(t)){const s=t.substring(1),o=s.length<=4?1:2,a=[0,0,0,255];for(let l=0,c=s.length;l<c;l+=o){let u=parseInt(s.substring(l,l+o),16);o===1&&(u+=u<<4),a[l/o]=u}return a[3]=a[3]/255,a}xd(t)}const e=e4();e.fillStyle="#abcdef";let n=e.fillStyle;e.fillStyle=t,e.fillStyle===n&&(e.fillStyle="#fedcba",n=e.fillStyle,e.fillStyle=t,e.fillStyle===n&&xd(t));const r=e.fillStyle;if(r.startsWith("#")||r.startsWith("rgba"))return sO(r);e.clearRect(0,0,1,1),e.fillRect(0,0,1,1);const i=Array.from(e.getImageData(0,0,1,1).data);return i[3]=tu(i[3]/255,3),i}function s4(t){return typeof t=="string"?t:_1(t)}const o4=1024,Nu={};let W_=0;function a4(t){if(t.length===4)return t;const e=t.slice();return e[3]=1,e}function H_(t){return t>.0031308?Math.pow(t,1/2.4)*269.025-14.025:t*3294.6}function K_(t){return t>.2068965?Math.pow(t,3):(t-4/29)*(108/841)}function Y_(t){return t>10.314724?Math.pow((t+14.025)/269.025,2.4):t/3294.6}function X_(t){return t>.0088564?Math.pow(t,1/3):t/(108/841)+4/29}function iT(t){const e=Y_(t[0]),n=Y_(t[1]),r=Y_(t[2]),i=X_(e*.222488403+n*.716873169+r*.06060791),s=500*(X_(e*.452247074+n*.399439023+r*.148375274)-i),o=200*(i-X_(e*.016863605+n*.117638439+r*.865350722)),a=Math.atan2(o,s)*(180/Math.PI);return[116*i-16,Math.sqrt(s*s+o*o),a<0?a+360:a,t[3]]}function l4(t){const e=(t[0]+16)/116,n=t[1],r=t[2]*Math.PI/180,i=K_(e),s=K_(e+n/500*Math.cos(r)),o=K_(e-n/200*Math.sin(r)),a=H_(s*3.021973625-i*1.617392459-o*.404875592),l=H_(s*-.943766287+i*1.916279586+o*.027607165),c=H_(s*.069407491-i*.22898585+o*1.159737864);return[ct(a+.5|0,0,255),ct(l+.5|0,0,255),ct(c+.5|0,0,255),t[3]]}function y1(t){if(t==="none")return m1;if(Nu.hasOwnProperty(t))return Nu[t];if(W_>=o4){let n=0;for(const r in Nu)n++&3||(delete Nu[r],--W_)}const e=sO(t);e.length!==4&&xd(t);for(const n of e)isNaN(n)&&xd(t);return Nu[t]=e,++W_,e}function Yr(t){return Array.isArray(t)?t:y1(t)}function _1(t){let e=t[0];e!=(e|0)&&(e=e+.5|0);let n=t[1];n!=(n|0)&&(n=n+.5|0);let r=t[2];r!=(r|0)&&(r=r+.5|0);const i=t[3]===void 0?1:Math.round(t[3]*1e3)/1e3;return"rgba("+e+","+n+","+r+","+i+")"}const Se={CHANGE:"change",ERROR:"error",CONTEXTMENU:"contextmenu",CLICK:"click",DBLCLICK:"dblclick",KEYDOWN:"keydown",KEYPRESS:"keypress",LOAD:"load",TOUCHMOVE:"touchmove",WHEEL:"wheel"};class Lh{constructor(){this.disposed=!1}dispose(){this.disposed||(this.disposed=!0,this.disposeInternal())}disposeInternal(){}}function c4(t,e,n){let r,i;n=n||Hi;let s=0,o=t.length,a=!1;for(;s<o;)r=s+(o-s>>1),i=+n(t[r],e),i<0?s=r+1:(o=r,a=!i);return a?s:~s}function Hi(t,e){return t>e?1:t<e?-1:0}function u4(t,e){return t<e?1:t>e?-1:0}function Hm(t,e,n){if(t[0]<=e)return 0;const r=t.length;if(e<=t[r-1])return r-1;if(typeof n=="function"){for(let i=1;i<r;++i){const s=t[i];if(s===e)return i;if(s<e)return n(e,t[i-1],s)>0?i-1:i}return r-1}if(n>0){for(let i=1;i<r;++i)if(t[i]<e)return i-1;return r-1}if(n<0){for(let i=1;i<r;++i)if(t[i]<=e)return i;return r-1}for(let i=1;i<r;++i){if(t[i]==e)return i;if(t[i]<e)return t[i-1]-e<e-t[i]?i-1:i}return r-1}function d4(t,e,n){for(;e<n;){const r=t[e];t[e]=t[n],t[n]=r,++e,--n}}function We(t,e){const n=Array.isArray(e)?e:[e],r=n.length;for(let i=0;i<r;i++)t[t.length]=n[i]}function es(t,e){const n=t.length;if(n!==e.length)return!1;for(let r=0;r<n;r++)if(t[r]!==e[r])return!1;return!0}function h4(t,e,n){const r=e||Hi;return t.every(function(i,s){if(s===0)return!0;const o=r(t[s-1],i);return!(o>0||o===0)})}function zo(){return!0}function nu(){return!1}function nh(){}function oO(t){let e,n,r;return function(){const i=Array.prototype.slice.call(arguments);return(!n||this!==r||!es(i,n))&&(r=this,n=i,e=t.apply(this,arguments)),e}}function aO(t){function e(){let n;try{n=t()}catch(r){return Promise.reject(r)}return n instanceof Promise?n:Promise.resolve(n)}return e()}function Qa(t){for(const e in t)delete t[e]}function Uo(t){let e;for(e in t)return!1;return!e}class Cr{constructor(e){this.propagationStopped,this.defaultPrevented,this.type=e,this.target=null}preventDefault(){this.defaultPrevented=!0}stopPropagation(){this.propagationStopped=!0}}class kh extends Lh{constructor(e){super(),this.eventTarget_=e,this.pendingRemovals_=null,this.dispatching_=null,this.listeners_=null}addEventListener(e,n){if(!e||!n)return;const r=this.listeners_||(this.listeners_={}),i=r[e]||(r[e]=[]);i.includes(n)||i.push(n)}dispatchEvent(e){const n=typeof e=="string",r=n?e:e.type,i=this.listeners_&&this.listeners_[r];if(!i)return;const s=n?new Cr(e):e;s.target||(s.target=this.eventTarget_||this);const o=this.dispatching_||(this.dispatching_={}),a=this.pendingRemovals_||(this.pendingRemovals_={});r in o||(o[r]=0,a[r]=0),++o[r];let l;for(let c=0,u=i.length;c<u;++c)if("handleEvent"in i[c]?l=i[c].handleEvent(s):l=i[c].call(this,s),l===!1||s.propagationStopped){l=!1;break}if(--o[r]===0){let c=a[r];for(delete a[r];c--;)this.removeEventListener(r,nh);delete o[r]}return l}disposeInternal(){this.listeners_&&Qa(this.listeners_)}getListeners(e){return this.listeners_&&this.listeners_[e]||void 0}hasListener(e){return this.listeners_?e?e in this.listeners_:Object.keys(this.listeners_).length>0:!1}removeEventListener(e,n){if(!this.listeners_)return;const r=this.listeners_[e];if(!r)return;const i=r.indexOf(n);i!==-1&&(this.pendingRemovals_&&e in this.pendingRemovals_?(r[i]=nh,++this.pendingRemovals_[e]):(r.splice(i,1),r.length===0&&delete this.listeners_[e]))}}function Oe(t,e,n,r,i){if(i){const o=n;n=function(a){return t.removeEventListener(e,n),o.call(r??this,a)}}else r&&r!==t&&(n=n.bind(r));const s={target:t,type:e,listener:n};return t.addEventListener(e,n),s}function Ap(t,e,n,r){return Oe(t,e,n,r,!0)}function it(t){t&&t.target&&(t.target.removeEventListener(t.type,t.listener),Qa(t))}class v1 extends kh{constructor(e,n,r,i){super(),this.extent=e,this.pixelRatio_=r,this.resolution=n,this.state=typeof i=="function"?ye.IDLE:i,this.image_=null,this.loader=typeof i=="function"?i:null}changed(){this.dispatchEvent(Se.CHANGE)}getExtent(){return this.extent}getImage(){return this.image_}getPixelRatio(){return this.pixelRatio_}getResolution(){return this.resolution}getState(){return this.state}load(){if(this.state==ye.IDLE&&this.loader){this.state=ye.LOADING,this.changed();const e=this.getResolution(),n=Array.isArray(e)?e[0]:e;aO(()=>this.loader(this.getExtent(),n,this.getPixelRatio())).then(r=>{"image"in r&&(this.image_=r.image),"extent"in r&&(this.extent=r.extent),"resolution"in r&&(this.resolution=r.resolution),"pixelRatio"in r&&(this.pixelRatio_=r.pixelRatio),(r instanceof HTMLImageElement||tO&&r instanceof ImageBitmap||r instanceof HTMLCanvasElement||r instanceof HTMLVideoElement)&&(this.image_=r),this.state=ye.LOADED}).catch(r=>{this.state=ye.ERROR,console.error(r)}).finally(()=>this.changed())}}setImage(e){this.image_=e}setResolution(e){this.resolution=e}}function f4(t,e,n){const r=t;let i=!0,s=!1,o=!1;const a=[Ap(r,Se.LOAD,function(){o=!0,s||e()})];return r.src&&p1?(s=!0,r.decode().then(function(){i&&e()}).catch(function(l){i&&(o?e():n())})):a.push(Ap(r,Se.ERROR,n)),function(){i=!1,a.forEach(it)}}function g4(t,e){return new Promise((n,r)=>{function i(){o(),n(t)}function s(){o(),r(new Error("Image load error"))}function o(){t.removeEventListener("load",i),t.removeEventListener("error",s)}t.addEventListener("load",i),t.addEventListener("error",s)})}function lO(t,e){return e&&(t.src=e),t.src&&p1?new Promise((n,r)=>t.decode().then(()=>n(t)).catch(i=>t.complete&&t.width?n(t):r(i))):g4(t)}function ru(t,e){return e&&(t.src=e),t.src&&p1&&tO?t.decode().then(()=>createImageBitmap(t)).catch(n=>{if(t.complete&&t.width)return t;throw n}):lO(t)}class p4{constructor(){this.cache_={},this.patternCache_={},this.cacheSize_=0,this.maxCacheSize_=1024}clear(){this.cache_={},this.patternCache_={},this.cacheSize_=0}canExpireCache(){return this.cacheSize_>this.maxCacheSize_}expire(){if(this.canExpireCache()){let e=0;for(const n in this.cache_){const r=this.cache_[n];!(e++&3)&&!r.hasListener()&&(delete this.cache_[n],delete this.patternCache_[n],--this.cacheSize_)}}}get(e,n,r){const i=Z_(e,n,r);return i in this.cache_?this.cache_[i]:null}getPattern(e,n,r){const i=Z_(e,n,r);return i in this.patternCache_?this.patternCache_[i]:null}set(e,n,r,i,s){const o=Z_(e,n,r),a=o in this.cache_;this.cache_[o]=i,s&&(i.getImageState()===ye.IDLE&&i.load(),i.getImageState()===ye.LOADING?i.ready().then(()=>{this.patternCache_[o]=Tp().createPattern(i.getImage(1),"repeat")}):this.patternCache_[o]=Tp().createPattern(i.getImage(1),"repeat")),a||++this.cacheSize_}setSize(e){this.maxCacheSize_=e,this.expire()}}function Z_(t,e,n){const r=n?Yr(n):"null";return e+":"+t+":"+r}const zr=new p4;let ju=null;class cO extends kh{constructor(e,n,r,i,s){super(),this.hitDetectionImage_=null,this.image_=e,this.crossOrigin_=r,this.canvas_={},this.color_=s,this.imageState_=i===void 0?ye.IDLE:i,this.size_=e&&e.width&&e.height?[e.width,e.height]:null,this.src_=n,this.tainted_,this.ready_=null}initializeImage_(){this.image_=new Image,this.crossOrigin_!==null&&(this.image_.crossOrigin=this.crossOrigin_)}isTainted_(){if(this.tainted_===void 0&&this.imageState_===ye.LOADED){ju||(ju=Vt(1,1,void 0,{willReadFrequently:!0})),ju.drawImage(this.image_,0,0);try{ju.getImageData(0,0,1,1),this.tainted_=!1}catch{ju=null,this.tainted_=!0}}return this.tainted_===!0}dispatchChangeEvent_(){this.dispatchEvent(Se.CHANGE)}handleImageError_(){this.imageState_=ye.ERROR,this.dispatchChangeEvent_()}handleImageLoad_(){this.imageState_=ye.LOADED,this.size_=[this.image_.width,this.image_.height],this.dispatchChangeEvent_()}getImage(e){return this.image_||this.initializeImage_(),this.replaceColor_(e),this.canvas_[e]?this.canvas_[e]:this.image_}getPixelRatio(e){return this.replaceColor_(e),this.canvas_[e]?e:1}getImageState(){return this.imageState_}getHitDetectionImage(){if(this.image_||this.initializeImage_(),!this.hitDetectionImage_)if(this.isTainted_()){const e=this.size_[0],n=this.size_[1],r=Vt(e,n);r.fillRect(0,0,e,n),this.hitDetectionImage_=r.canvas}else this.hitDetectionImage_=this.image_;return this.hitDetectionImage_}getSize(){return this.size_}getSrc(){return this.src_}load(){if(this.imageState_===ye.IDLE){this.image_||this.initializeImage_(),this.imageState_=ye.LOADING;try{this.src_!==void 0&&(this.image_.src=this.src_)}catch{this.handleImageError_()}this.image_ instanceof HTMLImageElement&&lO(this.image_,this.src_).then(e=>{this.image_=e,this.handleImageLoad_()}).catch(this.handleImageError_.bind(this))}}replaceColor_(e){if(!this.color_||this.canvas_[e]||this.imageState_!==ye.LOADED)return;const n=this.image_,r=Vt(Math.ceil(n.width*e),Math.ceil(n.height*e)),i=r.canvas;r.scale(e,e),r.drawImage(n,0,0),r.globalCompositeOperation="multiply",r.fillStyle=s4(this.color_),r.fillRect(0,0,i.width/e,i.height/e),r.globalCompositeOperation="destination-in",r.drawImage(n,0,0),this.canvas_[e]=i}ready(){return this.ready_||(this.ready_=new Promise(e=>{if(this.imageState_===ye.LOADED||this.imageState_===ye.ERROR)e();else{const n=()=>{(this.imageState_===ye.LOADED||this.imageState_===ye.ERROR)&&(this.removeEventListener(Se.CHANGE,n),e())};this.addEventListener(Se.CHANGE,n)}})),this.ready_}}function Fp(t,e,n,r,i,s){let o=e===void 0?void 0:zr.get(e,n,i);return o||(o=new cO(t,t&&"src"in t?t.src||void 0:e,n,r,i),zr.set(e,n,i,o,s)),s&&o&&!zr.getPattern(e,n,i)&&zr.set(e,n,i,o,s),o}function Ni(t){return t?Array.isArray(t)?_1(t):typeof t=="object"&&"src"in t?m4(t):t:null}function m4(t){if(!t.offset||!t.size)return zr.getPattern(t.src,"anonymous",t.color);const e=t.src+":"+t.offset,n=zr.getPattern(e,void 0,t.color);if(n)return n;const r=zr.get(t.src,"anonymous",null);if(r.getImageState()!==ye.LOADED)return null;const i=Vt(t.size[0],t.size[1]);return i.drawImage(r.getImage(1),t.offset[0],t.offset[1],t.size[0],t.size[1],0,0,t.size[0],t.size[1]),Fp(i.canvas,e,void 0,ye.LOADED,t.color,!0),zr.getPattern(e,void 0,t.color)}const Lc={PROPERTYCHANGE:"propertychange"};class Mh extends kh{constructor(){super(),this.on=this.onInternal,this.once=this.onceInternal,this.un=this.unInternal,this.revision_=0}changed(){++this.revision_,this.dispatchEvent(Se.CHANGE)}getRevision(){return this.revision_}onInternal(e,n){if(Array.isArray(e)){const r=e.length,i=new Array(r);for(let s=0;s<r;++s)i[s]=Oe(this,e[s],n);return i}return Oe(this,e,n)}onceInternal(e,n){let r;if(Array.isArray(e)){const i=e.length;r=new Array(i);for(let s=0;s<i;++s)r[s]=Ap(this,e[s],n)}else r=Ap(this,e,n);return n.ol_key=r,r}unInternal(e,n){const r=n.ol_key;if(r)ui(r);else if(Array.isArray(e))for(let i=0,s=e.length;i<s;++i)this.removeEventListener(e[i],n);else this.removeEventListener(e,n)}}Mh.prototype.on;Mh.prototype.once;Mh.prototype.un;function ui(t){if(Array.isArray(t))for(let e=0,n=t.length;e<n;++e)it(t[e]);else it(t)}function Te(){throw new Error("Unimplemented abstract method.")}let y4=0;function fe(t){return t.ol_uid||(t.ol_uid=String(++y4))}class sT extends Cr{constructor(e,n,r){super(e),this.key=n,this.oldValue=r}}class bi extends Mh{constructor(e){super(),this.on,this.once,this.un,fe(this),this.values_=null,e!==void 0&&this.setProperties(e)}get(e){let n;return this.values_&&this.values_.hasOwnProperty(e)&&(n=this.values_[e]),n}getKeys(){return this.values_&&Object.keys(this.values_)||[]}getProperties(){return this.values_&&Object.assign({},this.values_)||{}}getPropertiesInternal(){return this.values_}hasProperties(){return!!this.values_}notify(e,n){let r;r=`change:${e}`,this.hasListener(r)&&this.dispatchEvent(new sT(r,e,n)),r=Lc.PROPERTYCHANGE,this.hasListener(r)&&this.dispatchEvent(new sT(r,e,n))}addChangeListener(e,n){this.addEventListener(`change:${e}`,n)}removeChangeListener(e,n){this.removeEventListener(`change:${e}`,n)}set(e,n,r){const i=this.values_||(this.values_={});if(r)i[e]=n;else{const s=i[e];i[e]=n,s!==n&&this.notify(e,s)}}setProperties(e,n){for(const r in e)this.set(r,e[r],n)}applyProperties(e){e.values_&&Object.assign(this.values_||(this.values_={}),e.values_)}unset(e,n){if(this.values_&&e in this.values_){const r=this.values_[e];delete this.values_[e],Uo(this.values_)&&(this.values_=null),n||this.notify(e,r)}}}const Rf="ol-hidden",_4="ol-selectable",iu="ol-unselectable",oT="ol-unsupported",Km="ol-control",aT="ol-collapsed",v4=new RegExp(["^\\s*(?=(?:(?:[-a-z]+\\s*){0,2}(italic|oblique))?)","(?=(?:(?:[-a-z]+\\s*){0,2}(small-caps))?)","(?=(?:(?:[-a-z]+\\s*){0,2}(bold(?:er)?|lighter|[1-9]00 ))?)","(?:(?:normal|\\1|\\2|\\3)\\s*){0,3}((?:xx?-)?","(?:small|large)|medium|smaller|larger|[\\.\\d]+(?:\\%|in|[cem]m|ex|p[ctx]))","(?:\\s*\\/\\s*(normal|[\\.\\d]+(?:\\%|in|[cem]m|ex|p[ctx])?))",`?\\s*([-,\\"\\'\\sa-z0-9]+?)\\s*$`].join(""),"i"),lT=["style","variant","weight","size","lineHeight","family"],sw={normal:400,bold:700},ow=function(t){const e=t.match(v4);if(!e)return null;const n={lineHeight:"normal",size:"1.2em",style:"normal",weight:"400",variant:"normal"};for(let r=0,i=lT.length;r<i;++r){const s=e[r+1];s!==void 0&&(n[lT[r]]=typeof s=="string"?s.trim():s)}return isNaN(Number(n.weight))&&n.weight in sw&&(n.weight=sw[n.weight]),n.families=n.family.split(/,\s?/).map(r=>r.trim().replace(/^['"]|['"]$/g,"")),n},uO="10px sans-serif",Qn="#000",kc="round",Rs=[],Is=0,Mc="round",rh=10,ih="#000",sh="center",Op="middle",ba=[0,0,0,0],oh=1,kl=new bi;let zu=null,cT;const aw={},w4=new Set(["serif","sans-serif","monospace","cursive","fantasy","system-ui","ui-serif","ui-sans-serif","ui-monospace","ui-rounded","emoji","math","fangsong"]);function x4(t,e,n){return`${t} ${e} 16px "${n}"`}const E4=function(){let e,n;async function r(s){await n.ready;const o=await n.load(s);if(o.length===0)return!1;const a=ow(s),l=a.families[0].toLowerCase(),c=a.weight;return o.some(u=>{const d=u.family.replace(/^['"]|['"]$/g,"").toLowerCase(),h=sw[u.weight]||u.weight;return d===l&&u.style===a.style&&h==c})}async function i(){await n.ready;let s=!0;const o=kl.getProperties(),a=Object.keys(o).filter(l=>o[l]<100);for(let l=a.length-1;l>=0;--l){const c=a[l];let u=o[c];u<100&&(await r(c)?(Qa(aw),kl.set(c,100)):(u+=10,kl.set(c,u,!0),u<100&&(s=!1)))}e=void 0,s||(e=setTimeout(i,100))}return async function(s){n||(n=jr?self.fonts:document.fonts);const o=ow(s);if(!o)return;const a=o.families;let l=!1;for(const c of a){if(w4.has(c))continue;const u=x4(o.style,o.weight,c);kl.get(u)===void 0&&(kl.set(u,0,!0),l=!0)}l&&(clearTimeout(e),e=setTimeout(i,100))}}(),S4=function(){let t;return function(e){let n=aw[e];if(n==null){if(jr){const r=ow(e),i=dO(e,"g");n=(isNaN(Number(r.lineHeight))?1.2:Number(r.lineHeight))*(i.actualBoundingBoxAscent+i.actualBoundingBoxDescent)}else t||(t=document.createElement("div"),t.innerHTML="M",t.style.minHeight="0",t.style.maxHeight="none",t.style.height="auto",t.style.padding="0",t.style.border="none",t.style.position="absolute",t.style.display="block",t.style.left="-99999px"),t.style.font=e,document.body.appendChild(t),n=t.offsetHeight,document.body.removeChild(t);aw[e]=n}return n}}();function dO(t,e){return zu||(zu=Vt(1,1)),t!=cT&&(zu.font=t,cT=zu.font),zu.measureText(e)}function hO(t,e){return dO(t,e).width}function uT(t,e,n){if(e in n)return n[e];const r=e.split(`
`).reduce((i,s)=>Math.max(i,hO(t,s)),0);return n[e]=r,r}function b4(t,e){const n=[],r=[],i=[];let s=0,o=0,a=0,l=0;for(let c=0,u=e.length;c<=u;c+=2){const d=e[c];if(d===`
`||c===u){s=Math.max(s,o),i.push(o),o=0,a+=l,l=0;continue}const h=e[c+1]||t.font,f=hO(h,d);n.push(f),o+=f;const p=S4(h);r.push(p),l=Math.max(l,p)}return{width:s,height:a,widths:n,heights:r,lineWidths:i}}function C4(t,e,n,r,i,s,o,a,l,c,u){t.save(),n!==1&&(t.globalAlpha===void 0?t.globalAlpha=d=>d.globalAlpha*=n:t.globalAlpha*=n),e&&t.transform.apply(t,e),r.contextInstructions?(t.translate(l,c),t.scale(u[0],u[1]),T4(r,t)):u[0]<0||u[1]<0?(t.translate(l,c),t.scale(u[0],u[1]),t.drawImage(r,i,s,o,a,0,0,o,a)):t.drawImage(r,i,s,o,a,l,c,o*u[0],a*u[1]),t.restore()}function T4(t,e){const n=t.contextInstructions;for(let r=0,i=n.length;r<i;r+=2)Array.isArray(n[r+1])?e[n[r]].apply(e,n[r+1]):e[n[r]]=n[r+1]}function dT(t){return t[0]>0&&t[1]>0}function fO(t,e,n){return n===void 0&&(n=[0,0]),n[0]=t[0]*e+.5|0,n[1]=t[1]*e+.5|0,n}function dn(t,e){return Array.isArray(t)?t:(e===void 0?e=[t,t]:(e[0]=t,e[1]=t),e)}class Ym{constructor(e){this.opacity_=e.opacity,this.rotateWithView_=e.rotateWithView,this.rotation_=e.rotation,this.scale_=e.scale,this.scaleArray_=dn(e.scale),this.displacement_=e.displacement,this.declutterMode_=e.declutterMode}clone(){const e=this.getScale();return new Ym({opacity:this.getOpacity(),scale:Array.isArray(e)?e.slice():e,rotation:this.getRotation(),rotateWithView:this.getRotateWithView(),displacement:this.getDisplacement().slice(),declutterMode:this.getDeclutterMode()})}getOpacity(){return this.opacity_}getRotateWithView(){return this.rotateWithView_}getRotation(){return this.rotation_}getScale(){return this.scale_}getScaleArray(){return this.scaleArray_}getDisplacement(){return this.displacement_}getDeclutterMode(){return this.declutterMode_}getAnchor(){return Te()}getImage(e){return Te()}getHitDetectionImage(){return Te()}getPixelRatio(e){return 1}getImageState(){return Te()}getImageSize(){return Te()}getOrigin(){return Te()}getSize(){return Te()}setDisplacement(e){this.displacement_=e}setOpacity(e){this.opacity_=e}setRotateWithView(e){this.rotateWithView_=e}setRotation(e){this.rotation_=e}setScale(e){this.scale_=e,this.scaleArray_=dn(e)}listenImageChange(e){Te()}load(){Te()}unlistenImageChange(e){Te()}ready(){return Promise.resolve()}}class Dh extends Ym{constructor(e){super({opacity:1,rotateWithView:e.rotateWithView!==void 0?e.rotateWithView:!1,rotation:e.rotation!==void 0?e.rotation:0,scale:e.scale!==void 0?e.scale:1,displacement:e.displacement!==void 0?e.displacement:[0,0],declutterMode:e.declutterMode}),this.hitDetectionCanvas_=null,this.fill_=e.fill!==void 0?e.fill:null,this.origin_=[0,0],this.points_=e.points,this.radius=e.radius,this.radius2_=e.radius2,this.angle_=e.angle!==void 0?e.angle:0,this.stroke_=e.stroke!==void 0?e.stroke:null,this.size_,this.renderOptions_,this.imageState_=this.fill_&&this.fill_.loading()?ye.LOADING:ye.LOADED,this.imageState_===ye.LOADING&&this.ready().then(()=>this.imageState_=ye.LOADED),this.render()}clone(){const e=this.getScale(),n=new Dh({fill:this.getFill()?this.getFill().clone():void 0,points:this.getPoints(),radius:this.getRadius(),radius2:this.getRadius2(),angle:this.getAngle(),stroke:this.getStroke()?this.getStroke().clone():void 0,rotation:this.getRotation(),rotateWithView:this.getRotateWithView(),scale:Array.isArray(e)?e.slice():e,displacement:this.getDisplacement().slice(),declutterMode:this.getDeclutterMode()});return n.setOpacity(this.getOpacity()),n}getAnchor(){const e=this.size_,n=this.getDisplacement(),r=this.getScaleArray();return[e[0]/2-n[0]/r[0],e[1]/2+n[1]/r[1]]}getAngle(){return this.angle_}getFill(){return this.fill_}setFill(e){this.fill_=e,this.render()}getHitDetectionImage(){return this.hitDetectionCanvas_||(this.hitDetectionCanvas_=this.createHitDetectionCanvas_(this.renderOptions_)),this.hitDetectionCanvas_}getImage(e){var s,o;const n=(s=this.fill_)==null?void 0:s.getKey(),r=`${e},${this.angle_},${this.radius},${this.radius2_},${this.points_},${n}`+Object.values(this.renderOptions_).join(",");let i=(o=zr.get(r,null,null))==null?void 0:o.getImage(1);if(!i){const a=this.renderOptions_,l=Math.ceil(a.size*e),c=Vt(l,l);this.draw_(a,c,e),i=c.canvas,zr.set(r,null,null,new cO(i,void 0,null,ye.LOADED,null))}return i}getPixelRatio(e){return e}getImageSize(){return this.size_}getImageState(){return this.imageState_}getOrigin(){return this.origin_}getPoints(){return this.points_}getRadius(){return this.radius}getRadius2(){return this.radius2_}getSize(){return this.size_}getStroke(){return this.stroke_}setStroke(e){this.stroke_=e,this.render()}listenImageChange(e){}load(){}unlistenImageChange(e){}calculateLineJoinSize_(e,n,r){if(n===0||this.points_===1/0||e!=="bevel"&&e!=="miter")return n;let i=this.radius,s=this.radius2_===void 0?i:this.radius2_;if(i<s){const S=i;i=s,s=S}const o=this.radius2_===void 0?this.points_:this.points_*2,a=2*Math.PI/o,l=s*Math.sin(a),c=Math.sqrt(s*s-l*l),u=i-c,d=Math.sqrt(l*l+u*u),h=d/l;if(e==="miter"&&h<=r)return h*n;const f=n/2/h,p=n/2*(u/d),_=Math.sqrt((i+f)*(i+f)+p*p)-i;if(this.radius2_===void 0||e==="bevel")return _*2;const g=i*Math.sin(a),y=Math.sqrt(i*i-g*g),v=s-y,x=Math.sqrt(g*g+v*v)/g;if(x<=r){const S=x*n/2-s-i;return 2*Math.max(_,S)}return _*2}createRenderOptions(){let e=kc,n=Mc,r=0,i=null,s=0,o,a=0;this.stroke_&&(o=Ni(this.stroke_.getColor()??ih),a=this.stroke_.getWidth()??oh,i=this.stroke_.getLineDash(),s=this.stroke_.getLineDashOffset()??0,n=this.stroke_.getLineJoin()??Mc,e=this.stroke_.getLineCap()??kc,r=this.stroke_.getMiterLimit()??rh);const l=this.calculateLineJoinSize_(n,a,r),c=Math.max(this.radius,this.radius2_||0),u=Math.ceil(2*c+l);return{strokeStyle:o,strokeWidth:a,size:u,lineCap:e,lineDash:i,lineDashOffset:s,lineJoin:n,miterLimit:r}}render(){this.renderOptions_=this.createRenderOptions();const e=this.renderOptions_.size;this.hitDetectionCanvas_=null,this.size_=[e,e]}draw_(e,n,r){if(n.scale(r,r),n.translate(e.size/2,e.size/2),this.createPath_(n),this.fill_){let i=this.fill_.getColor();i===null&&(i=Qn),n.fillStyle=Ni(i),n.fill()}e.strokeStyle&&(n.strokeStyle=e.strokeStyle,n.lineWidth=e.strokeWidth,e.lineDash&&(n.setLineDash(e.lineDash),n.lineDashOffset=e.lineDashOffset),n.lineCap=e.lineCap,n.lineJoin=e.lineJoin,n.miterLimit=e.miterLimit,n.stroke())}createHitDetectionCanvas_(e){let n;if(this.fill_){let r=this.fill_.getColor(),i=0;typeof r=="string"&&(r=Yr(r)),r===null?i=1:Array.isArray(r)&&(i=r.length===4?r[3]:1),i===0&&(n=Vt(e.size,e.size),this.drawHitDetectionCanvas_(e,n))}return n?n.canvas:this.getImage(1)}createPath_(e){let n=this.points_;const r=this.radius;if(n===1/0)e.arc(0,0,r,0,2*Math.PI);else{const i=this.radius2_===void 0?r:this.radius2_;this.radius2_!==void 0&&(n*=2);const s=this.angle_-Math.PI/2,o=2*Math.PI/n;for(let a=0;a<n;a++){const l=s+a*o,c=a%2===0?r:i;e.lineTo(c*Math.cos(l),c*Math.sin(l))}e.closePath()}}drawHitDetectionCanvas_(e,n){n.translate(e.size/2,e.size/2),this.createPath_(n),n.fillStyle=Qn,n.fill(),e.strokeStyle&&(n.strokeStyle=e.strokeStyle,n.lineWidth=e.strokeWidth,e.lineDash&&(n.setLineDash(e.lineDash),n.lineDashOffset=e.lineDashOffset),n.lineJoin=e.lineJoin,n.miterLimit=e.miterLimit,n.stroke())}ready(){return this.fill_?this.fill_.ready():Promise.resolve()}}class Bs extends Dh{constructor(e){e=e||{radius:5},super({points:1/0,fill:e.fill,radius:e.radius,stroke:e.stroke,scale:e.scale!==void 0?e.scale:1,rotation:e.rotation!==void 0?e.rotation:0,rotateWithView:e.rotateWithView!==void 0?e.rotateWithView:!1,displacement:e.displacement!==void 0?e.displacement:[0,0],declutterMode:e.declutterMode})}clone(){const e=this.getScale(),n=new Bs({fill:this.getFill()?this.getFill().clone():void 0,stroke:this.getStroke()?this.getStroke().clone():void 0,radius:this.getRadius(),scale:Array.isArray(e)?e.slice():e,rotation:this.getRotation(),rotateWithView:this.getRotateWithView(),displacement:this.getDisplacement().slice(),declutterMode:this.getDeclutterMode()});return n.setOpacity(this.getOpacity()),n}setRadius(e){this.radius=e,this.render()}}class Wt{constructor(e){e=e||{},this.patternImage_=null,this.color_=null,e.color!==void 0&&this.setColor(e.color)}clone(){const e=this.getColor();return new Wt({color:Array.isArray(e)?e.slice():e||void 0})}getColor(){return this.color_}setColor(e){if(e!==null&&typeof e=="object"&&"src"in e){const n=Fp(null,e.src,"anonymous",void 0,e.offset?null:e.color?e.color:null,!(e.offset&&e.size));n.ready().then(()=>{this.patternImage_=null}),n.getImageState()===ye.IDLE&&n.load(),n.getImageState()===ye.LOADING&&(this.patternImage_=n)}this.color_=e}getKey(){const e=this.getColor();return e?e instanceof CanvasPattern||e instanceof CanvasGradient?fe(e):typeof e=="object"&&"src"in e?e.src+":"+e.offset:Yr(e).toString():""}loading(){return!!this.patternImage_}ready(){return this.patternImage_?this.patternImage_.ready():Promise.resolve()}}function ze(t,e){if(!t)throw new Error(e)}function hT(t,e,n,r){return n!==void 0&&r!==void 0?[n/t,r/e]:n!==void 0?n/t:r!==void 0?r/e:1}class Go extends Ym{constructor(e){e=e||{};const n=e.opacity!==void 0?e.opacity:1,r=e.rotation!==void 0?e.rotation:0,i=e.scale!==void 0?e.scale:1,s=e.rotateWithView!==void 0?e.rotateWithView:!1;super({opacity:n,rotation:r,scale:i,displacement:e.displacement!==void 0?e.displacement:[0,0],rotateWithView:s,declutterMode:e.declutterMode}),this.anchor_=e.anchor!==void 0?e.anchor:[.5,.5],this.normalizedAnchor_=null,this.anchorOrigin_=e.anchorOrigin!==void 0?e.anchorOrigin:"top-left",this.anchorXUnits_=e.anchorXUnits!==void 0?e.anchorXUnits:"fraction",this.anchorYUnits_=e.anchorYUnits!==void 0?e.anchorYUnits:"fraction",this.crossOrigin_=e.crossOrigin!==void 0?e.crossOrigin:null;const o=e.img!==void 0?e.img:null;let a=e.src;ze(!(a!==void 0&&o),"`image` and `src` cannot be provided at the same time"),(a===void 0||a.length===0)&&o&&(a=o.src||fe(o)),ze(a!==void 0&&a.length>0,"A defined and non-empty `src` or `image` must be provided"),ze(!((e.width!==void 0||e.height!==void 0)&&e.scale!==void 0),"`width` or `height` cannot be provided together with `scale`");let l;if(e.src!==void 0?l=ye.IDLE:o!==void 0&&("complete"in o?o.complete?l=o.src?ye.LOADED:ye.IDLE:l=ye.LOADING:l=ye.LOADED),this.color_=e.color!==void 0?Yr(e.color):null,this.iconImage_=Fp(o,a,this.crossOrigin_,l,this.color_),this.offset_=e.offset!==void 0?e.offset:[0,0],this.offsetOrigin_=e.offsetOrigin!==void 0?e.offsetOrigin:"top-left",this.origin_=null,this.size_=e.size!==void 0?e.size:null,this.initialOptions_,e.width!==void 0||e.height!==void 0){let c,u;if(e.size)[c,u]=e.size;else{const d=this.getImage(1);if(d.width&&d.height)c=d.width,u=d.height;else if(d instanceof HTMLImageElement){this.initialOptions_=e;const h=()=>{if(this.unlistenImageChange(h),!this.initialOptions_)return;const f=this.iconImage_.getSize();this.setScale(hT(f[0],f[1],e.width,e.height))};this.listenImageChange(h);return}}c!==void 0&&this.setScale(hT(c,u,e.width,e.height))}}clone(){let e,n,r;return this.initialOptions_?(n=this.initialOptions_.width,r=this.initialOptions_.height):(e=this.getScale(),e=Array.isArray(e)?e.slice():e),new Go({anchor:this.anchor_.slice(),anchorOrigin:this.anchorOrigin_,anchorXUnits:this.anchorXUnits_,anchorYUnits:this.anchorYUnits_,color:this.color_&&this.color_.slice?this.color_.slice():this.color_||void 0,crossOrigin:this.crossOrigin_,offset:this.offset_.slice(),offsetOrigin:this.offsetOrigin_,opacity:this.getOpacity(),rotateWithView:this.getRotateWithView(),rotation:this.getRotation(),scale:e,width:n,height:r,size:this.size_!==null?this.size_.slice():void 0,src:this.getSrc(),displacement:this.getDisplacement().slice(),declutterMode:this.getDeclutterMode()})}getAnchor(){let e=this.normalizedAnchor_;if(!e){e=this.anchor_;const i=this.getSize();if(this.anchorXUnits_=="fraction"||this.anchorYUnits_=="fraction"){if(!i)return null;e=this.anchor_.slice(),this.anchorXUnits_=="fraction"&&(e[0]*=i[0]),this.anchorYUnits_=="fraction"&&(e[1]*=i[1])}if(this.anchorOrigin_!="top-left"){if(!i)return null;e===this.anchor_&&(e=this.anchor_.slice()),(this.anchorOrigin_=="top-right"||this.anchorOrigin_=="bottom-right")&&(e[0]=-e[0]+i[0]),(this.anchorOrigin_=="bottom-left"||this.anchorOrigin_=="bottom-right")&&(e[1]=-e[1]+i[1])}this.normalizedAnchor_=e}const n=this.getDisplacement(),r=this.getScaleArray();return[e[0]-n[0]/r[0],e[1]+n[1]/r[1]]}setAnchor(e){this.anchor_=e,this.normalizedAnchor_=null}getColor(){return this.color_}getImage(e){return this.iconImage_.getImage(e)}getPixelRatio(e){return this.iconImage_.getPixelRatio(e)}getImageSize(){return this.iconImage_.getSize()}getImageState(){return this.iconImage_.getImageState()}getHitDetectionImage(){return this.iconImage_.getHitDetectionImage()}getOrigin(){if(this.origin_)return this.origin_;let e=this.offset_;if(this.offsetOrigin_!="top-left"){const n=this.getSize(),r=this.iconImage_.getSize();if(!n||!r)return null;e=e.slice(),(this.offsetOrigin_=="top-right"||this.offsetOrigin_=="bottom-right")&&(e[0]=r[0]-n[0]-e[0]),(this.offsetOrigin_=="bottom-left"||this.offsetOrigin_=="bottom-right")&&(e[1]=r[1]-n[1]-e[1])}return this.origin_=e,this.origin_}getSrc(){return this.iconImage_.getSrc()}setSrc(e){this.iconImage_=Fp(null,e,this.crossOrigin_,ye.IDLE,this.color_)}getSize(){return this.size_?this.size_:this.iconImage_.getSize()}getWidth(){const e=this.getScaleArray();if(this.size_)return this.size_[0]*e[0];if(this.iconImage_.getImageState()==ye.LOADED)return this.iconImage_.getSize()[0]*e[0]}getHeight(){const e=this.getScaleArray();if(this.size_)return this.size_[1]*e[1];if(this.iconImage_.getImageState()==ye.LOADED)return this.iconImage_.getSize()[1]*e[1]}setScale(e){delete this.initialOptions_,super.setScale(e)}listenImageChange(e){this.iconImage_.addEventListener(Se.CHANGE,e)}load(){this.iconImage_.load()}unlistenImageChange(e){this.iconImage_.removeEventListener(Se.CHANGE,e)}ready(){return this.iconImage_.ready()}}class yt{constructor(e){e=e||{},this.color_=e.color!==void 0?e.color:null,this.lineCap_=e.lineCap,this.lineDash_=e.lineDash!==void 0?e.lineDash:null,this.lineDashOffset_=e.lineDashOffset,this.lineJoin_=e.lineJoin,this.miterLimit_=e.miterLimit,this.width_=e.width}clone(){const e=this.getColor();return new yt({color:Array.isArray(e)?e.slice():e||void 0,lineCap:this.getLineCap(),lineDash:this.getLineDash()?this.getLineDash().slice():void 0,lineDashOffset:this.getLineDashOffset(),lineJoin:this.getLineJoin(),miterLimit:this.getMiterLimit(),width:this.getWidth()})}getColor(){return this.color_}getLineCap(){return this.lineCap_}getLineDash(){return this.lineDash_}getLineDashOffset(){return this.lineDashOffset_}getLineJoin(){return this.lineJoin_}getMiterLimit(){return this.miterLimit_}getWidth(){return this.width_}setColor(e){this.color_=e}setLineCap(e){this.lineCap_=e}setLineDash(e){this.lineDash_=e}setLineDashOffset(e){this.lineDashOffset_=e}setLineJoin(e){this.lineJoin_=e}setMiterLimit(e){this.miterLimit_=e}setWidth(e){this.width_=e}}class nt{constructor(e){e=e||{},this.geometry_=null,this.geometryFunction_=fT,e.geometry!==void 0&&this.setGeometry(e.geometry),this.fill_=e.fill!==void 0?e.fill:null,this.image_=e.image!==void 0?e.image:null,this.renderer_=e.renderer!==void 0?e.renderer:null,this.hitDetectionRenderer_=e.hitDetectionRenderer!==void 0?e.hitDetectionRenderer:null,this.stroke_=e.stroke!==void 0?e.stroke:null,this.text_=e.text!==void 0?e.text:null,this.zIndex_=e.zIndex}clone(){let e=this.getGeometry();return e&&typeof e=="object"&&(e=e.clone()),new nt({geometry:e??void 0,fill:this.getFill()?this.getFill().clone():void 0,image:this.getImage()?this.getImage().clone():void 0,renderer:this.getRenderer()??void 0,stroke:this.getStroke()?this.getStroke().clone():void 0,text:this.getText()?this.getText().clone():void 0,zIndex:this.getZIndex()})}getRenderer(){return this.renderer_}setRenderer(e){this.renderer_=e}setHitDetectionRenderer(e){this.hitDetectionRenderer_=e}getHitDetectionRenderer(){return this.hitDetectionRenderer_}getGeometry(){return this.geometry_}getGeometryFunction(){return this.geometryFunction_}getFill(){return this.fill_}setFill(e){this.fill_=e}getImage(){return this.image_}setImage(e){this.image_=e}getStroke(){return this.stroke_}setStroke(e){this.stroke_=e}getText(){return this.text_}setText(e){this.text_=e}getZIndex(){return this.zIndex_}setGeometry(e){typeof e=="function"?this.geometryFunction_=e:typeof e=="string"?this.geometryFunction_=function(n){return n.get(e)}:e?e!==void 0&&(this.geometryFunction_=function(){return e}):this.geometryFunction_=fT,this.geometry_=e}setZIndex(e){this.zIndex_=e}}function P4(t){let e;if(typeof t=="function")e=t;else{let n;Array.isArray(t)?n=t:(ze(typeof t.getZIndex=="function","Expected an `Style` or an array of `Style`"),n=[t]),e=function(){return n}}return e}let q_=null;function gO(t,e){if(!q_){const n=new Wt({color:"rgba(255,255,255,0.4)"}),r=new yt({color:"#3399CC",width:1.25});q_=[new nt({image:new Bs({fill:n,stroke:r,radius:5}),fill:n,stroke:r})]}return q_}function w1(){const t={},e=[255,255,255,1],n=[0,153,255,1],r=3;return t.Polygon=[new nt({fill:new Wt({color:[255,255,255,.5]})})],t.MultiPolygon=t.Polygon,t.LineString=[new nt({stroke:new yt({color:e,width:r+2})}),new nt({stroke:new yt({color:n,width:r})})],t.MultiLineString=t.LineString,t.Circle=t.Polygon.concat(t.LineString),t.Point=[new nt({image:new Bs({radius:r*2,fill:new Wt({color:n}),stroke:new yt({color:e,width:r/2})}),zIndex:1/0})],t.MultiPoint=t.Point,t.GeometryCollection=t.Polygon.concat(t.LineString,t.Point),t}function fT(t){return t.getGeometry()}const R4="#333";class Zo{constructor(e){e=e||{},this.font_=e.font,this.rotation_=e.rotation,this.rotateWithView_=e.rotateWithView,this.keepUpright_=e.keepUpright,this.scale_=e.scale,this.scaleArray_=dn(e.scale!==void 0?e.scale:1),this.text_=e.text,this.textAlign_=e.textAlign,this.justify_=e.justify,this.repeat_=e.repeat,this.textBaseline_=e.textBaseline,this.fill_=e.fill!==void 0?e.fill:new Wt({color:R4}),this.maxAngle_=e.maxAngle!==void 0?e.maxAngle:Math.PI/4,this.placement_=e.placement!==void 0?e.placement:"point",this.overflow_=!!e.overflow,this.stroke_=e.stroke!==void 0?e.stroke:null,this.offsetX_=e.offsetX!==void 0?e.offsetX:0,this.offsetY_=e.offsetY!==void 0?e.offsetY:0,this.backgroundFill_=e.backgroundFill?e.backgroundFill:null,this.backgroundStroke_=e.backgroundStroke?e.backgroundStroke:null,this.padding_=e.padding===void 0?null:e.padding,this.declutterMode_=e.declutterMode}clone(){const e=this.getScale();return new Zo({font:this.getFont(),placement:this.getPlacement(),repeat:this.getRepeat(),maxAngle:this.getMaxAngle(),overflow:this.getOverflow(),rotation:this.getRotation(),rotateWithView:this.getRotateWithView(),keepUpright:this.getKeepUpright(),scale:Array.isArray(e)?e.slice():e,text:this.getText(),textAlign:this.getTextAlign(),justify:this.getJustify(),textBaseline:this.getTextBaseline(),fill:this.getFill()instanceof Wt?this.getFill().clone():this.getFill(),stroke:this.getStroke()?this.getStroke().clone():void 0,offsetX:this.getOffsetX(),offsetY:this.getOffsetY(),backgroundFill:this.getBackgroundFill()?this.getBackgroundFill().clone():void 0,backgroundStroke:this.getBackgroundStroke()?this.getBackgroundStroke().clone():void 0,padding:this.getPadding()||void 0,declutterMode:this.getDeclutterMode()})}getOverflow(){return this.overflow_}getFont(){return this.font_}getMaxAngle(){return this.maxAngle_}getPlacement(){return this.placement_}getRepeat(){return this.repeat_}getOffsetX(){return this.offsetX_}getOffsetY(){return this.offsetY_}getFill(){return this.fill_}getRotateWithView(){return this.rotateWithView_}getKeepUpright(){return this.keepUpright_}getRotation(){return this.rotation_}getScale(){return this.scale_}getScaleArray(){return this.scaleArray_}getStroke(){return this.stroke_}getText(){return this.text_}getTextAlign(){return this.textAlign_}getJustify(){return this.justify_}getTextBaseline(){return this.textBaseline_}getBackgroundFill(){return this.backgroundFill_}getBackgroundStroke(){return this.backgroundStroke_}getPadding(){return this.padding_}getDeclutterMode(){return this.declutterMode_}setOverflow(e){this.overflow_=e}setFont(e){this.font_=e}setMaxAngle(e){this.maxAngle_=e}setOffsetX(e){this.offsetX_=e}setOffsetY(e){this.offsetY_=e}setPlacement(e){this.placement_=e}setRepeat(e){this.repeat_=e}setRotateWithView(e){this.rotateWithView_=e}setKeepUpright(e){this.keepUpright_=e}setFill(e){this.fill_=e}setRotation(e){this.rotation_=e}setScale(e){this.scale_=e,this.scaleArray_=dn(e!==void 0?e:1)}setStroke(e){this.stroke_=e}setText(e){this.text_=e}setTextAlign(e){this.textAlign_=e}setJustify(e){this.justify_=e}setTextBaseline(e){this.textBaseline_=e}setBackgroundFill(e){this.backgroundFill_=e}setBackgroundStroke(e){this.backgroundStroke_=e}setPadding(e){this.padding_=e}}const J_=(t,e=2,n)=>new nt({stroke:new yt({color:t,width:e,lineDash:n})}),Uu=(t,e="#333",n=1.5)=>new nt({fill:new Wt({color:t}),stroke:new yt({color:e,width:n})}),Or=(t,e="#fff",n=7,r=0,i=0)=>new nt({image:new Dh({radius:n,points:r,rotation:i,fill:new Wt({color:t}),stroke:new yt({color:e,width:1.5})})}),gT=(t,e,n)=>r=>{var s;const i=(s=r==null?void 0:r.get)==null?void 0:s.call(r,n);return new nt({stroke:new yt({color:t,width:e}),text:i?new Zo({text:String(i),font:"12px 'Inter', sans-serif",fill:new Wt({color:"#ffffff"}),stroke:new yt({color:"rgba(0,0,0,0.6)",width:3}),placement:"line",overflow:!0}):void 0})},ja={property_boundary:{file:"property_boundary.geojson",geometry:"Polygon",style:Uu("rgba(56, 189, 248, 0.12)","rgba(14, 165, 233, 0.9)",2.2),addable:!1,selectable:!1,label:"Property Boundary",icon:"",legendFill:"rgba(56, 189, 248, 0.22)",legendStroke:"rgba(14, 165, 233, 0.9)",areaField:"acres"},trees_points:{file:"trees_points.geojson",geometry:"Point",style:t=>{const e=t.get("density")||"medium";return Or("#2e7d32","#fff",e==="low"?5:e==="high"?9:7,3)},addable:!0,label:"Trees",icon:"T",legendFill:"#047857"},tree_stands:{file:"tree_stands.geojson",geometry:"Polygon",style:Uu("rgba(59, 130, 246, 0.20)","rgba(37, 99, 235, 0.75)",2),addable:!0,label:"Tree Stands (Area)",icon:"",legendFill:"rgba(59, 130, 246, 0.30)",legendStroke:"rgba(37, 99, 235, 0.75)",areaField:"area_acres"},bedding_areas:{file:"bedding_areas.geojson",geometry:"Polygon",style:Uu("rgba(217, 180, 255, 0.26)","rgba(168, 85, 247, 0.6)",1.8),addable:!0,label:"Bedding Areas",icon:"",legendFill:"rgba(217, 180, 255, 0.38)",legendStroke:"rgba(168, 85, 247, 0.6)",areaField:"size_acres"},beds_points:{file:"beds_points.geojson",geometry:"Point",style:Or("#7c3aed","#fff",7,4),addable:!0,label:"Beds",icon:"B",legendFill:"#7c3aed"},open_woods:{file:"open_woods.geojson",geometry:"Polygon",style:t=>{const e=t.get("openness_1_5")||3,n=t.get("understory_1_5")||3,r=.2+(5-e)*.05,i=120-n*5;return Uu(`hsla(${i}, 60%, 40%, ${r})`,"#4f772d",1.2)},addable:!0,label:"Open Woods",icon:"",legendFill:"rgba(34, 197, 94, 0.26)",legendStroke:"rgba(22, 163, 74, 0.6)",areaField:"area_acres"},cover_points:{file:"cover_points.geojson",geometry:"Point",style:Or("#0f766e","#fff",7,4),addable:!0,label:"Cover Points",icon:"C",legendFill:"#0f766e"},acorn_flats:{file:"acorn_flats.geojson",geometry:"Polygon",style:Uu("rgba(250, 204, 21, 0.24)","rgba(217, 119, 6, 0.6)",1.6),addable:!0,label:"Acorn Flats",icon:"",legendFill:"rgba(250, 204, 21, 0.36)",legendStroke:"rgba(217, 119, 6, 0.6)",areaField:"area_acres"},mast_check_points:{file:"mast_check_points.geojson",geometry:"Point",style:Or("#ca8a04","#fff",7,4),addable:!0,label:"Mast Checkpoints",icon:"MC",legendFill:"#ca8a04"},big_rocks:{file:"big_rocks.geojson",geometry:"Point",style:t=>{const e=t.get("size_m")||5,n=t.get("density")||"medium",r=Math.min(12,e);return Or("#616161","#fff",r,n==="high"?8:4)},addable:!0,label:"Big Rocks",icon:"RK",legendFill:"#4b5563"},cliffs:{file:"cliffs.geojson",geometry:"LineString",style:J_("#a16207",3.2,[6,4]),addable:!0,label:"Cliffs",icon:"Cliff",legendLine:"#a16207"},ravines:{file:"ravines.geojson",geometry:"LineString",style:J_("#7c3aed",3,[4,4]),addable:!0,label:"Ravines",icon:"Ravine",legendLine:"#7c3aed"},streams:{file:"streams.geojson",geometry:"LineString",style:J_("#0ea5e9",3.2),addable:!0,label:"Streams",icon:"Stream",legendLine:"#0ea5e9"},trails:{file:"trails.geojson",geometry:"LineString",style:gT("#f97316",3.2,"name"),addable:!0,label:"Trails",icon:"Trail",legendLine:"#f97316"},scrapes:{file:"scrapes.geojson",geometry:"Point",style:Or("#ff7043","#fff",7,4),addable:!0,label:"Scrapes",icon:"Sc",legendFill:"#f97316"},rubs:{file:"rubs.geojson",geometry:"Point",style:Or("#a0522d","#fff",7,5),addable:!0,label:"Rubs",icon:"R",legendFill:"#dc2626"},stands:{file:"stands.geojson",geometry:"Point",style:Or("#1d4ed8","#fff",9,5),addable:!0,label:"Tree Stands (Point)",icon:"S",legendFill:"#1d4ed8"},hunts:{file:"hunts.geojson",geometry:"Point",style:Or("#0ea5e9","#fff",8,4),addable:!0,label:"Hunts",icon:"H",legendFill:"#0ea5e9"},animal_sightings:{file:"animal_sightings.geojson",geometry:"Point",style:Or("#ec4899","#fff",8,4),addable:!0,label:"Animal Sightings",icon:"Si",legendFill:"#ec4899"},animal_paths:{file:"animal_paths.geojson",geometry:"LineString",style:gT("#14b8a6",3.2,"name"),addable:!0,label:"Animal Paths",icon:"Path",legendLine:"#14b8a6"},animal_sign:{file:"animal_sign.geojson",geometry:"Point",style:Or("#9333ea","#fff",7,4),addable:!0,label:"Animal Sign",icon:"SG",legendFill:"#9333ea"},harvests:{file:"harvests.geojson",geometry:"Point",style:Or("#f43f5e","#fff",8,4),addable:!0,label:"Harvests",icon:"Hv",legendFill:"#f43f5e"}},pO=["property_boundary","streams","cliffs","ravines","trails","tree_stands","open_woods","cover_points","acorn_flats","bedding_areas","trees_points","beds_points","mast_check_points","big_rocks","scrapes","rubs","stands","animal_sign","animal_paths","hunts","harvests","animal_sightings"],I4=/\.(kml|kmz|geojson|json|gpx)$/i,pT=t=>{const e=t.replace(/\\/g,"/");if(I4.test(e)){const n=e.lastIndexOf("/");if(n>0)return{projectDir:e.slice(0,n),selectedFile:e}}return{projectDir:e,selectedFile:null}},He=Qi(t=>({projectPath:null,projectName:null,loading:!1,hasBoundary:!1,pendingView:null,setHasBoundary:e=>t({hasBoundary:e}),setPendingView:e=>t({pendingView:e}),createNewProject:async()=>{t({loading:!0});try{const e=await window.api.chooseDirectory();if(!e){t({loading:!1});return}const{projectDir:n,selectedFile:r}=pT(e),s=n.split("/").filter(Boolean).pop()||"My True Map";await window.api.projectCreateStructure(n,s),window.api.setActiveProject(n),r&&window.alert(`Project folder created at:
${n}

(You picked a data file: ${r}. Use "Import Boundary" once the map loads to import it.)`),t({projectPath:n,projectName:s,loading:!1,hasBoundary:!1,pendingView:null})}catch(e){console.error("create project failed",e),window.alert("Could not create the project. Please choose a writable folder."),t({loading:!1})}},openExistingProject:async()=>{var e,n;t({loading:!0});try{const r=await window.api.chooseDirectory();if(!r){t({loading:!1});return}const{projectDir:i}=pT(r),s=await window.api.readTextFile(i,"project.json"),o=JSON.parse(s);window.api.setActiveProject(i);try{for(const c of Object.values(ja))try{await window.api.readTextFile(i,`data/${c.file}`)}catch{const d=JSON.stringify({type:"FeatureCollection",features:[]},null,2);await window.api.writeTextFile(i,`data/${c.file}`,d)}}catch{}let a=null,l=!1;try{const c=await window.api.readTextFile(i,"data/property_boundary.geojson");if(c){const u=JSON.parse(c),d=(n=(e=u==null?void 0:u.features)==null?void 0:e[0])==null?void 0:n.geometry;if((d==null?void 0:d.type)==="Polygon"&&Array.isArray(d.coordinates)){const h=d.coordinates[0];if(Array.isArray(h)&&h.length>0){l=!0;const f=h.map(g=>g[0]),p=h.map(g=>g[1]),m=(Math.min(...f)+Math.max(...f))/2,_=(Math.min(...p)+Math.max(...p))/2;Number.isFinite(m)&&Number.isFinite(_)&&(a=[m,_])}}}}catch{a=null,l=!1}t({projectPath:i,projectName:(o==null?void 0:o.name)||"Unnamed Project",loading:!1,hasBoundary:l,pendingView:a?{lon:a[0],lat:a[1],zoom:16}:null})}catch(r){console.error("open project failed",r),window.alert("That folder doesnt look like a TRUE MAP project yet."),t({loading:!1})}},setCrsFromLonLat:async(e,n)=>{var l;const r=((l=He.getState)==null?void 0:l.call(He))||null,i=r==null?void 0:r.projectPath;if(!i)return;const{pickUtmFromLonLat:s,registerUtmProjection:o}=await x5(async()=>{const{pickUtmFromLonLat:c,registerUtmProjection:u}=await import("./projection-DHxSVzUs.js");return{pickUtmFromLonLat:c,registerUtmProjection:u}},[]),a=s(e,n);o(a);try{const c=await window.api.readTextFile(i,"project.json"),u=JSON.parse(c||"{}");u.crs={code:a.code,utmZone:a.utmZone,isNorthern:a.isNorthern},await window.api.writeTextFile(i,"project.json",JSON.stringify(u,null,2))}catch{}}}));let fc=null;const lw=new Set;let Q_=null;const A4=new Set;function mT(t){fc=t;for(const e of lw)try{e(fc)}catch(n){console.error("Map listener error",n)}return fc}function Xm(){return fc}function yT(t){Q_=t;for(const e of A4)try{e(Q_)}catch(n){console.error("Cesium listener error",n)}return Q_}function F4(t){return lw.add(t),t(fc),()=>{lw.delete(t)}}function Tr(){const[t,e]=K.useState(fc);return K.useEffect(()=>F4(e),[]),t}const Ht={ADD:"add",REMOVE:"remove"},_T={LENGTH:"length"};class If extends Cr{constructor(e,n,r){super(e),this.element=n,this.index=r}}class Bn extends bi{constructor(e,n){if(super(),this.on,this.once,this.un,n=n||{},this.unique_=!!n.unique,this.array_=e??[],this.unique_)for(let r=1,i=this.array_.length;r<i;++r)this.assertUnique_(this.array_[r],r);this.updateLength_()}clear(){for(;this.getLength()>0;)this.pop()}extend(e){for(let n=0,r=e.length;n<r;++n)this.push(e[n]);return this}forEach(e){const n=this.array_;for(let r=0,i=n.length;r<i;++r)e(n[r],r,n)}getArray(){return this.array_}item(e){return this.array_[e]}getLength(){return this.get(_T.LENGTH)}insertAt(e,n){if(e<0||e>this.getLength())throw new Error("Index out of bounds: "+e);this.unique_&&this.assertUnique_(n),this.array_.splice(e,0,n),this.updateLength_(),this.dispatchEvent(new If(Ht.ADD,n,e))}pop(){return this.removeAt(this.getLength()-1)}push(e){const n=this.getLength();return this.insertAt(n,e),this.getLength()}remove(e){const n=this.array_;for(let r=0,i=n.length;r<i;++r)if(n[r]===e)return this.removeAt(r)}removeAt(e){if(e<0||e>=this.getLength())return;const n=this.array_[e];return this.array_.splice(e,1),this.updateLength_(),this.dispatchEvent(new If(Ht.REMOVE,n,e)),n}setAt(e,n){const r=this.getLength();if(e>=r){this.insertAt(e,n);return}if(e<0)throw new Error("Index out of bounds: "+e);this.unique_&&this.assertUnique_(n,e);const i=this.array_[e];this.array_[e]=n,this.dispatchEvent(new If(Ht.REMOVE,i,e)),this.dispatchEvent(new If(Ht.ADD,n,e))}updateLength_(){this.set(_T.LENGTH,this.array_.length)}assertUnique_(e,n){const r=this.array_;for(let i=0,s=r.length;i<s;++i)if(r[i]===e&&i!==n)throw new Error("Duplicate item added to a unique collection")}}class Ml extends Cr{constructor(e,n,r){super(e),this.map=n,this.frameState=r!==void 0?r:null}}class ps extends Ml{constructor(e,n,r,i,s,o){super(e,n,s),this.originalEvent=r,this.pixel_=null,this.coordinate_=null,this.dragging=i!==void 0?i:!1,this.activePointers=o}get pixel(){return this.pixel_||(this.pixel_=this.map.getEventPixel(this.originalEvent)),this.pixel_}set pixel(e){this.pixel_=e}get coordinate(){return this.coordinate_||(this.coordinate_=this.map.getCoordinateFromPixel(this.pixel)),this.coordinate_}set coordinate(e){this.coordinate_=e}preventDefault(){super.preventDefault(),"preventDefault"in this.originalEvent&&this.originalEvent.preventDefault()}stopPropagation(){super.stopPropagation(),"stopPropagation"in this.originalEvent&&this.originalEvent.stopPropagation()}}const Be={SINGLECLICK:"singleclick",CLICK:Se.CLICK,DBLCLICK:Se.DBLCLICK,POINTERDRAG:"pointerdrag",POINTERMOVE:"pointermove",POINTERDOWN:"pointerdown",POINTERUP:"pointerup",POINTEROVER:"pointerover",POINTEROUT:"pointerout",POINTERENTER:"pointerenter",POINTERLEAVE:"pointerleave",POINTERCANCEL:"pointercancel"},cw={POINTERMOVE:"pointermove",POINTERDOWN:"pointerdown"};class O4 extends kh{constructor(e,n){super(e),this.map_=e,this.clickTimeoutId_,this.emulateClicks_=!1,this.dragging_=!1,this.dragListenerKeys_=[],this.moveTolerance_=n===void 0?1:n,this.down_=null;const r=this.map_.getViewport();this.activePointers_=[],this.trackedTouches_={},this.element_=r,this.pointerdownListenerKey_=Oe(r,cw.POINTERDOWN,this.handlePointerDown_,this),this.originalPointerMoveEvent_,this.relayedListenerKey_=Oe(r,cw.POINTERMOVE,this.relayMoveEvent_,this),this.boundHandleTouchMove_=this.handleTouchMove_.bind(this),this.element_.addEventListener(Se.TOUCHMOVE,this.boundHandleTouchMove_,nO?{passive:!1}:!1)}emulateClick_(e){let n=new ps(Be.CLICK,this.map_,e);this.dispatchEvent(n),this.clickTimeoutId_!==void 0?(clearTimeout(this.clickTimeoutId_),this.clickTimeoutId_=void 0,n=new ps(Be.DBLCLICK,this.map_,e),this.dispatchEvent(n)):this.clickTimeoutId_=setTimeout(()=>{this.clickTimeoutId_=void 0;const r=new ps(Be.SINGLECLICK,this.map_,e);this.dispatchEvent(r)},250)}updateActivePointers_(e){const n=e,r=n.pointerId;if(n.type==Be.POINTERUP||n.type==Be.POINTERCANCEL){delete this.trackedTouches_[r];for(const i in this.trackedTouches_)if(this.trackedTouches_[i].target!==n.target){delete this.trackedTouches_[i];break}}else(n.type==Be.POINTERDOWN||n.type==Be.POINTERMOVE)&&(this.trackedTouches_[r]=n);this.activePointers_=Object.values(this.trackedTouches_)}handlePointerUp_(e){this.updateActivePointers_(e);const n=new ps(Be.POINTERUP,this.map_,e,void 0,void 0,this.activePointers_);this.dispatchEvent(n),this.emulateClicks_&&!n.defaultPrevented&&!this.dragging_&&this.isMouseActionButton_(e)&&this.emulateClick_(this.down_),this.activePointers_.length===0&&(this.dragListenerKeys_.forEach(it),this.dragListenerKeys_.length=0,this.dragging_=!1,this.down_=null)}isMouseActionButton_(e){return e.button===0}handlePointerDown_(e){this.emulateClicks_=this.activePointers_.length===0,this.updateActivePointers_(e);const n=new ps(Be.POINTERDOWN,this.map_,e,void 0,void 0,this.activePointers_);if(this.dispatchEvent(n),this.down_=new PointerEvent(e.type,e),Object.defineProperty(this.down_,"target",{writable:!1,value:e.target}),this.dragListenerKeys_.length===0){const r=this.map_.getOwnerDocument();this.dragListenerKeys_.push(Oe(r,Be.POINTERMOVE,this.handlePointerMove_,this),Oe(r,Be.POINTERUP,this.handlePointerUp_,this),Oe(this.element_,Be.POINTERCANCEL,this.handlePointerUp_,this)),this.element_.getRootNode&&this.element_.getRootNode()!==r&&this.dragListenerKeys_.push(Oe(this.element_.getRootNode(),Be.POINTERUP,this.handlePointerUp_,this))}}handlePointerMove_(e){if(this.isMoving_(e)){this.updateActivePointers_(e),this.dragging_=!0;const n=new ps(Be.POINTERDRAG,this.map_,e,this.dragging_,void 0,this.activePointers_);this.dispatchEvent(n)}}relayMoveEvent_(e){this.originalPointerMoveEvent_=e;const n=!!(this.down_&&this.isMoving_(e));this.dispatchEvent(new ps(Be.POINTERMOVE,this.map_,e,n))}handleTouchMove_(e){const n=this.originalPointerMoveEvent_;(!n||n.defaultPrevented)&&(typeof e.cancelable!="boolean"||e.cancelable===!0)&&e.preventDefault()}isMoving_(e){return this.dragging_||Math.abs(e.clientX-this.down_.clientX)>this.moveTolerance_||Math.abs(e.clientY-this.down_.clientY)>this.moveTolerance_}disposeInternal(){this.relayedListenerKey_&&(it(this.relayedListenerKey_),this.relayedListenerKey_=null),this.element_.removeEventListener(Se.TOUCHMOVE,this.boundHandleTouchMove_),this.pointerdownListenerKey_&&(it(this.pointerdownListenerKey_),this.pointerdownListenerKey_=null),this.dragListenerKeys_.forEach(it),this.dragListenerKeys_.length=0,this.element_=null,super.disposeInternal()}}const ms={POSTRENDER:"postrender",MOVESTART:"movestart",MOVEEND:"moveend",LOADSTART:"loadstart",LOADEND:"loadend"},on={LAYERGROUP:"layergroup",SIZE:"size",TARGET:"target",VIEW:"view"},ue={IDLE:0,LOADING:1,LOADED:2,ERROR:3,EMPTY:4},$p=1/0;class $4{constructor(e,n){this.priorityFunction_=e,this.keyFunction_=n,this.elements_=[],this.priorities_=[],this.queuedElements_={}}clear(){this.elements_.length=0,this.priorities_.length=0,Qa(this.queuedElements_)}dequeue(){const e=this.elements_,n=this.priorities_,r=e[0];e.length==1?(e.length=0,n.length=0):(e[0]=e.pop(),n[0]=n.pop(),this.siftUp_(0));const i=this.keyFunction_(r);return delete this.queuedElements_[i],r}enqueue(e){ze(!(this.keyFunction_(e)in this.queuedElements_),"Tried to enqueue an `element` that was already added to the queue");const n=this.priorityFunction_(e);return n!=$p?(this.elements_.push(e),this.priorities_.push(n),this.queuedElements_[this.keyFunction_(e)]=!0,this.siftDown_(0,this.elements_.length-1),!0):!1}getCount(){return this.elements_.length}getLeftChildIndex_(e){return e*2+1}getRightChildIndex_(e){return e*2+2}getParentIndex_(e){return e-1>>1}heapify_(){let e;for(e=(this.elements_.length>>1)-1;e>=0;e--)this.siftUp_(e)}isEmpty(){return this.elements_.length===0}isKeyQueued(e){return e in this.queuedElements_}isQueued(e){return this.isKeyQueued(this.keyFunction_(e))}siftUp_(e){const n=this.elements_,r=this.priorities_,i=n.length,s=n[e],o=r[e],a=e;for(;e<i>>1;){const l=this.getLeftChildIndex_(e),c=this.getRightChildIndex_(e),u=c<i&&r[c]<r[l]?c:l;n[e]=n[u],r[e]=r[u],e=u}n[e]=s,r[e]=o,this.siftDown_(a,e)}siftDown_(e,n){const r=this.elements_,i=this.priorities_,s=r[n],o=i[n];for(;n>e;){const a=this.getParentIndex_(n);if(i[a]>o)r[n]=r[a],i[n]=i[a],n=a;else break}r[n]=s,i[n]=o}reprioritize(){const e=this.priorityFunction_,n=this.elements_,r=this.priorities_;let i=0;const s=n.length;let o,a,l;for(a=0;a<s;++a)o=n[a],l=e(o),l==$p?delete this.queuedElements_[this.keyFunction_(o)]:(r[i]=l,n[i++]=o);n.length=i,r.length=i,this.heapify_()}}class L4 extends $4{constructor(e,n){super(r=>e.apply(null,r),r=>r[0].getKey()),this.boundHandleTileChange_=this.handleTileChange.bind(this),this.tileChangeCallback_=n,this.tilesLoading_=0,this.tilesLoadingKeys_={}}enqueue(e){const n=super.enqueue(e);return n&&e[0].addEventListener(Se.CHANGE,this.boundHandleTileChange_),n}getTilesLoading(){return this.tilesLoading_}handleTileChange(e){const n=e.target,r=n.getState();if(r===ue.LOADED||r===ue.ERROR||r===ue.EMPTY){r!==ue.ERROR&&n.removeEventListener(Se.CHANGE,this.boundHandleTileChange_);const i=n.getKey();i in this.tilesLoadingKeys_&&(delete this.tilesLoadingKeys_[i],--this.tilesLoading_),this.tileChangeCallback_()}}loadMoreTiles(e,n){let r=0;for(;this.tilesLoading_<e&&r<n&&this.getCount()>0;){const i=this.dequeue()[0],s=i.getKey();i.getState()===ue.IDLE&&!(s in this.tilesLoadingKeys_)&&(this.tilesLoadingKeys_[s]=!0,++this.tilesLoading_,++r,i.load())}}}function k4(t,e,n,r,i){if(!t||!(n in t.wantedTiles)||!t.wantedTiles[n][e.getKey()])return $p;const s=t.viewState.center,o=r[0]-s[0],a=r[1]-s[1];return 65536*Math.log(i)+Math.sqrt(o*o+a*a)/i}const gt={ANIMATING:0,INTERACTING:1},ri={CENTER:"center",RESOLUTION:"resolution",ROTATION:"rotation"};function vT(t,e,n){return function(r,i,s,o,a){if(!r)return;if(!i&&!e)return r;const l=e?0:s[0]*i,c=e?0:s[1]*i,u=a?a[0]:0,d=a?a[1]:0;let h=t[0]+l/2+u,f=t[2]-l/2+u,p=t[1]+c/2+d,m=t[3]-c/2+d;h>f&&(h=(f+h)/2,f=h),p>m&&(p=(m+p)/2,m=p);let _=ct(r[0],h,f),g=ct(r[1],p,m);if(o&&n&&i){const y=30*i;_+=-y*Math.log(1+Math.max(0,h-r[0])/y)+y*Math.log(1+Math.max(0,r[0]-f)/y),g+=-y*Math.log(1+Math.max(0,p-r[1])/y)+y*Math.log(1+Math.max(0,r[1]-m)/y)}return[_,g]}}function M4(t){return t}const ln={UNKNOWN:0,INTERSECTING:1,ABOVE:2,RIGHT:4,BELOW:8,LEFT:16};function _n(t){const e=Mn();for(let n=0,r=t.length;n<r;++n)Ed(e,t[n]);return e}function D4(t,e,n){const r=Math.min.apply(null,t),i=Math.min.apply(null,e),s=Math.max.apply(null,t),o=Math.max.apply(null,e);return Zi(r,i,s,o,n)}function wr(t,e,n){return n?(n[0]=t[0]-e,n[1]=t[1]-e,n[2]=t[2]+e,n[3]=t[3]+e,n):[t[0]-e,t[1]-e,t[2]+e,t[3]+e]}function mO(t,e){return e?(e[0]=t[0],e[1]=t[1],e[2]=t[2],e[3]=t[3],e):t.slice()}function el(t,e,n){let r,i;return e<t[0]?r=t[0]-e:t[2]<e?r=e-t[2]:r=0,n<t[1]?i=t[1]-n:t[3]<n?i=n-t[3]:i=0,r*r+i*i}function za(t,e){return x1(t,e[0],e[1])}function ji(t,e){return t[0]<=e[0]&&e[2]<=t[2]&&t[1]<=e[1]&&e[3]<=t[3]}function x1(t,e,n){return t[0]<=e&&e<=t[2]&&t[1]<=n&&n<=t[3]}function uw(t,e){const n=t[0],r=t[1],i=t[2],s=t[3],o=e[0],a=e[1];let l=ln.UNKNOWN;return o<n?l=l|ln.LEFT:o>i&&(l=l|ln.RIGHT),a<r?l=l|ln.BELOW:a>s&&(l=l|ln.ABOVE),l===ln.UNKNOWN&&(l=ln.INTERSECTING),l}function Mn(){return[1/0,1/0,-1/0,-1/0]}function Zi(t,e,n,r,i){return i?(i[0]=t,i[1]=e,i[2]=n,i[3]=r,i):[t,e,n,r]}function su(t){return Zi(1/0,1/0,-1/0,-1/0,t)}function gc(t,e){const n=t[0],r=t[1];return Zi(n,r,n,r,e)}function E1(t,e,n,r,i){const s=su(i);return _O(s,t,e,n,r)}function Bo(t,e){return t[0]==e[0]&&t[2]==e[2]&&t[1]==e[1]&&t[3]==e[3]}function yO(t,e){return e[0]<t[0]&&(t[0]=e[0]),e[2]>t[2]&&(t[2]=e[2]),e[1]<t[1]&&(t[1]=e[1]),e[3]>t[3]&&(t[3]=e[3]),t}function Ed(t,e){e[0]<t[0]&&(t[0]=e[0]),e[0]>t[2]&&(t[2]=e[0]),e[1]<t[1]&&(t[1]=e[1]),e[1]>t[3]&&(t[3]=e[1])}function _O(t,e,n,r,i){for(;n<r;n+=i)N4(t,e[n],e[n+1]);return t}function N4(t,e,n){t[0]=Math.min(t[0],e),t[1]=Math.min(t[1],n),t[2]=Math.max(t[2],e),t[3]=Math.max(t[3],n)}function S1(t,e){let n;return n=e(Zm(t)),n||(n=e(qm(t)),n)||(n=e(Jm(t)),n)||(n=e(qo(t)),n)?n:!1}function dw(t){let e=0;return tl(t)||(e=Me(t)*Gt(t)),e}function Zm(t){return[t[0],t[1]]}function qm(t){return[t[2],t[1]]}function Er(t){return[(t[0]+t[2])/2,(t[1]+t[3])/2]}function j4(t,e){let n;if(e==="bottom-left")n=Zm(t);else if(e==="bottom-right")n=qm(t);else if(e==="top-left")n=qo(t);else if(e==="top-right")n=Jm(t);else throw new Error("Invalid corner");return n}function ah(t,e,n,r,i){const[s,o,a,l,c,u,d,h]=vO(t,e,n,r);return Zi(Math.min(s,a,c,d),Math.min(o,l,u,h),Math.max(s,a,c,d),Math.max(o,l,u,h),i)}function vO(t,e,n,r){const i=e*r[0]/2,s=e*r[1]/2,o=Math.cos(n),a=Math.sin(n),l=i*o,c=i*a,u=s*o,d=s*a,h=t[0],f=t[1];return[h-l+d,f-c-u,h-l-d,f-c+u,h+l-d,f+c+u,h+l+d,f+c-u,h-l+d,f-c-u]}function Gt(t){return t[3]-t[1]}function _i(t,e,n){const r=n||Mn();return Lt(t,e)?(t[0]>e[0]?r[0]=t[0]:r[0]=e[0],t[1]>e[1]?r[1]=t[1]:r[1]=e[1],t[2]<e[2]?r[2]=t[2]:r[2]=e[2],t[3]<e[3]?r[3]=t[3]:r[3]=e[3]):su(r),r}function qo(t){return[t[0],t[3]]}function Jm(t){return[t[2],t[3]]}function Me(t){return t[2]-t[0]}function Lt(t,e){return t[0]<=e[2]&&t[2]>=e[0]&&t[1]<=e[3]&&t[3]>=e[1]}function tl(t){return t[2]<t[0]||t[3]<t[1]}function z4(t,e){return e?(e[0]=t[0],e[1]=t[1],e[2]=t[2],e[3]=t[3],e):t}function U4(t,e,n){let r=!1;const i=uw(t,e),s=uw(t,n);if(i===ln.INTERSECTING||s===ln.INTERSECTING)r=!0;else{const o=t[0],a=t[1],l=t[2],c=t[3],u=e[0],d=e[1],h=n[0],f=n[1],p=(f-d)/(h-u);let m,_;s&ln.ABOVE&&!(i&ln.ABOVE)&&(m=h-(f-c)/p,r=m>=o&&m<=l),!r&&s&ln.RIGHT&&!(i&ln.RIGHT)&&(_=f-(h-l)*p,r=_>=a&&_<=c),!r&&s&ln.BELOW&&!(i&ln.BELOW)&&(m=h-(f-a)/p,r=m>=o&&m<=l),!r&&s&ln.LEFT&&!(i&ln.LEFT)&&(_=f-(h-o)*p,r=_>=a&&_<=c)}return r}function G4(t,e,n,r){if(tl(t))return su(n);let i=[];if(r>1){const a=t[2]-t[0],l=t[3]-t[1];for(let c=0;c<r;++c)i.push(t[0]+a*c/r,t[1],t[2],t[1]+l*c/r,t[2]-a*c/r,t[3],t[0],t[3]-l*c/r)}else i=[t[0],t[1],t[2],t[1],t[2],t[3],t[0],t[3]];e(i,i,2);const s=[],o=[];for(let a=0,l=i.length;a<l;a+=2)s.push(i[a]),o.push(i[a+1]);return D4(s,o,n)}function wO(t,e){const n=e.getExtent(),r=Er(t);if(e.canWrapX()&&(r[0]<n[0]||r[0]>=n[2])){const i=Me(n),o=Math.floor((r[0]-n[0])/i)*i;t[0]-=o,t[2]-=o}return t}function xO(t,e,n){if(e.canWrapX()){const r=e.getExtent();if(!isFinite(t[0])||!isFinite(t[2]))return[[r[0],t[1],r[2],t[3]]];wO(t,e);const i=Me(r);if(Me(t)>i&&!n)return[[r[0],t[1],r[2],t[3]]];if(t[0]<r[0])return[[t[0]+i,t[1],r[2],t[3]],[r[0],t[1],t[2],t[3]]];if(t[2]>r[2])return[[t[0],t[1],r[2],t[3]],[r[0],t[1],t[2]-i,t[3]]]}return[t]}function Gu(t,e,n){const r=""+t;let i=r.indexOf(".");return i=i===-1?r.length:i,i>e?r:new Array(1+e-i).join("0")+r}function b1(t,e){const n=(""+t).split("."),r=(""+e).split(".");for(let i=0;i<Math.max(n.length,r.length);i++){const s=parseInt(n[i]||"0",10),o=parseInt(r[i]||"0",10);if(s>o)return 1;if(o>s)return-1}return 0}function EO(t,e){return t[0]+=+e[0],t[1]+=+e[1],t}function C1(t,e){const n=t[0],r=t[1],i=e[0],s=e[1],o=i[0],a=i[1],l=s[0],c=s[1],u=l-o,d=c-a,h=u===0&&d===0?0:(u*(n-o)+d*(r-a))/(u*u+d*d||0);let f,p;return h<=0?(f=o,p=a):h>=1?(f=l,p=c):(f=o+h*u,p=a+h*d),[f,p]}function Nn(t,e){let n=!0;for(let r=t.length-1;r>=0;--r)if(t[r]!=e[r]){n=!1;break}return n}function T1(t,e){const n=Math.cos(e),r=Math.sin(e),i=t[0]*n-t[1]*r,s=t[1]*n+t[0]*r;return t[0]=i,t[1]=s,t}function SO(t,e){return t[0]*=e,t[1]*=e,t}function Dc(t,e){const n=t[0]-e[0],r=t[1]-e[1];return n*n+r*r}function ec(t,e){return Math.sqrt(Dc(t,e))}function B4(t,e){return Dc(t,C1(t,e))}function P1(t,e){if(e.canWrapX()){const n=Me(e.getExtent()),r=bO(t,e,n);r&&(t[0]-=r*n)}return t}function bO(t,e,n){const r=e.getExtent();let i=0;return e.canWrapX()&&(t[0]<r[0]||t[0]>r[2])&&(n=n||Me(r),i=Math.floor((t[0]-r[0])/n)),i}function CO(t){return Math.pow(t,3)}function ou(t){return 1-CO(1-t)}function V4(t){return 3*t*t-2*t*t*t}function W4(t){return t}const R1=63710088e-1;function wT(t,e,n){n=n||R1;const r=or(t[1]),i=or(e[1]),s=(i-r)/2,o=or(e[0]-t[0])/2,a=Math.sin(s)*Math.sin(s)+Math.sin(o)*Math.sin(o)*Math.cos(r)*Math.cos(i);return 2*n*Math.atan2(Math.sqrt(a),Math.sqrt(1-a))}function Af(t,e){let n=0;const r=t.length;let i=t[r-1][0],s=t[r-1][1];for(let o=0;o<r;o++){const a=t[o][0],l=t[o][1];n+=or(a-i)*(2+Math.sin(or(s))+Math.sin(or(l))),i=a,s=l}return n*e*e/2}function hw(t,e){e=e||{};const n=e.radius||R1,r=e.projection||"EPSG:3857",i=t.getType();i!=="GeometryCollection"&&(t=t.clone().transform(r,"EPSG:4326"));let s=0,o,a,l,c,u,d;switch(i){case"Point":case"MultiPoint":case"LineString":case"MultiLineString":case"LinearRing":break;case"Polygon":{for(o=t.getCoordinates(),s=Math.abs(Af(o[0],n)),l=1,c=o.length;l<c;++l)s-=Math.abs(Af(o[l],n));break}case"MultiPolygon":{for(o=t.getCoordinates(),l=0,c=o.length;l<c;++l)for(a=o[l],s+=Math.abs(Af(a[0],n)),u=1,d=a.length;u<d;++u)s-=Math.abs(Af(a[u],n));break}case"GeometryCollection":{const h=t.getGeometries();for(l=0,c=h.length;l<c;++l)s+=hw(h[l],e);break}default:throw new Error("Unsupported geometry type: "+i)}return s}function H4(t,e,n,r){r=r||R1;const i=or(t[1]),s=or(t[0]),o=e/r,a=Math.asin(Math.sin(i)*Math.cos(o)+Math.cos(i)*Math.sin(o)*Math.cos(n)),l=s+Math.atan2(Math.sin(n)*Math.sin(o)*Math.cos(i),Math.cos(o)-Math.sin(i)*Math.sin(a));return[Rp(l),Rp(a)]}function TO(...t){console.warn(...t)}const Nc={radians:6370997/(2*Math.PI),degrees:2*Math.PI*6370997/360,ft:.3048,m:1,"us-ft":1200/3937};class Qm{constructor(e){this.code_=e.code,this.units_=e.units,this.extent_=e.extent!==void 0?e.extent:null,this.worldExtent_=e.worldExtent!==void 0?e.worldExtent:null,this.axisOrientation_=e.axisOrientation!==void 0?e.axisOrientation:"enu",this.global_=e.global!==void 0?e.global:!1,this.canWrapX_=!!(this.global_&&this.extent_),this.getPointResolutionFunc_=e.getPointResolution,this.defaultTileGrid_=null,this.metersPerUnit_=e.metersPerUnit}canWrapX(){return this.canWrapX_}getCode(){return this.code_}getExtent(){return this.extent_}getUnits(){return this.units_}getMetersPerUnit(){return this.metersPerUnit_||Nc[this.units_]}getWorldExtent(){return this.worldExtent_}getAxisOrientation(){return this.axisOrientation_}isGlobal(){return this.global_}setGlobal(e){this.global_=e,this.canWrapX_=!!(e&&this.extent_)}getDefaultTileGrid(){return this.defaultTileGrid_}setDefaultTileGrid(e){this.defaultTileGrid_=e}setExtent(e){this.extent_=e,this.canWrapX_=!!(this.global_&&e)}setWorldExtent(e){this.worldExtent_=e}setGetPointResolution(e){this.getPointResolutionFunc_=e}getPointResolutionFunc(){return this.getPointResolutionFunc_}}const Nh=6378137,tc=Math.PI*Nh,K4=[-tc,-tc,tc,tc],Y4=[-180,-85,180,85],Ff=Nh*Math.log(Math.tan(Math.PI/2));class wl extends Qm{constructor(e){super({code:e,units:"m",extent:K4,global:!0,worldExtent:Y4,getPointResolution:function(n,r){return n/Math.cosh(r[1]/Nh)}})}}const xT=[new wl("EPSG:3857"),new wl("EPSG:102100"),new wl("EPSG:102113"),new wl("EPSG:900913"),new wl("http://www.opengis.net/def/crs/EPSG/0/3857"),new wl("http://www.opengis.net/gml/srs/epsg.xml#3857")];function X4(t,e,n,r){const i=t.length;n=n>1?n:2,r=r??n,e===void 0&&(n>2?e=t.slice():e=new Array(i));for(let s=0;s<i;s+=r){e[s]=tc*t[s]/180;let o=Nh*Math.log(Math.tan(Math.PI*(+t[s+1]+90)/360));o>Ff?o=Ff:o<-Ff&&(o=-Ff),e[s+1]=o}return e}function Z4(t,e,n,r){const i=t.length;n=n>1?n:2,r=r??n,e===void 0&&(n>2?e=t.slice():e=new Array(i));for(let s=0;s<i;s+=r)e[s]=180*t[s]/tc,e[s+1]=360*Math.atan(Math.exp(t[s+1]/Nh))/Math.PI-90;return e}const q4=6378137,ET=[-180,-90,180,90],J4=Math.PI*q4/180;class oa extends Qm{constructor(e,n){super({code:e,units:"degrees",extent:ET,axisOrientation:n,global:!0,metersPerUnit:J4,worldExtent:ET})}}const ST=[new oa("CRS:84"),new oa("EPSG:4326","neu"),new oa("urn:ogc:def:crs:OGC:1.3:CRS84"),new oa("urn:ogc:def:crs:OGC:2:84"),new oa("http://www.opengis.net/def/crs/OGC/1.3/CRS84"),new oa("http://www.opengis.net/gml/srs/epsg.xml#4326","neu"),new oa("http://www.opengis.net/def/crs/EPSG/0/4326","neu")];let fw={};function Q4(t){return fw[t]||fw[t.replace(/urn:(x-)?ogc:def:crs:EPSG:(.*:)?(\w+)$/,"EPSG:$3")]||null}function ez(t,e){fw[t]=e}let pc={};function Ua(t,e,n){const r=t.getCode(),i=e.getCode();r in pc||(pc[r]={}),pc[r][i]=n}function e0(t,e){return t in pc&&e in pc[t]?pc[t][e]:null}const Lp=.9996,Vr=.00669438,ey=Vr*Vr,ty=ey*Vr,Ca=Vr/(1-Vr),bT=Math.sqrt(1-Vr),jc=(1-bT)/(1+bT),PO=jc*jc,I1=PO*jc,A1=I1*jc,RO=A1*jc,IO=1-Vr/4-3*ey/64-5*ty/256,tz=3*Vr/8+3*ey/32+45*ty/1024,nz=15*ey/256+45*ty/1024,rz=35*ty/3072,iz=3/2*jc-27/32*I1+269/512*RO,sz=21/16*PO-55/32*A1,oz=151/96*I1-417/128*RO,az=1097/512*A1,kp=6378137;function lz(t,e,n){const r=t-5e5,o=(n.north?e:e-1e7)/Lp/(kp*IO),a=o+iz*Math.sin(2*o)+sz*Math.sin(4*o)+oz*Math.sin(6*o)+az*Math.sin(8*o),l=Math.sin(a),c=l*l,u=Math.cos(a),d=l/u,h=d*d,f=h*h,p=1-Vr*c,m=Math.sqrt(1-Vr*c),_=kp/m,g=(1-Vr)/p,y=Ca*u**2,v=y*y,w=r/(_*Lp),x=w*w,S=x*w,C=S*w,T=C*w,P=T*w,F=a-d/g*(x/2-C/24*(5+3*h+10*y-4*v-9*Ca))+P/720*(61+90*h+298*y+45*f-252*Ca-3*v);let k=(w-S/6*(1+2*h+y)+T/120*(5-2*y+28*h-3*v+8*Ca+24*f))/u;return k=iw(k+or(AO(n.number)),-Math.PI,Math.PI),[Rp(k),Rp(F)]}const CT=-80,TT=84,cz=-180,uz=180;function dz(t,e,n){t=iw(t,cz,uz),e<CT?e=CT:e>TT&&(e=TT);const r=or(e),i=Math.sin(r),s=Math.cos(r),o=i/s,a=o*o,l=a*a,c=or(t),u=AO(n.number),d=or(u),h=kp/Math.sqrt(1-Vr*i**2),f=Ca*s**2,p=s*iw(c-d,-Math.PI,Math.PI),m=p*p,_=m*p,g=_*p,y=g*p,v=y*p,w=kp*(IO*r-tz*Math.sin(2*r)+nz*Math.sin(4*r)-rz*Math.sin(6*r)),x=Lp*h*(p+_/6*(1-a+f)+y/120*(5-18*a+l+72*f-58*Ca))+5e5;let S=Lp*(w+h*o*(m/2+g/24*(5-a+9*f+4*f**2)+v/720*(61-58*a+l+600*f-330*Ca)));return n.north||(S+=1e7),[x,S]}function AO(t){return(t-1)*6-180+3}const hz=[/^EPSG:(\d+)$/,/^urn:ogc:def:crs:EPSG::(\d+)$/,/^http:\/\/www\.opengis\.net\/def\/crs\/EPSG\/0\/(\d+)$/];function FO(t){let e=0;for(const i of hz){const s=t.match(i);if(s){e=parseInt(s[1]);break}}if(!e)return null;let n=0,r=!1;return e>32700&&e<32761?n=e-32700:e>32600&&e<32661&&(r=!0,n=e-32600),n?{number:n,north:r}:null}function PT(t,e){return function(n,r,i,s){const o=n.length;i=i>1?i:2,s=s??i,r||(i>2?r=n.slice():r=new Array(o));for(let a=0;a<o;a+=s){const l=n[a],c=n[a+1],u=t(l,c,e);r[a]=u[0],r[a+1]=u[1]}return r}}function fz(t){return FO(t)?new Qm({code:t,units:"m"}):null}function gz(t){const e=FO(t.getCode());return e?{forward:PT(dz,e),inverse:PT(lz,e)}:null}const pz=[gz],mz=[fz];let gw=!0;function OO(t){gw=!1}function F1(t,e){if(e!==void 0){for(let n=0,r=t.length;n<r;++n)e[n]=t[n];e=e}else e=t.slice();return e}function pw(t){ez(t.getCode(),t),Ua(t,t,F1)}function yz(t){t.forEach(pw)}function Ne(t){if(typeof t!="string")return t;const e=Q4(t);if(e)return e;for(const n of mz){const r=n(t);if(r)return r}return null}function Mp(t,e,n,r){t=Ne(t);let i;const s=t.getPointResolutionFunc();if(s){if(i=s(e,n),r&&r!==t.getUnits()){const o=t.getMetersPerUnit();o&&(i=i*o/Nc[r])}}else{const o=t.getUnits();if(o=="degrees"&&!r||r=="degrees")i=e;else{const a=ny(t,Ne("EPSG:4326"));if(!a&&o!=="degrees")i=e*t.getMetersPerUnit();else{let c=[n[0]-e/2,n[1],n[0]+e/2,n[1],n[0],n[1]-e/2,n[0],n[1]+e/2];c=a(c,c,2);const u=wT(c.slice(0,2),c.slice(2,4)),d=wT(c.slice(4,6),c.slice(6,8));i=(u+d)/2}const l=r?Nc[r]:t.getMetersPerUnit();l!==void 0&&(i/=l)}}return i}function RT(t){yz(t),t.forEach(function(e){t.forEach(function(n){e!==n&&Ua(e,n,F1)})})}function _z(t,e,n,r){t.forEach(function(i){e.forEach(function(s){Ua(i,s,n),Ua(s,i,r)})})}function O1(t,e){return t?typeof t=="string"?Ne(t):t:Ne(e)}function mw(t){return function(e,n,r,i){const s=e.length;r=r!==void 0?r:2,i=i??r,n=n!==void 0?n:new Array(s);for(let o=0;o<s;o+=i){const a=t(e.slice(o,o+r)),l=a.length;for(let c=0,u=i;c<u;++c)n[o+c]=c>=l?e[o+c]:a[c]}return n}}function AEe(t,e,n,r){const i=Ne(t),s=Ne(e);Ua(i,s,mw(n)),Ua(s,i,mw(r))}function IT(t,e){return OO(),nl(t,"EPSG:4326","EPSG:3857")}function $1(t,e){const n=nl(t,"EPSG:3857","EPSG:4326"),r=n[0];return(r<-180||r>180)&&(n[0]=Ps(r+180,360)-180),n}function Gn(t,e){if(t===e)return!0;const n=t.getUnits()===e.getUnits();return(t.getCode()===e.getCode()||ny(t,e)===F1)&&n}function ny(t,e){const n=t.getCode(),r=e.getCode();let i=e0(n,r);if(i)return i;let s=null,o=null;for(const l of pz)s||(s=l(t)),o||(o=l(e));if(!s&&!o)return null;const a="EPSG:4326";if(o)if(s)i=t0(s.inverse,o.forward);else{const l=e0(n,a);l&&(i=t0(l,o.forward))}else{const l=e0(a,r);l&&(i=t0(s.inverse,l))}return i&&(pw(t),pw(e),Ua(t,e,i)),i}function t0(t,e){return function(n,r,i,s){return r=t(n,r,i,s),e(r,r,i,s)}}function qi(t,e){const n=Ne(t),r=Ne(e);return ny(n,r)}function nl(t,e,n){const r=qi(e,n);if(!r){const i=Ne(e).getCode(),s=Ne(n).getCode();throw new Error(`No transform available between ${i} and ${s}`)}return r(t,void 0,t.length)}function Sd(t,e,n,r){const i=qi(e,n);return G4(t,i,void 0,r)}let vz=null;function wz(){return vz}function Ga(t,e){return t}function Ot(t,e){return gw&&!Nn(t,[0,0])&&t[0]>=-180&&t[0]<=180&&t[1]>=-90&&t[1]<=90&&(gw=!1,TO("Call useGeographic() from ol/proj once to work with [longitude, latitude] coordinates.")),t}function ry(t,e){return t}function fi(t,e){return t}function FEe(t,e,n){return function(r){let i,s;if(t.canWrapX()){const o=t.getExtent(),a=Me(o);r=r.slice(0),s=bO(r,t,a),s&&(r[0]=r[0]-s*a),r[0]=ct(r[0],o[0],o[2]),r[1]=ct(r[1],o[1],o[3]),i=n(r)}else i=n(r);return s&&e.canWrapX()&&(i[0]+=s*Me(e.getExtent())),i}}function xz(){RT(xT),RT(ST),_z(ST,xT,X4,Z4)}xz();const $O=new Array(6);function Bt(){return[1,0,0,1,0,0]}function AT(t){return L1(t,1,0,0,1,0,0)}function iy(t,e){const n=t[0],r=t[1],i=t[2],s=t[3],o=t[4],a=t[5],l=e[0],c=e[1],u=e[2],d=e[3],h=e[4],f=e[5];return t[0]=n*l+i*c,t[1]=r*l+s*c,t[2]=n*u+i*d,t[3]=r*u+s*d,t[4]=n*h+i*f+o,t[5]=r*h+s*f+a,t}function L1(t,e,n,r,i,s,o){return t[0]=e,t[1]=n,t[2]=r,t[3]=i,t[4]=s,t[5]=o,t}function LO(t,e){return t[0]=e[0],t[1]=e[1],t[2]=e[2],t[3]=e[3],t[4]=e[4],t[5]=e[5],t}function $t(t,e){const n=e[0],r=e[1];return e[0]=t[0]*n+t[2]*r+t[4],e[1]=t[1]*n+t[3]*r+t[5],e}function kg(t,e,n){return iy(t,L1($O,e,0,0,n,0,0))}function kO(t,e,n){return iy(t,L1($O,1,0,0,1,e,n))}function Xr(t,e,n,r,i,s,o,a){const l=Math.sin(s),c=Math.cos(s);return t[0]=r*c,t[1]=i*l,t[2]=-r*l,t[3]=i*c,t[4]=o*r*c-a*r*l+e,t[5]=o*i*l+a*i*c+n,t}function lh(t,e){const n=Ez(e);ze(n!==0,"Transformation matrix cannot be inverted");const r=e[0],i=e[1],s=e[2],o=e[3],a=e[4],l=e[5];return t[0]=o/n,t[1]=-i/n,t[2]=-s/n,t[3]=r/n,t[4]=(s*l-o*a)/n,t[5]=-(r*l-i*a)/n,t}function Ez(t){return t[0]*t[3]-t[1]*t[2]}const Sz=[1e5,1e5,1e5,1e5,2,2];function bz(t){return"matrix("+t.join(", ")+")"}function yw(t){return t.substring(7,t.length-1).split(",").map(parseFloat)}function Cz(t,e){const n=yw(t),r=yw(e);for(let i=0;i<6;++i)if(Math.round((n[i]-r[i])*Sz[i])!==0)return!1;return!0}function Ki(t,e,n,r,i,s,o){s=s||[],o=o||2;let a=0;for(let l=e;l<n;l+=r){const c=t[l],u=t[l+1];s[a++]=i[0]*c+i[2]*u+i[4],s[a++]=i[1]*c+i[3]*u+i[5];for(let d=2;d<o;d++)s[a++]=t[l+d]}return s&&s.length!=a&&(s.length=a),s}function k1(t,e,n,r,i,s,o){o=o||[];const a=Math.cos(i),l=Math.sin(i),c=s[0],u=s[1];let d=0;for(let h=e;h<n;h+=r){const f=t[h]-c,p=t[h+1]-u;o[d++]=c+f*a-p*l,o[d++]=u+f*l+p*a;for(let m=h+2;m<h+r;++m)o[d++]=t[m]}return o&&o.length!=d&&(o.length=d),o}function Tz(t,e,n,r,i,s,o,a){a=a||[];const l=o[0],c=o[1];let u=0;for(let d=e;d<n;d+=r){const h=t[d]-l,f=t[d+1]-c;a[u++]=l+i*h,a[u++]=c+s*f;for(let p=d+2;p<d+r;++p)a[u++]=t[p]}return a&&a.length!=u&&(a.length=u),a}function Pz(t,e,n,r,i,s,o){o=o||[];let a=0;for(let l=e;l<n;l+=r){o[a++]=t[l]+i,o[a++]=t[l+1]+s;for(let c=l+2;c<l+r;++c)o[a++]=t[c]}return o&&o.length!=a&&(o.length=a),o}const FT=Bt(),Rz=[NaN,NaN];class Dp extends bi{constructor(){super(),this.extent_=Mn(),this.extentRevision_=-1,this.simplifiedGeometryMaxMinSquaredTolerance=0,this.simplifiedGeometryRevision=0,this.simplifyTransformedInternal=oO((e,n,r)=>{if(!r)return this.getSimplifiedGeometry(n);const i=this.clone();return i.applyTransform(r),i.getSimplifiedGeometry(n)})}simplifyTransformed(e,n){return this.simplifyTransformedInternal(this.getRevision(),e,n)}clone(){return Te()}closestPointXY(e,n,r,i){return Te()}containsXY(e,n){return this.closestPointXY(e,n,Rz,Number.MIN_VALUE)===0}getClosestPoint(e,n){return n=n||[NaN,NaN],this.closestPointXY(e[0],e[1],n,1/0),n}intersectsCoordinate(e){return this.containsXY(e[0],e[1])}computeExtent(e){return Te()}getExtent(e){if(this.extentRevision_!=this.getRevision()){const n=this.computeExtent(this.extent_);(isNaN(n[0])||isNaN(n[1]))&&su(n),this.extentRevision_=this.getRevision()}return z4(this.extent_,e)}rotate(e,n){Te()}scale(e,n,r){Te()}simplify(e){return this.getSimplifiedGeometry(e*e)}getSimplifiedGeometry(e){return Te()}getType(){return Te()}applyTransform(e){Te()}intersectsExtent(e){return Te()}translate(e,n){Te()}transform(e,n){const r=Ne(e),i=r.getUnits()=="tile-pixels"?function(s,o,a){const l=r.getExtent(),c=r.getWorldExtent(),u=Gt(c)/Gt(l);Xr(FT,c[0],c[3],u,-u,0,0,0);const d=Ki(s,0,s.length,a,FT,o),h=qi(r,n);return h?h(d,d,a):d}:qi(r,n);return this.applyTransform(i),this}}class Vs extends Dp{constructor(){super(),this.layout="XY",this.stride=2,this.flatCoordinates}computeExtent(e){return E1(this.flatCoordinates,0,this.flatCoordinates.length,this.stride,e)}getCoordinates(){return Te()}getFirstCoordinate(){return this.flatCoordinates.slice(0,this.stride)}getFlatCoordinates(){return this.flatCoordinates}getLastCoordinate(){return this.flatCoordinates.slice(this.flatCoordinates.length-this.stride)}getLayout(){return this.layout}getSimplifiedGeometry(e){if(this.simplifiedGeometryRevision!==this.getRevision()&&(this.simplifiedGeometryMaxMinSquaredTolerance=0,this.simplifiedGeometryRevision=this.getRevision()),e<0||this.simplifiedGeometryMaxMinSquaredTolerance!==0&&e<=this.simplifiedGeometryMaxMinSquaredTolerance)return this;const n=this.getSimplifiedGeometryInternal(e);return n.getFlatCoordinates().length<this.flatCoordinates.length?n:(this.simplifiedGeometryMaxMinSquaredTolerance=e,this)}getSimplifiedGeometryInternal(e){return this}getStride(){return this.stride}setFlatCoordinates(e,n){this.stride=Np(e),this.layout=e,this.flatCoordinates=n}setCoordinates(e,n){Te()}setLayout(e,n,r){let i;if(e)i=Np(e);else{for(let s=0;s<r;++s){if(n.length===0){this.layout="XY",this.stride=2;return}n=n[0]}i=n.length,e=rl(i)}this.layout=e,this.stride=i}applyTransform(e){this.flatCoordinates&&(e(this.flatCoordinates,this.flatCoordinates,this.layout.startsWith("XYZ")?3:2,this.stride),this.changed())}rotate(e,n){const r=this.getFlatCoordinates();if(r){const i=this.getStride();k1(r,0,r.length,i,e,n,r),this.changed()}}scale(e,n,r){n===void 0&&(n=e),r||(r=Er(this.getExtent()));const i=this.getFlatCoordinates();if(i){const s=this.getStride();Tz(i,0,i.length,s,e,n,r,i),this.changed()}}translate(e,n){const r=this.getFlatCoordinates();if(r){const i=this.getStride();Pz(r,0,r.length,i,e,n,r),this.changed()}}}function rl(t){let e;return t==2?e="XY":t==3?e="XYZ":t==4&&(e="XYZM"),e}function Np(t){let e;return t=="XY"?e=2:t=="XYZ"||t=="XYM"?e=3:t=="XYZM"&&(e=4),e}function Iz(t,e,n){const r=t.getFlatCoordinates();if(!r)return null;const i=t.getStride();return Ki(r,0,r.length,i,e,n)}function MO(t,e,n,r){let i=0;const s=t[n-r],o=t[n-r+1];let a=0,l=0;for(;e<n;e+=r){const c=t[e]-s,u=t[e+1]-o;i+=l*c-a*u,a=c,l=u}return i/2}function DO(t,e,n,r){let i=0;for(let s=0,o=n.length;s<o;++s){const a=n[s];i+=MO(t,e,a,r),e=a}return i}function Az(t,e,n,r){let i=0;for(let s=0,o=n.length;s<o;++s){const a=n[s];i+=DO(t,e,a,r),e=a[a.length-1]}return i}function OT(t,e,n,r,i,s,o){const a=t[e],l=t[e+1],c=t[n]-a,u=t[n+1]-l;let d;if(c===0&&u===0)d=e;else{const h=((i-a)*c+(s-l)*u)/(c*c+u*u);if(h>1)d=n;else if(h>0){for(let f=0;f<r;++f)o[f]=fr(t[e+f],t[n+f],h);o.length=r;return}else d=e}for(let h=0;h<r;++h)o[h]=t[d+h];o.length=r}function M1(t,e,n,r,i){let s=t[e],o=t[e+1];for(e+=r;e<n;e+=r){const a=t[e],l=t[e+1],c=Ts(s,o,a,l);c>i&&(i=c),s=a,o=l}return i}function D1(t,e,n,r,i){for(let s=0,o=n.length;s<o;++s){const a=n[s];i=M1(t,e,a,r,i),e=a}return i}function Fz(t,e,n,r,i){for(let s=0,o=n.length;s<o;++s){const a=n[s];i=D1(t,e,a,r,i),e=a[a.length-1]}return i}function N1(t,e,n,r,i,s,o,a,l,c,u){if(e==n)return c;let d,h;if(i===0){if(h=Ts(o,a,t[e],t[e+1]),h<c){for(d=0;d<r;++d)l[d]=t[e+d];return l.length=r,h}return c}u=u||[NaN,NaN];let f=e+r;for(;f<n;)if(OT(t,f-r,f,r,o,a,u),h=Ts(o,a,u[0],u[1]),h<c){for(c=h,d=0;d<r;++d)l[d]=u[d];l.length=r,f+=r}else f+=r*Math.max((Math.sqrt(h)-Math.sqrt(c))/i|0,1);if(s&&(OT(t,n-r,e,r,o,a,u),h=Ts(o,a,u[0],u[1]),h<c)){for(c=h,d=0;d<r;++d)l[d]=u[d];l.length=r}return c}function j1(t,e,n,r,i,s,o,a,l,c,u){u=u||[NaN,NaN];for(let d=0,h=n.length;d<h;++d){const f=n[d];c=N1(t,e,f,r,i,s,o,a,l,c,u),e=f}return c}function Oz(t,e,n,r,i,s,o,a,l,c,u){u=u||[NaN,NaN];for(let d=0,h=n.length;d<h;++d){const f=n[d];c=j1(t,e,f,r,i,s,o,a,l,c,u),e=f[f.length-1]}return c}function NO(t,e,n,r){for(let i=0,s=n.length;i<s;++i)t[e++]=n[i];return e}function sy(t,e,n,r){for(let i=0,s=n.length;i<s;++i){const o=n[i];for(let a=0;a<r;++a)t[e++]=o[a]}return e}function jh(t,e,n,r,i){i=i||[];let s=0;for(let o=0,a=n.length;o<a;++o){const l=sy(t,e,n[o],r);i[s++]=l,e=l}return i.length=s,i}function jO(t,e,n,r,i){i=i||[];let s=0;for(let o=0,a=n.length;o<a;++o){const l=jh(t,e,n[o],r,i[s]);l.length===0&&(l[0]=e),i[s++]=l,e=l[l.length-1]}return i.length=s,i}function wo(t,e,n,r,i){i=i!==void 0?i:[];let s=0;for(let o=e;o<n;o+=r)i[s++]=t.slice(o,o+r);return i.length=s,i}function ch(t,e,n,r,i){i=i!==void 0?i:[];let s=0;for(let o=0,a=n.length;o<a;++o){const l=n[o];i[s++]=wo(t,e,l,r,i[s]),e=l}return i.length=s,i}function _w(t,e,n,r,i){i=i!==void 0?i:[];let s=0;for(let o=0,a=n.length;o<a;++o){const l=n[o];i[s++]=l.length===1&&l[0]===e?[]:ch(t,e,l,r,i[s]),e=l[l.length-1]}return i.length=s,i}function oy(t,e,n,r,i,s,o){const a=(n-e)/r;if(a<3){for(;e<n;e+=r)s[o++]=t[e],s[o++]=t[e+1];return o}const l=new Array(a);l[0]=1,l[a-1]=1;const c=[e,n-r];let u=0;for(;c.length>0;){const d=c.pop(),h=c.pop();let f=0;const p=t[h],m=t[h+1],_=t[d],g=t[d+1];for(let y=h+r;y<d;y+=r){const v=t[y],w=t[y+1],x=J5(v,w,p,m,_,g);x>f&&(u=y,f=x)}f>i&&(l[(u-e)/r]=1,h+r<u&&c.push(h,u),u+r<d&&c.push(u,d))}for(let d=0;d<a;++d)l[d]&&(s[o++]=t[e+d*r],s[o++]=t[e+d*r+1]);return o}function zO(t,e,n,r,i,s,o,a){for(let l=0,c=n.length;l<c;++l){const u=n[l];o=oy(t,e,u,r,i,s,o),a.push(o),e=u}return o}function ha(t,e){return e*Math.round(t/e)}function $z(t,e,n,r,i,s,o){if(e==n)return o;let a=ha(t[e],i),l=ha(t[e+1],i);e+=r,s[o++]=a,s[o++]=l;let c,u;do if(c=ha(t[e],i),u=ha(t[e+1],i),e+=r,e==n)return s[o++]=c,s[o++]=u,o;while(c==a&&u==l);for(;e<n;){const d=ha(t[e],i),h=ha(t[e+1],i);if(e+=r,d==c&&h==u)continue;const f=c-a,p=u-l,m=d-a,_=h-l;if(f*_==p*m&&(f<0&&m<f||f==m||f>0&&m>f)&&(p<0&&_<p||p==_||p>0&&_>p)){c=d,u=h;continue}s[o++]=c,s[o++]=u,a=c,l=u,c=d,u=h}return s[o++]=c,s[o++]=u,o}function z1(t,e,n,r,i,s,o,a){for(let l=0,c=n.length;l<c;++l){const u=n[l];o=$z(t,e,u,r,i,s,o),a.push(o),e=u}return o}function Lz(t,e,n,r,i,s,o,a){for(let l=0,c=n.length;l<c;++l){const u=n[l],d=[];o=z1(t,e,u,r,i,s,o,d),a.push(d),e=u[u.length-1]}return o}class uh extends Vs{constructor(e,n){super(),this.maxDelta_=-1,this.maxDeltaRevision_=-1,n!==void 0&&!Array.isArray(e[0])?this.setFlatCoordinates(n,e):this.setCoordinates(e,n)}clone(){return new uh(this.flatCoordinates.slice(),this.layout)}closestPointXY(e,n,r,i){return i<el(this.getExtent(),e,n)?i:(this.maxDeltaRevision_!=this.getRevision()&&(this.maxDelta_=Math.sqrt(M1(this.flatCoordinates,0,this.flatCoordinates.length,this.stride,0)),this.maxDeltaRevision_=this.getRevision()),N1(this.flatCoordinates,0,this.flatCoordinates.length,this.stride,this.maxDelta_,!0,e,n,r,i))}getArea(){return MO(this.flatCoordinates,0,this.flatCoordinates.length,this.stride)}getCoordinates(){return wo(this.flatCoordinates,0,this.flatCoordinates.length,this.stride)}getSimplifiedGeometryInternal(e){const n=[];return n.length=oy(this.flatCoordinates,0,this.flatCoordinates.length,this.stride,e,n,0),new uh(n,"XY")}getType(){return"LinearRing"}intersectsExtent(e){return!1}setCoordinates(e,n){this.setLayout(n,e,1),this.flatCoordinates||(this.flatCoordinates=[]),this.flatCoordinates.length=sy(this.flatCoordinates,0,e,this.stride),this.changed()}}class Sn extends Vs{constructor(e,n){super(),this.setCoordinates(e,n)}clone(){const e=new Sn(this.flatCoordinates.slice(),this.layout);return e.applyProperties(this),e}closestPointXY(e,n,r,i){const s=this.flatCoordinates,o=Ts(e,n,s[0],s[1]);if(o<i){const a=this.stride;for(let l=0;l<a;++l)r[l]=s[l];return r.length=a,o}return i}getCoordinates(){return this.flatCoordinates.slice()}computeExtent(e){return gc(this.flatCoordinates,e)}getType(){return"Point"}intersectsExtent(e){return x1(e,this.flatCoordinates[0],this.flatCoordinates[1])}setCoordinates(e,n){this.setLayout(n,e,0),this.flatCoordinates||(this.flatCoordinates=[]),this.flatCoordinates.length=NO(this.flatCoordinates,0,e,this.stride),this.changed()}}function kz(t,e,n,r,i){return!S1(i,function(o){return!Ta(t,e,n,r,o[0],o[1])})}function Ta(t,e,n,r,i,s){let o=0,a=t[n-r],l=t[n-r+1];for(;e<n;e+=r){const c=t[e],u=t[e+1];l<=s?u>s&&(c-a)*(s-l)-(i-a)*(u-l)>0&&o++:u<=s&&(c-a)*(s-l)-(i-a)*(u-l)<0&&o--,a=c,l=u}return o!==0}function U1(t,e,n,r,i,s){if(n.length===0||!Ta(t,e,n[0],r,i,s))return!1;for(let o=1,a=n.length;o<a;++o)if(Ta(t,n[o-1],n[o],r,i,s))return!1;return!0}function Mz(t,e,n,r,i,s){if(n.length===0)return!1;for(let o=0,a=n.length;o<a;++o){const l=n[o];if(U1(t,e,l,r,i,s))return!0;e=l[l.length-1]}return!1}function G1(t,e,n,r,i,s,o){let a,l,c,u,d,h,f;const p=i[s+1],m=[];for(let y=0,v=n.length;y<v;++y){const w=n[y];for(u=t[w-r],h=t[w-r+1],a=e;a<w;a+=r)d=t[a],f=t[a+1],(p<=h&&f<=p||h<=p&&p<=f)&&(c=(p-h)/(f-h)*(d-u)+u,m.push(c)),u=d,h=f}let _=NaN,g=-1/0;for(m.sort(Hi),u=m[0],a=1,l=m.length;a<l;++a){d=m[a];const y=Math.abs(d-u);y>g&&(c=(u+d)/2,U1(t,e,n,r,c,p)&&(_=c,g=y)),u=d}return isNaN(_)&&(_=i[s]),o?(o.push(_,p,g),o):[_,p,g]}function UO(t,e,n,r,i){let s=[];for(let o=0,a=n.length;o<a;++o){const l=n[o];s=G1(t,e,l,r,i,2*o,s),e=l[l.length-1]}return s}function GO(t,e,n,r,i){let s;for(e+=r;e<n;e+=r)if(s=i(t.slice(e-r,e),t.slice(e,e+r)),s)return s;return!1}function ay(t,e,n,r,i,s){return s=s??_O(Mn(),t,e,n,r),Lt(i,s)?s[0]>=i[0]&&s[2]<=i[2]||s[1]>=i[1]&&s[3]<=i[3]?!0:GO(t,e,n,r,function(o,a){return U4(i,o,a)}):!1}function Dz(t,e,n,r,i){for(let s=0,o=n.length;s<o;++s){if(ay(t,e,n[s],r,i))return!0;e=n[s]}return!1}function BO(t,e,n,r,i){return!!(ay(t,e,n,r,i)||Ta(t,e,n,r,i[0],i[1])||Ta(t,e,n,r,i[0],i[3])||Ta(t,e,n,r,i[2],i[1])||Ta(t,e,n,r,i[2],i[3]))}function VO(t,e,n,r,i){if(!BO(t,e,n[0],r,i))return!1;if(n.length===1)return!0;for(let s=1,o=n.length;s<o;++s)if(kz(t,n[s-1],n[s],r,i)&&!ay(t,n[s-1],n[s],r,i))return!1;return!0}function Nz(t,e,n,r,i){for(let s=0,o=n.length;s<o;++s){const a=n[s];if(VO(t,e,a,r,i))return!0;e=a[a.length-1]}return!1}function jz(t,e,n,r){for(;e<n-r;){for(let i=0;i<r;++i){const s=t[e+i];t[e+i]=t[n-r+i],t[n-r+i]=s}e+=r,n-=r}}function B1(t,e,n,r){let i=0,s=t[n-r],o=t[n-r+1];for(;e<n;e+=r){const a=t[e],l=t[e+1];i+=(a-s)*(l+o),s=a,o=l}return i===0?void 0:i>0}function V1(t,e,n,r,i){i=i!==void 0?i:!1;for(let s=0,o=n.length;s<o;++s){const a=n[s],l=B1(t,e,a,r);if(s===0){if(i&&l||!i&&!l)return!1}else if(i&&!l||!i&&l)return!1;e=a}return!0}function WO(t,e,n,r,i){for(let s=0,o=n.length;s<o;++s){const a=n[s];if(!V1(t,e,a,r,i))return!1;a.length&&(e=a[a.length-1])}return!0}function jp(t,e,n,r,i){i=i!==void 0?i:!1;for(let s=0,o=n.length;s<o;++s){const a=n[s],l=B1(t,e,a,r);(s===0?i&&l||!i&&!l:i&&!l||!i&&l)&&jz(t,e,a,r),e=a}return e}function vw(t,e,n,r,i){for(let s=0,o=n.length;s<o;++s)e=jp(t,e,n[s],r,i);return e}function W1(t,e){const n=[];let r=0,i=0,s;for(let o=0,a=e.length;o<a;++o){const l=e[o],c=B1(t,r,l,2);if(s===void 0&&(s=c),c===s)n.push(e.slice(i,o+1));else{if(n.length===0)continue;n[n.length-1].push(e[i])}i=o+1,r=l}return n}class lr extends Vs{constructor(e,n,r){super(),this.ends_=[],this.flatInteriorPointRevision_=-1,this.flatInteriorPoint_=null,this.maxDelta_=-1,this.maxDeltaRevision_=-1,this.orientedRevision_=-1,this.orientedFlatCoordinates_=null,n!==void 0&&r?(this.setFlatCoordinates(n,e),this.ends_=r):this.setCoordinates(e,n)}appendLinearRing(e){this.flatCoordinates?We(this.flatCoordinates,e.getFlatCoordinates()):this.flatCoordinates=e.getFlatCoordinates().slice(),this.ends_.push(this.flatCoordinates.length),this.changed()}clone(){const e=new lr(this.flatCoordinates.slice(),this.layout,this.ends_.slice());return e.applyProperties(this),e}closestPointXY(e,n,r,i){return i<el(this.getExtent(),e,n)?i:(this.maxDeltaRevision_!=this.getRevision()&&(this.maxDelta_=Math.sqrt(D1(this.flatCoordinates,0,this.ends_,this.stride,0)),this.maxDeltaRevision_=this.getRevision()),j1(this.flatCoordinates,0,this.ends_,this.stride,this.maxDelta_,!0,e,n,r,i))}containsXY(e,n){return U1(this.getOrientedFlatCoordinates(),0,this.ends_,this.stride,e,n)}getArea(){return DO(this.getOrientedFlatCoordinates(),0,this.ends_,this.stride)}getCoordinates(e){let n;return e!==void 0?(n=this.getOrientedFlatCoordinates().slice(),jp(n,0,this.ends_,this.stride,e)):n=this.flatCoordinates,ch(n,0,this.ends_,this.stride)}getEnds(){return this.ends_}getFlatInteriorPoint(){if(this.flatInteriorPointRevision_!=this.getRevision()){const e=Er(this.getExtent());this.flatInteriorPoint_=G1(this.getOrientedFlatCoordinates(),0,this.ends_,this.stride,e,0),this.flatInteriorPointRevision_=this.getRevision()}return this.flatInteriorPoint_}getInteriorPoint(){return new Sn(this.getFlatInteriorPoint(),"XYM")}getLinearRingCount(){return this.ends_.length}getLinearRing(e){return e<0||this.ends_.length<=e?null:new uh(this.flatCoordinates.slice(e===0?0:this.ends_[e-1],this.ends_[e]),this.layout)}getLinearRings(){const e=this.layout,n=this.flatCoordinates,r=this.ends_,i=[];let s=0;for(let o=0,a=r.length;o<a;++o){const l=r[o],c=new uh(n.slice(s,l),e);i.push(c),s=l}return i}getOrientedFlatCoordinates(){if(this.orientedRevision_!=this.getRevision()){const e=this.flatCoordinates;V1(e,0,this.ends_,this.stride)?this.orientedFlatCoordinates_=e:(this.orientedFlatCoordinates_=e.slice(),this.orientedFlatCoordinates_.length=jp(this.orientedFlatCoordinates_,0,this.ends_,this.stride)),this.orientedRevision_=this.getRevision()}return this.orientedFlatCoordinates_}getSimplifiedGeometryInternal(e){const n=[],r=[];return n.length=z1(this.flatCoordinates,0,this.ends_,this.stride,Math.sqrt(e),n,0,r),new lr(n,"XY",r)}getType(){return"Polygon"}intersectsExtent(e){return VO(this.getOrientedFlatCoordinates(),0,this.ends_,this.stride,e)}setCoordinates(e,n){this.setLayout(n,e,2),this.flatCoordinates||(this.flatCoordinates=[]);const r=jh(this.flatCoordinates,0,e,this.stride,this.ends_);this.flatCoordinates.length=r.length===0?0:r[r.length-1],this.changed()}}function zz(t,e,n,r){n=n||32;const i=[];for(let s=0;s<n;++s)We(i,H4(t,e,2*Math.PI*s/n,r));return i.push(i[0],i[1]),new lr(i,"XY",[i.length])}function $T(t){if(tl(t))throw new Error("Cannot create polygon from empty extent");const e=t[0],n=t[1],r=t[2],i=t[3],s=[e,n,e,i,r,i,r,n,e,n];return new lr(s,"XY",[s.length])}function H1(t,e,n,r){const i=Me(e)/n[0],s=Gt(e)/n[1];return r?Math.min(t,Math.max(i,s)):Math.min(t,Math.min(i,s))}function K1(t,e,n){let r=Math.min(t,e);const i=50;return r*=Math.log(1+i*Math.max(0,t/e-1))/i+1,n&&(r=Math.max(r,n),r/=Math.log(1+i*Math.max(0,n/t-1))/i+1),ct(r,n/2,e*2)}function Uz(t,e,n,r){return e=e!==void 0?e:!0,function(i,s,o,a){if(i!==void 0){const l=t[0],c=t[t.length-1],u=n?H1(l,n,o,r):l;if(a)return e?K1(i,u,c):ct(i,c,u);const d=Math.min(u,i),h=Math.floor(Hm(t,d,s));return t[h]>u&&h<t.length-1?t[h+1]:t[h]}}}function Gz(t,e,n,r,i,s){return r=r!==void 0?r:!0,n=n!==void 0?n:0,function(o,a,l,c){if(o!==void 0){const u=i?H1(e,i,l,s):e;if(c)return r?K1(o,u,n):ct(o,n,u);const d=1e-9,h=Math.ceil(Math.log(e/u)/Math.log(t)-d),f=-a*(.5-d)+.5,p=Math.min(u,o),m=Math.floor(Math.log(e/p)/Math.log(t)+f),_=Math.max(h,m),g=e/Math.pow(t,_);return ct(g,n,u)}}}function LT(t,e,n,r,i){return n=n!==void 0?n:!0,function(s,o,a,l){if(s!==void 0){const c=r?H1(t,r,a,i):t;return!n||!l?ct(s,e,c):K1(s,c,e)}}}function Y1(t){if(t!==void 0)return 0}function kT(t){if(t!==void 0)return t}function Bz(t){const e=2*Math.PI/t;return function(n,r){if(r)return n;if(n!==void 0)return n=Math.floor(n/e+.5)*e,n}}function Vz(t){const e=or(5);return function(n,r){return r||n===void 0?n:Math.abs(n)<=e?0:n}}const HO=42,X1=256,n0=0;class ki extends bi{constructor(e){super(),this.on,this.once,this.un,e=Object.assign({},e),this.hints_=[0,0],this.animations_=[],this.updateAnimationKey_,this.projection_=O1(e.projection,"EPSG:3857"),this.viewportSize_=[100,100],this.targetCenter_=null,this.targetResolution_,this.targetRotation_,this.nextCenter_=null,this.nextResolution_,this.nextRotation_,this.cancelAnchor_=void 0,e.projection&&OO(),e.center&&(e.center=Ot(e.center,this.projection_)),e.extent&&(e.extent=fi(e.extent,this.projection_)),this.applyOptions_(e)}applyOptions_(e){const n=Object.assign({},e);for(const a in ri)delete n[a];this.setProperties(n,!0);const r=Hz(e);this.maxResolution_=r.maxResolution,this.minResolution_=r.minResolution,this.zoomFactor_=r.zoomFactor,this.resolutions_=e.resolutions,this.padding_=e.padding,this.minZoom_=r.minZoom;const i=Wz(e),s=r.constraint,o=Kz(e);this.constraints_={center:i,resolution:s,rotation:o},this.setRotation(e.rotation!==void 0?e.rotation:0),this.setCenterInternal(e.center!==void 0?e.center:null),e.resolution!==void 0?this.setResolution(e.resolution):e.zoom!==void 0&&this.setZoom(e.zoom)}get padding(){return this.padding_}set padding(e){let n=this.padding_;this.padding_=e;const r=this.getCenterInternal();if(r){const i=e||[0,0,0,0];n=n||[0,0,0,0];const s=this.getResolution(),o=s/2*(i[3]-n[3]+n[1]-i[1]),a=s/2*(i[0]-n[0]+n[2]-i[2]);this.setCenterInternal([r[0]+o,r[1]-a])}}getUpdatedOptions_(e){const n=this.getProperties();return n.resolution!==void 0?n.resolution=this.getResolution():n.zoom=this.getZoom(),n.center=this.getCenterInternal(),n.rotation=this.getRotation(),Object.assign({},n,e)}animate(e){this.isDef()&&!this.getAnimating()&&this.resolveConstraints(0);const n=new Array(arguments.length);for(let r=0;r<n.length;++r){let i=arguments[r];i.center&&(i=Object.assign({},i),i.center=Ot(i.center,this.getProjection())),i.anchor&&(i=Object.assign({},i),i.anchor=Ot(i.anchor,this.getProjection())),n[r]=i}this.animateInternal.apply(this,n)}animateInternal(e){let n=arguments.length,r;n>1&&typeof arguments[n-1]=="function"&&(r=arguments[n-1],--n);let i=0;for(;i<n&&!this.isDef();++i){const u=arguments[i];u.center&&this.setCenterInternal(u.center),u.zoom!==void 0?this.setZoom(u.zoom):u.resolution&&this.setResolution(u.resolution),u.rotation!==void 0&&this.setRotation(u.rotation)}if(i===n){r&&Of(r,!0);return}let s=Date.now(),o=this.targetCenter_.slice(),a=this.targetResolution_,l=this.targetRotation_;const c=[];for(;i<n;++i){const u=arguments[i],d={start:s,complete:!1,anchor:u.anchor,duration:u.duration!==void 0?u.duration:1e3,easing:u.easing||V4,callback:r};if(u.center&&(d.sourceCenter=o,d.targetCenter=u.center.slice(),o=d.targetCenter),u.zoom!==void 0?(d.sourceResolution=a,d.targetResolution=this.getResolutionForZoom(u.zoom),a=d.targetResolution):u.resolution&&(d.sourceResolution=a,d.targetResolution=u.resolution,a=d.targetResolution),u.rotation!==void 0){d.sourceRotation=l;const h=Ps(u.rotation-l+Math.PI,2*Math.PI)-Math.PI;d.targetRotation=l+h,l=d.targetRotation}Yz(d)?d.complete=!0:s+=d.duration,c.push(d)}this.animations_.push(c),this.setHint(gt.ANIMATING,1),this.updateAnimations_()}getAnimating(){return this.hints_[gt.ANIMATING]>0}getInteracting(){return this.hints_[gt.INTERACTING]>0}cancelAnimations(){this.setHint(gt.ANIMATING,-this.hints_[gt.ANIMATING]);let e;for(let n=0,r=this.animations_.length;n<r;++n){const i=this.animations_[n];if(i[0].callback&&Of(i[0].callback,!1),!e)for(let s=0,o=i.length;s<o;++s){const a=i[s];if(!a.complete){e=a.anchor;break}}}this.animations_.length=0,this.cancelAnchor_=e,this.nextCenter_=null,this.nextResolution_=NaN,this.nextRotation_=NaN}updateAnimations_(){if(this.updateAnimationKey_!==void 0&&(cancelAnimationFrame(this.updateAnimationKey_),this.updateAnimationKey_=void 0),!this.getAnimating())return;const e=Date.now();let n=!1;for(let r=this.animations_.length-1;r>=0;--r){const i=this.animations_[r];let s=!0;for(let o=0,a=i.length;o<a;++o){const l=i[o];if(l.complete)continue;const c=e-l.start;let u=l.duration>0?c/l.duration:1;u>=1?(l.complete=!0,u=1):s=!1;const d=l.easing(u);if(l.sourceCenter){const h=l.sourceCenter[0],f=l.sourceCenter[1],p=l.targetCenter[0],m=l.targetCenter[1];this.nextCenter_=l.targetCenter;const _=h+d*(p-h),g=f+d*(m-f);this.targetCenter_=[_,g]}if(l.sourceResolution&&l.targetResolution){const h=d===1?l.targetResolution:l.sourceResolution+d*(l.targetResolution-l.sourceResolution);if(l.anchor){const f=this.getViewportSize_(this.getRotation()),p=this.constraints_.resolution(h,0,f,!0);this.targetCenter_=this.calculateCenterZoom(p,l.anchor)}this.nextResolution_=l.targetResolution,this.targetResolution_=h,this.applyTargetState_(!0)}if(l.sourceRotation!==void 0&&l.targetRotation!==void 0){const h=d===1?Ps(l.targetRotation+Math.PI,2*Math.PI)-Math.PI:l.sourceRotation+d*(l.targetRotation-l.sourceRotation);if(l.anchor){const f=this.constraints_.rotation(h,!0);this.targetCenter_=this.calculateCenterRotate(f,l.anchor)}this.nextRotation_=l.targetRotation,this.targetRotation_=h}if(this.applyTargetState_(!0),n=!0,!l.complete)break}if(s){this.animations_[r]=null,this.setHint(gt.ANIMATING,-1),this.nextCenter_=null,this.nextResolution_=NaN,this.nextRotation_=NaN;const o=i[0].callback;o&&Of(o,!0)}}this.animations_=this.animations_.filter(Boolean),n&&this.updateAnimationKey_===void 0&&(this.updateAnimationKey_=requestAnimationFrame(this.updateAnimations_.bind(this)))}calculateCenterRotate(e,n){let r;const i=this.getCenterInternal();return i!==void 0&&(r=[i[0]-n[0],i[1]-n[1]],T1(r,e-this.getRotation()),EO(r,n)),r}calculateCenterZoom(e,n){let r;const i=this.getCenterInternal(),s=this.getResolution();if(i!==void 0&&s!==void 0){const o=n[0]-e*(n[0]-i[0])/s,a=n[1]-e*(n[1]-i[1])/s;r=[o,a]}return r}getViewportSize_(e){const n=this.viewportSize_;if(e){const r=n[0],i=n[1];return[Math.abs(r*Math.cos(e))+Math.abs(i*Math.sin(e)),Math.abs(r*Math.sin(e))+Math.abs(i*Math.cos(e))]}return n}setViewportSize(e){this.viewportSize_=Array.isArray(e)?e.slice():[100,100],this.getAnimating()||this.resolveConstraints(0)}getCenter(){const e=this.getCenterInternal();return e&&Ga(e,this.getProjection())}getCenterInternal(){return this.get(ri.CENTER)}getConstraints(){return this.constraints_}getConstrainResolution(){return this.get("constrainResolution")}getHints(e){return e!==void 0?(e[0]=this.hints_[0],e[1]=this.hints_[1],e):this.hints_.slice()}calculateExtent(e){const n=this.calculateExtentInternal(e);return ry(n,this.getProjection())}calculateExtentInternal(e){e=e||this.getViewportSizeMinusPadding_();const n=this.getCenterInternal();ze(n,"The view center is not defined");const r=this.getResolution();ze(r!==void 0,"The view resolution is not defined");const i=this.getRotation();return ze(i!==void 0,"The view rotation is not defined"),ah(n,r,i,e)}getMaxResolution(){return this.maxResolution_}getMinResolution(){return this.minResolution_}getMaxZoom(){return this.getZoomForResolution(this.minResolution_)}setMaxZoom(e){this.applyOptions_(this.getUpdatedOptions_({maxZoom:e}))}getMinZoom(){return this.getZoomForResolution(this.maxResolution_)}setMinZoom(e){this.applyOptions_(this.getUpdatedOptions_({minZoom:e}))}setConstrainResolution(e){this.applyOptions_(this.getUpdatedOptions_({constrainResolution:e}))}getProjection(){return this.projection_}getResolution(){return this.get(ri.RESOLUTION)}getResolutions(){return this.resolutions_}getResolutionForExtent(e,n){return this.getResolutionForExtentInternal(fi(e,this.getProjection()),n)}getResolutionForExtentInternal(e,n){n=n||this.getViewportSizeMinusPadding_();const r=Me(e)/n[0],i=Gt(e)/n[1];return Math.max(r,i)}getResolutionForValueFunction(e){e=e||2;const n=this.getConstrainedResolution(this.maxResolution_),r=this.minResolution_,i=Math.log(n/r)/Math.log(e);return function(s){return n/Math.pow(e,s*i)}}getRotation(){return this.get(ri.ROTATION)}getValueForResolutionFunction(e){const n=Math.log(e||2),r=this.getConstrainedResolution(this.maxResolution_),i=this.minResolution_,s=Math.log(r/i)/n;return function(o){return Math.log(r/o)/n/s}}getViewportSizeMinusPadding_(e){let n=this.getViewportSize_(e);const r=this.padding_;return r&&(n=[n[0]-r[1]-r[3],n[1]-r[0]-r[2]]),n}getState(){const e=this.getProjection(),n=this.getResolution(),r=this.getRotation();let i=this.getCenterInternal();const s=this.padding_;if(s){const o=this.getViewportSizeMinusPadding_();i=r0(i,this.getViewportSize_(),[o[0]/2+s[3],o[1]/2+s[0]],n,r)}return{center:i.slice(0),projection:e!==void 0?e:null,resolution:n,nextCenter:this.nextCenter_,nextResolution:this.nextResolution_,nextRotation:this.nextRotation_,rotation:r,zoom:this.getZoom()}}getViewStateAndExtent(){return{viewState:this.getState(),extent:this.calculateExtent()}}getZoom(){let e;const n=this.getResolution();return n!==void 0&&(e=this.getZoomForResolution(n)),e}getZoomForResolution(e){let n=this.minZoom_||0,r,i;if(this.resolutions_){const s=Hm(this.resolutions_,e,1);n=s,r=this.resolutions_[s],s==this.resolutions_.length-1?i=2:i=r/this.resolutions_[s+1]}else r=this.maxResolution_,i=this.zoomFactor_;return n+Math.log(r/e)/Math.log(i)}getResolutionForZoom(e){var n;if((n=this.resolutions_)!=null&&n.length){if(this.resolutions_.length===1)return this.resolutions_[0];const r=ct(Math.floor(e),0,this.resolutions_.length-2),i=this.resolutions_[r]/this.resolutions_[r+1];return this.resolutions_[r]/Math.pow(i,ct(e-r,0,1))}return this.maxResolution_/Math.pow(this.zoomFactor_,e-this.minZoom_)}fit(e,n){let r;if(ze(Array.isArray(e)||typeof e.getSimplifiedGeometry=="function","Invalid extent or geometry provided as `geometry`"),Array.isArray(e)){ze(!tl(e),"Cannot fit empty extent provided as `geometry`");const i=fi(e,this.getProjection());r=$T(i)}else if(e.getType()==="Circle"){const i=fi(e.getExtent(),this.getProjection());r=$T(i),r.rotate(this.getRotation(),Er(i))}else r=e;this.fitInternal(r,n)}rotatedExtentForGeometry(e){const n=this.getRotation(),r=Math.cos(n),i=Math.sin(-n),s=e.getFlatCoordinates(),o=e.getStride();let a=1/0,l=1/0,c=-1/0,u=-1/0;for(let d=0,h=s.length;d<h;d+=o){const f=s[d]*r-s[d+1]*i,p=s[d]*i+s[d+1]*r;a=Math.min(a,f),l=Math.min(l,p),c=Math.max(c,f),u=Math.max(u,p)}return[a,l,c,u]}fitInternal(e,n){n=n||{};let r=n.size;r||(r=this.getViewportSizeMinusPadding_());const i=n.padding!==void 0?n.padding:[0,0,0,0],s=n.nearest!==void 0?n.nearest:!1;let o;n.minResolution!==void 0?o=n.minResolution:n.maxZoom!==void 0?o=this.getResolutionForZoom(n.maxZoom):o=0;const a=this.rotatedExtentForGeometry(e);let l=this.getResolutionForExtentInternal(a,[r[0]-i[1]-i[3],r[1]-i[0]-i[2]]);l=isNaN(l)?o:Math.max(l,o),l=this.getConstrainedResolution(l,s?0:1);const c=this.getRotation(),u=Math.sin(c),d=Math.cos(c),h=Er(a);h[0]+=(i[1]-i[3])/2*l,h[1]+=(i[0]-i[2])/2*l;const f=h[0]*d-h[1]*u,p=h[1]*d+h[0]*u,m=this.getConstrainedCenter([f,p],l),_=n.callback?n.callback:nh;n.duration!==void 0?this.animateInternal({resolution:l,center:m,duration:n.duration,easing:n.easing},_):(this.targetResolution_=l,this.targetCenter_=m,this.applyTargetState_(!1,!0),Of(_,!0))}centerOn(e,n,r){this.centerOnInternal(Ot(e,this.getProjection()),n,r)}centerOnInternal(e,n,r){this.setCenterInternal(r0(e,n,r,this.getResolution(),this.getRotation()))}calculateCenterShift(e,n,r,i){let s;const o=this.padding_;if(o&&e){const a=this.getViewportSizeMinusPadding_(-r),l=r0(e,i,[a[0]/2+o[3],a[1]/2+o[0]],n,r);s=[e[0]-l[0],e[1]-l[1]]}return s}isDef(){return!!this.getCenterInternal()&&this.getResolution()!==void 0}adjustCenter(e){const n=Ga(this.targetCenter_,this.getProjection());this.setCenter([n[0]+e[0],n[1]+e[1]])}adjustCenterInternal(e){const n=this.targetCenter_;this.setCenterInternal([n[0]+e[0],n[1]+e[1]])}adjustResolution(e,n){n=n&&Ot(n,this.getProjection()),this.adjustResolutionInternal(e,n)}adjustResolutionInternal(e,n){const r=this.getAnimating()||this.getInteracting(),i=this.getViewportSize_(this.getRotation()),s=this.constraints_.resolution(this.targetResolution_*e,0,i,r);n&&(this.targetCenter_=this.calculateCenterZoom(s,n)),this.targetResolution_*=e,this.applyTargetState_()}adjustZoom(e,n){this.adjustResolution(Math.pow(this.zoomFactor_,-e),n)}adjustRotation(e,n){n&&(n=Ot(n,this.getProjection())),this.adjustRotationInternal(e,n)}adjustRotationInternal(e,n){const r=this.getAnimating()||this.getInteracting(),i=this.constraints_.rotation(this.targetRotation_+e,r);n&&(this.targetCenter_=this.calculateCenterRotate(i,n)),this.targetRotation_+=e,this.applyTargetState_()}setCenter(e){this.setCenterInternal(e&&Ot(e,this.getProjection()))}setCenterInternal(e){this.targetCenter_=e,this.applyTargetState_()}setHint(e,n){return this.hints_[e]+=n,this.changed(),this.hints_[e]}setResolution(e){this.targetResolution_=e,this.applyTargetState_()}setRotation(e){this.targetRotation_=e,this.applyTargetState_()}setZoom(e){this.setResolution(this.getResolutionForZoom(e))}applyTargetState_(e,n){const r=this.getAnimating()||this.getInteracting()||n,i=this.constraints_.rotation(this.targetRotation_,r),s=this.getViewportSize_(i),o=this.constraints_.resolution(this.targetResolution_,0,s,r),a=this.constraints_.center(this.targetCenter_,o,s,r,this.calculateCenterShift(this.targetCenter_,o,i,s));this.get(ri.ROTATION)!==i&&this.set(ri.ROTATION,i),this.get(ri.RESOLUTION)!==o&&(this.set(ri.RESOLUTION,o),this.set("zoom",this.getZoom(),!0)),(!a||!this.get(ri.CENTER)||!Nn(this.get(ri.CENTER),a))&&this.set(ri.CENTER,a),this.getAnimating()&&!e&&this.cancelAnimations(),this.cancelAnchor_=void 0}resolveConstraints(e,n,r){e=e!==void 0?e:200;const i=n||0,s=this.constraints_.rotation(this.targetRotation_),o=this.getViewportSize_(s),a=this.constraints_.resolution(this.targetResolution_,i,o),l=this.constraints_.center(this.targetCenter_,a,o,!1,this.calculateCenterShift(this.targetCenter_,a,s,o));if(e===0&&!this.cancelAnchor_){this.targetResolution_=a,this.targetRotation_=s,this.targetCenter_=l,this.applyTargetState_();return}r=r||(e===0?this.cancelAnchor_:void 0),this.cancelAnchor_=void 0,(this.getResolution()!==a||this.getRotation()!==s||!this.getCenterInternal()||!Nn(this.getCenterInternal(),l))&&(this.getAnimating()&&this.cancelAnimations(),this.animateInternal({rotation:s,center:l,resolution:a,duration:e,easing:ou,anchor:r}))}beginInteraction(){this.resolveConstraints(0),this.setHint(gt.INTERACTING,1)}endInteraction(e,n,r){r=r&&Ot(r,this.getProjection()),this.endInteractionInternal(e,n,r)}endInteractionInternal(e,n,r){this.getInteracting()&&(this.setHint(gt.INTERACTING,-1),this.resolveConstraints(e,n,r))}getConstrainedCenter(e,n){const r=this.getViewportSize_(this.getRotation());return this.constraints_.center(e,n||this.getResolution(),r)}getConstrainedZoom(e,n){const r=this.getResolutionForZoom(e);return this.getZoomForResolution(this.getConstrainedResolution(r,n))}getConstrainedResolution(e,n){n=n||0;const r=this.getViewportSize_(this.getRotation());return this.constraints_.resolution(e,n,r)}}function Of(t,e){setTimeout(function(){t(e)},0)}function Wz(t){if(t.extent!==void 0){const n=t.smoothExtentConstraint!==void 0?t.smoothExtentConstraint:!0;return vT(t.extent,t.constrainOnlyCenter,n)}const e=O1(t.projection,"EPSG:3857");if(t.multiWorld!==!0&&e.isGlobal()){const n=e.getExtent().slice();return n[0]=-1/0,n[2]=1/0,vT(n,!1,!1)}return M4}function Hz(t){let e,n,r,o=t.minZoom!==void 0?t.minZoom:n0,a=t.maxZoom!==void 0?t.maxZoom:28;const l=t.zoomFactor!==void 0?t.zoomFactor:2,c=t.multiWorld!==void 0?t.multiWorld:!1,u=t.smoothResolutionConstraint!==void 0?t.smoothResolutionConstraint:!0,d=t.showFullExtent!==void 0?t.showFullExtent:!1,h=O1(t.projection,"EPSG:3857"),f=h.getExtent();let p=t.constrainOnlyCenter,m=t.extent;if(!c&&!m&&h.isGlobal()&&(p=!1,m=f),t.resolutions!==void 0){const _=t.resolutions;n=_[o],r=_[a]!==void 0?_[a]:_[_.length-1],t.constrainResolution?e=Uz(_,u,!p&&m,d):e=LT(n,r,u,!p&&m,d)}else{const g=(f?Math.max(Me(f),Gt(f)):360*Nc.degrees/h.getMetersPerUnit())/X1/Math.pow(2,n0),y=g/Math.pow(2,28-n0);n=t.maxResolution,n!==void 0?o=0:n=g/Math.pow(l,o),r=t.minResolution,r===void 0&&(t.maxZoom!==void 0?t.maxResolution!==void 0?r=n/Math.pow(l,a):r=g/Math.pow(l,a):r=y),a=o+Math.floor(Math.log(n/r)/Math.log(l)),r=n/Math.pow(l,a-o),t.constrainResolution?e=Gz(l,n,r,u,!p&&m,d):e=LT(n,r,u,!p&&m,d)}return{constraint:e,maxResolution:n,minResolution:r,minZoom:o,zoomFactor:l}}function Kz(t){if(t.enableRotation!==void 0?t.enableRotation:!0){const n=t.constrainRotation;return n===void 0||n===!0?Vz():n===!1?kT:typeof n=="number"?Bz(n):kT}return Y1}function Yz(t){return!(t.sourceCenter&&t.targetCenter&&!Nn(t.sourceCenter,t.targetCenter)||t.sourceResolution!==t.targetResolution||t.sourceRotation!==t.targetRotation)}function r0(t,e,n,r,i){const s=Math.cos(-i);let o=Math.sin(-i),a=t[0]*s-t[1]*o,l=t[1]*s+t[0]*o;a+=(e[0]/2-n[0])*r,l+=(n[1]-e[1]/2)*r,o=-o;const c=a*s-l*o,u=l*s+a*o;return[c,u]}class zh extends bi{constructor(e){super();const n=e.element;n&&!e.target&&!n.style.pointerEvents&&(n.style.pointerEvents="auto"),this.element=n||null,this.target_=null,this.map_=null,this.listenerKeys=[],e.render&&(this.render=e.render),e.target&&this.setTarget(e.target)}disposeInternal(){var e;(e=this.element)==null||e.remove(),super.disposeInternal()}getMap(){return this.map_}setMap(e){var n;this.map_&&((n=this.element)==null||n.remove());for(let r=0,i=this.listenerKeys.length;r<i;++r)it(this.listenerKeys[r]);if(this.listenerKeys.length=0,this.map_=e,e){const r=this.target_??e.getOverlayContainerStopEvent();this.element&&r.appendChild(this.element),this.render!==nh&&this.listenerKeys.push(Oe(e,ms.POSTRENDER,this.render,this)),e.render()}}render(e){}setTarget(e){this.target_=typeof e=="string"?document.getElementById(e):e}}class Xz extends zh{constructor(e){e=e||{},super({element:document.createElement("div"),render:e.render,target:e.target}),this.ulElement_=document.createElement("ul"),this.collapsed_=e.collapsed!==void 0?e.collapsed:!0,this.userCollapsed_=this.collapsed_,this.overrideCollapsible_=e.collapsible!==void 0,this.collapsible_=e.collapsible!==void 0?e.collapsible:!0,this.collapsible_||(this.collapsed_=!1),this.attributions_=e.attributions;const n=e.className!==void 0?e.className:"ol-attribution",r=e.tipLabel!==void 0?e.tipLabel:"Attributions",i=e.expandClassName!==void 0?e.expandClassName:n+"-expand",s=e.collapseLabel!==void 0?e.collapseLabel:"",o=e.collapseClassName!==void 0?e.collapseClassName:n+"-collapse";typeof s=="string"?(this.collapseLabel_=document.createElement("span"),this.collapseLabel_.textContent=s,this.collapseLabel_.className=o):this.collapseLabel_=s;const a=e.label!==void 0?e.label:"i";typeof a=="string"?(this.label_=document.createElement("span"),this.label_.textContent=a,this.label_.className=i):this.label_=a;const l=this.collapsible_&&!this.collapsed_?this.collapseLabel_:this.label_;this.toggleButton_=document.createElement("button"),this.toggleButton_.setAttribute("type","button"),this.toggleButton_.setAttribute("aria-expanded",String(!this.collapsed_)),this.toggleButton_.title=r,this.toggleButton_.appendChild(l),this.toggleButton_.addEventListener(Se.CLICK,this.handleClick_.bind(this),!1);const c=n+" "+iu+" "+Km+(this.collapsed_&&this.collapsible_?" "+aT:"")+(this.collapsible_?"":" ol-uncollapsible"),u=this.element;u.className=c,u.appendChild(this.toggleButton_),u.appendChild(this.ulElement_),this.renderedAttributions_=[],this.renderedVisible_=!0}collectSourceAttributions_(e){const n=this.getMap().getAllLayers(),r=new Set(n.flatMap(i=>i.getAttributions(e)));if(this.attributions_!==void 0&&(Array.isArray(this.attributions_)?this.attributions_.forEach(i=>r.add(i)):r.add(this.attributions_)),!this.overrideCollapsible_){const i=!n.some(s=>{var o;return((o=s.getSource())==null?void 0:o.getAttributionsCollapsible())===!1});this.setCollapsible(i)}return Array.from(r)}async updateElement_(e){if(!e){this.renderedVisible_&&(this.element.style.display="none",this.renderedVisible_=!1);return}const n=await Promise.all(this.collectSourceAttributions_(e).map(i=>aO(()=>i))),r=n.length>0;if(this.renderedVisible_!=r&&(this.element.style.display=r?"":"none",this.renderedVisible_=r),!es(n,this.renderedAttributions_)){rO(this.ulElement_);for(let i=0,s=n.length;i<s;++i){const o=document.createElement("li");o.innerHTML=n[i],this.ulElement_.appendChild(o)}this.renderedAttributions_=n}}handleClick_(e){e.preventDefault(),this.handleToggle_(),this.userCollapsed_=this.collapsed_}handleToggle_(){this.element.classList.toggle(aT),this.collapsed_?Pp(this.collapseLabel_,this.label_):Pp(this.label_,this.collapseLabel_),this.collapsed_=!this.collapsed_,this.toggleButton_.setAttribute("aria-expanded",String(!this.collapsed_))}getCollapsible(){return this.collapsible_}setCollapsible(e){this.collapsible_!==e&&(this.collapsible_=e,this.element.classList.toggle("ol-uncollapsible"),this.userCollapsed_&&this.handleToggle_())}setCollapsed(e){this.userCollapsed_=e,!(!this.collapsible_||this.collapsed_===e)&&this.handleToggle_()}getCollapsed(){return this.collapsed_}render(e){this.updateElement_(e.frameState)}}class Zz extends zh{constructor(e){e=e||{},super({element:document.createElement("div"),render:e.render,target:e.target});const n=e.className!==void 0?e.className:"ol-rotate",r=e.label!==void 0?e.label:"",i=e.compassClassName!==void 0?e.compassClassName:"ol-compass";this.label_=null,typeof r=="string"?(this.label_=document.createElement("span"),this.label_.className=i,this.label_.textContent=r):(this.label_=r,this.label_.classList.add(i));const s=e.tipLabel?e.tipLabel:"Reset rotation",o=document.createElement("button");o.className=n+"-reset",o.setAttribute("type","button"),o.title=s,o.appendChild(this.label_),o.addEventListener(Se.CLICK,this.handleClick_.bind(this),!1);const a=n+" "+iu+" "+Km,l=this.element;l.className=a,l.appendChild(o),this.callResetNorth_=e.resetNorth?e.resetNorth:void 0,this.duration_=e.duration!==void 0?e.duration:250,this.autoHide_=e.autoHide!==void 0?e.autoHide:!0,this.rotation_=void 0,this.autoHide_&&this.element.classList.add(Rf)}handleClick_(e){e.preventDefault(),this.callResetNorth_!==void 0?this.callResetNorth_():this.resetNorth_()}resetNorth_(){const n=this.getMap().getView();if(!n)return;const r=n.getRotation();r!==void 0&&(this.duration_>0&&r%(2*Math.PI)!==0?n.animate({rotation:0,duration:this.duration_,easing:ou}):n.setRotation(0))}render(e){const n=e.frameState;if(!n)return;const r=n.viewState.rotation;if(r!=this.rotation_){const i="rotate("+r+"rad)";if(this.autoHide_){const s=this.element.classList.contains(Rf);!s&&r===0?this.element.classList.add(Rf):s&&r!==0&&this.element.classList.remove(Rf)}this.label_.style.transform=i}this.rotation_=r}}class qz extends zh{constructor(e){e=e||{},super({element:document.createElement("div"),target:e.target});const n=e.className!==void 0?e.className:"ol-zoom",r=e.delta!==void 0?e.delta:1,i=e.zoomInClassName!==void 0?e.zoomInClassName:n+"-in",s=e.zoomOutClassName!==void 0?e.zoomOutClassName:n+"-out",o=e.zoomInLabel!==void 0?e.zoomInLabel:"+",a=e.zoomOutLabel!==void 0?e.zoomOutLabel:"",l=e.zoomInTipLabel!==void 0?e.zoomInTipLabel:"Zoom in",c=e.zoomOutTipLabel!==void 0?e.zoomOutTipLabel:"Zoom out",u=document.createElement("button");u.className=i,u.setAttribute("type","button"),u.title=l,u.appendChild(typeof o=="string"?document.createTextNode(o):o),u.addEventListener(Se.CLICK,this.handleClick_.bind(this,r),!1);const d=document.createElement("button");d.className=s,d.setAttribute("type","button"),d.title=c,d.appendChild(typeof a=="string"?document.createTextNode(a):a),d.addEventListener(Se.CLICK,this.handleClick_.bind(this,-r),!1);const h=n+" "+iu+" "+Km,f=this.element;f.className=h,f.appendChild(u),f.appendChild(d),this.duration_=e.duration!==void 0?e.duration:250}handleClick_(e,n){n.preventDefault(),this.zoomByDelta_(e)}zoomByDelta_(e){const r=this.getMap().getView();if(!r)return;const i=r.getZoom();if(i!==void 0){const s=r.getConstrainedZoom(i+e);this.duration_>0?(r.getAnimating()&&r.cancelAnimations(),r.animate({zoom:s,duration:this.duration_,easing:ou})):r.setZoom(s)}}}function KO(t){t=t||{};const e=new Bn;return(t.zoom!==void 0?t.zoom:!0)&&e.push(new qz(t.zoomOptions)),(t.rotate!==void 0?t.rotate:!0)&&e.push(new Zz(t.rotateOptions)),(t.attribution!==void 0?t.attribution:!0)&&e.push(new Xz(t.attributionOptions)),e}class Jz{constructor(e,n,r){this.decay_=e,this.minVelocity_=n,this.delay_=r,this.points_=[],this.angle_=0,this.initialVelocity_=0}begin(){this.points_.length=0,this.angle_=0,this.initialVelocity_=0}update(e,n){this.points_.push(e,n,Date.now())}end(){if(this.points_.length<6)return!1;const e=Date.now()-this.delay_,n=this.points_.length-3;if(this.points_[n+2]<e)return!1;let r=n-3;for(;r>0&&this.points_[r+2]>e;)r-=3;const i=this.points_[n+2]-this.points_[r+2];if(i<1e3/60)return!1;const s=this.points_[n]-this.points_[r],o=this.points_[n+1]-this.points_[r+1];return this.angle_=Math.atan2(o,s),this.initialVelocity_=Math.sqrt(s*s+o*o)/i,this.initialVelocity_>this.minVelocity_}getDistance(){return(this.minVelocity_-this.initialVelocity_)/this.decay_}getAngle(){return this.angle_}}const ww={ACTIVE:"active"};class au extends bi{constructor(e){super(),this.on,this.once,this.un,e&&e.handleEvent&&(this.handleEvent=e.handleEvent),this.map_=null,this.setActive(!0)}getActive(){return this.get(ww.ACTIVE)}getMap(){return this.map_}handleEvent(e){return!0}setActive(e){this.set(ww.ACTIVE,e)}setMap(e){this.map_=e}}function Qz(t,e,n){const r=t.getCenterInternal();if(r){const i=[r[0]+e[0],r[1]+e[1]];t.animateInternal({duration:n!==void 0?n:250,easing:W4,center:t.getConstrainedCenter(i)})}}function Z1(t,e,n,r){const i=t.getZoom();if(i===void 0)return;const s=t.getConstrainedZoom(i+e),o=t.getResolutionForZoom(s);t.getAnimating()&&t.cancelAnimations(),t.animate({resolution:o,anchor:n,duration:r!==void 0?r:250,easing:ou})}class eU extends au{constructor(e){super(),e=e||{},this.delta_=e.delta?e.delta:1,this.duration_=e.duration!==void 0?e.duration:250}handleEvent(e){let n=!1;if(e.type==Be.DBLCLICK){const r=e.originalEvent,i=e.map,s=e.coordinate,o=r.shiftKey?-this.delta_:this.delta_,a=i.getView();Z1(a,o,s,this.duration_),r.preventDefault(),n=!0}return!n}}function xw(t){const e=arguments;return function(n){let r=!0;for(let i=0,s=e.length;i<s&&(r=r&&e[i](n),!!r);++i);return r}}const tU=function(t){const e=t.originalEvent;return e.altKey&&!(e.metaKey||e.ctrlKey)&&!e.shiftKey},nU=function(t){const e=t.originalEvent;return e.altKey&&!(e.metaKey||e.ctrlKey)&&e.shiftKey},rU=function(t){const e=t.map.getTargetElement(),n=e.getRootNode(),r=t.map.getOwnerDocument().activeElement;return n instanceof ShadowRoot?n.host.contains(r):e.contains(r)},YO=function(t){const e=t.map.getTargetElement(),n=e.getRootNode();return(n instanceof ShadowRoot?n.host:e).hasAttribute("tabindex")?rU(t):!0},mc=zo,XO=function(t){const e=t.originalEvent;return"pointerId"in e&&e.button==0&&!(Y5&&QF&&e.ctrlKey)},zp=nu,ZO=function(t){return t.type==Be.SINGLECLICK},q1=function(t){const e=t.originalEvent;return!e.altKey&&!(e.metaKey||e.ctrlKey)&&!e.shiftKey},iU=function(t){const e=t.originalEvent;return QF?e.metaKey:e.ctrlKey},Up=function(t){const e=t.originalEvent;return!e.altKey&&!(e.metaKey||e.ctrlKey)&&e.shiftKey},qO=function(t){const e=t.originalEvent,n=e.target.tagName;return n!=="INPUT"&&n!=="SELECT"&&n!=="TEXTAREA"&&!e.target.isContentEditable},i0=function(t){const e=t.originalEvent;return"pointerId"in e&&e.pointerType=="mouse"},JO=function(t){const e=t.originalEvent;return"pointerId"in e&&e.isPrimary&&e.button===0};class il extends au{constructor(e){e=e||{},super(e),e.handleDownEvent&&(this.handleDownEvent=e.handleDownEvent),e.handleDragEvent&&(this.handleDragEvent=e.handleDragEvent),e.handleMoveEvent&&(this.handleMoveEvent=e.handleMoveEvent),e.handleUpEvent&&(this.handleUpEvent=e.handleUpEvent),e.stopDown&&(this.stopDown=e.stopDown),this.handlingDownUpSequence=!1,this.targetPointers=[]}getPointerCount(){return this.targetPointers.length}handleDownEvent(e){return!1}handleDragEvent(e){}handleEvent(e){if(!e.originalEvent)return!0;let n=!1;if(this.updateTrackedPointers_(e),this.handlingDownUpSequence){if(e.type==Be.POINTERDRAG)this.handleDragEvent(e),e.originalEvent.preventDefault();else if(e.type==Be.POINTERUP){const r=this.handleUpEvent(e);this.handlingDownUpSequence=r&&this.targetPointers.length>0}}else if(e.type==Be.POINTERDOWN){const r=this.handleDownEvent(e);this.handlingDownUpSequence=r,n=this.stopDown(r)}else e.type==Be.POINTERMOVE&&this.handleMoveEvent(e);return!n}handleMoveEvent(e){}handleUpEvent(e){return!1}stopDown(e){return e}updateTrackedPointers_(e){e.activePointers&&(this.targetPointers=e.activePointers)}}function J1(t){const e=t.length;let n=0,r=0;for(let i=0;i<e;i++)n+=t[i].clientX,r+=t[i].clientY;return{clientX:n/e,clientY:r/e}}class sU extends il{constructor(e){super({stopDown:nu}),e=e||{},this.kinetic_=e.kinetic,this.lastCentroid=null,this.lastPointersCount_,this.panning_=!1;const n=e.condition?e.condition:xw(q1,JO);this.condition_=e.onFocusOnly?xw(YO,n):n,this.noKinetic_=!1}handleDragEvent(e){const n=e.map;this.panning_||(this.panning_=!0,n.getView().beginInteraction());const r=this.targetPointers,i=n.getEventPixel(J1(r));if(r.length==this.lastPointersCount_){if(this.kinetic_&&this.kinetic_.update(i[0],i[1]),this.lastCentroid){const s=[this.lastCentroid[0]-i[0],i[1]-this.lastCentroid[1]],a=e.map.getView();SO(s,a.getResolution()),T1(s,a.getRotation()),a.adjustCenterInternal(s)}}else this.kinetic_&&this.kinetic_.begin();this.lastCentroid=i,this.lastPointersCount_=r.length,e.originalEvent.preventDefault()}handleUpEvent(e){const n=e.map,r=n.getView();if(this.targetPointers.length===0){if(!this.noKinetic_&&this.kinetic_&&this.kinetic_.end()){const i=this.kinetic_.getDistance(),s=this.kinetic_.getAngle(),o=r.getCenterInternal(),a=n.getPixelFromCoordinateInternal(o),l=n.getCoordinateFromPixelInternal([a[0]-i*Math.cos(s),a[1]-i*Math.sin(s)]);r.animateInternal({center:r.getConstrainedCenter(l),duration:500,easing:ou})}return this.panning_&&(this.panning_=!1,r.endInteraction()),!1}return this.kinetic_&&this.kinetic_.begin(),this.lastCentroid=null,!0}handleDownEvent(e){if(this.targetPointers.length>0&&this.condition_(e)){const r=e.map.getView();return this.lastCentroid=null,r.getAnimating()&&r.cancelAnimations(),this.kinetic_&&this.kinetic_.begin(),this.noKinetic_=this.targetPointers.length>1,!0}return!1}}class oU extends il{constructor(e){e=e||{},super({stopDown:nu}),this.condition_=e.condition?e.condition:nU,this.lastAngle_=void 0,this.duration_=e.duration!==void 0?e.duration:250}handleDragEvent(e){if(!i0(e))return;const n=e.map,r=n.getView();if(r.getConstraints().rotation===Y1)return;const i=n.getSize(),s=e.pixel,o=Math.atan2(i[1]/2-s[1],s[0]-i[0]/2);if(this.lastAngle_!==void 0){const a=o-this.lastAngle_;r.adjustRotationInternal(-a)}this.lastAngle_=o}handleUpEvent(e){return i0(e)?(e.map.getView().endInteraction(this.duration_),!1):!0}handleDownEvent(e){return i0(e)&&XO(e)&&this.condition_(e)?(e.map.getView().beginInteraction(),this.lastAngle_=void 0,!0):!1}}class aU extends Lh{constructor(e){super(),this.geometry_=null,this.element_=document.createElement("div"),this.element_.style.position="absolute",this.element_.style.pointerEvents="auto",this.element_.className="ol-box "+e,this.map_=null,this.startPixel_=null,this.endPixel_=null}disposeInternal(){this.setMap(null)}render_(){const e=this.startPixel_,n=this.endPixel_,r="px",i=this.element_.style;i.left=Math.min(e[0],n[0])+r,i.top=Math.min(e[1],n[1])+r,i.width=Math.abs(n[0]-e[0])+r,i.height=Math.abs(n[1]-e[1])+r}setMap(e){if(this.map_){this.map_.getOverlayContainer().removeChild(this.element_);const n=this.element_.style;n.left="inherit",n.top="inherit",n.width="inherit",n.height="inherit"}this.map_=e,this.map_&&this.map_.getOverlayContainer().appendChild(this.element_)}setPixels(e,n){this.startPixel_=e,this.endPixel_=n,this.createOrUpdateGeometry(),this.render_()}createOrUpdateGeometry(){if(!this.map_)return;const e=this.startPixel_,n=this.endPixel_,i=[e,[e[0],n[1]],n,[n[0],e[1]]].map(this.map_.getCoordinateFromPixelInternal,this.map_);i[4]=i[0].slice(),this.geometry_?this.geometry_.setCoordinates([i]):this.geometry_=new lr([i])}getGeometry(){return this.geometry_}}const xl={BOXSTART:"boxstart",BOXDRAG:"boxdrag",BOXEND:"boxend",BOXCANCEL:"boxcancel"};class Bu extends Cr{constructor(e,n,r){super(e),this.coordinate=n,this.mapBrowserEvent=r}}class lU extends il{constructor(e){super(),this.on,this.once,this.un,e=e??{},this.box_=new aU(e.className||"ol-dragbox"),this.minArea_=e.minArea??64,e.onBoxEnd&&(this.onBoxEnd=e.onBoxEnd),this.startPixel_=null,this.condition_=e.condition??XO,this.boxEndCondition_=e.boxEndCondition??this.defaultBoxEndCondition}defaultBoxEndCondition(e,n,r){const i=r[0]-n[0],s=r[1]-n[1];return i*i+s*s>=this.minArea_}getGeometry(){return this.box_.getGeometry()}handleDragEvent(e){this.startPixel_&&(this.box_.setPixels(this.startPixel_,e.pixel),this.dispatchEvent(new Bu(xl.BOXDRAG,e.coordinate,e)))}handleUpEvent(e){if(!this.startPixel_)return!1;const n=this.boxEndCondition_(e,this.startPixel_,e.pixel);return n&&this.onBoxEnd(e),this.dispatchEvent(new Bu(n?xl.BOXEND:xl.BOXCANCEL,e.coordinate,e)),this.box_.setMap(null),this.startPixel_=null,!1}handleDownEvent(e){return this.condition_(e)?(this.startPixel_=e.pixel,this.box_.setMap(e.map),this.box_.setPixels(this.startPixel_,this.startPixel_),this.dispatchEvent(new Bu(xl.BOXSTART,e.coordinate,e)),!0):!1}onBoxEnd(e){}setActive(e){e||(this.box_.setMap(null),this.startPixel_&&(this.dispatchEvent(new Bu(xl.BOXCANCEL,this.startPixel_,null)),this.startPixel_=null)),super.setActive(e)}setMap(e){this.getMap()&&(this.box_.setMap(null),this.startPixel_&&(this.dispatchEvent(new Bu(xl.BOXCANCEL,this.startPixel_,null)),this.startPixel_=null)),super.setMap(e)}}class cU extends lU{constructor(e){e=e||{};const n=e.condition?e.condition:Up;super({condition:n,className:e.className||"ol-dragzoom",minArea:e.minArea}),this.duration_=e.duration!==void 0?e.duration:200,this.out_=e.out!==void 0?e.out:!1}onBoxEnd(e){const r=this.getMap().getView();let i=this.getGeometry();if(this.out_){const s=r.rotatedExtentForGeometry(i),o=r.getResolutionForExtentInternal(s),a=r.getResolution()/o;i=i.clone(),i.scale(a*a)}r.fitInternal(i,{duration:this.duration_,easing:ou})}}const aa={LEFT:"ArrowLeft",UP:"ArrowUp",RIGHT:"ArrowRight",DOWN:"ArrowDown"};class uU extends au{constructor(e){super(),e=e||{},this.defaultCondition_=function(n){return q1(n)&&qO(n)},this.condition_=e.condition!==void 0?e.condition:this.defaultCondition_,this.duration_=e.duration!==void 0?e.duration:100,this.pixelDelta_=e.pixelDelta!==void 0?e.pixelDelta:128}handleEvent(e){let n=!1;if(e.type==Se.KEYDOWN){const r=e.originalEvent,i=r.key;if(this.condition_(e)&&(i==aa.DOWN||i==aa.LEFT||i==aa.RIGHT||i==aa.UP)){const o=e.map.getView(),a=o.getResolution()*this.pixelDelta_;let l=0,c=0;i==aa.DOWN?c=-a:i==aa.LEFT?l=-a:i==aa.RIGHT?l=a:c=a;const u=[l,c];T1(u,o.getRotation()),Qz(o,u,this.duration_),r.preventDefault(),n=!0}}return!n}}class dU extends au{constructor(e){super(),e=e||{},this.condition_=e.condition?e.condition:function(n){return!iU(n)&&qO(n)},this.delta_=e.delta?e.delta:1,this.duration_=e.duration!==void 0?e.duration:100}handleEvent(e){let n=!1;if(e.type==Se.KEYDOWN||e.type==Se.KEYPRESS){const r=e.originalEvent,i=r.key;if(this.condition_(e)&&(i==="+"||i==="-")){const s=e.map,o=i==="+"?this.delta_:-this.delta_,a=s.getView();Z1(a,o,void 0,this.duration_),r.preventDefault(),n=!0}}return!n}}const hU=40,fU=300;class gU extends au{constructor(e){e=e||{},super(e),this.totalDelta_=0,this.lastDelta_=0,this.maxDelta_=e.maxDelta!==void 0?e.maxDelta:1,this.duration_=e.duration!==void 0?e.duration:250,this.timeout_=e.timeout!==void 0?e.timeout:80,this.useAnchor_=e.useAnchor!==void 0?e.useAnchor:!0,this.constrainResolution_=e.constrainResolution!==void 0?e.constrainResolution:!1;const n=e.condition?e.condition:mc;this.condition_=e.onFocusOnly?xw(YO,n):n,this.lastAnchor_=null,this.startTime_=void 0,this.timeoutId_,this.mode_=void 0,this.trackpadEventGap_=400,this.trackpadTimeoutId_,this.deltaPerZoom_=300}endInteraction_(){this.trackpadTimeoutId_=void 0;const e=this.getMap();if(!e)return;e.getView().endInteraction(void 0,this.lastDelta_?this.lastDelta_>0?1:-1:0,this.lastAnchor_?e.getCoordinateFromPixel(this.lastAnchor_):null)}handleEvent(e){if(!this.condition_(e)||e.type!==Se.WHEEL)return!0;const r=e.map,i=e.originalEvent;i.preventDefault(),this.useAnchor_&&(this.lastAnchor_=e.pixel);let s=i.deltaY;switch(i.deltaMode){case WheelEvent.DOM_DELTA_LINE:s*=hU;break;case WheelEvent.DOM_DELTA_PAGE:s*=fU;break}if(s===0)return!1;this.lastDelta_=s;const o=Date.now();this.startTime_===void 0&&(this.startTime_=o),(!this.mode_||o-this.startTime_>this.trackpadEventGap_)&&(this.mode_=Math.abs(s)<4?"trackpad":"wheel");const a=r.getView();if(this.mode_==="trackpad"&&!(a.getConstrainResolution()||this.constrainResolution_))return this.trackpadTimeoutId_?clearTimeout(this.trackpadTimeoutId_):(a.getAnimating()&&a.cancelAnimations(),a.beginInteraction()),this.trackpadTimeoutId_=setTimeout(this.endInteraction_.bind(this),this.timeout_),a.adjustZoom(-s/this.deltaPerZoom_,this.lastAnchor_?r.getCoordinateFromPixel(this.lastAnchor_):null),this.startTime_=o,!1;this.totalDelta_+=s;const l=Math.max(this.timeout_-(o-this.startTime_),0);return clearTimeout(this.timeoutId_),this.timeoutId_=setTimeout(this.handleWheelZoom_.bind(this,r),l),!1}handleWheelZoom_(e){const n=e.getView();n.getAnimating()&&n.cancelAnimations();let r=-ct(this.totalDelta_,-this.maxDelta_*this.deltaPerZoom_,this.maxDelta_*this.deltaPerZoom_)/this.deltaPerZoom_;(n.getConstrainResolution()||this.constrainResolution_)&&(r=r?r>0?1:-1:0),Z1(n,r,this.lastAnchor_?e.getCoordinateFromPixel(this.lastAnchor_):null,this.duration_),this.mode_=void 0,this.totalDelta_=0,this.lastAnchor_=null,this.startTime_=void 0,this.timeoutId_=void 0}setMouseAnchor(e){this.useAnchor_=e,e||(this.lastAnchor_=null)}}class pU extends il{constructor(e){e=e||{};const n=e;n.stopDown||(n.stopDown=nu),super(n),this.anchor_=null,this.lastAngle_=void 0,this.rotating_=!1,this.rotationDelta_=0,this.threshold_=e.threshold!==void 0?e.threshold:.3,this.duration_=e.duration!==void 0?e.duration:250}handleDragEvent(e){let n=0;const r=this.targetPointers[0],i=this.targetPointers[1],s=Math.atan2(i.clientY-r.clientY,i.clientX-r.clientX);if(this.lastAngle_!==void 0){const l=s-this.lastAngle_;this.rotationDelta_+=l,!this.rotating_&&Math.abs(this.rotationDelta_)>this.threshold_&&(this.rotating_=!0),n=l}this.lastAngle_=s;const o=e.map,a=o.getView();a.getConstraints().rotation!==Y1&&(this.anchor_=o.getCoordinateFromPixelInternal(o.getEventPixel(J1(this.targetPointers))),this.rotating_&&(o.render(),a.adjustRotationInternal(n,this.anchor_)))}handleUpEvent(e){return this.targetPointers.length<2?(e.map.getView().endInteraction(this.duration_),!1):!0}handleDownEvent(e){if(this.targetPointers.length>=2){const n=e.map;return this.anchor_=null,this.lastAngle_=void 0,this.rotating_=!1,this.rotationDelta_=0,this.handlingDownUpSequence||n.getView().beginInteraction(),!0}return!1}}class mU extends il{constructor(e){e=e||{};const n=e;n.stopDown||(n.stopDown=nu),super(n),this.anchor_=null,this.duration_=e.duration!==void 0?e.duration:400,this.lastDistance_=void 0,this.lastScaleDelta_=1}handleDragEvent(e){let n=1;const r=this.targetPointers[0],i=this.targetPointers[1],s=r.clientX-i.clientX,o=r.clientY-i.clientY,a=Math.sqrt(s*s+o*o);this.lastDistance_!==void 0&&(n=this.lastDistance_/a),this.lastDistance_=a;const l=e.map,c=l.getView();n!=1&&(this.lastScaleDelta_=n),this.anchor_=l.getCoordinateFromPixelInternal(l.getEventPixel(J1(this.targetPointers))),l.render(),c.adjustResolutionInternal(n,this.anchor_)}handleUpEvent(e){if(this.targetPointers.length<2){const r=e.map.getView(),i=this.lastScaleDelta_>1?1:-1;return r.endInteraction(this.duration_,i),!1}return!0}handleDownEvent(e){if(this.targetPointers.length>=2){const n=e.map;return this.anchor_=null,this.lastDistance_=void 0,this.lastScaleDelta_=1,this.handlingDownUpSequence||n.getView().beginInteraction(),!0}return!1}}function yU(t){t=t||{};const e=new Bn,n=new Jz(-.005,.05,100);return(t.altShiftDragRotate!==void 0?t.altShiftDragRotate:!0)&&e.push(new oU),(t.doubleClickZoom!==void 0?t.doubleClickZoom:!0)&&e.push(new eU({delta:t.zoomDelta,duration:t.zoomDuration})),(t.dragPan!==void 0?t.dragPan:!0)&&e.push(new sU({onFocusOnly:t.onFocusOnly,kinetic:n})),(t.pinchRotate!==void 0?t.pinchRotate:!0)&&e.push(new pU),(t.pinchZoom!==void 0?t.pinchZoom:!0)&&e.push(new mU({duration:t.zoomDuration})),(t.keyboard!==void 0?t.keyboard:!0)&&(e.push(new uU),e.push(new dU({delta:t.zoomDelta,duration:t.zoomDuration}))),(t.mouseWheelZoom!==void 0?t.mouseWheelZoom:!0)&&e.push(new gU({onFocusOnly:t.onFocusOnly,duration:t.zoomDuration})),(t.shiftDragZoom!==void 0?t.shiftDragZoom:!0)&&e.push(new cU({duration:t.zoomDuration})),e}const Qe={OPACITY:"opacity",VISIBLE:"visible",EXTENT:"extent",Z_INDEX:"zIndex",MAX_RESOLUTION:"maxResolution",MIN_RESOLUTION:"minResolution",MAX_ZOOM:"maxZoom",MIN_ZOOM:"minZoom",SOURCE:"source",MAP:"map"};class QO extends bi{constructor(e){super(),this.on,this.once,this.un,this.background_=e.background;const n=Object.assign({},e);typeof e.properties=="object"&&(delete n.properties,Object.assign(n,e.properties)),n[Qe.OPACITY]=e.opacity!==void 0?e.opacity:1,ze(typeof n[Qe.OPACITY]=="number","Layer opacity must be a number"),n[Qe.VISIBLE]=e.visible!==void 0?e.visible:!0,n[Qe.Z_INDEX]=e.zIndex,n[Qe.MAX_RESOLUTION]=e.maxResolution!==void 0?e.maxResolution:1/0,n[Qe.MIN_RESOLUTION]=e.minResolution!==void 0?e.minResolution:0,n[Qe.MIN_ZOOM]=e.minZoom!==void 0?e.minZoom:-1/0,n[Qe.MAX_ZOOM]=e.maxZoom!==void 0?e.maxZoom:1/0,this.className_=n.className!==void 0?n.className:"ol-layer",delete n.className,this.setProperties(n),this.state_=null}getBackground(){return this.background_}getClassName(){return this.className_}getLayerState(e){const n=this.state_||{layer:this,managed:e===void 0?!0:e},r=this.getZIndex();return n.opacity=ct(Math.round(this.getOpacity()*100)/100,0,1),n.visible=this.getVisible(),n.extent=this.getExtent(),n.zIndex=r===void 0&&!n.managed?1/0:r,n.maxResolution=this.getMaxResolution(),n.minResolution=Math.max(this.getMinResolution(),0),n.minZoom=this.getMinZoom(),n.maxZoom=this.getMaxZoom(),this.state_=n,n}getLayersArray(e){return Te()}getLayerStatesArray(e){return Te()}getExtent(){return this.get(Qe.EXTENT)}getMaxResolution(){return this.get(Qe.MAX_RESOLUTION)}getMinResolution(){return this.get(Qe.MIN_RESOLUTION)}getMinZoom(){return this.get(Qe.MIN_ZOOM)}getMaxZoom(){return this.get(Qe.MAX_ZOOM)}getOpacity(){return this.get(Qe.OPACITY)}getSourceState(){return Te()}getVisible(){return this.get(Qe.VISIBLE)}getZIndex(){return this.get(Qe.Z_INDEX)}setBackground(e){this.background_=e,this.changed()}setExtent(e){this.set(Qe.EXTENT,e)}setMaxResolution(e){this.set(Qe.MAX_RESOLUTION,e)}setMinResolution(e){this.set(Qe.MIN_RESOLUTION,e)}setMaxZoom(e){this.set(Qe.MAX_ZOOM,e)}setMinZoom(e){this.set(Qe.MIN_ZOOM,e)}setOpacity(e){ze(typeof e=="number","Layer opacity must be a number"),this.set(Qe.OPACITY,e)}setVisible(e){this.set(Qe.VISIBLE,e)}setZIndex(e){this.set(Qe.Z_INDEX,e)}disposeInternal(){this.state_&&(this.state_.layer=null,this.state_=null),super.disposeInternal()}}const Qs={ADDLAYER:"addlayer",REMOVELAYER:"removelayer"};class ho extends Cr{constructor(e,n){super(e),this.layer=n}}const s0={LAYERS:"layers"};class Ds extends QO{constructor(e){e=e||{};const n=Object.assign({},e);delete n.layers;let r=e.layers;super(n),this.on,this.once,this.un,this.layersListenerKeys_=[],this.listenerKeys_={},this.addChangeListener(s0.LAYERS,this.handleLayersChanged_),r?Array.isArray(r)?r=new Bn(r.slice(),{unique:!0}):ze(typeof r.getArray=="function","Expected `layers` to be an array or a `Collection`"):r=new Bn(void 0,{unique:!0}),this.setLayers(r)}handleLayerChange_(){this.changed()}handleLayersChanged_(){this.layersListenerKeys_.forEach(it),this.layersListenerKeys_.length=0;const e=this.getLayers();this.layersListenerKeys_.push(Oe(e,Ht.ADD,this.handleLayersAdd_,this),Oe(e,Ht.REMOVE,this.handleLayersRemove_,this));for(const r in this.listenerKeys_)this.listenerKeys_[r].forEach(it);Qa(this.listenerKeys_);const n=e.getArray();for(let r=0,i=n.length;r<i;r++){const s=n[r];this.registerLayerListeners_(s),this.dispatchEvent(new ho(Qs.ADDLAYER,s))}this.changed()}registerLayerListeners_(e){const n=[Oe(e,Lc.PROPERTYCHANGE,this.handleLayerChange_,this),Oe(e,Se.CHANGE,this.handleLayerChange_,this)];e instanceof Ds&&n.push(Oe(e,Qs.ADDLAYER,this.handleLayerGroupAdd_,this),Oe(e,Qs.REMOVELAYER,this.handleLayerGroupRemove_,this)),this.listenerKeys_[fe(e)]=n}handleLayerGroupAdd_(e){this.dispatchEvent(new ho(Qs.ADDLAYER,e.layer))}handleLayerGroupRemove_(e){this.dispatchEvent(new ho(Qs.REMOVELAYER,e.layer))}handleLayersAdd_(e){const n=e.element;this.registerLayerListeners_(n),this.dispatchEvent(new ho(Qs.ADDLAYER,n)),this.changed()}handleLayersRemove_(e){const n=e.element,r=fe(n);this.listenerKeys_[r].forEach(it),delete this.listenerKeys_[r],this.dispatchEvent(new ho(Qs.REMOVELAYER,n)),this.changed()}getLayers(){return this.get(s0.LAYERS)}setLayers(e){const n=this.getLayers();if(n){const r=n.getArray();for(let i=0,s=r.length;i<s;++i)this.dispatchEvent(new ho(Qs.REMOVELAYER,r[i]))}this.set(s0.LAYERS,e)}getLayersArray(e){return e=e!==void 0?e:[],this.getLayers().forEach(function(n){n.getLayersArray(e)}),e}getLayerStatesArray(e){const n=e!==void 0?e:[],r=n.length;this.getLayers().forEach(function(o){o.getLayerStatesArray(n)});const i=this.getLayerState();let s=i.zIndex;!e&&i.zIndex===void 0&&(s=0);for(let o=r,a=n.length;o<a;o++){const l=n[o];l.opacity*=i.opacity,l.visible=l.visible&&i.visible,l.maxResolution=Math.min(l.maxResolution,i.maxResolution),l.minResolution=Math.max(l.minResolution,i.minResolution),l.minZoom=Math.max(l.minZoom,i.minZoom),l.maxZoom=Math.min(l.maxZoom,i.maxZoom),i.extent!==void 0&&(l.extent!==void 0?l.extent=_i(l.extent,i.extent):l.extent=i.extent),l.zIndex===void 0&&(l.zIndex=s)}return n}getSourceState(){return"ready"}}const un={PRERENDER:"prerender",POSTRENDER:"postrender",PRECOMPOSE:"precompose",POSTCOMPOSE:"postcompose",RENDERCOMPLETE:"rendercomplete"};class lu extends QO{constructor(e){const n=Object.assign({},e);delete n.source,super(n),this.on,this.once,this.un,this.mapPrecomposeKey_=null,this.mapRenderKey_=null,this.sourceChangeKey_=null,this.renderer_=null,this.sourceReady_=!1,this.rendered=!1,e.render&&(this.render=e.render),e.map&&this.setMap(e.map),this.addChangeListener(Qe.SOURCE,this.handleSourcePropertyChange_);const r=e.source?e.source:null;this.setSource(r)}getLayersArray(e){return e=e||[],e.push(this),e}getLayerStatesArray(e){return e=e||[],e.push(this.getLayerState()),e}getSource(){return this.get(Qe.SOURCE)||null}getRenderSource(){return this.getSource()}getSourceState(){const e=this.getSource();return e?e.getState():"undefined"}handleSourceChange_(){this.changed(),!(this.sourceReady_||this.getSource().getState()!=="ready")&&(this.sourceReady_=!0,this.dispatchEvent("sourceready"))}handleSourcePropertyChange_(){this.sourceChangeKey_&&(it(this.sourceChangeKey_),this.sourceChangeKey_=null),this.sourceReady_=!1;const e=this.getSource();e&&(this.sourceChangeKey_=Oe(e,Se.CHANGE,this.handleSourceChange_,this),e.getState()==="ready"&&(this.sourceReady_=!0,setTimeout(()=>{this.dispatchEvent("sourceready")},0))),this.changed()}getFeatures(e){return this.renderer_?this.renderer_.getFeatures(e):Promise.resolve([])}getData(e){return!this.renderer_||!this.rendered?null:this.renderer_.getData(e)}isVisible(e){let n;const r=this.getMapInternal();!e&&r&&(e=r.getView()),e instanceof ki?n={viewState:e.getState(),extent:e.calculateExtent()}:n=e,!n.layerStatesArray&&r&&(n.layerStatesArray=r.getLayerGroup().getLayerStatesArray());let i;if(n.layerStatesArray){if(i=n.layerStatesArray.find(o=>o.layer===this),!i)return!1}else i=this.getLayerState();const s=this.getExtent();return Q1(i,n.viewState)&&(!s||Lt(s,n.extent))}getAttributions(e){var s;if(!this.isVisible(e))return[];const n=(s=this.getSource())==null?void 0:s.getAttributions();if(!n)return[];const r=e instanceof ki?e.getViewStateAndExtent():e;let i=n(r);return Array.isArray(i)||(i=[i]),i}render(e,n){const r=this.getRenderer();return r.prepareFrame(e)?(this.rendered=!0,r.renderFrame(e,n)):null}unrender(){this.rendered=!1}getDeclutter(){}renderDeclutter(e,n){}renderDeferred(e){const n=this.getRenderer();n&&n.renderDeferred(e)}setMapInternal(e){e||this.unrender(),this.set(Qe.MAP,e)}getMapInternal(){return this.get(Qe.MAP)}setMap(e){this.mapPrecomposeKey_&&(it(this.mapPrecomposeKey_),this.mapPrecomposeKey_=null),e||this.changed(),this.mapRenderKey_&&(it(this.mapRenderKey_),this.mapRenderKey_=null),e&&(this.mapPrecomposeKey_=Oe(e,un.PRECOMPOSE,this.handlePrecompose_,this),this.mapRenderKey_=Oe(this,Se.CHANGE,e.render,e),this.changed())}handlePrecompose_(e){const n=e.frameState.layerStatesArray,r=this.getLayerState(!1);ze(!n.some(i=>i.layer===r.layer),"A layer can only be added to the map once. Use either `layer.setMap()` or `map.addLayer()`, not both."),n.push(r)}setSource(e){this.set(Qe.SOURCE,e)}getRenderer(){return this.renderer_||(this.renderer_=this.createRenderer()),this.renderer_}hasRenderer(){return!!this.renderer_}createRenderer(){return null}clearRenderer(){this.renderer_&&(this.renderer_.dispose(),delete this.renderer_)}disposeInternal(){this.clearRenderer(),this.setSource(null),super.disposeInternal()}}function Q1(t,e){if(!t.visible)return!1;const n=e.resolution;if(n<t.minResolution||n>=t.maxResolution)return!1;const r=e.zoom;return r>t.minZoom&&r<=t.maxZoom}function e$(t,e,n=0,r=t.length-1,i=_U){for(;r>n;){if(r-n>600){const l=r-n+1,c=e-n+1,u=Math.log(l),d=.5*Math.exp(2*u/3),h=.5*Math.sqrt(u*d*(l-d)/l)*(c-l/2<0?-1:1),f=Math.max(n,Math.floor(e-c*d/l+h)),p=Math.min(r,Math.floor(e+(l-c)*d/l+h));e$(t,e,f,p,i)}const s=t[e];let o=n,a=r;for(Vu(t,n,e),i(t[r],s)>0&&Vu(t,n,r);o<a;){for(Vu(t,o,a),o++,a--;i(t[o],s)<0;)o++;for(;i(t[a],s)>0;)a--}i(t[n],s)===0?Vu(t,n,a):(a++,Vu(t,a,r)),a<=e&&(n=a+1),e<=a&&(r=a-1)}}function Vu(t,e,n){const r=t[e];t[e]=t[n],t[n]=r}function _U(t,e){return t<e?-1:t>e?1:0}let t$=class{constructor(e=9){this._maxEntries=Math.max(4,e),this._minEntries=Math.max(2,Math.ceil(this._maxEntries*.4)),this.clear()}all(){return this._all(this.data,[])}search(e){let n=this.data;const r=[];if(!Lf(e,n))return r;const i=this.toBBox,s=[];for(;n;){for(let o=0;o<n.children.length;o++){const a=n.children[o],l=n.leaf?i(a):a;Lf(e,l)&&(n.leaf?r.push(a):a0(e,l)?this._all(a,r):s.push(a))}n=s.pop()}return r}collides(e){let n=this.data;if(!Lf(e,n))return!1;const r=[];for(;n;){for(let i=0;i<n.children.length;i++){const s=n.children[i],o=n.leaf?this.toBBox(s):s;if(Lf(e,o)){if(n.leaf||a0(e,o))return!0;r.push(s)}}n=r.pop()}return!1}load(e){if(!(e&&e.length))return this;if(e.length<this._minEntries){for(let r=0;r<e.length;r++)this.insert(e[r]);return this}let n=this._build(e.slice(),0,e.length-1,0);if(!this.data.children.length)this.data=n;else if(this.data.height===n.height)this._splitRoot(this.data,n);else{if(this.data.height<n.height){const r=this.data;this.data=n,n=r}this._insert(n,this.data.height-n.height-1,!0)}return this}insert(e){return e&&this._insert(e,this.data.height-1),this}clear(){return this.data=Dl([]),this}remove(e,n){if(!e)return this;let r=this.data;const i=this.toBBox(e),s=[],o=[];let a,l,c;for(;r||s.length;){if(r||(r=s.pop(),l=s[s.length-1],a=o.pop(),c=!0),r.leaf){const u=vU(e,r.children,n);if(u!==-1)return r.children.splice(u,1),s.push(r),this._condense(s),this}!c&&!r.leaf&&a0(r,i)?(s.push(r),o.push(a),a=0,l=r,r=r.children[0]):l?(a++,r=l.children[a],c=!1):r=null}return this}toBBox(e){return e}compareMinX(e,n){return e.minX-n.minX}compareMinY(e,n){return e.minY-n.minY}toJSON(){return this.data}fromJSON(e){return this.data=e,this}_all(e,n){const r=[];for(;e;)e.leaf?n.push(...e.children):r.push(...e.children),e=r.pop();return n}_build(e,n,r,i){const s=r-n+1;let o=this._maxEntries,a;if(s<=o)return a=Dl(e.slice(n,r+1)),El(a,this.toBBox),a;i||(i=Math.ceil(Math.log(s)/Math.log(o)),o=Math.ceil(s/Math.pow(o,i-1))),a=Dl([]),a.leaf=!1,a.height=i;const l=Math.ceil(s/o),c=l*Math.ceil(Math.sqrt(o));MT(e,n,r,c,this.compareMinX);for(let u=n;u<=r;u+=c){const d=Math.min(u+c-1,r);MT(e,u,d,l,this.compareMinY);for(let h=u;h<=d;h+=l){const f=Math.min(h+l-1,d);a.children.push(this._build(e,h,f,i-1))}}return El(a,this.toBBox),a}_chooseSubtree(e,n,r,i){for(;i.push(n),!(n.leaf||i.length-1===r);){let s=1/0,o=1/0,a;for(let l=0;l<n.children.length;l++){const c=n.children[l],u=o0(c),d=EU(e,c)-u;d<o?(o=d,s=u<s?u:s,a=c):d===o&&u<s&&(s=u,a=c)}n=a||n.children[0]}return n}_insert(e,n,r){const i=r?e:this.toBBox(e),s=[],o=this._chooseSubtree(i,this.data,n,s);for(o.children.push(e),ad(o,i);n>=0&&s[n].children.length>this._maxEntries;)this._split(s,n),n--;this._adjustParentBBoxes(i,s,n)}_split(e,n){const r=e[n],i=r.children.length,s=this._minEntries;this._chooseSplitAxis(r,s,i);const o=this._chooseSplitIndex(r,s,i),a=Dl(r.children.splice(o,r.children.length-o));a.height=r.height,a.leaf=r.leaf,El(r,this.toBBox),El(a,this.toBBox),n?e[n-1].children.push(a):this._splitRoot(r,a)}_splitRoot(e,n){this.data=Dl([e,n]),this.data.height=e.height+1,this.data.leaf=!1,El(this.data,this.toBBox)}_chooseSplitIndex(e,n,r){let i,s=1/0,o=1/0;for(let a=n;a<=r-n;a++){const l=od(e,0,a,this.toBBox),c=od(e,a,r,this.toBBox),u=SU(l,c),d=o0(l)+o0(c);u<s?(s=u,i=a,o=d<o?d:o):u===s&&d<o&&(o=d,i=a)}return i||r-n}_chooseSplitAxis(e,n,r){const i=e.leaf?this.compareMinX:wU,s=e.leaf?this.compareMinY:xU,o=this._allDistMargin(e,n,r,i),a=this._allDistMargin(e,n,r,s);o<a&&e.children.sort(i)}_allDistMargin(e,n,r,i){e.children.sort(i);const s=this.toBBox,o=od(e,0,n,s),a=od(e,r-n,r,s);let l=$f(o)+$f(a);for(let c=n;c<r-n;c++){const u=e.children[c];ad(o,e.leaf?s(u):u),l+=$f(o)}for(let c=r-n-1;c>=n;c--){const u=e.children[c];ad(a,e.leaf?s(u):u),l+=$f(a)}return l}_adjustParentBBoxes(e,n,r){for(let i=r;i>=0;i--)ad(n[i],e)}_condense(e){for(let n=e.length-1,r;n>=0;n--)e[n].children.length===0?n>0?(r=e[n-1].children,r.splice(r.indexOf(e[n]),1)):this.clear():El(e[n],this.toBBox)}};function vU(t,e,n){if(!n)return e.indexOf(t);for(let r=0;r<e.length;r++)if(n(t,e[r]))return r;return-1}function El(t,e){od(t,0,t.children.length,e,t)}function od(t,e,n,r,i){i||(i=Dl(null)),i.minX=1/0,i.minY=1/0,i.maxX=-1/0,i.maxY=-1/0;for(let s=e;s<n;s++){const o=t.children[s];ad(i,t.leaf?r(o):o)}return i}function ad(t,e){return t.minX=Math.min(t.minX,e.minX),t.minY=Math.min(t.minY,e.minY),t.maxX=Math.max(t.maxX,e.maxX),t.maxY=Math.max(t.maxY,e.maxY),t}function wU(t,e){return t.minX-e.minX}function xU(t,e){return t.minY-e.minY}function o0(t){return(t.maxX-t.minX)*(t.maxY-t.minY)}function $f(t){return t.maxX-t.minX+(t.maxY-t.minY)}function EU(t,e){return(Math.max(e.maxX,t.maxX)-Math.min(e.minX,t.minX))*(Math.max(e.maxY,t.maxY)-Math.min(e.minY,t.minY))}function SU(t,e){const n=Math.max(t.minX,e.minX),r=Math.max(t.minY,e.minY),i=Math.min(t.maxX,e.maxX),s=Math.min(t.maxY,e.maxY);return Math.max(0,i-n)*Math.max(0,s-r)}function a0(t,e){return t.minX<=e.minX&&t.minY<=e.minY&&e.maxX<=t.maxX&&e.maxY<=t.maxY}function Lf(t,e){return e.minX<=t.maxX&&e.minY<=t.maxY&&e.maxX>=t.minX&&e.maxY>=t.minY}function Dl(t){return{children:t,height:1,leaf:!0,minX:1/0,minY:1/0,maxX:-1/0,maxY:-1/0}}function MT(t,e,n,r,i){const s=[e,n];for(;s.length;){if(n=s.pop(),e=s.pop(),n-e<=r)continue;const o=e+Math.ceil((n-e)/r/2)*r;e$(t,o,e,n,i),s.push(e,o,o,n)}}let sl=0;const Kt=1<<sl++,_e=1<<sl++,Jt=1<<sl++,Rt=1<<sl++,cr=1<<sl++,Ur=1<<sl++,kf=Math.pow(2,sl)-1,eE={[Kt]:"boolean",[_e]:"number",[Jt]:"string",[Rt]:"color",[cr]:"number[]",[Ur]:"size"},bU=Object.keys(eE).map(Number).sort(Hi);function CU(t){return t in eE}function nc(t){const e=[];for(const n of bU)ld(t,n)&&e.push(eE[n]);return e.length===0?"untyped":e.length<3?e.join(" or "):e.slice(0,-1).join(", ")+", or "+e[e.length-1]}function ld(t,e){return(t&e)===e}function $i(t,e){return t===e}class Xt{constructor(e,n){if(!CU(e))throw new Error(`literal expressions must have a specific type, got ${nc(e)}`);this.type=e,this.value=n}}class n${constructor(e,n,...r){this.type=e,this.operator=n,this.args=r}}function tE(){return{variables:new Set,properties:new Set,featureId:!1,geometryType:!1,mapState:!1}}function hn(t,e,n){switch(typeof t){case"boolean":{if($i(e,Jt))return new Xt(Jt,t?"true":"false");if(!ld(e,Kt))throw new Error(`got a boolean, but expected ${nc(e)}`);return new Xt(Kt,t)}case"number":{if($i(e,Ur))return new Xt(Ur,dn(t));if($i(e,Kt))return new Xt(Kt,!!t);if($i(e,Jt))return new Xt(Jt,t.toString());if(!ld(e,_e))throw new Error(`got a number, but expected ${nc(e)}`);return new Xt(_e,t)}case"string":{if($i(e,Rt))return new Xt(Rt,y1(t));if($i(e,Kt))return new Xt(Kt,!!t);if(!ld(e,Jt))throw new Error(`got a string, but expected ${nc(e)}`);return new Xt(Jt,t)}}if(!Array.isArray(t))throw new Error("expression must be an array or a primitive value");if(t.length===0)throw new Error("empty expression");if(typeof t[0]=="string")return MU(t,e,n);for(const r of t)if(typeof r!="number")throw new Error("expected an array of numbers");if($i(e,Ur)){if(t.length!==2)throw new Error(`expected an array of two values for a size, got ${t.length}`);return new Xt(Ur,t)}if($i(e,Rt)){if(t.length===3)return new Xt(Rt,[...t,1]);if(t.length===4)return new Xt(Rt,t);throw new Error(`expected an array of 3 or 4 values for a color, got ${t.length}`)}if(!ld(e,cr))throw new Error(`got an array of numbers, but expected ${nc(e)}`);return new Xt(cr,t)}const Z={Get:"get",Var:"var",Concat:"concat",GeometryType:"geometry-type",LineMetric:"line-metric",Any:"any",All:"all",Not:"!",Resolution:"resolution",Zoom:"zoom",Time:"time",Equal:"==",NotEqual:"!=",GreaterThan:">",GreaterThanOrEqualTo:">=",LessThan:"<",LessThanOrEqualTo:"<=",Multiply:"*",Divide:"/",Add:"+",Subtract:"-",Clamp:"clamp",Mod:"%",Pow:"^",Abs:"abs",Floor:"floor",Ceil:"ceil",Round:"round",Sin:"sin",Cos:"cos",Atan:"atan",Sqrt:"sqrt",Match:"match",Between:"between",Interpolate:"interpolate",Coalesce:"coalesce",Case:"case",In:"in",Number:"number",String:"string",Array:"array",Color:"color",Id:"id",Band:"band",Palette:"palette",ToString:"to-string",Has:"has"},TU={[Z.Get]:Pe(Ae(1,1/0),DT),[Z.Var]:Pe(Ae(1,1),PU),[Z.Has]:Pe(Ae(1,1/0),DT),[Z.Id]:Pe(RU,Sl),[Z.Concat]:Pe(Ae(2,1/0),Je(Jt)),[Z.GeometryType]:Pe(IU,Sl),[Z.LineMetric]:Pe(Sl),[Z.Resolution]:Pe(l0,Sl),[Z.Zoom]:Pe(l0,Sl),[Z.Time]:Pe(l0,Sl),[Z.Any]:Pe(Ae(2,1/0),Je(Kt)),[Z.All]:Pe(Ae(2,1/0),Je(Kt)),[Z.Not]:Pe(Ae(1,1),Je(Kt)),[Z.Equal]:Pe(Ae(2,2),Je(kf)),[Z.NotEqual]:Pe(Ae(2,2),Je(kf)),[Z.GreaterThan]:Pe(Ae(2,2),Je(_e)),[Z.GreaterThanOrEqualTo]:Pe(Ae(2,2),Je(_e)),[Z.LessThan]:Pe(Ae(2,2),Je(_e)),[Z.LessThanOrEqualTo]:Pe(Ae(2,2),Je(_e)),[Z.Multiply]:Pe(Ae(2,1/0),NT),[Z.Coalesce]:Pe(Ae(2,1/0),NT),[Z.Divide]:Pe(Ae(2,2),Je(_e)),[Z.Add]:Pe(Ae(2,1/0),Je(_e)),[Z.Subtract]:Pe(Ae(2,2),Je(_e)),[Z.Clamp]:Pe(Ae(3,3),Je(_e)),[Z.Mod]:Pe(Ae(2,2),Je(_e)),[Z.Pow]:Pe(Ae(2,2),Je(_e)),[Z.Abs]:Pe(Ae(1,1),Je(_e)),[Z.Floor]:Pe(Ae(1,1),Je(_e)),[Z.Ceil]:Pe(Ae(1,1),Je(_e)),[Z.Round]:Pe(Ae(1,1),Je(_e)),[Z.Sin]:Pe(Ae(1,1),Je(_e)),[Z.Cos]:Pe(Ae(1,1),Je(_e)),[Z.Atan]:Pe(Ae(1,2),Je(_e)),[Z.Sqrt]:Pe(Ae(1,1),Je(_e)),[Z.Match]:Pe(Ae(4,1/0),jT,FU),[Z.Between]:Pe(Ae(3,3),Je(_e)),[Z.Interpolate]:Pe(Ae(6,1/0),jT,OU),[Z.Case]:Pe(Ae(3,1/0),AU,$U),[Z.In]:Pe(Ae(2,2),LU),[Z.Number]:Pe(Ae(1,1/0),Je(kf)),[Z.String]:Pe(Ae(1,1/0),Je(kf)),[Z.Array]:Pe(Ae(1,1/0),Je(_e)),[Z.Color]:Pe(Ae(1,4),Je(_e)),[Z.Band]:Pe(Ae(1,3),Je(_e)),[Z.Palette]:Pe(Ae(2,2),kU),[Z.ToString]:Pe(Ae(1,1),Je(Kt|_e|Jt|Rt))};function DT(t,e,n){const r=t.length-1,i=new Array(r);for(let s=0;s<r;++s){const o=t[s+1];switch(typeof o){case"number":{i[s]=new Xt(_e,o);break}case"string":{i[s]=new Xt(Jt,o);break}default:throw new Error(`expected a string key or numeric array index for a get operation, got ${o}`)}s===0&&n.properties.add(String(o))}return i}function PU(t,e,n){const r=t[1];if(typeof r!="string")throw new Error("expected a string argument for var operation");return n.variables.add(r),[new Xt(Jt,r)]}function RU(t,e,n){n.featureId=!0}function IU(t,e,n){n.geometryType=!0}function l0(t,e,n){n.mapState=!0}function Sl(t,e,n){const r=t[0];if(t.length!==1)throw new Error(`expected no arguments for ${r} operation`);return[]}function Ae(t,e){return function(n,r,i){const s=n[0],o=n.length-1;if(t===e){if(o!==t){const a=t===1?"":"s";throw new Error(`expected ${t} argument${a} for ${s}, got ${o}`)}}else if(o<t||o>e){const a=e===1/0?`${t} or more`:`${t} to ${e}`;throw new Error(`expected ${a} arguments for ${s}, got ${o}`)}}}function NT(t,e,n){const r=t.length-1,i=new Array(r);for(let s=0;s<r;++s){const o=hn(t[s+1],e,n);i[s]=o}return i}function Je(t){return function(e,n,r){const i=e.length-1,s=new Array(i);for(let o=0;o<i;++o){const a=hn(e[o+1],t,r);s[o]=a}return s}}function AU(t,e,n){const r=t[0],i=t.length-1;if(i%2===0)throw new Error(`expected an odd number of arguments for ${r}, got ${i} instead`)}function jT(t,e,n){const r=t[0],i=t.length-1;if(i%2===1)throw new Error(`expected an even number of arguments for operation ${r}, got ${i} instead`)}function FU(t,e,n){const r=t.length-1,i=Jt|_e|Kt,s=hn(t[1],i,n),o=hn(t[t.length-1],e,n),a=new Array(r-2);for(let l=0;l<r-2;l+=2){try{const c=hn(t[l+2],s.type,n);a[l]=c}catch(c){throw new Error(`failed to parse argument ${l+1} of match expression: ${c.message}`)}try{const c=hn(t[l+3],o.type,n);a[l+1]=c}catch(c){throw new Error(`failed to parse argument ${l+2} of match expression: ${c.message}`)}}return[s,...a,o]}function OU(t,e,n){const r=t[1];let i;switch(r[0]){case"linear":i=1;break;case"exponential":const l=r[1];if(typeof l!="number"||l<=0)throw new Error(`expected a number base for exponential interpolation, got ${JSON.stringify(l)} instead`);i=l;break;default:throw new Error(`invalid interpolation type: ${JSON.stringify(r)}`)}const s=new Xt(_e,i);let o;try{o=hn(t[2],_e,n)}catch(l){throw new Error(`failed to parse argument 1 in interpolate expression: ${l.message}`)}const a=new Array(t.length-3);for(let l=0;l<a.length;l+=2){try{const c=hn(t[l+3],_e,n);a[l]=c}catch(c){throw new Error(`failed to parse argument ${l+2} for interpolate expression: ${c.message}`)}try{const c=hn(t[l+4],e,n);a[l+1]=c}catch(c){throw new Error(`failed to parse argument ${l+3} for interpolate expression: ${c.message}`)}}return[s,o,...a]}function $U(t,e,n){const r=hn(t[t.length-1],e,n),i=new Array(t.length-1);for(let s=0;s<i.length-1;s+=2){try{const o=hn(t[s+1],Kt,n);i[s]=o}catch(o){throw new Error(`failed to parse argument ${s} of case expression: ${o.message}`)}try{const o=hn(t[s+2],r.type,n);i[s+1]=o}catch(o){throw new Error(`failed to parse argument ${s+1} of case expression: ${o.message}`)}}return i[i.length-1]=r,i}function LU(t,e,n){let r=t[2];if(!Array.isArray(r))throw new Error('the second argument for the "in" operator must be an array');let i;if(typeof r[0]=="string"){if(r[0]!=="literal")throw new Error('for the "in" operator, a string array should be wrapped in a "literal" operator to disambiguate from expressions');if(!Array.isArray(r[1]))throw new Error('failed to parse "in" expression: the literal operator must be followed by an array');r=r[1],i=Jt}else i=_e;const s=new Array(r.length);for(let a=0;a<s.length;a++)try{const l=hn(r[a],i,n);s[a]=l}catch(l){throw new Error(`failed to parse haystack item ${a} for "in" expression: ${l.message}`)}return[hn(t[1],i,n),...s]}function kU(t,e,n){let r;try{r=hn(t[1],_e,n)}catch(o){throw new Error(`failed to parse first argument in palette expression: ${o.message}`)}const i=t[2];if(!Array.isArray(i))throw new Error("the second argument of palette must be an array");const s=new Array(i.length);for(let o=0;o<s.length;o++){let a;try{a=hn(i[o],Rt,n)}catch(l){throw new Error(`failed to parse color at index ${o} in palette expression: ${l.message}`)}if(!(a instanceof Xt))throw new Error(`the palette color at index ${o} must be a literal value`);s[o]=a}return[r,...s]}function Pe(...t){return function(e,n,r){const i=e[0];let s;for(let o=0;o<t.length;o++){const a=t[o](e,n,r);if(o==t.length-1){if(!a)throw new Error("expected last argument validator to return the parsed args");s=a}}return new n$(n,i,...s)}}function MU(t,e,n){const r=t[0],i=TU[r];if(!i)throw new Error(`unknown operator: ${r}`);return i(t,e,n)}function nE(t){if(!t)return"";const e=t.getType();switch(e){case"Point":case"LineString":case"Polygon":return e;case"MultiPoint":case"MultiLineString":case"MultiPolygon":return e.substring(5);case"Circle":return"Polygon";case"GeometryCollection":return nE(t.getGeometries()[0]);default:return""}}function r$(){return{variables:{},properties:{},resolution:NaN,featureId:null,geometryType:""}}function Ws(t,e,n){const r=hn(t,e,n);return Ei(r)}function Ei(t,e){if(t instanceof Xt){if(t.type===Rt&&typeof t.value=="string"){const r=y1(t.value);return function(){return r}}return function(){return t.value}}const n=t.operator;switch(n){case Z.Number:case Z.String:case Z.Coalesce:return DU(t);case Z.Get:case Z.Var:case Z.Has:return NU(t);case Z.Id:return r=>r.featureId;case Z.GeometryType:return r=>r.geometryType;case Z.Concat:{const r=t.args.map(i=>Ei(i));return i=>"".concat(...r.map(s=>s(i).toString()))}case Z.Resolution:return r=>r.resolution;case Z.Any:case Z.All:case Z.Between:case Z.In:case Z.Not:return zU(t);case Z.Equal:case Z.NotEqual:case Z.LessThan:case Z.LessThanOrEqualTo:case Z.GreaterThan:case Z.GreaterThanOrEqualTo:return jU(t);case Z.Multiply:case Z.Divide:case Z.Add:case Z.Subtract:case Z.Clamp:case Z.Mod:case Z.Pow:case Z.Abs:case Z.Floor:case Z.Ceil:case Z.Round:case Z.Sin:case Z.Cos:case Z.Atan:case Z.Sqrt:return UU(t);case Z.Case:return GU(t);case Z.Match:return BU(t);case Z.Interpolate:return VU(t);case Z.ToString:return WU(t);default:throw new Error(`Unsupported operator ${n}`)}}function DU(t,e){const n=t.operator,r=t.args.length,i=new Array(r);for(let s=0;s<r;++s)i[s]=Ei(t.args[s]);switch(n){case Z.Coalesce:return s=>{for(let o=0;o<r;++o){const a=i[o](s);if(typeof a<"u"&&a!==null)return a}throw new Error("Expected one of the values to be non-null")};case Z.Number:case Z.String:return s=>{for(let o=0;o<r;++o){const a=i[o](s);if(typeof a===n)return a}throw new Error(`Expected one of the values to be a ${n}`)};default:throw new Error(`Unsupported assertion operator ${n}`)}}function NU(t,e){const r=t.args[0].value;switch(t.operator){case Z.Get:return i=>{const s=t.args;let o=i.properties[r];for(let a=1,l=s.length;a<l;++a){const u=s[a].value;o=o[u]}return o};case Z.Var:return i=>i.variables[r];case Z.Has:return i=>{const s=t.args;if(!(r in i.properties))return!1;let o=i.properties[r];for(let a=1,l=s.length;a<l;++a){const u=s[a].value;if(!o||!Object.hasOwn(o,u))return!1;o=o[u]}return!0};default:throw new Error(`Unsupported accessor operator ${t.operator}`)}}function jU(t,e){const n=t.operator,r=Ei(t.args[0]),i=Ei(t.args[1]);switch(n){case Z.Equal:return s=>r(s)===i(s);case Z.NotEqual:return s=>r(s)!==i(s);case Z.LessThan:return s=>r(s)<i(s);case Z.LessThanOrEqualTo:return s=>r(s)<=i(s);case Z.GreaterThan:return s=>r(s)>i(s);case Z.GreaterThanOrEqualTo:return s=>r(s)>=i(s);default:throw new Error(`Unsupported comparison operator ${n}`)}}function zU(t,e){const n=t.operator,r=t.args.length,i=new Array(r);for(let s=0;s<r;++s)i[s]=Ei(t.args[s]);switch(n){case Z.Any:return s=>{for(let o=0;o<r;++o)if(i[o](s))return!0;return!1};case Z.All:return s=>{for(let o=0;o<r;++o)if(!i[o](s))return!1;return!0};case Z.Between:return s=>{const o=i[0](s),a=i[1](s),l=i[2](s);return o>=a&&o<=l};case Z.In:return s=>{const o=i[0](s);for(let a=1;a<r;++a)if(o===i[a](s))return!0;return!1};case Z.Not:return s=>!i[0](s);default:throw new Error(`Unsupported logical operator ${n}`)}}function UU(t,e){const n=t.operator,r=t.args.length,i=new Array(r);for(let s=0;s<r;++s)i[s]=Ei(t.args[s]);switch(n){case Z.Multiply:return s=>{let o=1;for(let a=0;a<r;++a)o*=i[a](s);return o};case Z.Divide:return s=>i[0](s)/i[1](s);case Z.Add:return s=>{let o=0;for(let a=0;a<r;++a)o+=i[a](s);return o};case Z.Subtract:return s=>i[0](s)-i[1](s);case Z.Clamp:return s=>{const o=i[0](s),a=i[1](s);if(o<a)return a;const l=i[2](s);return o>l?l:o};case Z.Mod:return s=>i[0](s)%i[1](s);case Z.Pow:return s=>Math.pow(i[0](s),i[1](s));case Z.Abs:return s=>Math.abs(i[0](s));case Z.Floor:return s=>Math.floor(i[0](s));case Z.Ceil:return s=>Math.ceil(i[0](s));case Z.Round:return s=>Math.round(i[0](s));case Z.Sin:return s=>Math.sin(i[0](s));case Z.Cos:return s=>Math.cos(i[0](s));case Z.Atan:return r===2?s=>Math.atan2(i[0](s),i[1](s)):s=>Math.atan(i[0](s));case Z.Sqrt:return s=>Math.sqrt(i[0](s));default:throw new Error(`Unsupported numeric operator ${n}`)}}function GU(t,e){const n=t.args.length,r=new Array(n);for(let i=0;i<n;++i)r[i]=Ei(t.args[i]);return i=>{for(let s=0;s<n-1;s+=2)if(r[s](i))return r[s+1](i);return r[n-1](i)}}function BU(t,e){const n=t.args.length,r=new Array(n);for(let i=0;i<n;++i)r[i]=Ei(t.args[i]);return i=>{const s=r[0](i);for(let o=1;o<n-1;o+=2)if(s===r[o](i))return r[o+1](i);return r[n-1](i)}}function VU(t,e){const n=t.args.length,r=new Array(n);for(let i=0;i<n;++i)r[i]=Ei(t.args[i]);return i=>{const s=r[0](i),o=r[1](i);let a,l;for(let c=2;c<n;c+=2){const u=r[c](i);let d=r[c+1](i);const h=Array.isArray(d);if(h&&(d=a4(d)),u>=o)return c===2?d:h?HU(s,o,a,l,u,d):cd(s,o,a,l,u,d);a=u,l=d}return l}}function WU(t,e){const n=t.operator,r=t.args.length,i=new Array(r);for(let s=0;s<r;++s)i[s]=Ei(t.args[s]);switch(n){case Z.ToString:return s=>{const o=i[0](s);return t.args[0].type===Rt?_1(o):o.toString()};default:throw new Error(`Unsupported convert operator ${n}`)}}function cd(t,e,n,r,i,s){const o=i-n;if(o===0)return r;const a=e-n,l=t===1?a/o:(Math.pow(t,a)-1)/(Math.pow(t,o)-1);return r+l*(s-r)}function HU(t,e,n,r,i,s){if(i-n===0)return r;const a=iT(r),l=iT(s);let c=l[2]-a[2];c>180?c-=360:c<-180&&(c+=360);const u=[cd(t,e,n,a[0],i,l[0]),cd(t,e,n,a[1],i,l[1]),a[2]+cd(t,e,n,0,i,c),cd(t,e,n,r[3],i,s[3])];return l4(u)}function KU(t){return!0}function YU(t){const e=tE(),n=XU(t,e),r=r$();return function(i,s){if(r.properties=i.getPropertiesInternal(),r.resolution=s,e.featureId){const o=i.getId();o!==void 0?r.featureId=o:r.featureId=null}return e.geometryType&&(r.geometryType=nE(i.getGeometry())),n(r)}}function zT(t){const e=tE(),n=t.length,r=new Array(n);for(let o=0;o<n;++o)r[o]=Ew(t[o],e);const i=r$(),s=new Array(n);return function(o,a){if(i.properties=o.getPropertiesInternal(),i.resolution=a,e.featureId){const c=o.getId();c!==void 0?i.featureId=c:i.featureId=null}let l=0;for(let c=0;c<n;++c){const u=r[c](i);u&&(s[l]=u,l+=1)}return s.length=l,s}}function XU(t,e){const n=t.length,r=new Array(n);for(let i=0;i<n;++i){const s=t[i],o="filter"in s?Ws(s.filter,Kt,e):KU;let a;if(Array.isArray(s.style)){const l=s.style.length;a=new Array(l);for(let c=0;c<l;++c)a[c]=Ew(s.style[c],e)}else a=[Ew(s.style,e)];r[i]={filter:o,styles:a}}return function(i){const s=[];let o=!1;for(let a=0;a<n;++a){const l=r[a].filter;if(l(i)&&!(t[a].else&&o)){o=!0;for(const c of r[a].styles){const u=c(i);u&&s.push(u)}}}return s}}function Ew(t,e){const n=dh(t,"",e),r=hh(t,"",e),i=ZU(t,e),s=qU(t,e),o=er(t,"z-index",e);if(!n&&!r&&!i&&!s&&!Uo(t))throw new Error("No fill, stroke, point, or text symbolizer properties in style: "+JSON.stringify(t));const a=new nt;return function(l){let c=!0;if(n){const u=n(l);u&&(c=!1),a.setFill(u)}if(r){const u=r(l);u&&(c=!1),a.setStroke(u)}if(i){const u=i(l);u&&(c=!1),a.setText(u)}if(s){const u=s(l);u&&(c=!1),a.setImage(u)}return o&&a.setZIndex(o(l)),c?null:a}}function dh(t,e,n){let r;if(e+"fill-pattern-src"in t)r=tG(t,e+"fill-",n);else{if(t[e+"fill-color"]==="none")return s=>null;r=rE(t,e+"fill-color",n)}if(!r)return null;const i=new Wt;return function(s){const o=r(s);return o===m1?null:(i.setColor(o),i)}}function hh(t,e,n){const r=er(t,e+"stroke-width",n),i=rE(t,e+"stroke-color",n);if(!r&&!i)return null;const s=_s(t,e+"stroke-line-cap",n),o=_s(t,e+"stroke-line-join",n),a=i$(t,e+"stroke-line-dash",n),l=er(t,e+"stroke-line-dash-offset",n),c=er(t,e+"stroke-miter-limit",n),u=new yt;return function(d){if(i){const h=i(d);if(h===m1)return null;u.setColor(h)}if(r&&u.setWidth(r(d)),s){const h=s(d);if(h!=="butt"&&h!=="round"&&h!=="square")throw new Error("Expected butt, round, or square line cap");u.setLineCap(h)}if(o){const h=o(d);if(h!=="bevel"&&h!=="round"&&h!=="miter")throw new Error("Expected bevel, round, or miter line join");u.setLineJoin(h)}return a&&u.setLineDash(a(d)),l&&u.setLineDashOffset(l(d)),c&&u.setMiterLimit(c(d)),u}}function ZU(t,e){const n="text-",r=_s(t,n+"value",e);if(!r)return null;const i=dh(t,n,e),s=dh(t,n+"background-",e),o=hh(t,n,e),a=hh(t,n+"background-",e),l=_s(t,n+"font",e),c=er(t,n+"max-angle",e),u=er(t,n+"offset-x",e),d=er(t,n+"offset-y",e),h=yc(t,n+"overflow",e),f=_s(t,n+"placement",e),p=er(t,n+"repeat",e),m=ly(t,n+"scale",e),_=yc(t,n+"rotate-with-view",e),g=er(t,n+"rotation",e),y=_s(t,n+"align",e),v=_s(t,n+"justify",e),w=_s(t,n+"baseline",e),x=yc(t,n+"keep-upright",e),S=i$(t,n+"padding",e),C=cy(t,n+"declutter-mode"),T=new Zo({declutterMode:C});return function(P){if(T.setText(r(P)),i&&T.setFill(i(P)),s&&T.setBackgroundFill(s(P)),o&&T.setStroke(o(P)),a&&T.setBackgroundStroke(a(P)),l&&T.setFont(l(P)),c&&T.setMaxAngle(c(P)),u&&T.setOffsetX(u(P)),d&&T.setOffsetY(d(P)),h&&T.setOverflow(h(P)),f){const F=f(P);if(F!=="point"&&F!=="line")throw new Error("Expected point or line for text-placement");T.setPlacement(F)}if(p&&T.setRepeat(p(P)),m&&T.setScale(m(P)),_&&T.setRotateWithView(_(P)),g&&T.setRotation(g(P)),y){const F=y(P);if(F!=="left"&&F!=="center"&&F!=="right"&&F!=="end"&&F!=="start")throw new Error("Expected left, right, center, start, or end for text-align");T.setTextAlign(F)}if(v){const F=v(P);if(F!=="left"&&F!=="right"&&F!=="center")throw new Error("Expected left, right, or center for text-justify");T.setJustify(F)}if(w){const F=w(P);if(F!=="bottom"&&F!=="top"&&F!=="middle"&&F!=="alphabetic"&&F!=="hanging")throw new Error("Expected bottom, top, middle, alphabetic, or hanging for text-baseline");T.setTextBaseline(F)}return S&&T.setPadding(S(P)),x&&T.setKeepUpright(x(P)),T}}function qU(t,e){return"icon-src"in t?JU(t,e):"shape-points"in t?QU(t,e):"circle-radius"in t?eG(t,e):null}function JU(t,e){const n="icon-",r=n+"src",i=s$(t[r],r),s=Gp(t,n+"anchor",e),o=ly(t,n+"scale",e),a=er(t,n+"opacity",e),l=Gp(t,n+"displacement",e),c=er(t,n+"rotation",e),u=yc(t,n+"rotate-with-view",e),d=GT(t,n+"anchor-origin"),h=BT(t,n+"anchor-x-units"),f=BT(t,n+"anchor-y-units"),p=sG(t,n+"color"),m=rG(t,n+"cross-origin"),_=iG(t,n+"offset"),g=GT(t,n+"offset-origin"),y=Bp(t,n+"width"),v=Bp(t,n+"height"),w=nG(t,n+"size"),x=cy(t,n+"declutter-mode"),S=new Go({src:i,anchorOrigin:d,anchorXUnits:h,anchorYUnits:f,color:p,crossOrigin:m,offset:_,offsetOrigin:g,height:v,width:y,size:w,declutterMode:x});return function(C){return a&&S.setOpacity(a(C)),l&&S.setDisplacement(l(C)),c&&S.setRotation(c(C)),u&&S.setRotateWithView(u(C)),o&&S.setScale(o(C)),s&&S.setAnchor(s(C)),S}}function QU(t,e){const n="shape-",r=n+"points",i=n+"radius",s=Sw(t[r],r),o=Sw(t[i],i),a=dh(t,n,e),l=hh(t,n,e),c=ly(t,n+"scale",e),u=Gp(t,n+"displacement",e),d=er(t,n+"rotation",e),h=yc(t,n+"rotate-with-view",e),f=Bp(t,n+"radius2"),p=Bp(t,n+"angle"),m=cy(t,n+"declutter-mode"),_=new Dh({points:s,radius:o,radius2:f,angle:p,declutterMode:m});return function(g){return a&&_.setFill(a(g)),l&&_.setStroke(l(g)),u&&_.setDisplacement(u(g)),d&&_.setRotation(d(g)),h&&_.setRotateWithView(h(g)),c&&_.setScale(c(g)),_}}function eG(t,e){const n="circle-",r=dh(t,n,e),i=hh(t,n,e),s=er(t,n+"radius",e),o=ly(t,n+"scale",e),a=Gp(t,n+"displacement",e),l=er(t,n+"rotation",e),c=yc(t,n+"rotate-with-view",e),u=cy(t,n+"declutter-mode"),d=new Bs({radius:5,declutterMode:u});return function(h){return s&&d.setRadius(s(h)),r&&d.setFill(r(h)),i&&d.setStroke(i(h)),a&&d.setDisplacement(a(h)),l&&d.setRotation(l(h)),c&&d.setRotateWithView(c(h)),o&&d.setScale(o(h)),d}}function er(t,e,n){if(!(e in t))return;const r=Ws(t[e],_e,n);return function(i){return Sw(r(i),e)}}function _s(t,e,n){if(!(e in t))return null;const r=Ws(t[e],Jt,n);return function(i){return s$(r(i),e)}}function tG(t,e,n){const r=_s(t,e+"pattern-src",n),i=UT(t,e+"pattern-offset",n),s=UT(t,e+"pattern-size",n),o=rE(t,e+"color",n);return function(a){return{src:r(a),offset:i&&i(a),size:s&&s(a),color:o&&o(a)}}}function yc(t,e,n){if(!(e in t))return null;const r=Ws(t[e],Kt,n);return function(i){const s=r(i);if(typeof s!="boolean")throw new Error(`Expected a boolean for ${e}`);return s}}function rE(t,e,n){if(!(e in t))return null;const r=Ws(t[e],Rt,n);return function(i){return o$(r(i),e)}}function i$(t,e,n){if(!(e in t))return null;const r=Ws(t[e],cr,n);return function(i){return Uh(r(i),e)}}function Gp(t,e,n){if(!(e in t))return null;const r=Ws(t[e],cr,n);return function(i){const s=Uh(r(i),e);if(s.length!==2)throw new Error(`Expected two numbers for ${e}`);return s}}function UT(t,e,n){if(!(e in t))return null;const r=Ws(t[e],cr,n);return function(i){return a$(r(i),e)}}function ly(t,e,n){if(!(e in t))return null;const r=Ws(t[e],cr|_e,n);return function(i){return oG(r(i),e)}}function Bp(t,e){const n=t[e];if(n!==void 0){if(typeof n!="number")throw new Error(`Expected a number for ${e}`);return n}}function nG(t,e){const n=t[e];if(n!==void 0){if(typeof n=="number")return dn(n);if(!Array.isArray(n))throw new Error(`Expected a number or size array for ${e}`);if(n.length!==2||typeof n[0]!="number"||typeof n[1]!="number")throw new Error(`Expected a number or size array for ${e}`);return n}}function rG(t,e){const n=t[e];if(n!==void 0){if(typeof n!="string")throw new Error(`Expected a string for ${e}`);return n}}function GT(t,e){const n=t[e];if(n!==void 0){if(n!=="bottom-left"&&n!=="bottom-right"&&n!=="top-left"&&n!=="top-right")throw new Error(`Expected bottom-left, bottom-right, top-left, or top-right for ${e}`);return n}}function BT(t,e){const n=t[e];if(n!==void 0){if(n!=="pixels"&&n!=="fraction")throw new Error(`Expected pixels or fraction for ${e}`);return n}}function iG(t,e){const n=t[e];if(n!==void 0)return Uh(n,e)}function cy(t,e){const n=t[e];if(n!==void 0){if(typeof n!="string")throw new Error(`Expected a string for ${e}`);if(n!=="declutter"&&n!=="obstacle"&&n!=="none")throw new Error(`Expected declutter, obstacle, or none for ${e}`);return n}}function sG(t,e){const n=t[e];if(n!==void 0)return o$(n,e)}function Uh(t,e){if(!Array.isArray(t))throw new Error(`Expected an array for ${e}`);const n=t.length;for(let r=0;r<n;++r)if(typeof t[r]!="number")throw new Error(`Expected an array of numbers for ${e}`);return t}function s$(t,e){if(typeof t!="string")throw new Error(`Expected a string for ${e}`);return t}function Sw(t,e){if(typeof t!="number")throw new Error(`Expected a number for ${e}`);return t}function o$(t,e){if(typeof t=="string")return t;const n=Uh(t,e),r=n.length;if(r<3||r>4)throw new Error(`Expected a color with 3 or 4 values for ${e}`);return n}function a$(t,e){const n=Uh(t,e);if(n.length!==2)throw new Error(`Expected an array of two numbers for ${e}`);return n}function oG(t,e){return typeof t=="number"?t:a$(t,e)}const VT={RENDER_ORDER:"renderOrder"};class cu extends lu{constructor(e){e=e||{};const n=Object.assign({},e);delete n.style,delete n.renderBuffer,delete n.updateWhileAnimating,delete n.updateWhileInteracting,super(n),this.declutter_=e.declutter?String(e.declutter):void 0,this.renderBuffer_=e.renderBuffer!==void 0?e.renderBuffer:100,this.style_=null,this.styleFunction_=void 0,this.setStyle(e.style),this.updateWhileAnimating_=e.updateWhileAnimating!==void 0?e.updateWhileAnimating:!1,this.updateWhileInteracting_=e.updateWhileInteracting!==void 0?e.updateWhileInteracting:!1}getDeclutter(){return this.declutter_}getFeatures(e){return super.getFeatures(e)}getRenderBuffer(){return this.renderBuffer_}getRenderOrder(){return this.get(VT.RENDER_ORDER)}getStyle(){return this.style_}getStyleFunction(){return this.styleFunction_}getUpdateWhileAnimating(){return this.updateWhileAnimating_}getUpdateWhileInteracting(){return this.updateWhileInteracting_}renderDeclutter(e,n){const r=this.getDeclutter();r in e.declutter||(e.declutter[r]=new t$(9)),this.getRenderer().renderDeclutter(e,n)}setRenderOrder(e){this.set(VT.RENDER_ORDER,e)}setStyle(e){this.style_=e===void 0?gO:e;const n=aG(e);this.styleFunction_=e===null?void 0:P4(n),this.changed()}setDeclutter(e){this.declutter_=e?String(e):void 0,this.changed()}}function aG(t){if(t===void 0)return gO;if(!t)return null;if(typeof t=="function"||t instanceof nt)return t;if(!Array.isArray(t))return zT([t]);if(t.length===0)return[];const e=t.length,n=t[0];if(n instanceof nt){const i=new Array(e);for(let s=0;s<e;++s){const o=t[s];if(!(o instanceof nt))throw new Error("Expected a list of style instances");i[s]=o}return i}if("style"in n){const i=new Array(e);for(let s=0;s<e;++s){const o=t[s];if(!("style"in o))throw new Error("Expected a list of rules with a style property");i[s]=o}return YU(i)}return zT(t)}class bd extends Cr{constructor(e,n,r,i){super(e),this.inversePixelTransform=n,this.frameState=r,this.context=i}}class lG extends Lh{constructor(e){super(),this.map_=e}dispatchRenderEvent(e,n){Te()}calculateMatrices2D(e){const n=e.viewState,r=e.coordinateToPixelTransform,i=e.pixelToCoordinateTransform;Xr(r,e.size[0]/2,e.size[1]/2,1/n.resolution,-1/n.resolution,-n.rotation,-n.center[0],-n.center[1]),lh(i,r)}forEachFeatureAtCoordinate(e,n,r,i,s,o,a,l){let c;const u=n.viewState;function d(w,x,S,C){return s.call(o,x,w?S:null,C)}const h=u.projection,f=P1(e.slice(),h),p=[[0,0]];if(h.canWrapX()&&i){const w=h.getExtent(),x=Me(w);p.push([-x,0],[x,0])}const m=n.layerStatesArray,_=m.length,g=[],y=[];for(let w=0;w<p.length;w++)for(let x=_-1;x>=0;--x){const S=m[x],C=S.layer;if(C.hasRenderer()&&Q1(S,u)&&a.call(l,C)){const T=C.getRenderer(),P=C.getSource();if(T&&P){const F=P.getWrapX()?f:e,k=d.bind(null,S.managed);y[0]=F[0]+p[w][0],y[1]=F[1]+p[w][1],c=T.forEachFeatureAtCoordinate(y,n,r,k,g)}if(c)return c}}if(g.length===0)return;const v=1/g.length;return g.forEach((w,x)=>w.distanceSq+=x*v),g.sort((w,x)=>w.distanceSq-x.distanceSq),g.some(w=>c=w.callback(w.feature,w.layer,w.geometry)),c}hasFeatureAtCoordinate(e,n,r,i,s,o){return this.forEachFeatureAtCoordinate(e,n,r,i,zo,this,s,o)!==void 0}getMap(){return this.map_}renderFrame(e){Te()}scheduleExpireIconCache(e){zr.canExpireCache()&&e.postRenderFunctions.push(cG)}}function cG(t,e){zr.expire()}class uG extends lG{constructor(e){super(e),this.fontChangeListenerKey_=Oe(kl,Lc.PROPERTYCHANGE,e.redrawText,e),this.element_=jr?iO():document.createElement("div");const n=this.element_.style;n.position="absolute",n.width="100%",n.height="100%",n.zIndex="0",this.element_.className=iu+" ol-layers";const r=e.getViewport();r&&r.insertBefore(this.element_,r.firstChild||null),this.children_=[],this.renderedVisible_=!0}dispatchRenderEvent(e,n){const r=this.getMap();if(r.hasListener(e)){const i=new bd(e,void 0,n);r.dispatchEvent(i)}}disposeInternal(){it(this.fontChangeListenerKey_),this.element_.remove(),super.disposeInternal()}renderFrame(e){if(!e){this.renderedVisible_&&(this.element_.style.display="none",this.renderedVisible_=!1);return}this.calculateMatrices2D(e),this.dispatchRenderEvent(un.PRECOMPOSE,e);const n=e.layerStatesArray.sort((c,u)=>c.zIndex-u.zIndex);n.some(c=>c.layer instanceof cu&&c.layer.getDeclutter())&&(e.declutter={});const i=e.viewState;this.children_.length=0;const s=[];let o=null;for(let c=0,u=n.length;c<u;++c){const d=n[c];e.layerIndex=c;const h=d.layer,f=h.getSourceState();if(!Q1(d,i)||f!="ready"&&f!="undefined"){h.unrender();continue}const p=h.render(e,o);p&&(p!==o&&(this.children_.push(p),o=p),s.push(d))}this.declutter(e,s),q5(this.element_,this.children_);const l=this.getMap().getTargetElement();if(_o(l)){const c=l.getContext("2d");for(const u of this.children_){const d=u.firstElementChild||u,h=u.style.backgroundColor;if(h&&(!_o(d)||d.width>0)&&(c.fillStyle=h,c.fillRect(0,0,l.width,l.height)),_o(d)&&d.width>0){const f=u.style.opacity||d.style.opacity;c.globalAlpha=f===""?1:Number(f);const p=d.style.transform;if(p)c.setTransform(...yw(p));else{const m=parseFloat(d.style.width)/d.width,_=parseFloat(d.style.height)/d.height;c.setTransform(m,0,0,_,0,0)}c.drawImage(d,0,0)}}c.globalAlpha=1,c.setTransform(1,0,0,1,0,0)}this.dispatchRenderEvent(un.POSTCOMPOSE,e),this.renderedVisible_||(this.element_.style.display="",this.renderedVisible_=!0),this.scheduleExpireIconCache(e)}declutter(e,n){if(e.declutter){for(let r=n.length-1;r>=0;--r){const i=n[r],s=i.layer;s.getDeclutter()&&s.renderDeclutter(e,i)}n.forEach(r=>r.layer.renderDeferred(e))}}}function l$(t){if(t instanceof lu){t.setMapInternal(null);return}t instanceof Ds&&t.getLayers().forEach(l$)}function c$(t,e){if(t instanceof lu){t.setMapInternal(e);return}if(t instanceof Ds){const n=t.getLayers().getArray();for(let r=0,i=n.length;r<i;++r)c$(n[r],e)}}let dG=class extends bi{constructor(e){super(),e=e||{},this.on,this.once,this.un;const n=hG(e);this.renderComplete_=!1,this.loaded_=!0,this.boundHandleBrowserEvent_=this.handleBrowserEvent.bind(this),this.maxTilesLoading_=e.maxTilesLoading!==void 0?e.maxTilesLoading:16,this.pixelRatio_=e.pixelRatio!==void 0?e.pixelRatio:eO,this.postRenderTimeoutHandle_,this.animationDelayKey_,this.animationDelay_=this.animationDelay_.bind(this),this.coordinateToPixelTransform_=Bt(),this.pixelToCoordinateTransform_=Bt(),this.frameIndex_=0,this.frameState_=null,this.previousExtent_=null,this.viewPropertyListenerKey_=null,this.viewChangeListenerKey_=null,this.layerGroupPropertyListenerKeys_=null,jr||(this.viewport_=document.createElement("div"),this.viewport_.className="ol-viewport"+("ontouchstart"in window?" ol-touch":""),this.viewport_.style.position="relative",this.viewport_.style.overflow="hidden",this.viewport_.style.width="100%",this.viewport_.style.height="100%",this.overlayContainer_=document.createElement("div"),this.overlayContainer_.style.position="absolute",this.overlayContainer_.style.zIndex="0",this.overlayContainer_.style.width="100%",this.overlayContainer_.style.height="100%",this.overlayContainer_.style.pointerEvents="none",this.overlayContainer_.className="ol-overlaycontainer",this.viewport_.appendChild(this.overlayContainer_),this.overlayContainerStopEvent_=document.createElement("div"),this.overlayContainerStopEvent_.style.position="absolute",this.overlayContainerStopEvent_.style.zIndex="0",this.overlayContainerStopEvent_.style.width="100%",this.overlayContainerStopEvent_.style.height="100%",this.overlayContainerStopEvent_.style.pointerEvents="none",this.overlayContainerStopEvent_.className="ol-overlaycontainer-stopevent",this.viewport_.appendChild(this.overlayContainerStopEvent_)),this.mapBrowserEventHandler_=null,this.moveTolerance_=e.moveTolerance,this.keyboardEventTarget_=n.keyboardEventTarget,this.targetChangeHandlerKeys_=null,this.targetElement_=null,jr||(this.resizeObserver_=new ResizeObserver(()=>this.updateSize())),this.controls=n.controls||(jr?new Bn:KO()),this.interactions=n.interactions||(jr?new Bn:yU({onFocusOnly:!0})),this.overlays_=n.overlays,this.overlayIdIndex_={},this.renderer_=null,this.postRenderFunctions_=[],this.tileQueue_=new L4(this.getTilePriority.bind(this),this.handleTileChange_.bind(this)),this.addChangeListener(on.LAYERGROUP,this.handleLayerGroupChanged_),this.addChangeListener(on.VIEW,this.handleViewChanged_),this.addChangeListener(on.SIZE,this.handleSizeChanged_),this.addChangeListener(on.TARGET,this.handleTargetChanged_),this.setProperties(n.values);const r=this;e.view&&!(e.view instanceof ki)&&e.view.then(function(i){r.setView(new ki(i))}),this.controls.addEventListener(Ht.ADD,i=>{i.element.setMap(this)}),this.controls.addEventListener(Ht.REMOVE,i=>{i.element.setMap(null)}),this.interactions.addEventListener(Ht.ADD,i=>{i.element.setMap(this)}),this.interactions.addEventListener(Ht.REMOVE,i=>{i.element.setMap(null)}),this.overlays_.addEventListener(Ht.ADD,i=>{this.addOverlayInternal_(i.element)}),this.overlays_.addEventListener(Ht.REMOVE,i=>{const s=i.element.getId();s!==void 0&&delete this.overlayIdIndex_[s.toString()],i.element.setMap(null)}),this.controls.forEach(i=>{i.setMap(this)}),this.interactions.forEach(i=>{i.setMap(this)}),this.overlays_.forEach(this.addOverlayInternal_.bind(this))}addControl(e){this.getControls().push(e)}addInteraction(e){this.getInteractions().push(e)}addLayer(e){this.getLayerGroup().getLayers().push(e)}handleLayerAdd_(e){c$(e.layer,this)}addOverlay(e){this.getOverlays().push(e)}addOverlayInternal_(e){const n=e.getId();n!==void 0&&(this.overlayIdIndex_[n.toString()]=e),e.setMap(this)}disposeInternal(){var e;this.controls.clear(),this.interactions.clear(),this.overlays_.clear(),(e=this.resizeObserver_)==null||e.disconnect(),this.setTarget(null),super.disposeInternal()}forEachFeatureAtPixel(e,n,r){if(!this.frameState_||!this.renderer_)return;const i=this.getCoordinateFromPixelInternal(e);r=r!==void 0?r:{};const s=r.hitTolerance!==void 0?r.hitTolerance:0,o=r.layerFilter!==void 0?r.layerFilter:zo,a=r.checkWrapped!==!1;return this.renderer_.forEachFeatureAtCoordinate(i,this.frameState_,s,a,n,null,o,null)}getFeaturesAtPixel(e,n){const r=[];return this.forEachFeatureAtPixel(e,function(i){r.push(i)},n),r}getAllLayers(){const e=[];function n(r){r.forEach(function(i){i instanceof Ds?n(i.getLayers()):e.push(i)})}return n(this.getLayers()),e}hasFeatureAtPixel(e,n){if(!this.frameState_||!this.renderer_)return!1;const r=this.getCoordinateFromPixelInternal(e);n=n!==void 0?n:{};const i=n.layerFilter!==void 0?n.layerFilter:zo,s=n.hitTolerance!==void 0?n.hitTolerance:0,o=n.checkWrapped!==!1;return this.renderer_.hasFeatureAtCoordinate(r,this.frameState_,s,o,i,null)}getEventCoordinate(e){return this.getCoordinateFromPixel(this.getEventPixel(e))}getEventCoordinateInternal(e){return this.getCoordinateFromPixelInternal(this.getEventPixel(e))}getEventPixel(e){const r=this.viewport_.getBoundingClientRect(),i=this.getSize(),s=r.width/i[0],o=r.height/i[1],a="changedTouches"in e?e.changedTouches[0]:e;return[(a.clientX-r.left)/s,(a.clientY-r.top)/o]}getTarget(){return this.get(on.TARGET)}getTargetElement(){return this.targetElement_}getCoordinateFromPixel(e){return Ga(this.getCoordinateFromPixelInternal(e),this.getView().getProjection())}getCoordinateFromPixelInternal(e){const n=this.frameState_;return n?$t(n.pixelToCoordinateTransform,e.slice()):null}getControls(){return this.controls}getOverlays(){return this.overlays_}getOverlayById(e){const n=this.overlayIdIndex_[e.toString()];return n!==void 0?n:null}getInteractions(){return this.interactions}getLayerGroup(){return this.get(on.LAYERGROUP)}setLayers(e){const n=this.getLayerGroup();if(e instanceof Bn){n.setLayers(e);return}const r=n.getLayers();r.clear(),r.extend(e)}getLayers(){return this.getLayerGroup().getLayers()}getLoadingOrNotReady(){const e=this.getLayerGroup().getLayerStatesArray();for(let n=0,r=e.length;n<r;++n){const i=e[n];if(!i.visible)continue;const s=i.layer.getRenderer();if(s&&!s.ready)return!0;const o=i.layer.getSource();if(o&&o.loading)return!0}return!1}getPixelFromCoordinate(e){const n=Ot(e,this.getView().getProjection());return this.getPixelFromCoordinateInternal(n)}getPixelFromCoordinateInternal(e){const n=this.frameState_;return n?$t(n.coordinateToPixelTransform,e.slice(0,2)):null}getRenderer(){return this.renderer_}getSize(){return this.get(on.SIZE)}getView(){return this.get(on.VIEW)}getViewport(){return this.viewport_}getOverlayContainer(){return this.overlayContainer_}getOverlayContainerStopEvent(){return this.overlayContainerStopEvent_}getOwnerDocument(){const e=this.getTargetElement();return e?e.ownerDocument:document}getTilePriority(e,n,r,i){return k4(this.frameState_,e,n,r,i)}handleBrowserEvent(e,n){n=n||e.type;const r=new ps(n,this,e);this.handleMapBrowserEvent(r)}handleMapBrowserEvent(e){if(!this.frameState_)return;const n=e.originalEvent,r=n.type;if(r===cw.POINTERDOWN||r===Se.WHEEL||r===Se.KEYDOWN){const i=this.getOwnerDocument(),s=this.viewport_.getRootNode?this.viewport_.getRootNode():i,o=n.target,a=s instanceof ShadowRoot?s.host===o?s.host.ownerDocument:s:s===i?i.documentElement:s;if(this.overlayContainerStopEvent_.contains(o)||!a.contains(o))return}if(e.frameState=this.frameState_,this.dispatchEvent(e)!==!1){const i=this.getInteractions().getArray().slice();for(let s=i.length-1;s>=0;s--){const o=i[s];if(o.getMap()!==this||!o.getActive()||!this.getTargetElement())continue;if(!o.handleEvent(e)||e.propagationStopped)break}}}handlePostRender(){const e=this.frameState_,n=this.tileQueue_;if(!n.isEmpty()){let i=this.maxTilesLoading_,s=i;if(e){const o=e.viewHints;if(o[gt.ANIMATING]||o[gt.INTERACTING]){const a=Date.now()-e.time>8;i=a?0:8,s=a?0:2}}n.getTilesLoading()<i&&(n.reprioritize(),n.loadMoreTiles(i,s))}e&&this.renderer_&&!e.animate&&(this.renderComplete_?(this.hasListener(un.RENDERCOMPLETE)&&this.renderer_.dispatchRenderEvent(un.RENDERCOMPLETE,e),this.loaded_===!1&&(this.loaded_=!0,this.dispatchEvent(new Ml(ms.LOADEND,this,e)))):this.loaded_===!0&&(this.loaded_=!1,this.dispatchEvent(new Ml(ms.LOADSTART,this,e))));const r=this.postRenderFunctions_;if(e)for(let i=0,s=r.length;i<s;++i)r[i](this,e);r.length=0}handleSizeChanged_(){this.getView()&&!this.getView().getAnimating()&&this.getView().resolveConstraints(0),this.render()}handleTargetChanged_(){var r,i;if(this.mapBrowserEventHandler_){for(let s=0,o=this.targetChangeHandlerKeys_.length;s<o;++s)it(this.targetChangeHandlerKeys_[s]);this.targetChangeHandlerKeys_=null,this.viewport_.removeEventListener(Se.CONTEXTMENU,this.boundHandleBrowserEvent_),this.viewport_.removeEventListener(Se.WHEEL,this.boundHandleBrowserEvent_),this.mapBrowserEventHandler_.dispose(),this.mapBrowserEventHandler_=null,this.viewport_.remove()}if(this.targetElement_&&!_o(this.targetElement_)){(r=this.resizeObserver_)==null||r.unobserve(this.targetElement_);const s=this.targetElement_.getRootNode();s instanceof ShadowRoot&&this.resizeObserver_.unobserve(s.host),this.setSize(void 0)}const e=this.getTarget(),n=typeof e=="string"?document.getElementById(e):e;if(this.targetElement_=n,!n)this.renderer_&&(clearTimeout(this.postRenderTimeoutHandle_),this.postRenderTimeoutHandle_=void 0,this.postRenderFunctions_.length=0,this.renderer_.dispose(),this.renderer_=null),this.animationDelayKey_&&(cancelAnimationFrame(this.animationDelayKey_),this.animationDelayKey_=void 0);else{if(_o(n)||n.appendChild(this.viewport_),this.renderer_||(this.renderer_=new uG(this)),!_o(n)){this.mapBrowserEventHandler_=new O4(this,this.moveTolerance_);for(const o in Be)this.mapBrowserEventHandler_.addEventListener(Be[o],this.handleMapBrowserEvent.bind(this));this.viewport_.addEventListener(Se.CONTEXTMENU,this.boundHandleBrowserEvent_,!1),this.viewport_.addEventListener(Se.WHEEL,this.boundHandleBrowserEvent_,nO?{passive:!1}:!1);let s;if(this.keyboardEventTarget_)s=this.keyboardEventTarget_;else{const o=n.getRootNode();s=o instanceof ShadowRoot?o.host:n}if(this.targetChangeHandlerKeys_=[Oe(s,Se.KEYDOWN,this.handleBrowserEvent,this),Oe(s,Se.KEYPRESS,this.handleBrowserEvent,this)],n instanceof HTMLElement){const o=n.getRootNode();o instanceof ShadowRoot&&this.resizeObserver_.observe(o.host),(i=this.resizeObserver_)==null||i.observe(n)}}this.updateSize()}}handleTileChange_(){this.render()}handleViewPropertyChanged_(){this.render()}handleViewChanged_(){this.viewPropertyListenerKey_&&(it(this.viewPropertyListenerKey_),this.viewPropertyListenerKey_=null),this.viewChangeListenerKey_&&(it(this.viewChangeListenerKey_),this.viewChangeListenerKey_=null);const e=this.getView();e&&(this.updateViewportSize_(this.getSize()),this.viewPropertyListenerKey_=Oe(e,Lc.PROPERTYCHANGE,this.handleViewPropertyChanged_,this),this.viewChangeListenerKey_=Oe(e,Se.CHANGE,this.handleViewPropertyChanged_,this),e.resolveConstraints(0)),this.render()}handleLayerGroupChanged_(){this.layerGroupPropertyListenerKeys_&&(this.layerGroupPropertyListenerKeys_.forEach(it),this.layerGroupPropertyListenerKeys_=null);const e=this.getLayerGroup();e&&(this.handleLayerAdd_(new ho("addlayer",e)),this.layerGroupPropertyListenerKeys_=[Oe(e,Lc.PROPERTYCHANGE,this.render,this),Oe(e,Se.CHANGE,this.render,this),Oe(e,"addlayer",this.handleLayerAdd_,this),Oe(e,"removelayer",this.handleLayerRemove_,this)]),this.render()}isRendered(){return!!this.frameState_}animationDelay_(){this.animationDelayKey_=void 0,this.renderFrame_(Date.now())}renderSync(){this.animationDelayKey_&&cancelAnimationFrame(this.animationDelayKey_),this.animationDelay_()}redrawText(){if(!this.frameState_)return;const e=this.frameState_.layerStatesArray;for(let n=0,r=e.length;n<r;++n){const i=e[n].layer;i.hasRenderer()&&i.getRenderer().handleFontsChanged()}}render(){this.renderer_&&this.animationDelayKey_===void 0&&(this.animationDelayKey_=requestAnimationFrame(this.animationDelay_))}removeControl(e){return this.getControls().remove(e)}removeInteraction(e){return this.getInteractions().remove(e)}removeLayer(e){return this.getLayerGroup().getLayers().remove(e)}handleLayerRemove_(e){l$(e.layer)}removeOverlay(e){return this.getOverlays().remove(e)}renderFrame_(e){const n=this.getSize(),r=this.getView(),i=this.frameState_;let s=null;if(n!==void 0&&dT(n)&&r&&r.isDef()){const o=r.getHints(this.frameState_?this.frameState_.viewHints:void 0),a=r.getState();if(s={animate:!1,coordinateToPixelTransform:this.coordinateToPixelTransform_,declutter:null,extent:ah(a.center,a.resolution,a.rotation,n),index:this.frameIndex_++,layerIndex:0,layerStatesArray:this.getLayerGroup().getLayerStatesArray(),pixelRatio:this.pixelRatio_,pixelToCoordinateTransform:this.pixelToCoordinateTransform_,postRenderFunctions:[],size:n,tileQueue:this.tileQueue_,time:e,usedTiles:{},viewState:a,viewHints:o,wantedTiles:{},mapId:fe(this),renderTargets:{}},a.nextCenter&&a.nextResolution){const l=isNaN(a.nextRotation)?a.rotation:a.nextRotation;s.nextExtent=ah(a.nextCenter,a.nextResolution,l,n)}}this.frameState_=s,this.renderer_.renderFrame(s),s&&(s.animate&&this.render(),Array.prototype.push.apply(this.postRenderFunctions_,s.postRenderFunctions),i&&(!this.previousExtent_||!tl(this.previousExtent_)&&!Bo(s.extent,this.previousExtent_))&&(this.dispatchEvent(new Ml(ms.MOVESTART,this,i)),this.previousExtent_=su(this.previousExtent_)),this.previousExtent_&&!s.viewHints[gt.ANIMATING]&&!s.viewHints[gt.INTERACTING]&&!Bo(s.extent,this.previousExtent_)&&(this.dispatchEvent(new Ml(ms.MOVEEND,this,s)),mO(s.extent,this.previousExtent_))),this.dispatchEvent(new Ml(ms.POSTRENDER,this,s)),this.renderComplete_=(this.hasListener(ms.LOADSTART)||this.hasListener(ms.LOADEND)||this.hasListener(un.RENDERCOMPLETE))&&!this.tileQueue_.getTilesLoading()&&!this.tileQueue_.getCount()&&!this.getLoadingOrNotReady(),this.postRenderTimeoutHandle_||(this.postRenderTimeoutHandle_=setTimeout(()=>{this.postRenderTimeoutHandle_=void 0,this.handlePostRender()},0))}setLayerGroup(e){const n=this.getLayerGroup();n&&this.handleLayerRemove_(new ho("removelayer",n)),this.set(on.LAYERGROUP,e)}setSize(e){this.set(on.SIZE,e)}setTarget(e){this.set(on.TARGET,e)}setView(e){if(!e||e instanceof ki){this.set(on.VIEW,e);return}this.set(on.VIEW,new ki);const n=this;e.then(function(r){n.setView(new ki(r))})}updateSize(){const e=this.getTargetElement();let n;if(e){let i,s;if(_o(e))i=e.width,s=e.height;else{const o=getComputedStyle(e);i=e.offsetWidth-parseFloat(o.borderLeftWidth)-parseFloat(o.paddingLeft)-parseFloat(o.paddingRight)-parseFloat(o.borderRightWidth),s=e.offsetHeight-parseFloat(o.borderTopWidth)-parseFloat(o.paddingTop)-parseFloat(o.paddingBottom)-parseFloat(o.borderBottomWidth)}!isNaN(i)&&!isNaN(s)&&(n=[Math.max(0,i),Math.max(0,s)],!dT(n)&&(e.offsetWidth||e.offsetHeight||e.getClientRects().length)&&TO("No map visible because the map container's width or height are 0."))}const r=this.getSize();n&&(!r||!es(n,r))&&(this.setSize(n),this.updateViewportSize_(n))}updateViewportSize_(e){const n=this.getView();n&&n.setViewportSize(e)}};function hG(t){let e=null;t.keyboardEventTarget!==void 0&&(e=typeof t.keyboardEventTarget=="string"?document.getElementById(t.keyboardEventTarget):t.keyboardEventTarget);const n={},r=t.layers&&typeof t.layers.getLayers=="function"?t.layers:new Ds({layers:t.layers});n[on.LAYERGROUP]=r,n[on.TARGET]=t.target,n[on.VIEW]=t.view instanceof ki?t.view:new ki;let i;t.controls!==void 0&&(Array.isArray(t.controls)?i=new Bn(t.controls.slice()):(ze(typeof t.controls.getArray=="function","Expected `controls` to be an array or an `ol/Collection.js`"),i=t.controls));let s;t.interactions!==void 0&&(Array.isArray(t.interactions)?s=new Bn(t.interactions.slice()):(ze(typeof t.interactions.getArray=="function","Expected `interactions` to be an array or an `ol/Collection.js`"),s=t.interactions));let o;return t.overlays!==void 0?Array.isArray(t.overlays)?o=new Bn(t.overlays.slice()):(ze(typeof t.overlays.getArray=="function","Expected `overlays` to be an array or an `ol/Collection.js`"),o=t.overlays):o=new Bn,{controls:i,interactions:s,keyboardEventTarget:e,overlays:o,values:n}}const WT=["fullscreenchange","webkitfullscreenchange"],HT={ENTERFULLSCREEN:"enterfullscreen",LEAVEFULLSCREEN:"leavefullscreen"};class fG extends zh{constructor(e){e=e||{},super({element:document.createElement("div"),target:e.target}),this.on,this.once,this.un,this.keys_=e.keys!==void 0?e.keys:!1,this.source_=e.source,this.isInFullscreen_=!1,this.boundHandleMapTargetChange_=this.handleMapTargetChange_.bind(this),this.cssClassName_=e.className!==void 0?e.className:"ol-full-screen",this.documentListeners_=[],this.activeClassName_=e.activeClassName!==void 0?e.activeClassName.split(" "):[this.cssClassName_+"-true"],this.inactiveClassName_=e.inactiveClassName!==void 0?e.inactiveClassName.split(" "):[this.cssClassName_+"-false"];const n=e.label!==void 0?e.label:"";this.labelNode_=typeof n=="string"?document.createTextNode(n):n;const r=e.labelActive!==void 0?e.labelActive:"";this.labelActiveNode_=typeof r=="string"?document.createTextNode(r):r;const i=e.tipLabel?e.tipLabel:"Toggle full-screen";this.button_=document.createElement("button"),this.button_.title=i,this.button_.setAttribute("type","button"),this.button_.appendChild(this.labelNode_),this.button_.addEventListener(Se.CLICK,this.handleClick_.bind(this),!1),this.setClassName_(this.button_,this.isInFullscreen_),this.element.className=`${this.cssClassName_} ${iu} ${Km}`,this.element.appendChild(this.button_)}handleClick_(e){e.preventDefault(),this.handleFullScreen_()}handleFullScreen_(){const e=this.getMap();if(!e)return;const n=e.getOwnerDocument();if(KT(n))if(YT(n))pG(n);else{let r;this.source_?r=typeof this.source_=="string"?n.getElementById(this.source_):this.source_:r=e.getTargetElement(),this.keys_?gG(r):u$(r)}}handleFullScreenChange_(){const e=this.getMap();if(!e)return;const n=this.isInFullscreen_;this.isInFullscreen_=YT(e.getOwnerDocument()),n!==this.isInFullscreen_&&(this.setClassName_(this.button_,this.isInFullscreen_),this.isInFullscreen_?(Pp(this.labelActiveNode_,this.labelNode_),this.dispatchEvent(HT.ENTERFULLSCREEN)):(Pp(this.labelNode_,this.labelActiveNode_),this.dispatchEvent(HT.LEAVEFULLSCREEN)),e.updateSize())}setClassName_(e,n){n?(e.classList.remove(...this.inactiveClassName_),e.classList.add(...this.activeClassName_)):(e.classList.remove(...this.activeClassName_),e.classList.add(...this.inactiveClassName_))}setMap(e){const n=this.getMap();n&&n.removeChangeListener(on.TARGET,this.boundHandleMapTargetChange_),super.setMap(e),this.handleMapTargetChange_(),e&&e.addChangeListener(on.TARGET,this.boundHandleMapTargetChange_)}handleMapTargetChange_(){const e=this.documentListeners_;for(let r=0,i=e.length;r<i;++r)it(e[r]);e.length=0;const n=this.getMap();if(n){const r=n.getOwnerDocument();KT(r)?this.element.classList.remove(oT):this.element.classList.add(oT);for(let i=0,s=WT.length;i<s;++i)e.push(Oe(r,WT[i],this.handleFullScreenChange_,this));this.handleFullScreenChange_()}}}function KT(t){const e=t.body;return!!(e.webkitRequestFullscreen||e.requestFullscreen&&t.fullscreenEnabled)}function YT(t){return!!(t.webkitIsFullScreen||t.fullscreenElement)}function u$(t){t.requestFullscreen?t.requestFullscreen():t.webkitRequestFullscreen&&t.webkitRequestFullscreen()}function gG(t){t.webkitRequestFullscreen?t.webkitRequestFullscreen():u$(t)}function pG(t){t.exitFullscreen?t.exitFullscreen():t.webkitExitFullscreen&&t.webkitExitFullscreen()}const In={ELEMENT:"element",MAP:"map",OFFSET:"offset",POSITION:"position",POSITIONING:"positioning"};class mG extends bi{constructor(e){super(),this.on,this.once,this.un,this.options=e,this.id=e.id,this.insertFirst=e.insertFirst!==void 0?e.insertFirst:!0,this.stopEvent=e.stopEvent!==void 0?e.stopEvent:!0,this.element=document.createElement("div"),this.element.className=e.className!==void 0?e.className:"ol-overlay-container "+_4,this.element.style.position="absolute",this.element.style.pointerEvents="auto",this.autoPan=e.autoPan===!0?{}:e.autoPan||void 0,this.rendered={transform_:"",visible:!0},this.mapPostrenderListenerKey=null,this.addChangeListener(In.ELEMENT,this.handleElementChanged),this.addChangeListener(In.MAP,this.handleMapChanged),this.addChangeListener(In.OFFSET,this.handleOffsetChanged),this.addChangeListener(In.POSITION,this.handlePositionChanged),this.addChangeListener(In.POSITIONING,this.handlePositioningChanged),e.element!==void 0&&this.setElement(e.element),this.setOffset(e.offset!==void 0?e.offset:[0,0]),this.setPositioning(e.positioning||"top-left"),e.position!==void 0&&this.setPosition(e.position)}getElement(){return this.get(In.ELEMENT)}getId(){return this.id}getMap(){return this.get(In.MAP)||null}getOffset(){return this.get(In.OFFSET)}getPosition(){return this.get(In.POSITION)}getPositioning(){return this.get(In.POSITIONING)}handleElementChanged(){rO(this.element);const e=this.getElement();e&&this.element.appendChild(e)}handleMapChanged(){var n;this.mapPostrenderListenerKey&&((n=this.element)==null||n.remove(),it(this.mapPostrenderListenerKey),this.mapPostrenderListenerKey=null);const e=this.getMap();if(e){this.mapPostrenderListenerKey=Oe(e,ms.POSTRENDER,this.render,this),this.updatePixelPosition();const r=this.stopEvent?e.getOverlayContainerStopEvent():e.getOverlayContainer();this.insertFirst?r.insertBefore(this.element,r.childNodes[0]||null):r.appendChild(this.element),this.performAutoPan()}}render(){this.updatePixelPosition()}handleOffsetChanged(){this.updatePixelPosition()}handlePositionChanged(){this.updatePixelPosition(),this.performAutoPan()}handlePositioningChanged(){this.updatePixelPosition()}setElement(e){this.set(In.ELEMENT,e)}setMap(e){this.set(In.MAP,e)}setOffset(e){this.set(In.OFFSET,e)}setPosition(e){this.set(In.POSITION,e)}performAutoPan(){this.autoPan&&this.panIntoView(this.autoPan)}panIntoView(e){const n=this.getMap();if(!n||!n.getTargetElement()||!this.get(In.POSITION))return;const r=this.getRect(n.getTargetElement(),n.getSize()),i=this.getElement(),s=this.getRect(i,[X5(i),Z5(i)]);e=e||{};const o=e.margin===void 0?20:e.margin;if(!ji(r,s)){const a=s[0]-r[0],l=r[2]-s[2],c=s[1]-r[1],u=r[3]-s[3],d=[0,0];if(a<0?d[0]=a-o:l<0&&(d[0]=Math.abs(l)+o),c<0?d[1]=c-o:u<0&&(d[1]=Math.abs(u)+o),d[0]!==0||d[1]!==0){const h=n.getView().getCenterInternal(),f=n.getPixelFromCoordinateInternal(h);if(!f)return;const p=[f[0]+d[0],f[1]+d[1]],m=e.animation||{};n.getView().animateInternal({center:n.getCoordinateFromPixelInternal(p),duration:m.duration,easing:m.easing})}}}getRect(e,n){const r=e.getBoundingClientRect(),i=r.left+window.pageXOffset,s=r.top+window.pageYOffset;return[i,s,i+n[0],s+n[1]]}setPositioning(e){this.set(In.POSITIONING,e)}setVisible(e){this.rendered.visible!==e&&(this.element.style.display=e?"":"none",this.rendered.visible=e)}updatePixelPosition(){const e=this.getMap(),n=this.getPosition();if(!e||!e.isRendered()||!n){this.setVisible(!1);return}const r=e.getPixelFromCoordinate(n),i=e.getSize();this.updateRenderedPosition(r,i)}updateRenderedPosition(e,n){const r=this.element.style,i=this.getOffset(),s=this.getPositioning();this.setVisible(!0);const o=`${e[0]+i[0]}px`,a=`${e[1]+i[1]}px`;let l="0%",c="0%";s=="bottom-right"||s=="center-right"||s=="top-right"?l="-100%":(s=="bottom-center"||s=="center-center"||s=="top-center")&&(l="-50%"),s=="bottom-left"||s=="bottom-center"||s=="bottom-right"?c="-100%":(s=="center-left"||s=="center-center"||s=="center-right")&&(c="-50%");const u=`translate(${l}, ${c}) translate(${o}, ${a})`;this.rendered.transform_!=u&&(this.rendered.transform_=u,r.transform=u)}getOptions(){return this.options}}const c0="units",yG=[1,2,5],Wu=25.4/.28;class _G extends zh{constructor(e){e=e||{};const n=document.createElement("div");n.style.pointerEvents="none",super({element:n,render:e.render,target:e.target}),this.on,this.once,this.un;const r=e.className!==void 0?e.className:e.bar?"ol-scale-bar":"ol-scale-line";this.innerElement_=document.createElement("div"),this.innerElement_.className=r+"-inner",this.element.className=r+" "+iu,this.element.appendChild(this.innerElement_),this.viewState_=null,this.minWidth_=e.minWidth!==void 0?e.minWidth:64,this.maxWidth_=e.maxWidth,this.renderedVisible_=!1,this.renderedWidth_=void 0,this.renderedHTML_="",this.addChangeListener(c0,this.handleUnitsChanged_),this.setUnits(e.units||"metric"),this.scaleBar_=e.bar||!1,this.scaleBarSteps_=e.steps||4,this.scaleBarText_=e.text||!1,this.dpi_=e.dpi||void 0}getUnits(){return this.get(c0)}handleUnitsChanged_(){this.updateElement_()}setUnits(e){this.set(c0,e)}setDpi(e){this.dpi_=e}updateElement_(){const e=this.viewState_;if(!e){this.renderedVisible_&&(this.element.style.display="none",this.renderedVisible_=!1);return}const n=e.center,r=e.projection,i=this.getUnits(),s=i=="degrees"?"degrees":"m";let o=Mp(r,e.resolution,n,s);const a=this.minWidth_*(this.dpi_||Wu)/Wu,l=this.maxWidth_!==void 0?this.maxWidth_*(this.dpi_||Wu)/Wu:void 0;let c=a*o,u="";if(i=="degrees"){const v=Nc.degrees;c*=v,c<v/60?(u="",o*=3600):c<v?(u="",o*=60):u=""}else if(i=="imperial")c<.9144?(u="in",o/=.0254):c<1609.344?(u="ft",o/=.3048):(u="mi",o/=1609.344);else if(i=="nautical")o/=1852,u="NM";else if(i=="metric")c<1e-6?(u="nm",o*=1e9):c<.001?(u="m",o*=1e6):c<1?(u="mm",o*=1e3):c<1e3?u="m":(u="km",o/=1e3);else if(i=="us")c<.9144?(u="in",o*=39.37):c<1609.344?(u="ft",o/=.30480061):(u="mi",o/=1609.3472);else throw new Error("Invalid units");let d=3*Math.floor(Math.log(a*o)/Math.log(10)),h,f,p,m=0,_,g;for(;;){p=Math.floor(d/3);const v=Math.pow(10,p);if(h=yG[(d%3+3)%3]*v,f=Math.round(h/o),isNaN(f)){this.element.style.display="none",this.renderedVisible_=!1;return}if(l!==void 0&&f>=l){h=m,f=_,p=g;break}else if(f>=a)break;m=h,_=f,g=p,++d}const y=this.scaleBar_?this.createScaleBar(f,h,u):h.toFixed(p<0?-p:0)+" "+u;this.renderedHTML_!=y&&(this.innerElement_.innerHTML=y,this.renderedHTML_=y),this.renderedWidth_!=f&&(this.innerElement_.style.width=f+"px",this.renderedWidth_=f),this.renderedVisible_||(this.element.style.display="",this.renderedVisible_=!0)}createScaleBar(e,n,r){const i=this.getScaleForResolution(),s=i<1?Math.round(1/i).toLocaleString()+" : 1":"1 : "+Math.round(i).toLocaleString(),o=this.scaleBarSteps_,a=e/o,l=[this.createMarker("absolute")];for(let u=0;u<o;++u){const d=u%2===0?"ol-scale-singlebar-odd":"ol-scale-singlebar-even";l.push(`<div><div class="ol-scale-singlebar ${d}" style="width: ${a}px;"></div>`+this.createMarker("relative")+(u%2===0||o===2?this.createStepText(u,e,!1,n,r):"")+"</div>")}return l.push(this.createStepText(o,e,!0,n,r)),(this.scaleBarText_?`<div class="ol-scale-text" style="width: ${e}px;">`+s+"</div>":"")+l.join("")}createMarker(e){return`<div class="ol-scale-step-marker" style="position: ${e}; top: ${e==="absolute"?3:-10}px;"></div>`}createStepText(e,n,r,i,s){const a=(e===0?0:Math.round(i/this.scaleBarSteps_*e*100)/100)+(e===0?"":" "+s),l=e===0?-3:n/this.scaleBarSteps_*-1,c=e===0?0:n/this.scaleBarSteps_*2;return`<div class="ol-scale-step-text" style="margin-left: ${l}px;text-align: ${e===0?"left":"center"};min-width: ${c}px;left: ${r?n+"px":"unset"};">`+a+"</div>"}getScaleForResolution(){const e=Mp(this.viewState_.projection,this.viewState_.resolution,this.viewState_.center,"m"),n=this.dpi_||Wu,r=1e3/25.4;return e*r*n}render(e){const n=e.frameState;n?this.viewState_=n.viewState:this.viewState_=null,this.updateElement_()}}let Mf,d$;function bw(){if(Mf===void 0){const t=document.createElement("canvas");t.setAttribute("style","image-rendering: -moz-crisp-edges; image-rendering: crisp-edges; image-rendering: pixelated;");const e=t.style.imageRendering;Mf=!!e,Mf&&(d$=e)}return Mf}function vG(){return bw(),d$||""}function Mg(t){return t.get("olcs_projection")||t.getProjection()}let wG=0;function Qt(t){return t.olcs_uid||(t.olcs_uid=++wG)}function u0(t){const e=t,n=e.readyPromise;return n||(e.ready!==void 0?e.ready?Promise.resolve(t):new Promise((r,i)=>{const s=setInterval(()=>{e.ready&&(clearInterval(s),r(t))},20)}):Promise.reject("Not a readyable object"))}class Gh extends kh{constructor(e,n,r){super(),r=r||{},this.tileCoord=e,this.state=n,this.key="",this.transition_=r.transition===void 0?250:r.transition,this.transitionStarts_={},this.interpolate=!!r.interpolate}changed(){this.dispatchEvent(Se.CHANGE)}release(){this.setState(ue.EMPTY)}getKey(){return this.key+"/"+this.tileCoord}getTileCoord(){return this.tileCoord}getState(){return this.state}setState(e){if(this.state!==ue.EMPTY){if(this.state!==ue.ERROR&&this.state>e)throw new Error("Tile load sequence violation");this.state=e,this.changed()}}load(){Te()}getAlpha(e,n){if(!this.transition_)return 1;let r=this.transitionStarts_[e];if(!r)r=n,this.transitionStarts_[e]=r;else if(r===-1)return 1;const i=n-r+1e3/60;return i>=this.transition_?1:CO(i/this.transition_)}inTransition(e){return this.transition_?this.transitionStarts_[e]!==-1:!1}endTransition(e){this.transition_&&(this.transitionStarts_[e]=-1)}disposeInternal(){this.release(),super.disposeInternal()}}function Cw(t){return t instanceof Image||t instanceof HTMLCanvasElement||t instanceof HTMLVideoElement||t instanceof ImageBitmap?t:null}const xG=new Error("disposed"),EG=[256,256];class XT extends Gh{constructor(e){const n=ue.IDLE;super(e.tileCoord,n,{transition:e.transition,interpolate:e.interpolate}),this.loader_=e.loader,this.data_=null,this.error_=null,this.size_=e.size||null,this.controller_=e.controller||null}getSize(){if(this.size_)return this.size_;const e=Cw(this.data_);return e?[e.width,e.height]:EG}getData(){return this.data_}getError(){return this.error_}load(){if(this.state!==ue.IDLE&&this.state!==ue.ERROR)return;this.state=ue.LOADING,this.changed();const e=this;this.loader_().then(function(n){e.data_=n,e.state=ue.LOADED,e.changed()}).catch(function(n){e.error_=n,e.state=ue.ERROR,e.changed()})}disposeInternal(){this.controller_&&(this.controller_.abort(xG),this.controller_=null),super.disposeInternal()}}class h$ extends Gh{constructor(e,n,r,i,s,o){super(e,n,o),this.crossOrigin_=i,this.src_=r,this.key=r,this.image_,jr?this.image_=new OffscreenCanvas(1,1):(this.image_=new Image,i!==null&&(this.image_.crossOrigin=i)),this.unlisten_=null,this.tileLoadFunction_=s}getImage(){return this.image_}setImage(e){this.image_=e,this.state=ue.LOADED,this.unlistenImage_(),this.changed()}getCrossOrigin(){return this.crossOrigin_}handleImageError_(){this.state=ue.ERROR,this.unlistenImage_(),this.image_=SG(),this.changed()}handleImageLoad_(){if(jr)this.state=ue.LOADED;else{const e=this.image_;e.naturalWidth&&e.naturalHeight?this.state=ue.LOADED:this.state=ue.EMPTY}this.unlistenImage_(),this.changed()}load(){this.state==ue.ERROR&&(this.state=ue.IDLE,this.image_=new Image,this.crossOrigin_!==null&&(this.image_.crossOrigin=this.crossOrigin_)),this.state==ue.IDLE&&(this.state=ue.LOADING,this.changed(),this.tileLoadFunction_(this,this.src_),this.unlisten_=f4(this.image_,this.handleImageLoad_.bind(this),this.handleImageError_.bind(this)))}unlistenImage_(){this.unlisten_&&(this.unlisten_(),this.unlisten_=null)}disposeInternal(){this.unlistenImage_(),this.image_=null,super.disposeInternal()}}function SG(){const t=Vt(1,1);return t.fillStyle="rgba(0,0,0,0)",t.fillRect(0,0,1,1),t.canvas}class iE{constructor(e,n,r,i){this.minX=e,this.maxX=n,this.minY=r,this.maxY=i}contains(e){return this.containsXY(e[1],e[2])}containsTileRange(e){return this.minX<=e.minX&&e.maxX<=this.maxX&&this.minY<=e.minY&&e.maxY<=this.maxY}containsXY(e,n){return this.minX<=e&&e<=this.maxX&&this.minY<=n&&n<=this.maxY}equals(e){return this.minX==e.minX&&this.minY==e.minY&&this.maxX==e.maxX&&this.maxY==e.maxY}extend(e){e.minX<this.minX&&(this.minX=e.minX),e.maxX>this.maxX&&(this.maxX=e.maxX),e.minY<this.minY&&(this.minY=e.minY),e.maxY>this.maxY&&(this.maxY=e.maxY)}getHeight(){return this.maxY-this.minY+1}getSize(){return[this.getWidth(),this.getHeight()]}getWidth(){return this.maxX-this.minX+1}intersects(e){return this.minX<=e.maxX&&this.maxX>=e.minX&&this.minY<=e.maxY&&this.maxY>=e.minY}}function bl(t,e,n,r,i){return i!==void 0?(i.minX=t,i.maxX=e,i.minY=n,i.maxY=r,i):new iE(t,e,n,r)}let d0;const _c=[];function ZT(t,e,n,r,i){t.beginPath(),t.moveTo(0,0),t.lineTo(e,n),t.lineTo(r,i),t.closePath(),t.save(),t.clip(),t.fillRect(0,0,Math.max(e,r)+1,Math.max(n,i)),t.restore()}function h0(t,e){return Math.abs(t[e*4]-210)>2||Math.abs(t[e*4+3]-.75*255)>2}function bG(){if(d0===void 0){const t=Vt(6,6,_c);t.globalCompositeOperation="lighter",t.fillStyle="rgba(210, 0, 0, 0.75)",ZT(t,4,5,4,0),ZT(t,4,5,0,5);const e=t.getImageData(0,0,3,3).data;d0=h0(e,0)||h0(e,4)||h0(e,8),$h(t),_c.push(t.canvas)}return d0}function fh(t,e,n,r){const i=nl(n,e,t);let s=Mp(e,r,n);const o=e.getMetersPerUnit();o!==void 0&&(s*=o);const a=t.getMetersPerUnit();a!==void 0&&(s/=a);const l=t.getExtent();if(!l||za(l,i)){const c=Mp(t,s,i)/s;isFinite(c)&&c>0&&(s/=c)}return s}function CG(t,e,n,r){const i=Er(n);let s=fh(t,e,i,r);return(!isFinite(s)||s<=0)&&S1(n,function(o){return s=fh(t,e,o,r),isFinite(s)&&s>0}),s}function f$(t,e,n,r,i,s,o,a,l,c,u,d,h,f){const p=Vt(Math.round(n*t),Math.round(n*e),_c);if(d||(p.imageSmoothingEnabled=!1),l.length===0)return p.canvas;p.scale(n,n);function m(x){return Math.round(x*n)/n}p.globalCompositeOperation="lighter";const _=Mn();l.forEach(function(x,S,C){yO(_,x.extent)});let g;const y=n/r,v=(d?1:1+Math.pow(2,-24))/y;(!h||l.length!==1||c!==0)&&(g=Vt(Math.round(Me(_)*y),Math.round(Gt(_)*y),_c),d||(g.imageSmoothingEnabled=!1),l.forEach(function(x,S,C){if(x.image.width>0&&x.image.height>0){if(x.clipExtent){g.save();const A=(x.clipExtent[0]-_[0])*y,M=-(x.clipExtent[3]-_[3])*y,b=Me(x.clipExtent)*y,j=Gt(x.clipExtent)*y;g.rect(d?A:Math.round(A),d?M:Math.round(M),d?b:Math.round(A+b)-Math.round(A),d?j:Math.round(M+j)-Math.round(M)),g.clip()}const T=(x.extent[0]-_[0])*y,P=-(x.extent[3]-_[3])*y,F=Me(x.extent)*y,k=Gt(x.extent)*y;g.drawImage(x.image,c,c,x.image.width-2*c,x.image.height-2*c,d?T:Math.round(T),d?P:Math.round(P),d?F:Math.round(T+F)-Math.round(T),d?k:Math.round(P+k)-Math.round(P)),x.clipExtent&&g.restore()}}));const w=qo(o);return a.getTriangles().forEach(function(x,S,C){const T=x.source,P=x.target;let F=T[0][0],k=T[0][1],A=T[1][0],M=T[1][1],b=T[2][0],j=T[2][1];const V=m((P[0][0]-w[0])/s),H=m(-(P[0][1]-w[1])/s),U=m((P[1][0]-w[0])/s),B=m(-(P[1][1]-w[1])/s),N=m((P[2][0]-w[0])/s),O=m(-(P[2][1]-w[1])/s),$=F,G=k;F=0,k=0,A-=$,M-=G,b-=$,j-=G;const R=[[A,M,0,0,U-V],[b,j,0,0,N-V],[0,0,A,M,B-H],[0,0,b,j,O-H]],L=Q5(R);if(!L)return;if(p.save(),p.beginPath(),bG()||!d){p.moveTo(U,B);const te=4,ee=V-U,ce=H-B;for(let ge=0;ge<te;ge++)p.lineTo(U+m((ge+1)*ee/te),B+m(ge*ce/(te-1))),ge!=te-1&&p.lineTo(U+m((ge+1)*ee/te),B+m((ge+1)*ce/(te-1)));p.lineTo(N,O)}else p.moveTo(U,B),p.lineTo(V,H),p.lineTo(N,O);p.clip(),p.transform(L[0],L[2],L[1],L[3],V,H),p.translate(_[0]-$,_[3]-G);let W;if(g)W=g.canvas,p.scale(v,-v);else{const te=l[0],ee=te.extent;W=te.image,p.scale(Me(ee)/W.width,-Gt(ee)/W.height)}p.drawImage(W,0,0),p.restore()}),g&&($h(g),_c.push(g.canvas)),u&&(p.save(),p.globalCompositeOperation="source-over",p.strokeStyle="black",p.lineWidth=1,a.getTriangles().forEach(function(x,S,C){const T=x.target,P=(T[0][0]-w[0])/s,F=-(T[0][1]-w[1])/s,k=(T[1][0]-w[0])/s,A=-(T[1][1]-w[1])/s,M=(T[2][0]-w[0])/s,b=-(T[2][1]-w[1])/s;p.beginPath(),p.moveTo(k,A),p.lineTo(P,F),p.lineTo(M,b),p.closePath(),p.stroke()}),p.restore()),p.canvas}const TG=10,qT=.25;class g${constructor(e,n,r,i,s,o,a){this.sourceProj_=e,this.targetProj_=n;let l={};const c=a?mw(v=>$t(a,nl(v,this.targetProj_,this.sourceProj_))):qi(this.targetProj_,this.sourceProj_);this.transformInv_=function(v){const w=v[0]+"/"+v[1];return l[w]||(l[w]=c(v)),l[w]},this.maxSourceExtent_=i,this.errorThresholdSquared_=s*s,this.triangles_=[],this.wrapsXInSource_=!1,this.canWrapXInSource_=this.sourceProj_.canWrapX()&&!!i&&!!this.sourceProj_.getExtent()&&Me(i)>=Me(this.sourceProj_.getExtent()),this.sourceWorldWidth_=this.sourceProj_.getExtent()?Me(this.sourceProj_.getExtent()):null,this.targetWorldWidth_=this.targetProj_.getExtent()?Me(this.targetProj_.getExtent()):null;const u=qo(r),d=Jm(r),h=qm(r),f=Zm(r),p=this.transformInv_(u),m=this.transformInv_(d),_=this.transformInv_(h),g=this.transformInv_(f),y=TG+(o?Math.max(0,Math.ceil(Math.log2(dw(r)/(o*o*256*256)))):0);if(this.addQuad_(u,d,h,f,p,m,_,g,y),this.wrapsXInSource_){let v=1/0;this.triangles_.forEach(function(w,x,S){v=Math.min(v,w.source[0][0],w.source[1][0],w.source[2][0])}),this.triangles_.forEach(w=>{if(Math.max(w.source[0][0],w.source[1][0],w.source[2][0])-v>this.sourceWorldWidth_/2){const x=[[w.source[0][0],w.source[0][1]],[w.source[1][0],w.source[1][1]],[w.source[2][0],w.source[2][1]]];x[0][0]-v>this.sourceWorldWidth_/2&&(x[0][0]-=this.sourceWorldWidth_),x[1][0]-v>this.sourceWorldWidth_/2&&(x[1][0]-=this.sourceWorldWidth_),x[2][0]-v>this.sourceWorldWidth_/2&&(x[2][0]-=this.sourceWorldWidth_);const S=Math.min(x[0][0],x[1][0],x[2][0]);Math.max(x[0][0],x[1][0],x[2][0])-S<this.sourceWorldWidth_/2&&(w.source=x)}})}l={}}addTriangle_(e,n,r,i,s,o){this.triangles_.push({source:[i,s,o],target:[e,n,r]})}addQuad_(e,n,r,i,s,o,a,l,c){const u=_n([s,o,a,l]),d=this.sourceWorldWidth_?Me(u)/this.sourceWorldWidth_:null,h=this.sourceWorldWidth_,f=this.sourceProj_.canWrapX()&&d>.5&&d<1;let p=!1;if(c>0){if(this.targetProj_.isGlobal()&&this.targetWorldWidth_){const _=_n([e,n,r,i]);p=Me(_)/this.targetWorldWidth_>qT||p}!f&&this.sourceProj_.isGlobal()&&d&&(p=d>qT||p)}if(!p&&this.maxSourceExtent_&&isFinite(u[0])&&isFinite(u[1])&&isFinite(u[2])&&isFinite(u[3])&&!Lt(u,this.maxSourceExtent_))return;let m=0;if(!p&&(!isFinite(s[0])||!isFinite(s[1])||!isFinite(o[0])||!isFinite(o[1])||!isFinite(a[0])||!isFinite(a[1])||!isFinite(l[0])||!isFinite(l[1]))){if(c>0)p=!0;else if(m=(!isFinite(s[0])||!isFinite(s[1])?8:0)+(!isFinite(o[0])||!isFinite(o[1])?4:0)+(!isFinite(a[0])||!isFinite(a[1])?2:0)+(!isFinite(l[0])||!isFinite(l[1])?1:0),m!=1&&m!=2&&m!=4&&m!=8)return}if(c>0){if(!p){const _=[(e[0]+r[0])/2,(e[1]+r[1])/2],g=this.transformInv_(_);let y;f?y=(Ps(s[0],h)+Ps(a[0],h))/2-Ps(g[0],h):y=(s[0]+a[0])/2-g[0];const v=(s[1]+a[1])/2-g[1];p=y*y+v*v>this.errorThresholdSquared_}if(p){if(Math.abs(e[0]-r[0])<=Math.abs(e[1]-r[1])){const _=[(n[0]+r[0])/2,(n[1]+r[1])/2],g=this.transformInv_(_),y=[(i[0]+e[0])/2,(i[1]+e[1])/2],v=this.transformInv_(y);this.addQuad_(e,n,_,y,s,o,g,v,c-1),this.addQuad_(y,_,r,i,v,g,a,l,c-1)}else{const _=[(e[0]+n[0])/2,(e[1]+n[1])/2],g=this.transformInv_(_),y=[(r[0]+i[0])/2,(r[1]+i[1])/2],v=this.transformInv_(y);this.addQuad_(e,_,y,i,s,g,v,l,c-1),this.addQuad_(_,n,r,y,g,o,a,v,c-1)}return}}if(f){if(!this.canWrapXInSource_)return;this.wrapsXInSource_=!0}m&11||this.addTriangle_(e,r,i,s,a,l),m&14||this.addTriangle_(e,r,n,s,a,o),m&&(m&13||this.addTriangle_(n,i,e,o,l,s),m&7||this.addTriangle_(n,i,r,o,l,a))}calculateSourceExtent(){const e=Mn();return this.triangles_.forEach(function(n,r,i){const s=n.source;Ed(e,s[0]),Ed(e,s[1]),Ed(e,s[2])}),e}getTriangles(){return this.triangles_}}const p$=.5;class m$ extends Gh{constructor(e,n,r,i,s,o,a,l,c,u,d,h){super(s,ue.IDLE,h),this.renderEdges_=d!==void 0?d:!1,this.pixelRatio_=a,this.gutter_=l,this.canvas_=null,this.sourceTileGrid_=n,this.targetTileGrid_=i,this.wrappedTileCoord_=o||s,this.sourceTiles_=[],this.sourcesListenerKeys_=null,this.sourceZ_=0,this.clipExtent_=e.canWrapX()?e.getExtent():void 0;const f=i.getTileCoordExtent(this.wrappedTileCoord_),p=this.targetTileGrid_.getExtent();let m=this.sourceTileGrid_.getExtent();const _=p?_i(f,p):f;if(dw(_)===0){this.state=ue.EMPTY;return}const g=e.getExtent();g&&(m?m=_i(m,g):m=g);const y=i.getResolution(this.wrappedTileCoord_[0]),v=CG(e,r,_,y);if(!isFinite(v)||v<=0){this.state=ue.EMPTY;return}const w=u!==void 0?u:p$;if(this.triangulation_=new g$(e,r,_,m,v*w,y),this.triangulation_.getTriangles().length===0){this.state=ue.EMPTY;return}this.sourceZ_=n.getZForResolution(v);let x=this.triangulation_.calculateSourceExtent();if(m&&(e.canWrapX()?(x[1]=ct(x[1],m[1],m[3]),x[3]=ct(x[3],m[1],m[3])):x=_i(x,m)),!dw(x))this.state=ue.EMPTY;else{let S=0,C=0;e.canWrapX()&&(S=Me(g),C=Math.floor((x[0]-g[0])/S)),xO(x.slice(),e,!0).forEach(P=>{const F=n.getTileRangeForExtentAndZ(P,this.sourceZ_);for(let k=F.minX;k<=F.maxX;k++)for(let A=F.minY;A<=F.maxY;A++){const M=c(this.sourceZ_,k,A,a);if(M){const b=C*S;this.sourceTiles_.push({tile:M,offset:b})}}++C}),this.sourceTiles_.length===0&&(this.state=ue.EMPTY)}}getImage(){return this.canvas_}reproject_(){const e=[];if(this.sourceTiles_.forEach(n=>{var i;const r=n.tile;if(r&&r.getState()==ue.LOADED){const s=this.sourceTileGrid_.getTileCoordExtent(r.tileCoord);s[0]+=n.offset,s[2]+=n.offset;const o=(i=this.clipExtent_)==null?void 0:i.slice();o&&(o[0]+=n.offset,o[2]+=n.offset),e.push({extent:s,clipExtent:o,image:r.getImage()})}}),this.sourceTiles_.length=0,e.length===0)this.state=ue.ERROR;else{const n=this.wrappedTileCoord_[0],r=this.targetTileGrid_.getTileSize(n),i=typeof r=="number"?r:r[0],s=typeof r=="number"?r:r[1],o=this.targetTileGrid_.getResolution(n),a=this.sourceTileGrid_.getResolution(this.sourceZ_),l=this.targetTileGrid_.getTileCoordExtent(this.wrappedTileCoord_);this.canvas_=f$(i,s,this.pixelRatio_,a,this.sourceTileGrid_.getExtent(),o,l,this.triangulation_,e,this.gutter_,this.renderEdges_,this.interpolate),this.state=ue.LOADED}this.changed()}load(){if(this.state==ue.IDLE){this.state=ue.LOADING,this.changed();let e=0;this.sourcesListenerKeys_=[],this.sourceTiles_.forEach(({tile:n})=>{const r=n.getState();if(r==ue.IDLE||r==ue.LOADING){e++;const i=Oe(n,Se.CHANGE,s=>{const o=n.getState();(o==ue.LOADED||o==ue.ERROR||o==ue.EMPTY)&&(it(i),e--,e===0&&(this.unlistenSources_(),this.reproject_()))});this.sourcesListenerKeys_.push(i)}}),e===0?setTimeout(this.reproject_.bind(this),0):this.sourceTiles_.forEach(function({tile:n},r,i){n.getState()==ue.IDLE&&n.load()})}}unlistenSources_(){this.sourcesListenerKeys_.forEach(it),this.sourcesListenerKeys_=null}release(){this.canvas_&&($h(this.canvas_.getContext("2d")),_c.push(this.canvas_),this.canvas_=null),super.release()}}class Vp{constructor(e){this.highWaterMark=e!==void 0?e:2048,this.count_=0,this.entries_={},this.oldest_=null,this.newest_=null}deleteOldest(){const e=this.pop();e instanceof Lh&&e.dispose()}canExpireCache(){return this.highWaterMark>0&&this.getCount()>this.highWaterMark}expireCache(e){for(;this.canExpireCache();)this.deleteOldest()}clear(){for(;this.oldest_;)this.deleteOldest()}containsKey(e){return this.entries_.hasOwnProperty(e)}forEach(e){let n=this.oldest_;for(;n;)e(n.value_,n.key_,this),n=n.newer}get(e,n){const r=this.entries_[e];return ze(r!==void 0,"Tried to get a value for a key that does not exist in the cache"),r===this.newest_||(r===this.oldest_?(this.oldest_=this.oldest_.newer,this.oldest_.older=null):(r.newer.older=r.older,r.older.newer=r.newer),r.newer=null,r.older=this.newest_,this.newest_.newer=r,this.newest_=r),r.value_}remove(e){const n=this.entries_[e];return ze(n!==void 0,"Tried to get a value for a key that does not exist in the cache"),n===this.newest_?(this.newest_=n.older,this.newest_&&(this.newest_.newer=null)):n===this.oldest_?(this.oldest_=n.newer,this.oldest_&&(this.oldest_.older=null)):(n.newer.older=n.older,n.older.newer=n.newer),delete this.entries_[e],--this.count_,n.value_}getCount(){return this.count_}getKeys(){const e=new Array(this.count_);let n=0,r;for(r=this.newest_;r;r=r.older)e[n++]=r.key_;return e}getValues(){const e=new Array(this.count_);let n=0,r;for(r=this.newest_;r;r=r.older)e[n++]=r.value_;return e}peekLast(){return this.oldest_.value_}peekLastKey(){return this.oldest_.key_}peekFirstKey(){return this.newest_.key_}peek(e){var n;return(n=this.entries_[e])==null?void 0:n.value_}pop(){const e=this.oldest_;return delete this.entries_[e.key_],e.newer&&(e.newer.older=null),this.oldest_=e.newer,this.oldest_||(this.newest_=null),--this.count_,e.value_}replace(e,n){this.get(e),this.entries_[e].value_=n}set(e,n){ze(!(e in this.entries_),"Tried to set a value for a key that is used already");const r={key_:e,newer:null,older:this.newest_,value_:n};this.newest_?this.newest_.newer=r:this.oldest_=r,this.newest_=r,this.entries_[e]=r,++this.count_}setSize(e){this.highWaterMark=e}}function Wp(t,e,n,r){return r!==void 0?(r[0]=t,r[1]=e,r[2]=n,r):[t,e,n]}function PG(t,e,n){return t+"/"+e+"/"+n}function Dg(t,e,n,r,i){return`${fe(t)},${e},${PG(n,r,i)}`}function sE(t){return RG(t[0],t[1],t[2])}function RG(t,e,n){return(e<<t)+n}function IG(t,e){const n=t[0],r=t[1],i=t[2];if(e.getMinZoom()>n||n>e.getMaxZoom())return!1;const s=e.getFullTileRange(n);return s?s.containsXY(r,i):!0}class oE{constructor(){q(this,"pushMethodArgs_",(...e)=>(this.push_(e),this));this.instructions_=[],this.zIndex=0,this.offset_=0,this.context_=new Proxy(Tp(),{get:(e,n)=>{if(typeof Tp()[n]=="function")return this.push_(n),this.pushMethodArgs_},set:(e,n,r)=>(this.push_(n,r),!0)})}push_(...e){const n=this.instructions_,r=this.zIndex+this.offset_;n[r]||(n[r]=[]),n[r].push(...e)}pushFunction(e){this.push_(e)}getContext(){return this.context_}draw(e){this.instructions_.forEach(n=>{for(let r=0,i=n.length;r<i;++r){const s=n[r];if(typeof s=="function"){s(e);continue}const o=n[++r];if(typeof e[s]=="function")e[s](...o);else{if(typeof o=="function"){e[s]=o(e);continue}e[s]=o}}})}clear(){this.instructions_.length=0,this.zIndex=0,this.offset_=0}offset(){this.offset_=this.instructions_.length,this.zIndex=0}}const AG=5;class y$ extends Mh{constructor(e){super(),this.ready=!0,this.boundHandleImageChange_=this.handleImageChange_.bind(this),this.layer_=e,this.staleKeys_=new Array,this.maxStaleKeys=AG}getStaleKeys(){return this.staleKeys_}prependStaleKey(e){this.staleKeys_.unshift(e),this.staleKeys_.length>this.maxStaleKeys&&(this.staleKeys_.length=this.maxStaleKeys)}getFeatures(e){return Te()}getData(e){return null}prepareFrame(e){return Te()}renderFrame(e,n){return Te()}forEachFeatureAtCoordinate(e,n,r,i,s){}getLayer(){return this.layer_}handleFontsChanged(){}handleImageChange_(e){const n=e.target;(n.getState()===ye.LOADED||n.getState()===ye.ERROR)&&this.renderIfReadyAndVisible()}loadImage(e){let n=e.getState();return n!=ye.LOADED&&n!=ye.ERROR&&e.addEventListener(Se.CHANGE,this.boundHandleImageChange_),n==ye.IDLE&&(e.load(),n=e.getState()),n==ye.LOADED}renderIfReadyAndVisible(){const e=this.getLayer();e&&e.getVisible()&&e.getSourceState()==="ready"&&e.changed()}renderDeferred(e){}disposeInternal(){delete this.layer_,super.disposeInternal()}}const JT=[];let Nl=null;function FG(){Nl=Vt(1,1,void 0,{willReadFrequently:!0})}class aE extends y${constructor(e){super(e),this.container=null,this.renderedResolution,this.tempTransform=Bt(),this.pixelTransform=Bt(),this.inversePixelTransform=Bt(),this.context=null,this.deferredContext_=null,this.containerReused=!1,this.frameState=null}getImageData(e,n,r){Nl||FG(),Nl.clearRect(0,0,1,1);let i;try{Nl.drawImage(e,n,r,1,1,0,0,1,1),i=Nl.getImageData(0,0,1,1).data}catch{return Nl=null,null}return i}getBackground(e){let r=this.getLayer().getBackground();return typeof r=="function"&&(r=r(e.viewState.resolution)),r||void 0}useContainer(e,n,r){const i=this.getLayer().getClassName();let s,o;if(e&&e.className===i&&(!r||e&&e.style.backgroundColor&&es(Yr(e.style.backgroundColor),Yr(r)))){const a=e.firstElementChild;_o(a)&&(o=a.getContext("2d"))}if(o&&Cz(o.canvas.style.transform,n)?(this.container=e,this.context=o,this.containerReused=!0):this.containerReused?(this.container=null,this.context=null,this.containerReused=!1):this.container&&(this.container.style.backgroundColor=null),!this.container){s=jr?iO():document.createElement("div"),s.className=i;let a=s.style;a.position="absolute",a.width="100%",a.height="100%",o=Vt();const l=o.canvas;s.appendChild(l),a=l.style,a.position="absolute",a.left="0",a.transformOrigin="top left",this.container=s,this.context=o}!this.containerReused&&r&&!this.container.style.backgroundColor&&(this.container.style.backgroundColor=r)}clipUnrotated(e,n,r){const i=qo(r),s=Jm(r),o=qm(r),a=Zm(r);$t(n.coordinateToPixelTransform,i),$t(n.coordinateToPixelTransform,s),$t(n.coordinateToPixelTransform,o),$t(n.coordinateToPixelTransform,a);const l=this.inversePixelTransform;$t(l,i),$t(l,s),$t(l,o),$t(l,a),e.save(),e.beginPath(),e.moveTo(Math.round(i[0]),Math.round(i[1])),e.lineTo(Math.round(s[0]),Math.round(s[1])),e.lineTo(Math.round(o[0]),Math.round(o[1])),e.lineTo(Math.round(a[0]),Math.round(a[1])),e.clip()}prepareContainer(e,n){const r=e.extent,i=e.viewState.resolution,s=e.viewState.rotation,o=e.pixelRatio,a=Math.round(Me(r)/i*o),l=Math.round(Gt(r)/i*o);Xr(this.pixelTransform,e.size[0]/2,e.size[1]/2,1/o,1/o,s,-a/2,-l/2),lh(this.inversePixelTransform,this.pixelTransform);const c=bz(this.pixelTransform);if(this.useContainer(n,c,this.getBackground(e)),!this.containerReused){const u=this.context.canvas;u.width!=a||u.height!=l?(u.width=a,u.height=l):this.context.clearRect(0,0,a,l),c!==u.style.transform&&(u.style.transform=c)}}dispatchRenderEvent_(e,n,r){const i=this.getLayer();if(i.hasListener(e)){const s=new bd(e,this.inversePixelTransform,r,n);i.dispatchEvent(s)}}preRender(e,n){this.frameState=n,!n.declutter&&this.dispatchRenderEvent_(un.PRERENDER,e,n)}postRender(e,n){n.declutter||this.dispatchRenderEvent_(un.POSTRENDER,e,n)}renderDeferredInternal(e){}getRenderContext(e){return e.declutter&&!this.deferredContext_&&(this.deferredContext_=new oE),e.declutter?this.deferredContext_.getContext():this.context}renderDeferred(e){e.declutter&&(this.dispatchRenderEvent_(un.PRERENDER,this.context,e),e.declutter&&this.deferredContext_&&(this.deferredContext_.draw(this.context),this.deferredContext_.clear()),this.renderDeferredInternal(e),this.dispatchRenderEvent_(un.POSTRENDER,this.context,e))}getRenderTransform(e,n,r,i,s,o,a){const l=s/2,c=o/2,u=i/n,d=-u,h=-e[0]+a,f=-e[1];return Xr(this.tempTransform,l,c,u,d,-r,h,f)}disposeInternal(){delete this.frameState,super.disposeInternal()}}function f0(t,e,n){if(!(n in t))return t[n]=new Set([e]),!0;const r=t[n],i=r.has(e);return i||r.add(e),!i}function OG(t,e,n){const r=t[n];return r?r.delete(e):!1}function QT(t,e){const n=t.layerStatesArray[t.layerIndex];n.extent&&(e=_i(e,fi(n.extent,t.viewState.projection)));const r=n.layer.getRenderSource();if(!r.getWrapX()){const i=r.getTileGridForProjection(t.viewState.projection).getExtent();i&&(e=_i(e,i))}return e}class _$ extends aE{constructor(e,n){super(e),n=n||{},this.extentChanged=!0,this.renderComplete=!1,this.renderedExtent_=null,this.renderedPixelRatio,this.renderedProjection=null,this.renderedTiles=[],this.renderedSourceKey_,this.renderedSourceRevision_,this.tempExtent=Mn(),this.tempTileRange_=new iE(0,0,0,0),this.tempTileCoord_=Wp(0,0,0);const r=n.cacheSize!==void 0?n.cacheSize:512;this.tileCache_=new Vp(r),this.sourceTileCache_=null,this.maxStaleKeys=r*.5}getTileCache(){return this.tileCache_}getSourceTileCache(){return this.sourceTileCache_||(this.sourceTileCache_=new Vp(512)),this.sourceTileCache_}getOrCreateTile(e,n,r,i){const s=this.tileCache_,a=this.getLayer().getSource(),l=Dg(a,a.getKey(),e,n,r);let c;if(s.containsKey(l))c=s.get(l);else{const u=i.viewState.projection,d=a.getProjection();if(c=a.getTile(e,n,r,i.pixelRatio,u,!d||Gn(d,u)?void 0:this.getSourceTileCache()),!c)return null;s.set(l,c)}return c}getTile(e,n,r,i){const s=this.getOrCreateTile(e,n,r,i);return s||null}getData(e){const n=this.frameState;if(!n)return null;const r=this.getLayer(),i=$t(n.pixelToCoordinateTransform,e.slice()),s=r.getExtent();if(s&&!za(s,i))return null;const o=n.viewState,a=r.getRenderSource(),l=a.getTileGridForProjection(o.projection),c=a.getTilePixelRatio(n.pixelRatio);for(let u=l.getZForResolution(o.resolution);u>=l.getMinZoom();--u){const d=l.getTileCoordForCoordAndZ(i,u),h=this.getTile(u,d[1],d[2],n);if(!h||h.getState()!==ue.LOADED)continue;const f=l.getOrigin(u),p=dn(l.getTileSize(u)),m=l.getResolution(u);let _;if(h instanceof h$||h instanceof m$)_=h.getImage();else if(h instanceof XT){if(_=Cw(h.getData()),!_)continue}else continue;const g=Math.floor(c*((i[0]-f[0])/m-d[1]*p[0])),y=Math.floor(c*((f[1]-i[1])/m-d[2]*p[1])),v=Math.round(c*a.getGutterForProjection(o.projection));return this.getImageData(_,g+v,y+v)}return null}prepareFrame(e){var i;this.renderedProjection?e.viewState.projection!==this.renderedProjection&&(this.tileCache_.clear(),this.renderedProjection=e.viewState.projection):this.renderedProjection=e.viewState.projection;const n=this.getLayer().getSource();if(!n)return!1;const r=n.getRevision();return this.renderedSourceRevision_?this.renderedSourceRevision_!==r&&(this.renderedSourceRevision_=r,this.renderedSourceKey_===n.getKey()&&(this.tileCache_.clear(),(i=this.sourceTileCache_)==null||i.clear())):this.renderedSourceRevision_=r,!0}enqueueTilesForNextExtent(){return!0}enqueueTiles(e,n,r,i,s){const o=e.viewState,a=this.getLayer(),l=a.getRenderSource(),c=l.getTileGridForProjection(o.projection),u=fe(l);u in e.wantedTiles||(e.wantedTiles[u]={});const d=e.wantedTiles[u],h=a.getMapInternal(),f=Math.max(r-s,c.getMinZoom(),c.getZForResolution(Math.min(a.getMaxResolution(),h?h.getView().getResolutionForZoom(Math.max(a.getMinZoom(),0)):c.getResolution(0)),l.zDirection)),p=o.rotation,m=p?vO(o.center,o.resolution,p,e.size):void 0;for(let _=r;_>=f;--_){const g=c.getTileRangeForExtentAndZ(n,_,this.tempTileRange_),y=c.getResolution(_);for(let v=g.minX;v<=g.maxX;++v)for(let w=g.minY;w<=g.maxY;++w){if(p&&!c.tileCoordIntersectsViewport([_,v,w],m))continue;const x=this.getTile(_,v,w,e);if(!x||!f0(i,x,_))continue;const C=x.getKey();if(d[C]=!0,x.getState()===ue.IDLE&&!e.tileQueue.isKeyQueued(C)){const T=Wp(_,v,w,this.tempTileCoord_);e.tileQueue.enqueue([x,u,c.getTileCoordCenter(T),y])}}}}findStaleTile_(e,n){const r=this.tileCache_,i=e[0],s=e[1],o=e[2],a=this.getStaleKeys();for(let l=0;l<a.length;++l){const c=Dg(this.getLayer().getSource(),a[l],i,s,o);if(r.containsKey(c)){const u=r.peek(c);if(u.getState()===ue.LOADED)return u.endTransition(fe(this)),f0(n,u,i),!0}}return!1}findAltTiles_(e,n,r,i){const s=e.getTileRangeForTileCoordAndZ(n,r,this.tempTileRange_);if(!s)return!1;let o=!0;const a=this.tileCache_,l=this.getLayer().getRenderSource(),c=l.getKey();for(let u=s.minX;u<=s.maxX;++u)for(let d=s.minY;d<=s.maxY;++d){const h=Dg(l,c,r,u,d);let f=!1;if(a.containsKey(h)){const p=a.peek(h);p.getState()===ue.LOADED&&(f0(i,p,r),f=!0)}f||(o=!1)}return o}renderFrame(e,n){this.renderComplete=!0;const r=e.layerStatesArray[e.layerIndex],i=e.viewState,s=i.projection,o=i.resolution,a=i.center,l=e.pixelRatio,c=this.getLayer(),u=c.getSource(),d=u.getTileGridForProjection(s),h=d.getZForResolution(o,u.zDirection),f=d.getResolution(h),p=u.getKey();this.renderedSourceKey_?this.renderedSourceKey_!==p&&(this.prependStaleKey(this.renderedSourceKey_),this.renderedSourceKey_=p):this.renderedSourceKey_=p;let m=e.extent;const _=u.getTilePixelRatio(l);this.prepareContainer(e,n);const g=this.context.canvas.width,y=this.context.canvas.height,v=r.extent&&fi(r.extent);v&&(m=_i(m,fi(r.extent)));const w=f*g/2/_,x=f*y/2/_,S=[a[0]-w,a[1]-x,a[0]+w,a[1]+x],C={};this.renderedTiles.length=0;const T=c.getPreload();if(e.nextExtent&&this.enqueueTilesForNextExtent()){const U=d.getZForResolution(i.nextResolution,u.zDirection),B=QT(e,e.nextExtent);this.enqueueTiles(e,B,U,C,T)}const P=QT(e,m);if(this.enqueueTiles(e,P,h,C,0),T>0&&setTimeout(()=>{this.enqueueTiles(e,P,h-1,C,T-1)},0),!(h in C))return this.container;const F=fe(this),k=e.time;for(const U of C[h]){const B=U.getState();if(B===ue.EMPTY)continue;const N=U.tileCoord;if(B===ue.LOADED&&U.getAlpha(F,k)===1){U.endTransition(F);continue}if(B!==ue.ERROR&&(this.renderComplete=!1),this.findStaleTile_(N,C)){OG(C,U,h),e.animate=!0;continue}if(this.findAltTiles_(d,N,h+1,C))continue;const G=d.getMinZoom();for(let R=h-1;R>=G&&!this.findAltTiles_(d,N,R,C);--R);}const A=f/o*l/_,M=this.getRenderContext(e);Xr(this.tempTransform,g/2,y/2,A,A,0,-g/2,-y/2),r.extent&&this.clipUnrotated(M,e,v),u.getInterpolate()||(M.imageSmoothingEnabled=!1),this.preRender(M,e);const b=Object.keys(C).map(Number);b.sort(Hi);let j;const V=[],H=[];for(let U=b.length-1;U>=0;--U){const B=b[U],N=u.getTilePixelSize(B,l,s),$=d.getResolution(B)/f,G=N[0]*$*A,R=N[1]*$*A,L=d.getTileCoordForCoordAndZ(qo(S),B),W=d.getTileCoordExtent(L),te=$t(this.tempTransform,[_*(W[0]-S[0])/f,_*(S[3]-W[3])/f]),ee=_*u.getGutterForProjection(s);for(const ce of C[B]){if(ce.getState()!==ue.LOADED)continue;const ge=ce.tileCoord,Ce=L[1]-ge[1],_t=Math.round(te[0]-(Ce-1)*G),vt=L[2]-ge[2],I=Math.round(te[1]-(vt-1)*R),Q=Math.round(te[0]-Ce*G),J=Math.round(te[1]-vt*R),z=_t-Q,D=I-J,Y=b.length===1;let ne=!1;j=[Q,J,Q+z,J,Q+z,J+D,Q,J+D];for(let re=0,X=V.length;re<X;++re)if(!Y&&B<H[re]){const ie=V[re];Lt([Q,J,Q+z,J+D],[ie[0],ie[3],ie[4],ie[7]])&&(ne||(M.save(),ne=!0),M.beginPath(),M.moveTo(j[0],j[1]),M.lineTo(j[2],j[3]),M.lineTo(j[4],j[5]),M.lineTo(j[6],j[7]),M.moveTo(ie[6],ie[7]),M.lineTo(ie[4],ie[5]),M.lineTo(ie[2],ie[3]),M.lineTo(ie[0],ie[1]),M.clip())}V.push(j),H.push(B),this.drawTile(ce,e,Q,J,z,D,ee,Y),ne&&M.restore(),this.renderedTiles.unshift(ce),this.updateUsedTiles(e.usedTiles,u,ce)}}if(this.renderedResolution=f,this.extentChanged=!this.renderedExtent_||!Bo(this.renderedExtent_,S),this.renderedExtent_=S,this.renderedPixelRatio=l,this.postRender(this.context,e),r.extent&&M.restore(),M.imageSmoothingEnabled=!0,this.renderComplete){const U=(B,N)=>{var R;const O=fe(u),$=N.wantedTiles[O],G=$?Object.keys($).length:0;this.updateCacheSize(G),this.tileCache_.expireCache(),(R=this.sourceTileCache_)==null||R.expireCache()};e.postRenderFunctions.push(U)}return this.container}updateCacheSize(e){this.tileCache_.highWaterMark=Math.max(this.tileCache_.highWaterMark,e*2)}drawTile(e,n,r,i,s,o,a,l){let c;if(e instanceof XT){if(c=Cw(e.getData()),!c)throw new Error("Rendering array data is not yet supported")}else c=this.getTileImage(e);if(!c)return;const u=this.getRenderContext(n),d=fe(this),h=n.layerStatesArray[n.layerIndex],f=h.opacity*(l?e.getAlpha(d,n.time):1),p=f!==u.globalAlpha;p&&(u.save(),u.globalAlpha=f),u.drawImage(c,a,a,c.width-2*a,c.height-2*a,r,i,s,o),p&&u.restore(),f!==h.opacity?n.animate=!0:l&&e.endTransition(d)}getImage(){const e=this.context;return e?e.canvas:null}getTileImage(e){return e.getImage()}updateUsedTiles(e,n,r){const i=fe(n);i in e||(e[i]={}),e[i][r.getKey()]=!0}}const xo={PRELOAD:"preload",USE_INTERIM_TILES_ON_ERROR:"useInterimTilesOnError"};class $G extends lu{constructor(e){e=e||{};const n=Object.assign({},e),r=e.cacheSize;delete e.cacheSize,delete n.preload,delete n.useInterimTilesOnError,super(n),this.on,this.once,this.un,this.cacheSize_=r,this.setPreload(e.preload!==void 0?e.preload:0),this.setUseInterimTilesOnError(e.useInterimTilesOnError!==void 0?e.useInterimTilesOnError:!0)}getCacheSize(){return this.cacheSize_}getPreload(){return this.get(xo.PRELOAD)}setPreload(e){this.set(xo.PRELOAD,e)}getUseInterimTilesOnError(){return this.get(xo.USE_INTERIM_TILES_ON_ERROR)}setUseInterimTilesOnError(e){this.set(xo.USE_INTERIM_TILES_ON_ERROR,e)}getData(e){return super.getData(e)}}class jl extends $G{constructor(e){super(e)}createRenderer(){return new _$(this,{cacheSize:this.getCacheSize()})}}class LG extends aE{constructor(e){super(e),this.image=null}getImage(){return this.image?this.image.getImage():null}prepareFrame(e){const n=e.layerStatesArray[e.layerIndex],r=e.pixelRatio,i=e.viewState,s=i.resolution,o=this.getLayer().getSource(),a=e.viewHints;let l=e.extent;if(n.extent!==void 0&&(l=_i(l,fi(n.extent,i.projection))),!a[gt.ANIMATING]&&!a[gt.INTERACTING]&&!tl(l))if(o){const c=i.projection,u=o.getImage(l,s,r,c);u&&(this.loadImage(u)?this.image=u:u.getState()===ye.EMPTY&&(this.image=null))}else this.image=null;return!!this.image}getData(e){const n=this.frameState;if(!n)return null;const r=this.getLayer(),i=$t(n.pixelToCoordinateTransform,e.slice()),s=r.getExtent();if(s&&!za(s,i))return null;const o=this.image.getExtent(),a=this.image.getImage(),l=Me(o),c=Math.floor(a.width*((i[0]-o[0])/l));if(c<0||c>=a.width)return null;const u=Gt(o),d=Math.floor(a.height*((o[3]-i[1])/u));return d<0||d>=a.height?null:this.getImageData(a,c,d)}renderFrame(e,n){const r=this.image,i=r.getExtent(),s=r.getResolution(),[o,a]=Array.isArray(s)?s:[s,s],l=r.getPixelRatio(),c=e.layerStatesArray[e.layerIndex],u=e.pixelRatio,d=e.viewState,h=d.center,f=d.resolution,p=u*o/(f*l),m=u*a/(f*l);this.prepareContainer(e,n);const _=this.context.canvas.width,g=this.context.canvas.height,y=this.getRenderContext(e);let v=!1,w=!0;if(c.extent){const P=fi(c.extent,d.projection);w=Lt(P,e.extent),v=w&&!ji(P,e.extent),v&&this.clipUnrotated(y,e,P)}const x=r.getImage(),S=Xr(this.tempTransform,_/2,g/2,p,m,0,l*(i[0]-h[0])/o,l*(h[1]-i[3])/a);this.renderedResolution=a*u/l;const C=x.width*S[0],T=x.height*S[3];if(this.getLayer().getSource().getInterpolate()||(y.imageSmoothingEnabled=!1),this.preRender(y,e),w&&C>=.5&&T>=.5){const P=S[4],F=S[5],k=c.opacity;k!==1&&(y.save(),y.globalAlpha=k),y.drawImage(x,0,0,+x.width,+x.height,P,F,C,T),k!==1&&y.restore()}return this.postRender(this.context,e),v&&y.restore(),y.imageSmoothingEnabled=!0,this.container}}class kG extends lu{constructor(e){e=e||{},super(e)}}class v$ extends kG{constructor(e){super(e)}createRenderer(){return new LG(this)}getData(e){return super.getData(e)}}function Tw(t){return Array.isArray(t)?Math.min(...t):t}class MG extends v1{constructor(e,n,r,i,s,o,a){let l=e.getExtent();l&&e.canWrapX()&&(l=l.slice(),l[0]=-1/0,l[2]=1/0);let c=n.getExtent();c&&n.canWrapX()&&(c=c.slice(),c[0]=-1/0,c[2]=1/0);const u=c?_i(r,c):r,d=Er(u),h=fh(e,n,d,i),f=p$,p=new g$(e,n,u,l,h*f,i),m=p.calculateSourceExtent(),_=tl(m)?null:o(m,h,s),g=_?ye.IDLE:ye.EMPTY,y=_?_.getPixelRatio():1;super(r,i,y,g),this.targetProj_=n,this.maxSourceExtent_=l,this.triangulation_=p,this.targetResolution_=i,this.targetExtent_=r,this.sourceImage_=_,this.sourcePixelRatio_=y,this.interpolate_=a,this.canvas_=null,this.sourceListenerKey_=null}disposeInternal(){this.state==ye.LOADING&&this.unlistenSource_(),super.disposeInternal()}getImage(){return this.canvas_}getProjection(){return this.targetProj_}reproject_(){const e=this.sourceImage_.getState();if(e==ye.LOADED){const n=Me(this.targetExtent_)/this.targetResolution_,r=Gt(this.targetExtent_)/this.targetResolution_;this.canvas_=f$(n,r,this.sourcePixelRatio_,Tw(this.sourceImage_.getResolution()),this.maxSourceExtent_,this.targetResolution_,this.targetExtent_,this.triangulation_,[{extent:this.sourceImage_.getExtent(),image:this.sourceImage_.getImage()}],0,void 0,this.interpolate_,!0)}this.state=e,this.changed()}load(){if(this.state==ye.IDLE){this.state=ye.LOADING,this.changed();const e=this.sourceImage_.getState();e==ye.LOADED||e==ye.ERROR?this.reproject_():(this.sourceListenerKey_=Oe(this.sourceImage_,Se.CHANGE,n=>{const r=this.sourceImage_.getState();(r==ye.LOADED||r==ye.ERROR)&&(this.unlistenSource_(),this.reproject_())}),this.sourceImage_.load())}}unlistenSource_(){it(this.sourceListenerKey_),this.sourceListenerKey_=null}}class lE extends bi{constructor(e){super(),this.projection=Ne(e.projection),this.attributions_=eP(e.attributions),this.attributionsCollapsible_=e.attributionsCollapsible??!0,this.loading=!1,this.state_=e.state!==void 0?e.state:"ready",this.wrapX_=e.wrapX!==void 0?e.wrapX:!1,this.interpolate_=!!e.interpolate,this.viewResolver=null,this.viewRejector=null;const n=this;this.viewPromise_=new Promise(function(r,i){n.viewResolver=r,n.viewRejector=i})}getAttributions(){return this.attributions_}getAttributionsCollapsible(){return this.attributionsCollapsible_}getProjection(){return this.projection}getResolutions(e){return null}getView(){return this.viewPromise_}getState(){return this.state_}getWrapX(){return this.wrapX_}getInterpolate(){return this.interpolate_}refresh(){this.changed()}setAttributions(e){this.attributions_=eP(e),this.changed()}setState(e){this.state_=e,this.changed()}}function eP(t){return t?typeof t=="function"?t:(Array.isArray(t)||(t=[t]),e=>t):null}const zi=4,g0={IMAGELOADSTART:"imageloadstart",IMAGELOADEND:"imageloadend",IMAGELOADERROR:"imageloaderror"};class DG extends Cr{constructor(e,n){super(e),this.image=n}}class cE extends lE{constructor(e){super({attributions:e.attributions,projection:e.projection,state:e.state,interpolate:e.interpolate!==void 0?e.interpolate:!0}),this.on,this.once,this.un,this.loader=e.loader||null,this.resolutions_=e.resolutions!==void 0?e.resolutions:null,this.reprojectedImage_=null,this.reprojectedRevision_=0,this.image=null,this.wantedExtent_,this.wantedResolution_,this.static_=e.loader?e.loader.length===0:!1,this.wantedProjection_=null}getResolutions(){return this.resolutions_}setResolutions(e){this.resolutions_=e}findNearestResolution(e){const n=this.getResolutions();if(n){const r=Hm(n,e,0);e=n[r]}return e}getImage(e,n,r,i){const s=this.getProjection();if(!s||!i||Gn(s,i))return s&&(i=s),this.getImageInternal(e,n,r,i);if(this.reprojectedImage_){if(this.reprojectedRevision_==this.getRevision()&&Gn(this.reprojectedImage_.getProjection(),i)&&this.reprojectedImage_.getResolution()==n&&Bo(this.reprojectedImage_.getExtent(),e))return this.reprojectedImage_;this.reprojectedImage_.dispose(),this.reprojectedImage_=null}return this.reprojectedImage_=new MG(s,i,e,n,r,(o,a,l)=>this.getImageInternal(o,a,l,s),this.getInterpolate()),this.reprojectedRevision_=this.getRevision(),this.reprojectedImage_}getImageInternal(e,n,r,i){if(this.loader){const s=dE(e,n,r,1),o=this.findNearestResolution(n);if(this.image&&(this.static_||this.wantedProjection_===i&&(this.wantedExtent_&&ji(this.wantedExtent_,s)||ji(this.image.getExtent(),s))&&(this.wantedResolution_&&Tw(this.wantedResolution_)===o||Tw(this.image.getResolution())===o)))return this.image;this.wantedProjection_=i,this.wantedExtent_=s,this.wantedResolution_=o,this.image=new v1(s,o,r,this.loader),this.image.addEventListener(Se.CHANGE,this.handleImageChange.bind(this))}return this.image}handleImageChange(e){const n=e.target;let r;switch(n.getState()){case ye.LOADING:this.loading=!0,r=g0.IMAGELOADSTART;break;case ye.LOADED:this.loading=!1,r=g0.IMAGELOADEND;break;case ye.ERROR:this.loading=!1,r=g0.IMAGELOADERROR;break;default:return}this.hasListener(r)&&this.dispatchEvent(new DG(r,n))}}function uE(t,e){t.getImage().src=e}function dE(t,e,n,r){const i=e/n,s=Er(t),o=vo(Me(t)/i,zi),a=vo(Gt(t)/i,zi),l=vo((r-1)*o/2,zi),c=o+2*l,u=vo((r-1)*a/2,zi),d=a+2*u;return ah(s,i,0,[c,d])}function NG(t){const e=t.load||ru,n=t.imageExtent,r=t.crossOrigin??null;return()=>{const i=new Image;return i.crossOrigin=r,e(i,t.url).then(s=>{const o=Me(n)/s.width,a=Gt(n)/s.height;return{image:s,extent:n,resolution:o!==a?[o,a]:a,pixelRatio:1}})}}class jG extends cE{constructor(e){const n=e.crossOrigin!==void 0?e.crossOrigin:null,r=e.imageLoadFunction!==void 0?e.imageLoadFunction:uE;super({attributions:e.attributions,interpolate:e.interpolate,projection:Ne(e.projection)}),this.url_=e.url,this.imageExtent_=e.imageExtent,this.image=null,this.image=new v1(this.imageExtent_,void 0,1,NG({url:e.url,imageExtent:e.imageExtent,crossOrigin:n,load:(i,s)=>(this.image.setImage(i),r(this.image,s),ru(i))})),this.image.addEventListener(Se.CHANGE,this.handleImageChange.bind(this))}getImageExtent(){return this.imageExtent_}getImageInternal(e,n,r,i){return Lt(e,this.image.getExtent())?this.image:null}getUrl(){return this.url_}}function uy(t,e){const n=[];Object.keys(e).forEach(function(i){e[i]!==null&&e[i]!==void 0&&n.push(i+"="+encodeURIComponent(e[i]))});const r=n.join("&");return t=t.replace(/[?&]$/,""),t+=t.includes("?")?"&":"?",t+r}const zG=/\{z\}/g,UG=/\{x\}/g,GG=/\{y\}/g,BG=/\{-y\}/g;function VG(t,e,n,r,i){return t.replace(zG,e.toString()).replace(UG,n.toString()).replace(GG,r.toString()).replace(BG,function(){if(i===void 0)throw new Error("If the URL template has a {-y} placeholder, the grid extent must be known");return(i-r).toString()})}function WG(t){const e=[];let n=/\{([a-z])-([a-z])\}/.exec(t);if(n){const r=n[1].charCodeAt(0),i=n[2].charCodeAt(0);let s;for(s=r;s<=i;++s)e.push(t.replace(n[0],String.fromCharCode(s)));return e}if(n=/\{(\d+)-(\d+)\}/.exec(t),n){const r=parseInt(n[2],10);for(let i=parseInt(n[1],10);i<=r;i++)e.push(t.replace(n[0],i.toString()));return e}return e.push(t),e}const Hp="1.3.0",tP=[101,101];function w$(t,e,n,r,i){i.WIDTH=n[0],i.HEIGHT=n[1];const s=r.getAxisOrientation(),o=b1(i.VERSION,"1.3")>=0;i[o?"CRS":"SRS"]=r.getCode();const a=o&&s.startsWith("ne")?[e[1],e[0],e[3],e[2]]:e;return i.BBOX=a.join(","),uy(t,i)}function x$(t,e,n,r,i,s,o){s=Object.assign({REQUEST:"GetMap"},s);const a=e/n,l=[Ip(Me(t)/a,zi),Ip(Gt(t)/a,zi)];if(n!=1)switch(o){case"geoserver":const u=90*n+.5|0;"FORMAT_OPTIONS"in s?s.FORMAT_OPTIONS+=";dpi:"+u:s.FORMAT_OPTIONS="dpi:"+u;break;case"mapserver":s.MAP_RESOLUTION=90*n;break;case"carmentaserver":case"qgis":s.DPI=90*n;break;default:throw new Error("Unknown `serverType` configured")}return w$(i,t,l,r,s)}function Kp(t,e){return Object.assign({REQUEST:e,SERVICE:"WMS",VERSION:Hp,FORMAT:"image/png",STYLES:"",TRANSPARENT:"TRUE"},t)}function HG(t){const e=t.hidpi===void 0?!0:t.hidpi,n=Ne(t.projection||"EPSG:3857"),r=t.ratio||1.5,i=t.load||ru,s=t.crossOrigin??null;return(o,a,l)=>{o=dE(o,a,l,r),l!=1&&(!e||t.serverType===void 0)&&(l=1);const c=x$(o,a,l,n,t.url,Kp(t.params,"GetMap"),t.serverType),u=new Image;return u.crossOrigin=s,i(u,c).then(d=>({image:d,extent:o,pixelRatio:l}))}}function KG(t,e,n){if(t.url===void 0)return;const r=Ne(t.projection||"EPSG:3857"),i=ah(e,n,0,tP),s={QUERY_LAYERS:t.params.LAYERS,INFO_FORMAT:"application/json"};Object.assign(s,Kp(t.params,"GetFeatureInfo"),t.params);const o=Ql((e[0]-i[0])/n,zi),a=Ql((i[3]-e[1])/n,zi),l=b1(s.VERSION,"1.3")>=0;return s[l?"I":"X"]=o,s[l?"J":"Y"]=a,w$(t.url,i,tP,r,s)}function YG(t,e){if(t.url===void 0)return;const n={SERVICE:"WMS",VERSION:Hp,REQUEST:"GetLegendGraphic",FORMAT:"image/png"};if(e!==void 0){const r=Ne(t.projection||"EPSG:3857").getMetersPerUnit()||1,i=28e-5;n.SCALE=e*r/i}if(Object.assign(n,t.params),t.params!==void 0&&n.LAYER===void 0){const r=n.LAYERS;if(!(!Array.isArray(r)||r.length!==1))return;n.LAYER=r}return uy(t.url,n)}class XG extends cE{constructor(e){e=e||{},super({attributions:e.attributions,interpolate:e.interpolate,projection:e.projection,resolutions:e.resolutions}),this.crossOrigin_=e.crossOrigin!==void 0?e.crossOrigin:null,this.url_=e.url,this.imageLoadFunction_=e.imageLoadFunction!==void 0?e.imageLoadFunction:uE,this.params_=Object.assign({},e.params),this.serverType_=e.serverType,this.hidpi_=e.hidpi!==void 0?e.hidpi:!0,this.renderedRevision_=0,this.ratio_=e.ratio!==void 0?e.ratio:1.5,this.loaderProjection_=null}getFeatureInfoUrl(e,n,r,i){const s=Ne(r),o=this.getProjection();o&&o!==s&&(n=fh(o,s,e,n),e=nl(e,s,o));const a={url:this.url_,params:{...this.params_,...i},projection:o||s};return KG(a,e,n)}getLegendUrl(e,n){return YG({url:this.url_,params:{...this.params_,...n}},e)}getParams(){return this.params_}getImageInternal(e,n,r,i){return this.url_===void 0?null:((!this.loader||this.loaderProjection_!==i)&&(this.loaderProjection_=i,this.loader=HG({crossOrigin:this.crossOrigin_,params:this.params_,projection:i,serverType:this.serverType_,hidpi:this.hidpi_,url:this.url_,ratio:this.ratio_,load:(s,o)=>(this.image.setImage(s),this.imageLoadFunction_(this.image,o),ru(s))})),super.getImageInternal(e,n,r,i))}getImageLoadFunction(){return this.imageLoadFunction_}getUrl(){return this.url_}setImageLoadFunction(e){this.imageLoadFunction_=e,this.changed()}setUrl(e){e!=this.url_&&(this.url_=e,this.loader=null,this.changed())}setParams(e){this.params_=Object.assign({},e),this.changed()}updateParams(e){Object.assign(this.params_,e),this.changed()}changed(){this.image=null,super.changed()}}const Cl=[0,0,0],eo=5;class hE{constructor(e){this.minZoom=e.minZoom!==void 0?e.minZoom:0,this.resolutions_=e.resolutions,ze(h4(this.resolutions_,(i,s)=>s-i),"`resolutions` must be sorted in descending order");let n;if(!e.origins){for(let i=0,s=this.resolutions_.length-1;i<s;++i)if(!n)n=this.resolutions_[i]/this.resolutions_[i+1];else if(this.resolutions_[i]/this.resolutions_[i+1]!==n){n=void 0;break}}this.zoomFactor_=n,this.maxZoom=this.resolutions_.length-1,this.origin_=e.origin!==void 0?e.origin:null,this.origins_=null,e.origins!==void 0&&(this.origins_=e.origins,ze(this.origins_.length==this.resolutions_.length,"Number of `origins` and `resolutions` must be equal"));const r=e.extent;r!==void 0&&!this.origin_&&!this.origins_&&(this.origin_=qo(r)),ze(!this.origin_&&this.origins_||this.origin_&&!this.origins_,"Either `origin` or `origins` must be configured, never both"),this.tileSizes_=null,e.tileSizes!==void 0&&(this.tileSizes_=e.tileSizes,ze(this.tileSizes_.length==this.resolutions_.length,"Number of `tileSizes` and `resolutions` must be equal")),this.tileSize_=e.tileSize!==void 0?e.tileSize:this.tileSizes_?null:X1,ze(!this.tileSize_&&this.tileSizes_||this.tileSize_&&!this.tileSizes_,"Either `tileSize` or `tileSizes` must be configured, never both"),this.extent_=r!==void 0?r:null,this.fullTileRanges_=null,this.tmpSize_=[0,0],this.tmpExtent_=[0,0,0,0],e.sizes!==void 0?this.fullTileRanges_=e.sizes.map((i,s)=>{const o=new iE(Math.min(0,i[0]),Math.max(i[0]-1,-1),Math.min(0,i[1]),Math.max(i[1]-1,-1));if(r){const a=this.getTileRangeForExtentAndZ(r,s);o.minX=Math.max(a.minX,o.minX),o.maxX=Math.min(a.maxX,o.maxX),o.minY=Math.max(a.minY,o.minY),o.maxY=Math.min(a.maxY,o.maxY)}return o}):r&&this.calculateTileRanges_(r)}forEachTileCoord(e,n,r){const i=this.getTileRangeForExtentAndZ(e,n);for(let s=i.minX,o=i.maxX;s<=o;++s)for(let a=i.minY,l=i.maxY;a<=l;++a)r([n,s,a])}forEachTileCoordParentTileRange(e,n,r,i){let s,o,a,l=null,c=e[0]-1;for(this.zoomFactor_===2?(o=e[1],a=e[2]):l=this.getTileCoordExtent(e,i);c>=this.minZoom;){if(o!==void 0&&a!==void 0?(o=Math.floor(o/2),a=Math.floor(a/2),s=bl(o,o,a,a,r)):s=this.getTileRangeForExtentAndZ(l,c,r),n(c,s))return!0;--c}return!1}getExtent(){return this.extent_}getMaxZoom(){return this.maxZoom}getMinZoom(){return this.minZoom}getOrigin(e){return this.origin_?this.origin_:this.origins_[e]}getResolution(e){return this.resolutions_[e]}getResolutions(){return this.resolutions_}getTileCoordChildTileRange(e,n,r){if(e[0]<this.maxZoom){if(this.zoomFactor_===2){const s=e[1]*2,o=e[2]*2;return bl(s,s+1,o,o+1,n)}const i=this.getTileCoordExtent(e,r||this.tmpExtent_);return this.getTileRangeForExtentAndZ(i,e[0]+1,n)}return null}getTileRangeForTileCoordAndZ(e,n,r){if(n>this.maxZoom||n<this.minZoom)return null;const i=e[0],s=e[1],o=e[2];if(n===i)return bl(s,o,s,o,r);if(this.zoomFactor_){const l=Math.pow(this.zoomFactor_,n-i),c=Math.floor(s*l),u=Math.floor(o*l);if(n<i)return bl(c,c,u,u,r);const d=Math.floor(l*(s+1))-1,h=Math.floor(l*(o+1))-1;return bl(c,d,u,h,r)}const a=this.getTileCoordExtent(e,this.tmpExtent_);return this.getTileRangeForExtentAndZ(a,n,r)}getTileRangeForExtentAndZ(e,n,r){this.getTileCoordForXYAndZ_(e[0],e[3],n,!1,Cl);const i=Cl[1],s=Cl[2];this.getTileCoordForXYAndZ_(e[2],e[1],n,!0,Cl);const o=Cl[1],a=Cl[2];return bl(i,o,s,a,r)}getTileCoordCenter(e){const n=this.getOrigin(e[0]),r=this.getResolution(e[0]),i=dn(this.getTileSize(e[0]),this.tmpSize_);return[n[0]+(e[1]+.5)*i[0]*r,n[1]-(e[2]+.5)*i[1]*r]}getTileCoordExtent(e,n){const r=this.getOrigin(e[0]),i=this.getResolution(e[0]),s=dn(this.getTileSize(e[0]),this.tmpSize_),o=r[0]+e[1]*s[0]*i,a=r[1]-(e[2]+1)*s[1]*i,l=o+s[0]*i,c=a+s[1]*i;return Zi(o,a,l,c,n)}getTileCoordForCoordAndResolution(e,n,r){return this.getTileCoordForXYAndResolution_(e[0],e[1],n,!1,r)}getTileCoordForXYAndResolution_(e,n,r,i,s){const o=this.getZForResolution(r),a=r/this.getResolution(o),l=this.getOrigin(o),c=dn(this.getTileSize(o),this.tmpSize_);let u=a*(e-l[0])/r/c[0],d=a*(l[1]-n)/r/c[1];return i?(u=vo(u,eo)-1,d=vo(d,eo)-1):(u=Ql(u,eo),d=Ql(d,eo)),Wp(o,u,d,s)}getTileCoordForXYAndZ_(e,n,r,i,s){const o=this.getOrigin(r),a=this.getResolution(r),l=dn(this.getTileSize(r),this.tmpSize_);let c=(e-o[0])/a/l[0],u=(o[1]-n)/a/l[1];return i?(c=vo(c,eo)-1,u=vo(u,eo)-1):(c=Ql(c,eo),u=Ql(u,eo)),Wp(r,c,u,s)}getTileCoordForCoordAndZ(e,n,r){return this.getTileCoordForXYAndZ_(e[0],e[1],n,!1,r)}getTileCoordResolution(e){return this.resolutions_[e[0]]}getTileSize(e){return this.tileSize_?this.tileSize_:this.tileSizes_[e]}getFullTileRange(e){return this.fullTileRanges_?this.fullTileRanges_[e]:this.extent_?this.getTileRangeForExtentAndZ(this.extent_,e):null}getZForResolution(e,n){const r=Hm(this.resolutions_,e,n||0);return ct(r,this.minZoom,this.maxZoom)}tileCoordIntersectsViewport(e,n){return BO(n,0,n.length,2,this.getTileCoordExtent(e))}calculateTileRanges_(e){const n=this.resolutions_.length,r=new Array(n);for(let i=this.minZoom;i<n;++i)r[i]=this.getTileRangeForExtentAndZ(e,i);this.fullTileRanges_=r}}function dy(t){let e=t.getDefaultTileGrid();return e||(e=JG(t),t.setDefaultTileGrid(e)),e}function ZG(t,e,n){const r=e[0],i=t.getTileCoordCenter(e),s=hy(n);if(!za(s,i)){const o=Me(s),a=Math.ceil((s[0]-i[0])/o);return i[0]+=o*a,t.getTileCoordForCoordAndZ(i,r)}return e}function qG(t,e,n,r){r=r!==void 0?r:"top-left";const i=S$(t,e,n);return new hE({extent:t,origin:j4(t,r),resolutions:i,tileSize:n})}function E$(t){const e=t||{},n=e.extent||Ne("EPSG:3857").getExtent(),r={extent:n,minZoom:e.minZoom,tileSize:e.tileSize,resolutions:S$(n,e.maxZoom,e.tileSize,e.maxResolution)};return new hE(r)}function S$(t,e,n,r){e=e!==void 0?e:HO,n=dn(n!==void 0?n:X1);const i=Gt(t),s=Me(t);r=r>0?r:Math.max(s/n[0],i/n[1]);const o=e+1,a=new Array(o);for(let l=0;l<o;++l)a[l]=r/Math.pow(2,l);return a}function JG(t,e,n,r){const i=hy(t);return qG(i,e,n,r)}function hy(t){t=Ne(t);let e=t.getExtent();if(!e){const n=180*Nc.degrees/t.getMetersPerUnit();e=Zi(-n,-n,n,n)}return e}function QG(t,e){return function(n,r,i){if(!n)return;let s;const o=n[0];if(e){const a=e.getFullTileRange(o);a&&(s=a.getHeight()-1)}return VG(t,o,n[1],n[2],s)}}function b$(t,e){const n=t.length,r=new Array(n);for(let i=0;i<n;++i)r[i]=QG(t[i],e);return e6(r)}function e6(t){return t.length===1?t[0]:function(e,n,r){if(!e)return;const i=sE(e),s=Ps(i,t.length);return t[s](e,n,r)}}class t6 extends lE{constructor(e){super({attributions:e.attributions,attributionsCollapsible:e.attributionsCollapsible,projection:e.projection,state:e.state,wrapX:e.wrapX,interpolate:e.interpolate}),this.on,this.once,this.un,this.tilePixelRatio_=e.tilePixelRatio!==void 0?e.tilePixelRatio:1,this.tileGrid=e.tileGrid!==void 0?e.tileGrid:null;const n=[256,256];this.tileGrid&&dn(this.tileGrid.getTileSize(this.tileGrid.getMinZoom()),n),this.tmpSize=[0,0],this.key_=e.key||fe(this),this.tileOptions={transition:e.transition,interpolate:e.interpolate},this.zDirection=e.zDirection?e.zDirection:0}getGutterForProjection(e){return 0}getKey(){return this.key_}setKey(e){this.key_!==e&&(this.key_=e,this.changed())}getResolutions(e){const n=e?this.getTileGridForProjection(e):this.tileGrid;return n?n.getResolutions():null}getTile(e,n,r,i,s,o){return Te()}getTileGrid(){return this.tileGrid}getTileGridForProjection(e){return this.tileGrid?this.tileGrid:dy(e)}getTilePixelRatio(e){return this.tilePixelRatio_}getTilePixelSize(e,n,r){const i=this.getTileGridForProjection(r),s=this.getTilePixelRatio(n),o=dn(i.getTileSize(e),this.tmpSize);return s==1?o:fO(o,s,this.tmpSize)}getTileCoordForTileUrlFunction(e,n){const r=n!==void 0?n:this.getProjection(),i=n!==void 0?this.getTileGridForProjection(r):this.tileGrid||this.getTileGridForProjection(r);return this.getWrapX()&&r.isGlobal()&&(e=ZG(i,e,r)),IG(e,i)?e:null}clear(){}refresh(){this.clear(),super.refresh()}}class n6 extends Cr{constructor(e,n){super(e),this.tile=n}}const p0={TILELOADSTART:"tileloadstart",TILELOADEND:"tileloadend",TILELOADERROR:"tileloaderror"};class fy extends t6{constructor(e){super({attributions:e.attributions,cacheSize:e.cacheSize,projection:e.projection,state:e.state,tileGrid:e.tileGrid,tilePixelRatio:e.tilePixelRatio,wrapX:e.wrapX,transition:e.transition,interpolate:e.interpolate,key:e.key,attributionsCollapsible:e.attributionsCollapsible,zDirection:e.zDirection}),this.generateTileUrlFunction_=this.tileUrlFunction===fy.prototype.tileUrlFunction,this.tileLoadFunction=e.tileLoadFunction,e.tileUrlFunction&&(this.tileUrlFunction=e.tileUrlFunction),this.urls=null,e.urls?this.setUrls(e.urls):e.url&&this.setUrl(e.url),this.tileLoadingKeys_={}}getTileLoadFunction(){return this.tileLoadFunction}getTileUrlFunction(){return Object.getPrototypeOf(this).tileUrlFunction===this.tileUrlFunction?this.tileUrlFunction.bind(this):this.tileUrlFunction}getUrls(){return this.urls}handleTileChange(e){const n=e.target,r=fe(n),i=n.getState();let s;i==ue.LOADING?(this.tileLoadingKeys_[r]=!0,s=p0.TILELOADSTART):r in this.tileLoadingKeys_&&(delete this.tileLoadingKeys_[r],s=i==ue.ERROR?p0.TILELOADERROR:i==ue.LOADED?p0.TILELOADEND:void 0),s!=null&&this.dispatchEvent(new n6(s,n))}setTileLoadFunction(e){this.tileLoadFunction=e,this.changed()}setTileUrlFunction(e,n){this.tileUrlFunction=e,typeof n<"u"?this.setKey(n):this.changed()}setUrl(e){const n=WG(e);this.urls=n,this.setUrls(n)}setUrls(e){this.urls=e;const n=e.join(`
`);this.generateTileUrlFunction_?this.setTileUrlFunction(b$(e,this.tileGrid),n):this.setKey(n)}tileUrlFunction(e,n,r){}}class gy extends fy{constructor(e){super({attributions:e.attributions,cacheSize:e.cacheSize,projection:e.projection,state:e.state,tileGrid:e.tileGrid,tileLoadFunction:e.tileLoadFunction?e.tileLoadFunction:r6,tilePixelRatio:e.tilePixelRatio,tileUrlFunction:e.tileUrlFunction,url:e.url,urls:e.urls,wrapX:e.wrapX,transition:e.transition,interpolate:e.interpolate!==void 0?e.interpolate:!0,key:e.key,attributionsCollapsible:e.attributionsCollapsible,zDirection:e.zDirection}),this.crossOrigin=e.crossOrigin!==void 0?e.crossOrigin:null,this.tileClass=e.tileClass!==void 0?e.tileClass:h$,this.tileGridForProjection={},this.reprojectionErrorThreshold_=e.reprojectionErrorThreshold,this.renderReprojectionEdges_=!1}getGutterForProjection(e){return this.getProjection()&&e&&!Gn(this.getProjection(),e)?0:this.getGutter()}getGutter(){return 0}getKey(){let e=super.getKey();return this.getInterpolate()||(e+=":disable-interpolation"),e}getTileGridForProjection(e){const n=this.getProjection();if(this.tileGrid&&(!n||Gn(n,e)))return this.tileGrid;const r=fe(e);return r in this.tileGridForProjection||(this.tileGridForProjection[r]=dy(e)),this.tileGridForProjection[r]}createTile_(e,n,r,i,s,o){const a=[e,n,r],l=this.getTileCoordForTileUrlFunction(a,s),c=l?this.tileUrlFunction(l,i,s):void 0,u=new this.tileClass(a,c!==void 0?ue.IDLE:ue.EMPTY,c!==void 0?c:"",this.crossOrigin,this.tileLoadFunction,this.tileOptions);return u.key=o,u.addEventListener(Se.CHANGE,this.handleTileChange.bind(this)),u}getTile(e,n,r,i,s,o){const a=this.getProjection();if(!a||!s||Gn(a,s))return this.getTileInternal(e,n,r,i,a||s);const l=[e,n,r],c=this.getKey(),u=this.getTileGridForProjection(a),d=this.getTileGridForProjection(s),h=this.getTileCoordForTileUrlFunction(l,s),f=new m$(a,u,s,d,l,h,this.getTilePixelRatio(i),this.getGutter(),(p,m,_,g)=>this.getTileInternal(p,m,_,g,a,o),this.reprojectionErrorThreshold_,this.renderReprojectionEdges_,this.tileOptions);return f.key=c,f}getTileInternal(e,n,r,i,s,o){const a=this.getKey(),l=Dg(this,a,e,n,r);if(o&&o.containsKey(l))return o.get(l);const c=this.createTile_(e,n,r,i,s,a);return o==null||o.set(l,c),c}setRenderReprojectionEdges(e){this.renderReprojectionEdges_!=e&&(this.renderReprojectionEdges_=e,this.changed())}setTileGridForProjection(e,n){const r=Ne(e);if(r){const i=fe(r);i in this.tileGridForProjection||(this.tileGridForProjection[i]=n)}}}function r6(t,e){if(jr){const n=t.getCrossOrigin();let r="same-origin",i="same-origin";n==="anonymous"||n===""?(r="cors",i="omit"):n==="use-credentials"&&(r="cors",i="include"),fetch(e,{mode:r,credentials:i}).then(s=>{if(!s.ok)throw new Error(`HTTP ${s.status}`);return s.blob()}).then(s=>createImageBitmap(s)).then(s=>{var l;const o=t.getImage();o.width=s.width,o.height=s.height,o.getContext("2d").drawImage(s,0,0),(l=s.close)==null||l.call(s),o.dispatchEvent(new Event("load"))}).catch(()=>{t.getImage().dispatchEvent(new Event("error"))});return}t.getImage().src=e}class i6 extends gy{constructor(e){e=e||{};const n=Object.assign({},e.params);super({attributions:e.attributions,attributionsCollapsible:e.attributionsCollapsible,cacheSize:e.cacheSize,crossOrigin:e.crossOrigin,interpolate:e.interpolate,projection:e.projection,reprojectionErrorThreshold:e.reprojectionErrorThreshold,tileClass:e.tileClass,tileGrid:e.tileGrid,tileLoadFunction:e.tileLoadFunction,url:e.url,urls:e.urls,wrapX:e.wrapX!==void 0?e.wrapX:!0,transition:e.transition,zDirection:e.zDirection}),this.gutter_=e.gutter!==void 0?e.gutter:0,this.params_=n,this.v13_=!0,this.serverType_=e.serverType,this.hidpi_=e.hidpi!==void 0?e.hidpi:!0,this.tmpExtent_=Mn(),this.updateV13_(),this.setKey(this.getKeyForParams_())}getFeatureInfoUrl(e,n,r,i){const s=Ne(r),o=this.getProjection()||s;let a=this.getTileGrid();a||(a=this.getTileGridForProjection(o));const l=nl(e,s,o),c=fh(o,s,e,n),u=a.getZForResolution(c,this.zDirection),d=a.getResolution(u),h=a.getTileCoordForCoordAndZ(l,u);if(a.getResolutions().length<=h[0])return;let f=a.getTileCoordExtent(h,this.tmpExtent_);const p=this.gutter_;p!==0&&(f=wr(f,d*p,f));const m={QUERY_LAYERS:this.params_.LAYERS};Object.assign(m,Kp(this.params_,"GetFeatureInfo"),i);const _=Math.floor((l[0]-f[0])/d),g=Math.floor((f[3]-l[1])/d);return m[this.v13_?"I":"X"]=_,m[this.v13_?"J":"Y"]=g,this.getRequestUrl_(h,f,1,o||s,m)}getLegendUrl(e,n){if(this.urls[0]===void 0)return;const r={SERVICE:"WMS",VERSION:Hp,REQUEST:"GetLegendGraphic",FORMAT:"image/png"};if(n===void 0||n.LAYER===void 0){const i=this.params_.LAYERS;if(!(!Array.isArray(i)||i.length===1))return;r.LAYER=i}if(e!==void 0){const i=this.getProjection()?this.getProjection().getMetersPerUnit():1,s=28e-5;r.SCALE=e*i/s}return Object.assign(r,n),uy(this.urls[0],r)}getGutter(){return this.gutter_}getParams(){return this.params_}getRequestUrl_(e,n,r,i,s){const o=this.urls;if(!o)return;let a;if(o.length==1)a=o[0];else{const l=Ps(sE(e),o.length);a=o[l]}return x$(n,(this.tileGrid||this.getTileGridForProjection(i)).getResolution(e[0]),r,i,a,s,this.serverType_)}getTilePixelRatio(e){return!this.hidpi_||this.serverType_===void 0?1:e}getKeyForParams_(){let e=0;const n=[];for(const r in this.params_)n[e++]=r+"-"+this.params_[r];return n.join("/")}setParams_(e){this.params_=e,this.updateV13_(),this.setKey(this.getKeyForParams_())}setParams(e){this.setParams_(Object.assign({},e))}updateParams(e){this.setParams_(Object.assign(this.params_,e))}updateV13_(){const e=this.params_.VERSION||Hp;this.v13_=b1(e,"1.3")>=0}tileUrlFunction(e,n,r){let i=this.getTileGrid();if(i||(i=this.getTileGridForProjection(r)),i.getResolutions().length<=e[0])return;n!=1&&(!this.hidpi_||this.serverType_===void 0)&&(n=1);const s=i.getResolution(e[0]);let o=i.getTileCoordExtent(e,this.tmpExtent_);const a=this.gutter_;a!==0&&(o=wr(o,s*a,o));const l=Object.assign({},Kp(this.params_,"GetMap"));return this.getRequestUrl_(e,o,n,r,l)}}const nP=[];class s6 extends Gh{constructor(e,n,r,i,s){super(e,n,{transition:0}),this.context_=null,this.executorGroups={},this.loadingSourceTiles=0,this.hitDetectionImageData={},this.replayState_={},this.sourceTiles=[],this.errorTileKeys={},this.wantedResolution,this.getSourceTiles=i.bind(void 0,this),this.removeSourceTiles_=s,this.wrappedTileCoord=r}getContext(){return this.context_||(this.context_=Vt(1,1,nP)),this.context_}hasContext(){return!!this.context_}getImage(){return this.hasContext()?this.getContext().canvas:null}getReplayState(e){const n=fe(e);return n in this.replayState_||(this.replayState_[n]={dirty:!1,renderedRenderOrder:null,renderedResolution:NaN,renderedRevision:-1,renderedTileResolution:NaN,renderedTileRevision:-1,renderedTileZ:-1}),this.replayState_[n]}load(){this.getSourceTiles()}release(){this.context_&&($h(this.context_),nP.push(this.context_.canvas),this.context_=null),this.removeSourceTiles_(this),this.sourceTiles.length=0,super.release()}}let o6=class extends Gh{constructor(e,n,r,i,s,o){super(e,n,o),this.extent=null,this.format_=i,this.features_=null,this.loader_,this.projection=null,this.resolution,this.tileLoadFunction_=s,this.url_=r,this.key=r}getTileUrl(){return this.url_}getFormat(){return this.format_}getFeatures(){return this.features_}load(){this.state==ue.IDLE&&(this.setState(ue.LOADING),this.tileLoadFunction_(this,this.url_),this.loader_&&this.loader_(this.extent,this.resolution,this.projection))}onLoad(e,n){this.setFeatures(e)}onError(){this.setState(ue.ERROR)}setFeatures(e){this.features_=e,this.setState(ue.LOADED)}setLoader(e){this.loader_=e}},a6=!1;function C$(t,e,n,r,i,s,o){const a=new XMLHttpRequest;a.open("GET",typeof t=="function"?t(n,r,i):t,!0),e.getType()=="arraybuffer"&&(a.responseType="arraybuffer"),a.withCredentials=a6,a.onload=function(l){if(!a.status||a.status>=200&&a.status<300){const c=e.getType();try{let u;c=="text"||c=="json"?u=a.responseText:c=="xml"?u=a.responseXML||a.responseText:c=="arraybuffer"&&(u=a.response),u?s(e.readFeatures(u,{extent:n,featureProjection:i}),e.readProjection(u)):o()}catch{o()}}else o()},a.onerror=o,a.send()}function rP(t,e){return function(n,r,i,s,o){C$(t,e,n,r,i,(a,l)=>{this.addFeatures(a),s!==void 0&&s(a)},()=>{this.changed(),o!==void 0&&o()})}}class l6 extends fy{constructor(e){const n=e.projection||"EPSG:3857",r=e.extent||hy(n),i=e.tileGrid||E$({extent:r,maxResolution:e.maxResolution,maxZoom:e.maxZoom!==void 0?e.maxZoom:22,minZoom:e.minZoom,tileSize:e.tileSize||512});super({attributions:e.attributions,attributionsCollapsible:e.attributionsCollapsible,cacheSize:e.cacheSize,interpolate:!0,projection:n,state:e.state,tileGrid:i,tileLoadFunction:e.tileLoadFunction?e.tileLoadFunction:c6,tileUrlFunction:e.tileUrlFunction,url:e.url,urls:e.urls,wrapX:e.wrapX===void 0?!0:e.wrapX,transition:e.transition,zDirection:e.zDirection===void 0?1:e.zDirection}),this.format_=e.format?e.format:null,this.tileKeysBySourceTileUrl_={},this.sourceTiles_={},this.overlaps_=e.overlaps==null?!0:e.overlaps,this.tileClass=e.tileClass?e.tileClass:o6,this.tileGrids_={}}getOverlaps(){return this.overlaps_}getSourceTiles(e,n,r){if(r.getState()===ue.IDLE){r.setState(ue.LOADING);const i=r.wrappedTileCoord,s=this.getTileGridForProjection(n);let o=s.getTileCoordExtent(i);const a=i[0],l=s.getResolution(a);wr(o,-l,o);const c=this.projection;n&&this.projection&&!Gn(n,c)&&(o=Sd(o,n,c));const u=this.tileGrid,d=u.getExtent();d&&_i(o,d,o);let h=l;n&&c&&!Gn(n,c)&&(h=l/c.getMetersPerUnit()/n.getMetersPerUnit());const f=u.getZForResolution(h,this.zDirection);u.forEachTileCoord(o,f,p=>{const m=this.tileUrlFunction(p,e,n);this.sourceTiles_[m]||(this.sourceTiles_[m]=new this.tileClass(p,m?ue.IDLE:ue.EMPTY,m,this.format_,this.tileLoadFunction));const _=this.sourceTiles_[m];r.sourceTiles.push(_),this.tileKeysBySourceTileUrl_[m]||(this.tileKeysBySourceTileUrl_[m]=[]),this.tileKeysBySourceTileUrl_[m].push(r.getKey());const g=_.getState();if(g<ue.LOADED){const y=v=>{this.handleTileChange(v);const w=_.getState();if(w===ue.LOADED||w===ue.ERROR){const x=_.getKey();x in r.errorTileKeys?_.getState()===ue.LOADED&&delete r.errorTileKeys[x]:r.loadingSourceTiles--,w===ue.ERROR?r.errorTileKeys[x]=!0:_.removeEventListener(Se.CHANGE,y),r.loadingSourceTiles===0&&r.setState(Uo(r.errorTileKeys)?ue.LOADED:ue.ERROR)}};_.addEventListener(Se.CHANGE,y),r.loadingSourceTiles++}g===ue.IDLE&&(_.extent=u.getTileCoordExtent(p),_.projection=this.projection,_.resolution=u.getResolution(p[0]),_.load())}),r.loadingSourceTiles||r.setState(r.sourceTiles.some(p=>p.getState()===ue.ERROR)?ue.ERROR:ue.LOADED)}return r.sourceTiles}removeSourceTiles(e){const n=e.getKey(),r=e.sourceTiles;for(let i=0,s=r.length;i<s;++i){const o=r[i].getTileUrl();if(!this.tileKeysBySourceTileUrl_[o])return;const a=this.tileKeysBySourceTileUrl_[o].indexOf(n);a!==-1&&(this.tileKeysBySourceTileUrl_[o].splice(a,1),this.tileKeysBySourceTileUrl_[o].length===0&&(delete this.tileKeysBySourceTileUrl_[o],delete this.sourceTiles_[o]))}}getTile(e,n,r,i,s){const o=[e,n,r];let a=this.getTileCoordForTileUrlFunction(o,s);const l=this.getTileGrid().getExtent(),c=this.projection,u=this.getTileGridForProjection(s);if(a&&l){const f=u.getTileCoordExtent(a);wr(f,-u.getResolution(e),f),Lt(l,!s||!c||Gn(s,c)?f:Sd(f,s,c))||(a=null)}let d=!0;if(a!==null){const f=this.tileGrid,p=u.getResolution(e);let m=p;s&&c&&!Gn(s,c)&&(m=p/c.getMetersPerUnit()/s.getMetersPerUnit());const _=f.getZForResolution(m,1),g=u.getTileCoordExtent(a);wr(g,-p,g),f.forEachTileCoord(!s||!c||Gn(s,c)?g:Sd(g,s,c),_,y=>{d=d&&!this.tileUrlFunction(y,i,c)})}const h=new s6(o,d?ue.EMPTY:ue.IDLE,a,this.getSourceTiles.bind(this,i,s),this.removeSourceTiles.bind(this));return h.key=this.getKey(),h}getTileGridForProjection(e){const n=e.getCode();let r=this.tileGrids_[n];if(!r){const i=this.projection;if(i!==null&&!Gn(i,e))return dy(e);const s=this.tileGrid,o=s.getResolutions().slice(),a=o.map(function(u,d){return s.getOrigin(d)}),l=o.map(function(u,d){return s.getTileSize(d)}),c=HO+1;for(let u=o.length;u<c;++u)o.push(o[u-1]/2),a.push(a[u-1]),l.push(l[u-1]);r=new hE({extent:s.getExtent(),origins:a,resolutions:o,tileSizes:l}),this.tileGrids_[n]=r}return r}getTilePixelRatio(e){return e}getTilePixelSize(e,n,r){const i=this.getTileGridForProjection(r),s=dn(i.getTileSize(e),this.tmpSize);return[Math.round(s[0]*n),Math.round(s[1]*n)]}setOverlaps(e){this.overlaps_=e,this.changed()}}function c6(t,e){t.setLoader(function(n,r,i){C$(e,t.getFormat(),n,r,i,t.onLoad.bind(t),t.onError.bind(t))})}class Hu extends gy{constructor(e){e=e||{};const n=e.projection!==void 0?e.projection:"EPSG:3857",r=e.tileGrid!==void 0?e.tileGrid:E$({extent:hy(n),maxResolution:e.maxResolution,maxZoom:e.maxZoom,minZoom:e.minZoom,tileSize:e.tileSize});super({attributions:e.attributions,cacheSize:e.cacheSize,crossOrigin:e.crossOrigin,interpolate:e.interpolate,projection:n,reprojectionErrorThreshold:e.reprojectionErrorThreshold,tileGrid:r,tileLoadFunction:e.tileLoadFunction,tilePixelRatio:e.tilePixelRatio,tileUrlFunction:e.tileUrlFunction,url:e.url,urls:e.urls,wrapX:e.wrapX!==void 0?e.wrapX:!0,transition:e.transition,attributionsCollapsible:e.attributionsCollapsible,zDirection:e.zDirection}),this.gutter_=e.gutter!==void 0?e.gutter:0}getGutter(){return this.gutter_}}class en extends bi{constructor(e){if(super(),this.on,this.once,this.un,this.id_=void 0,this.geometryName_="geometry",this.style_=null,this.styleFunction_=void 0,this.geometryChangeKey_=null,this.addChangeListener(this.geometryName_,this.handleGeometryChanged_),e)if(typeof e.getSimplifiedGeometry=="function"){const n=e;this.setGeometry(n)}else{const n=e;this.setProperties(n)}}clone(){const e=new en(this.hasProperties()?this.getProperties():null);e.setGeometryName(this.getGeometryName());const n=this.getGeometry();n&&e.setGeometry(n.clone());const r=this.getStyle();return r&&e.setStyle(r),e}getGeometry(){return this.get(this.geometryName_)}getId(){return this.id_}getGeometryName(){return this.geometryName_}getStyle(){return this.style_}getStyleFunction(){return this.styleFunction_}handleGeometryChange_(){this.changed()}handleGeometryChanged_(){this.geometryChangeKey_&&(it(this.geometryChangeKey_),this.geometryChangeKey_=null);const e=this.getGeometry();e&&(this.geometryChangeKey_=Oe(e,Se.CHANGE,this.handleGeometryChange_,this)),this.changed()}setGeometry(e){this.set(this.geometryName_,e)}setStyle(e){this.style_=e,this.styleFunction_=e?u6(e):void 0,this.changed()}setId(e){this.id_=e,this.changed()}setGeometryName(e){this.removeChangeListener(this.geometryName_,this.handleGeometryChanged_),this.geometryName_=e,this.addChangeListener(this.geometryName_,this.handleGeometryChanged_),this.handleGeometryChanged_()}}function u6(t){if(typeof t=="function")return t;let e;return Array.isArray(t)?e=t:(ze(typeof t.getZIndex=="function","Expected an `ol/style/Style` or an array of `ol/style/Style.js`"),e=[t]),function(){return e}}function d6(t,e){return[[-1/0,-1/0,1/0,1/0]]}function T$(t,e,n,r){const i=[];let s=Mn();for(let o=0,a=n.length;o<a;++o){const l=n[o];s=E1(t,e,l[0],r),i.push((s[0]+s[2])/2,(s[1]+s[3])/2),e=l[l.length-1]}return i}function Yp(t,e,n,r,i,s,o){let a,l;const c=(n-e)/r;if(c===1)a=e;else if(c===2)a=e,l=i;else if(c!==0){let u=t[e],d=t[e+1],h=0;const f=[0];for(let _=e+r;_<n;_+=r){const g=t[_],y=t[_+1];h+=Math.sqrt((g-u)*(g-u)+(y-d)*(y-d)),f.push(h),u=g,d=y}const p=i*h,m=c4(f,p);m<0?(l=(p-f[-m-2])/(f[-m-1]-f[-m-2]),a=e+(-m-2)*r):a=e+m*r}o=o>1?o:2,s=s||new Array(o);for(let u=0;u<o;++u)s[u]=a===void 0?NaN:l===void 0?t[a+u]:fr(t[a+u],t[a+r+u],l);return s}function Pw(t,e,n,r,i,s){if(n==e)return null;let o;if(i<t[e+r-1])return s?(o=t.slice(e,e+r),o[r-1]=i,o):null;if(t[n-1]<i)return s?(o=t.slice(n-r,n),o[r-1]=i,o):null;if(i==t[e+r-1])return t.slice(e,e+r);let a=e/r,l=n/r;for(;a<l;){const h=a+l>>1;i<t[(h+1)*r-1]?l=h:a=h+1}const c=t[a*r-1];if(i==c)return t.slice((a-1)*r,(a-1)*r+r);const u=t[(a+1)*r-1],d=(i-c)/(u-c);o=[];for(let h=0;h<r-1;++h)o.push(fr(t[(a-1)*r+h],t[a*r+h],d));return o.push(i),o}function h6(t,e,n,r,i,s,o){if(o)return Pw(t,e,n[n.length-1],r,i,s);let a;if(i<t[r-1])return s?(a=t.slice(0,r),a[r-1]=i,a):null;if(t[t.length-1]<i)return s?(a=t.slice(t.length-r),a[r-1]=i,a):null;for(let l=0,c=n.length;l<c;++l){const u=n[l];if(e!=u){if(i<t[e+r-1])return null;if(i<=t[u-1])return Pw(t,e,u,r,i,!1);e=u}}return null}class py extends Vs{constructor(e,n,r){super(),r!==void 0&&n===void 0?this.setFlatCoordinates(r,e):(n=n||0,this.setCenterAndRadius(e,n,r))}clone(){const e=new py(this.flatCoordinates.slice(),void 0,this.layout);return e.applyProperties(this),e}closestPointXY(e,n,r,i){const s=this.flatCoordinates,o=e-s[0],a=n-s[1],l=o*o+a*a;if(l<i){if(l===0)for(let c=0;c<this.stride;++c)r[c]=s[c];else{const c=this.getRadius()/Math.sqrt(l);r[0]=s[0]+c*o,r[1]=s[1]+c*a;for(let u=2;u<this.stride;++u)r[u]=s[u]}return r.length=this.stride,l}return i}containsXY(e,n){const r=this.flatCoordinates,i=e-r[0],s=n-r[1];return i*i+s*s<=this.getRadiusSquared_()}getCenter(){return this.flatCoordinates.slice(0,this.stride)}computeExtent(e){const n=this.flatCoordinates,r=n[this.stride]-n[0];return Zi(n[0]-r,n[1]-r,n[0]+r,n[1]+r,e)}getRadius(){return Math.sqrt(this.getRadiusSquared_())}getRadiusSquared_(){const e=this.flatCoordinates[this.stride]-this.flatCoordinates[0],n=this.flatCoordinates[this.stride+1]-this.flatCoordinates[1];return e*e+n*n}getType(){return"Circle"}intersectsExtent(e){const n=this.getExtent();if(Lt(e,n)){const r=this.getCenter();return e[0]<=r[0]&&e[2]>=r[0]||e[1]<=r[1]&&e[3]>=r[1]?!0:S1(e,this.intersectsCoordinate.bind(this))}return!1}setCenter(e){const n=this.stride,r=this.flatCoordinates[n]-this.flatCoordinates[0],i=e.slice();i[n]=i[0]+r;for(let s=1;s<n;++s)i[n+s]=e[s];this.setFlatCoordinates(this.layout,i),this.changed()}setCenterAndRadius(e,n,r){this.setLayout(r,e,0),this.flatCoordinates||(this.flatCoordinates=[]);const i=this.flatCoordinates;let s=NO(i,0,e,this.stride);i[s++]=i[0]+n;for(let o=1,a=this.stride;o<a;++o)i[s++]=i[o];i.length=s,this.changed()}getCoordinates(){return null}setCoordinates(e,n){}setRadius(e){this.flatCoordinates[this.stride]=this.flatCoordinates[0]+e,this.changed()}rotate(e,n){const r=this.getCenter(),i=this.getStride();this.setCenter(k1(r,0,r.length,i,e,n,r)),this.changed()}}py.prototype.transform;class Wr extends Dp{constructor(e){super(),this.geometries_=e,this.changeEventsKeys_=[],this.listenGeometriesChange_()}unlistenGeometriesChange_(){this.changeEventsKeys_.forEach(it),this.changeEventsKeys_.length=0}listenGeometriesChange_(){const e=this.geometries_;for(let n=0,r=e.length;n<r;++n)this.changeEventsKeys_.push(Oe(e[n],Se.CHANGE,this.changed,this))}clone(){const e=new Wr(m0(this.geometries_));return e.applyProperties(this),e}closestPointXY(e,n,r,i){if(i<el(this.getExtent(),e,n))return i;const s=this.geometries_;for(let o=0,a=s.length;o<a;++o)i=s[o].closestPointXY(e,n,r,i);return i}containsXY(e,n){const r=this.geometries_;for(let i=0,s=r.length;i<s;++i)if(r[i].containsXY(e,n))return!0;return!1}computeExtent(e){su(e);const n=this.geometries_;for(let r=0,i=n.length;r<i;++r)yO(e,n[r].getExtent());return e}getGeometries(){return m0(this.geometries_)}getGeometriesArray(){return this.geometries_}getGeometriesArrayRecursive(){let e=[];const n=this.geometries_;for(let r=0,i=n.length;r<i;++r)n[r].getType()===this.getType()?e=e.concat(n[r].getGeometriesArrayRecursive()):e.push(n[r]);return e}getSimplifiedGeometry(e){if(this.simplifiedGeometryRevision!==this.getRevision()&&(this.simplifiedGeometryMaxMinSquaredTolerance=0,this.simplifiedGeometryRevision=this.getRevision()),e<0||this.simplifiedGeometryMaxMinSquaredTolerance!==0&&e<this.simplifiedGeometryMaxMinSquaredTolerance)return this;const n=[],r=this.geometries_;let i=!1;for(let s=0,o=r.length;s<o;++s){const a=r[s],l=a.getSimplifiedGeometry(e);n.push(l),l!==a&&(i=!0)}return i?new Wr(n):(this.simplifiedGeometryMaxMinSquaredTolerance=e,this)}getType(){return"GeometryCollection"}intersectsExtent(e){const n=this.geometries_;for(let r=0,i=n.length;r<i;++r)if(n[r].intersectsExtent(e))return!0;return!1}isEmpty(){return this.geometries_.length===0}rotate(e,n){const r=this.geometries_;for(let i=0,s=r.length;i<s;++i)r[i].rotate(e,n);this.changed()}scale(e,n,r){r||(r=Er(this.getExtent()));const i=this.geometries_;for(let s=0,o=i.length;s<o;++s)i[s].scale(e,n,r);this.changed()}setGeometries(e){this.setGeometriesArray(m0(e))}setGeometriesArray(e){this.unlistenGeometriesChange_(),this.geometries_=e,this.listenGeometriesChange_(),this.changed()}applyTransform(e){const n=this.geometries_;for(let r=0,i=n.length;r<i;++r)n[r].applyTransform(e);this.changed()}translate(e,n){const r=this.geometries_;for(let i=0,s=r.length;i<s;++i)r[i].translate(e,n);this.changed()}disposeInternal(){this.unlistenGeometriesChange_(),super.disposeInternal()}}function m0(t){return t.map(e=>e.clone())}function fE(t,e,n,r){let i=t[e],s=t[e+1],o=0;for(let a=e+r;a<n;a+=r){const l=t[a],c=t[a+1];o+=Math.sqrt((l-i)*(l-i)+(c-s)*(c-s)),i=l,s=c}return o}class ar extends Vs{constructor(e,n){super(),this.flatMidpoint_=null,this.flatMidpointRevision_=-1,this.maxDelta_=-1,this.maxDeltaRevision_=-1,n!==void 0&&!Array.isArray(e[0])?this.setFlatCoordinates(n,e):this.setCoordinates(e,n)}appendCoordinate(e){We(this.flatCoordinates,e),this.changed()}clone(){const e=new ar(this.flatCoordinates.slice(),this.layout);return e.applyProperties(this),e}closestPointXY(e,n,r,i){return i<el(this.getExtent(),e,n)?i:(this.maxDeltaRevision_!=this.getRevision()&&(this.maxDelta_=Math.sqrt(M1(this.flatCoordinates,0,this.flatCoordinates.length,this.stride,0)),this.maxDeltaRevision_=this.getRevision()),N1(this.flatCoordinates,0,this.flatCoordinates.length,this.stride,this.maxDelta_,!1,e,n,r,i))}forEachSegment(e){return GO(this.flatCoordinates,0,this.flatCoordinates.length,this.stride,e)}getCoordinateAtM(e,n){return this.layout!="XYM"&&this.layout!="XYZM"?null:(n=n!==void 0?n:!1,Pw(this.flatCoordinates,0,this.flatCoordinates.length,this.stride,e,n))}getCoordinates(){return wo(this.flatCoordinates,0,this.flatCoordinates.length,this.stride)}getCoordinateAt(e,n){return Yp(this.flatCoordinates,0,this.flatCoordinates.length,this.stride,e,n,this.stride)}getLength(){return fE(this.flatCoordinates,0,this.flatCoordinates.length,this.stride)}getFlatMidpoint(){return this.flatMidpointRevision_!=this.getRevision()&&(this.flatMidpoint_=this.getCoordinateAt(.5,this.flatMidpoint_??void 0),this.flatMidpointRevision_=this.getRevision()),this.flatMidpoint_}getSimplifiedGeometryInternal(e){const n=[];return n.length=oy(this.flatCoordinates,0,this.flatCoordinates.length,this.stride,e,n,0),new ar(n,"XY")}getType(){return"LineString"}intersectsExtent(e){return ay(this.flatCoordinates,0,this.flatCoordinates.length,this.stride,e,this.getExtent())}setCoordinates(e,n){this.setLayout(n,e,1),this.flatCoordinates||(this.flatCoordinates=[]),this.flatCoordinates.length=sy(this.flatCoordinates,0,e,this.stride),this.changed()}}class Ji extends Vs{constructor(e,n,r){if(super(),this.ends_=[],this.maxDelta_=-1,this.maxDeltaRevision_=-1,Array.isArray(e[0]))this.setCoordinates(e,n);else if(n!==void 0&&r)this.setFlatCoordinates(n,e),this.ends_=r;else{const i=e,s=[],o=[];for(let l=0,c=i.length;l<c;++l){const u=i[l];We(s,u.getFlatCoordinates()),o.push(s.length)}const a=i.length===0?this.getLayout():i[0].getLayout();this.setFlatCoordinates(a,s),this.ends_=o}}appendLineString(e){We(this.flatCoordinates,e.getFlatCoordinates().slice()),this.ends_.push(this.flatCoordinates.length),this.changed()}clone(){const e=new Ji(this.flatCoordinates.slice(),this.layout,this.ends_.slice());return e.applyProperties(this),e}closestPointXY(e,n,r,i){return i<el(this.getExtent(),e,n)?i:(this.maxDeltaRevision_!=this.getRevision()&&(this.maxDelta_=Math.sqrt(D1(this.flatCoordinates,0,this.ends_,this.stride,0)),this.maxDeltaRevision_=this.getRevision()),j1(this.flatCoordinates,0,this.ends_,this.stride,this.maxDelta_,!1,e,n,r,i))}getCoordinateAtM(e,n,r){return this.layout!="XYM"&&this.layout!="XYZM"||this.flatCoordinates.length===0?null:(n=n!==void 0?n:!1,r=r!==void 0?r:!1,h6(this.flatCoordinates,0,this.ends_,this.stride,e,n,r))}getCoordinates(){return ch(this.flatCoordinates,0,this.ends_,this.stride)}getEnds(){return this.ends_}getLineString(e){return e<0||this.ends_.length<=e?null:new ar(this.flatCoordinates.slice(e===0?0:this.ends_[e-1],this.ends_[e]),this.layout)}getLineStrings(){const e=this.flatCoordinates,n=this.ends_,r=this.layout,i=[];let s=0;for(let o=0,a=n.length;o<a;++o){const l=n[o],c=new ar(e.slice(s,l),r);i.push(c),s=l}return i}getLength(){const e=this.ends_;let n=0,r=0;for(let i=0,s=e.length;i<s;++i)r+=fE(this.flatCoordinates,n,e[i],this.stride),n=e[i];return r}getFlatMidpoints(){const e=[],n=this.flatCoordinates;let r=0;const i=this.ends_,s=this.stride;for(let o=0,a=i.length;o<a;++o){const l=i[o],c=Yp(n,r,l,s,.5);We(e,c),r=l}return e}getSimplifiedGeometryInternal(e){const n=[],r=[];return n.length=zO(this.flatCoordinates,0,this.ends_,this.stride,e,n,0,r),new Ji(n,"XY",r)}getType(){return"MultiLineString"}intersectsExtent(e){return Dz(this.flatCoordinates,0,this.ends_,this.stride,e)}setCoordinates(e,n){this.setLayout(n,e,2),this.flatCoordinates||(this.flatCoordinates=[]);const r=jh(this.flatCoordinates,0,e,this.stride,this.ends_);this.flatCoordinates.length=r.length===0?0:r[r.length-1],this.changed()}}class ol extends Vs{constructor(e,n){super(),n&&!Array.isArray(e[0])?this.setFlatCoordinates(n,e):this.setCoordinates(e,n)}appendPoint(e){We(this.flatCoordinates,e.getFlatCoordinates()),this.changed()}clone(){const e=new ol(this.flatCoordinates.slice(),this.layout);return e.applyProperties(this),e}closestPointXY(e,n,r,i){if(i<el(this.getExtent(),e,n))return i;const s=this.flatCoordinates,o=this.stride;for(let a=0,l=s.length;a<l;a+=o){const c=Ts(e,n,s[a],s[a+1]);if(c<i){i=c;for(let u=0;u<o;++u)r[u]=s[a+u];r.length=o}}return i}getCoordinates(){return wo(this.flatCoordinates,0,this.flatCoordinates.length,this.stride)}getPoint(e){const n=this.flatCoordinates.length/this.stride;return e<0||n<=e?null:new Sn(this.flatCoordinates.slice(e*this.stride,(e+1)*this.stride),this.layout)}getPoints(){const e=this.flatCoordinates,n=this.layout,r=this.stride,i=[];for(let s=0,o=e.length;s<o;s+=r){const a=new Sn(e.slice(s,s+r),n);i.push(a)}return i}getType(){return"MultiPoint"}intersectsExtent(e){const n=this.flatCoordinates,r=this.stride;for(let i=0,s=n.length;i<s;i+=r){const o=n[i],a=n[i+1];if(x1(e,o,a))return!0}return!1}setCoordinates(e,n){this.setLayout(n,e,1),this.flatCoordinates||(this.flatCoordinates=[]),this.flatCoordinates.length=sy(this.flatCoordinates,0,e,this.stride),this.changed()}}class Vo extends Vs{constructor(e,n,r){if(super(),this.endss_=[],this.flatInteriorPointsRevision_=-1,this.flatInteriorPoints_=null,this.maxDelta_=-1,this.maxDeltaRevision_=-1,this.orientedRevision_=-1,this.orientedFlatCoordinates_=null,!r&&!Array.isArray(e[0])){const i=e,s=[],o=[];for(let a=0,l=i.length;a<l;++a){const c=i[a],u=s.length,d=c.getEnds();for(let h=0,f=d.length;h<f;++h)d[h]+=u;We(s,c.getFlatCoordinates()),o.push(d)}n=i.length===0?this.getLayout():i[0].getLayout(),e=s,r=o}n!==void 0&&r?(this.setFlatCoordinates(n,e),this.endss_=r):this.setCoordinates(e,n)}appendPolygon(e){let n;if(!this.flatCoordinates)this.flatCoordinates=e.getFlatCoordinates().slice(),n=e.getEnds().slice(),this.endss_.push();else{const r=this.flatCoordinates.length;We(this.flatCoordinates,e.getFlatCoordinates()),n=e.getEnds().slice();for(let i=0,s=n.length;i<s;++i)n[i]+=r}this.endss_.push(n),this.changed()}clone(){const e=this.endss_.length,n=new Array(e);for(let i=0;i<e;++i)n[i]=this.endss_[i].slice();const r=new Vo(this.flatCoordinates.slice(),this.layout,n);return r.applyProperties(this),r}closestPointXY(e,n,r,i){return i<el(this.getExtent(),e,n)?i:(this.maxDeltaRevision_!=this.getRevision()&&(this.maxDelta_=Math.sqrt(Fz(this.flatCoordinates,0,this.endss_,this.stride,0)),this.maxDeltaRevision_=this.getRevision()),Oz(this.getOrientedFlatCoordinates(),0,this.endss_,this.stride,this.maxDelta_,!0,e,n,r,i))}containsXY(e,n){return Mz(this.getOrientedFlatCoordinates(),0,this.endss_,this.stride,e,n)}getArea(){return Az(this.getOrientedFlatCoordinates(),0,this.endss_,this.stride)}getCoordinates(e){let n;return e!==void 0?(n=this.getOrientedFlatCoordinates().slice(),vw(n,0,this.endss_,this.stride,e)):n=this.flatCoordinates,_w(n,0,this.endss_,this.stride)}getEndss(){return this.endss_}getFlatInteriorPoints(){if(this.flatInteriorPointsRevision_!=this.getRevision()){const e=T$(this.flatCoordinates,0,this.endss_,this.stride);this.flatInteriorPoints_=UO(this.getOrientedFlatCoordinates(),0,this.endss_,this.stride,e),this.flatInteriorPointsRevision_=this.getRevision()}return this.flatInteriorPoints_}getInteriorPoints(){return new ol(this.getFlatInteriorPoints().slice(),"XYM")}getOrientedFlatCoordinates(){if(this.orientedRevision_!=this.getRevision()){const e=this.flatCoordinates;WO(e,0,this.endss_,this.stride)?this.orientedFlatCoordinates_=e:(this.orientedFlatCoordinates_=e.slice(),this.orientedFlatCoordinates_.length=vw(this.orientedFlatCoordinates_,0,this.endss_,this.stride)),this.orientedRevision_=this.getRevision()}return this.orientedFlatCoordinates_}getSimplifiedGeometryInternal(e){const n=[],r=[];return n.length=Lz(this.flatCoordinates,0,this.endss_,this.stride,Math.sqrt(e),n,0,r),new Vo(n,"XY",r)}getPolygon(e){if(e<0||this.endss_.length<=e)return null;let n;if(e===0)n=0;else{const s=this.endss_[e-1];n=s[s.length-1]}const r=this.endss_[e].slice(),i=r[r.length-1];if(n!==0)for(let s=0,o=r.length;s<o;++s)r[s]-=n;return new lr(this.flatCoordinates.slice(n,i),this.layout,r)}getPolygons(){const e=this.layout,n=this.flatCoordinates,r=this.endss_,i=[];let s=0;for(let o=0,a=r.length;o<a;++o){const l=r[o].slice(),c=l[l.length-1];if(s!==0)for(let d=0,h=l.length;d<h;++d)l[d]-=s;const u=new lr(n.slice(s,c),e,l);i.push(u),s=c}return i}getType(){return"MultiPolygon"}intersectsExtent(e){return Nz(this.getOrientedFlatCoordinates(),0,this.endss_,this.stride,e)}setCoordinates(e,n){this.setLayout(n,e,3),this.flatCoordinates||(this.flatCoordinates=[]);const r=jO(this.flatCoordinates,0,e,this.stride,this.endss_);if(r.length===0)this.flatCoordinates.length=0;else{const i=r[r.length-1];this.flatCoordinates.length=i.length===0?0:i[i.length-1]}this.changed()}}const iP=Bt();class wn{constructor(e,n,r,i,s,o){this.styleFunction,this.extent_,this.id_=o,this.type_=e,this.flatCoordinates_=n,this.flatInteriorPoints_=null,this.flatMidpoints_=null,this.ends_=r||null,this.properties_=s,this.squaredTolerance_,this.stride_=i,this.simplifiedGeometry_}get(e){return this.properties_[e]}getExtent(){return this.extent_||(this.extent_=this.type_==="Point"?gc(this.flatCoordinates_):E1(this.flatCoordinates_,0,this.flatCoordinates_.length,2)),this.extent_}getFlatInteriorPoint(){if(!this.flatInteriorPoints_){const e=Er(this.getExtent());this.flatInteriorPoints_=G1(this.flatCoordinates_,0,this.ends_,2,e,0)}return this.flatInteriorPoints_}getFlatInteriorPoints(){if(!this.flatInteriorPoints_){const e=W1(this.flatCoordinates_,this.ends_),n=T$(this.flatCoordinates_,0,e,2);this.flatInteriorPoints_=UO(this.flatCoordinates_,0,e,2,n)}return this.flatInteriorPoints_}getFlatMidpoint(){return this.flatMidpoints_||(this.flatMidpoints_=Yp(this.flatCoordinates_,0,this.flatCoordinates_.length,2,.5)),this.flatMidpoints_}getFlatMidpoints(){if(!this.flatMidpoints_){this.flatMidpoints_=[];const e=this.flatCoordinates_;let n=0;const r=this.ends_;for(let i=0,s=r.length;i<s;++i){const o=r[i],a=Yp(e,n,o,2,.5);We(this.flatMidpoints_,a),n=o}}return this.flatMidpoints_}getId(){return this.id_}getOrientedFlatCoordinates(){return this.flatCoordinates_}getGeometry(){return this}getSimplifiedGeometry(e){return this}simplifyTransformed(e,n){return this}getProperties(){return this.properties_}getPropertiesInternal(){return this.properties_}getStride(){return this.stride_}getStyleFunction(){return this.styleFunction}getType(){return this.type_}transform(e){e=Ne(e);const n=e.getExtent(),r=e.getWorldExtent();if(n&&r){const i=Gt(r)/Gt(n);Xr(iP,r[0],r[3],i,-i,0,0,0),Ki(this.flatCoordinates_,0,this.flatCoordinates_.length,2,iP,this.flatCoordinates_)}}applyTransform(e){e(this.flatCoordinates_,this.flatCoordinates_,this.stride_)}clone(){var e;return new wn(this.type_,this.flatCoordinates_.slice(),(e=this.ends_)==null?void 0:e.slice(),this.stride_,Object.assign({},this.properties_),this.id_)}getEnds(){return this.ends_}enableSimplifyTransformed(){return this.simplifyTransformed=oO((e,n)=>{if(e===this.squaredTolerance_)return this.simplifiedGeometry_;this.simplifiedGeometry_=this.clone(),n&&this.simplifiedGeometry_.applyTransform(n);const r=this.simplifiedGeometry_.getFlatCoordinates();let i;switch(this.type_){case"LineString":r.length=oy(r,0,this.simplifiedGeometry_.flatCoordinates_.length,this.simplifiedGeometry_.stride_,e,r,0),i=[r.length];break;case"MultiLineString":i=[],r.length=zO(r,0,this.simplifiedGeometry_.ends_,this.simplifiedGeometry_.stride_,e,r,0,i);break;case"Polygon":i=[],r.length=z1(r,0,this.simplifiedGeometry_.ends_,this.simplifiedGeometry_.stride_,Math.sqrt(e),r,0,i);break}return i&&(this.simplifiedGeometry_=new wn(this.type_,r,i,2,this.properties_,this.id_)),this.squaredTolerance_=e,this.simplifiedGeometry_}),this}}wn.prototype.getFlatCoordinates=wn.prototype.getOrientedFlatCoordinates;class Rw{constructor(e){this.rbush_=new t$(e),this.items_={}}insert(e,n){const r={minX:e[0],minY:e[1],maxX:e[2],maxY:e[3],value:n};this.rbush_.insert(r),this.items_[fe(n)]=r}load(e,n){const r=new Array(n.length);for(let i=0,s=n.length;i<s;i++){const o=e[i],a=n[i],l={minX:o[0],minY:o[1],maxX:o[2],maxY:o[3],value:a};r[i]=l,this.items_[fe(a)]=l}this.rbush_.load(r)}remove(e){const n=fe(e),r=this.items_[n];return delete this.items_[n],this.rbush_.remove(r)!==null}update(e,n){const r=this.items_[fe(n)],i=[r.minX,r.minY,r.maxX,r.maxY];Bo(i,e)||(this.remove(n),this.insert(e,n))}getAll(){return this.rbush_.all().map(function(n){return n.value})}getInExtent(e){const n={minX:e[0],minY:e[1],maxX:e[2],maxY:e[3]};return this.rbush_.search(n).map(function(i){return i.value})}forEach(e){return this.forEach_(this.getAll(),e)}forEachInExtent(e,n){return this.forEach_(this.getInExtent(e),n)}forEach_(e,n){let r;for(let i=0,s=e.length;i<s;i++)if(r=n(e[i]),r)return r;return r}isEmpty(){return Uo(this.items_)}clear(){this.rbush_.clear(),this.items_={}}getExtent(e){const n=this.rbush_.toJSON();return Zi(n.minX,n.minY,n.maxX,n.maxY,e)}concat(e){this.rbush_.load(e.rbush_.all());for(const n in e.items_)this.items_[n]=e.items_[n]}}const an={ADDFEATURE:"addfeature",CHANGEFEATURE:"changefeature",CLEAR:"clear",REMOVEFEATURE:"removefeature",FEATURESLOADSTART:"featuresloadstart",FEATURESLOADEND:"featuresloadend",FEATURESLOADERROR:"featuresloaderror"};class to extends Cr{constructor(e,n,r){super(e),this.feature=n,this.features=r}}class Cn extends lE{constructor(e){e=e||{},super({attributions:e.attributions,interpolate:!0,projection:void 0,state:"ready",wrapX:e.wrapX!==void 0?e.wrapX:!0}),this.on,this.once,this.un,this.loader_=nh,this.format_=e.format||null,this.overlaps_=e.overlaps===void 0?!0:e.overlaps,this.url_=e.url,e.loader!==void 0?this.loader_=e.loader:this.url_!==void 0&&(ze(this.format_,"`format` must be set when `url` is set"),this.loader_=rP(this.url_,this.format_)),this.strategy_=e.strategy!==void 0?e.strategy:d6;const n=e.useSpatialIndex!==void 0?e.useSpatialIndex:!0;this.featuresRtree_=n?new Rw:null,this.loadedExtentsRtree_=new Rw,this.loadingExtentsCount_=0,this.nullGeometryFeatures_={},this.idIndex_={},this.uidIndex_={},this.featureChangeKeys_={},this.featuresCollection_=null;let r,i;Array.isArray(e.features)?i=e.features:e.features&&(r=e.features,i=r.getArray()),!n&&r===void 0&&(r=new Bn(i)),i!==void 0&&this.addFeaturesInternal(i),r!==void 0&&this.bindFeaturesCollection_(r)}addFeature(e){this.addFeatureInternal(e),this.changed()}addFeatureInternal(e){const n=fe(e);if(!this.addToIndex_(n,e)){this.featuresCollection_&&this.featuresCollection_.remove(e);return}this.setupChangeEvents_(n,e);const r=e.getGeometry();if(r){const i=r.getExtent();this.featuresRtree_&&this.featuresRtree_.insert(i,e)}else this.nullGeometryFeatures_[n]=e;this.dispatchEvent(new to(an.ADDFEATURE,e))}setupChangeEvents_(e,n){n instanceof wn||(this.featureChangeKeys_[e]=[Oe(n,Se.CHANGE,this.handleFeatureChange_,this),Oe(n,Lc.PROPERTYCHANGE,this.handleFeatureChange_,this)])}addToIndex_(e,n){let r=!0;if(n.getId()!==void 0){const i=String(n.getId());if(!(i in this.idIndex_))this.idIndex_[i]=n;else if(n instanceof wn){const s=this.idIndex_[i];s instanceof wn?Array.isArray(s)?s.push(n):this.idIndex_[i]=[s,n]:r=!1}else r=!1}return r&&(ze(!(e in this.uidIndex_),"The passed `feature` was already added to the source"),this.uidIndex_[e]=n),r}addFeatures(e){this.addFeaturesInternal(e),this.changed()}addFeaturesInternal(e){const n=[],r=[],i=[];for(let s=0,o=e.length;s<o;s++){const a=e[s],l=fe(a);this.addToIndex_(l,a)&&r.push(a)}for(let s=0,o=r.length;s<o;s++){const a=r[s],l=fe(a);this.setupChangeEvents_(l,a);const c=a.getGeometry();if(c){const u=c.getExtent();n.push(u),i.push(a)}else this.nullGeometryFeatures_[l]=a}if(this.featuresRtree_&&this.featuresRtree_.load(n,i),this.hasListener(an.ADDFEATURE))for(let s=0,o=r.length;s<o;s++)this.dispatchEvent(new to(an.ADDFEATURE,r[s]))}bindFeaturesCollection_(e){let n=!1;this.addEventListener(an.ADDFEATURE,function(r){n||(n=!0,e.push(r.feature),n=!1)}),this.addEventListener(an.REMOVEFEATURE,function(r){n||(n=!0,e.remove(r.feature),n=!1)}),e.addEventListener(Ht.ADD,r=>{n||(n=!0,this.addFeature(r.element),n=!1)}),e.addEventListener(Ht.REMOVE,r=>{n||(n=!0,this.removeFeature(r.element),n=!1)}),this.featuresCollection_=e}clear(e){if(e){for(const r in this.featureChangeKeys_)this.featureChangeKeys_[r].forEach(it);this.featuresCollection_||(this.featureChangeKeys_={},this.idIndex_={},this.uidIndex_={})}else if(this.featuresRtree_){this.featuresRtree_.forEach(r=>{this.removeFeatureInternal(r)});for(const r in this.nullGeometryFeatures_)this.removeFeatureInternal(this.nullGeometryFeatures_[r])}this.featuresCollection_&&this.featuresCollection_.clear(),this.featuresRtree_&&this.featuresRtree_.clear(),this.nullGeometryFeatures_={};const n=new to(an.CLEAR);this.dispatchEvent(n),this.changed()}forEachFeature(e){if(this.featuresRtree_)return this.featuresRtree_.forEach(e);this.featuresCollection_&&this.featuresCollection_.forEach(e)}forEachFeatureAtCoordinateDirect(e,n){const r=[e[0],e[1],e[0],e[1]];return this.forEachFeatureInExtent(r,function(i){const s=i.getGeometry();if(s instanceof wn||s.intersectsCoordinate(e))return n(i)})}forEachFeatureInExtent(e,n){if(this.featuresRtree_)return this.featuresRtree_.forEachInExtent(e,n);this.featuresCollection_&&this.featuresCollection_.forEach(n)}forEachFeatureIntersectingExtent(e,n){return this.forEachFeatureInExtent(e,function(r){const i=r.getGeometry();if(i instanceof wn||i.intersectsExtent(e)){const s=n(r);if(s)return s}})}getFeaturesCollection(){return this.featuresCollection_}getFeatures(){let e;return this.featuresCollection_?e=this.featuresCollection_.getArray().slice(0):this.featuresRtree_&&(e=this.featuresRtree_.getAll(),Uo(this.nullGeometryFeatures_)||We(e,Object.values(this.nullGeometryFeatures_))),e}getFeaturesAtCoordinate(e){const n=[];return this.forEachFeatureAtCoordinateDirect(e,function(r){n.push(r)}),n}getFeaturesInExtent(e,n){if(this.featuresRtree_){if(!(n&&n.canWrapX()&&this.getWrapX()))return this.featuresRtree_.getInExtent(e);const i=xO(e,n);return[].concat(...i.map(s=>this.featuresRtree_.getInExtent(s)))}return this.featuresCollection_?this.featuresCollection_.getArray().slice(0):[]}getClosestFeatureToCoordinate(e,n){const r=e[0],i=e[1];let s=null;const o=[NaN,NaN];let a=1/0;const l=[-1/0,-1/0,1/0,1/0];return n=n||zo,this.featuresRtree_.forEachInExtent(l,function(c){if(n(c)){const u=c.getGeometry(),d=a;if(a=u instanceof wn?0:u.closestPointXY(r,i,o,a),a<d){s=c;const h=Math.sqrt(a);l[0]=r-h,l[1]=i-h,l[2]=r+h,l[3]=i+h}}}),s}getExtent(e){return this.featuresRtree_.getExtent(e)}getFeatureById(e){const n=this.idIndex_[e.toString()];return n!==void 0?n:null}getFeatureByUid(e){const n=this.uidIndex_[e];return n!==void 0?n:null}getFormat(){return this.format_}getOverlaps(){return this.overlaps_}getUrl(){return this.url_}handleFeatureChange_(e){const n=e.target,r=fe(n),i=n.getGeometry();if(!i)r in this.nullGeometryFeatures_||(this.featuresRtree_&&this.featuresRtree_.remove(n),this.nullGeometryFeatures_[r]=n);else{const o=i.getExtent();r in this.nullGeometryFeatures_?(delete this.nullGeometryFeatures_[r],this.featuresRtree_&&this.featuresRtree_.insert(o,n)):this.featuresRtree_&&this.featuresRtree_.update(o,n)}const s=n.getId();if(s!==void 0){const o=s.toString();this.idIndex_[o]!==n&&(this.removeFromIdIndex_(n),this.idIndex_[o]=n)}else this.removeFromIdIndex_(n),this.uidIndex_[r]=n;this.changed(),this.dispatchEvent(new to(an.CHANGEFEATURE,n))}hasFeature(e){const n=e.getId();return n!==void 0?n in this.idIndex_:fe(e)in this.uidIndex_}isEmpty(){return this.featuresRtree_?this.featuresRtree_.isEmpty()&&Uo(this.nullGeometryFeatures_):this.featuresCollection_?this.featuresCollection_.getLength()===0:!0}loadFeatures(e,n,r){const i=this.loadedExtentsRtree_,s=this.strategy_(e,n,r);for(let o=0,a=s.length;o<a;++o){const l=s[o];i.forEachInExtent(l,function(u){return ji(u.extent,l)})||(++this.loadingExtentsCount_,this.dispatchEvent(new to(an.FEATURESLOADSTART)),this.loader_.call(this,l,n,r,u=>{--this.loadingExtentsCount_,this.dispatchEvent(new to(an.FEATURESLOADEND,void 0,u))},()=>{--this.loadingExtentsCount_,this.dispatchEvent(new to(an.FEATURESLOADERROR))}),i.insert(l,{extent:l.slice()}))}this.loading=this.loader_.length<4?!1:this.loadingExtentsCount_>0}refresh(){this.clear(!0),this.loadedExtentsRtree_.clear(),super.refresh()}removeLoadedExtent(e){const n=this.loadedExtentsRtree_,r=n.forEachInExtent(e,function(i){if(Bo(i.extent,e))return i});r&&n.remove(r)}removeFeatures(e){let n=!1;for(let r=0,i=e.length;r<i;++r)n=this.removeFeatureInternal(e[r])||n;n&&this.changed()}removeFeature(e){if(!e)return;this.removeFeatureInternal(e)&&this.changed()}removeFeatureInternal(e){const n=fe(e);if(!(n in this.uidIndex_))return!1;n in this.nullGeometryFeatures_?delete this.nullGeometryFeatures_[n]:this.featuresRtree_&&this.featuresRtree_.remove(e);const r=this.featureChangeKeys_[n];r==null||r.forEach(it),delete this.featureChangeKeys_[n];const i=e.getId();if(i!==void 0){const s=i.toString(),o=this.idIndex_[s];o===e?delete this.idIndex_[s]:Array.isArray(o)&&(o.splice(o.indexOf(e),1),o.length===1&&(this.idIndex_[s]=o[0]))}return delete this.uidIndex_[n],this.hasListener(an.REMOVEFEATURE)&&this.dispatchEvent(new to(an.REMOVEFEATURE,e)),!0}removeFromIdIndex_(e){for(const n in this.idIndex_)if(this.idIndex_[n]===e){delete this.idIndex_[n];break}}setLoader(e){this.loader_=e}setUrl(e){ze(this.format_,"`format` must be set when `url` is set"),this.url_=e,this.setLoader(rP(e,this.format_))}setOverlaps(e){this.overlaps_=e,this.changed()}}class P$ extends Cn{constructor(e){e=e||{},super({attributions:e.attributions,wrapX:e.wrapX}),this.resolution=void 0,this.distance=e.distance!==void 0?e.distance:20,this.minDistance=e.minDistance||0,this.interpolationRatio=0,this.features=[],this.geometryFunction=e.geometryFunction||function(n){const r=n.getGeometry();return ze(!r||r.getType()==="Point","The default `geometryFunction` can only handle `Point` or null geometries"),r},this.createCustomCluster_=e.createCluster,this.source=null,this.boundRefresh_=this.refresh.bind(this),this.updateDistance(this.distance,this.minDistance),this.setSource(e.source||null)}clear(e){this.features.length=0,super.clear(e)}getDistance(){return this.distance}getSource(){return this.source}loadFeatures(e,n,r){var i;(i=this.source)==null||i.loadFeatures(e,n,r),n!==this.resolution&&(this.resolution=n,this.refresh())}setDistance(e){this.updateDistance(e,this.minDistance)}setMinDistance(e){this.updateDistance(this.distance,e)}getMinDistance(){return this.minDistance}setSource(e){this.source&&this.source.removeEventListener(Se.CHANGE,this.boundRefresh_),this.source=e,e&&e.addEventListener(Se.CHANGE,this.boundRefresh_),this.refresh()}refresh(){this.clear(),this.cluster(),this.addFeatures(this.features)}updateDistance(e,n){const r=e===0?0:Math.min(n,e)/e,i=e!==this.distance||this.interpolationRatio!==r;this.distance=e,this.minDistance=n,this.interpolationRatio=r,i&&this.refresh()}cluster(){if(this.resolution===void 0||!this.source)return;const e=Mn(),n=this.distance*this.resolution,r=this.source.getFeatures(),i={};for(let s=0,o=r.length;s<o;s++){const a=r[s];if(!(fe(a)in i)){const l=this.geometryFunction(a);if(l){const c=l.getCoordinates();gc(c,e),wr(e,n,e);const u=this.source.getFeaturesInExtent(e).filter(function(d){const h=fe(d);return h in i?!1:(i[h]=!0,!0)});this.features.push(this.createCluster(u,e))}}}}createCluster(e,n){const r=[0,0];for(let a=e.length-1;a>=0;--a){const l=this.geometryFunction(e[a]);l?EO(r,l.getCoordinates()):e.splice(a,1)}SO(r,1/e.length);const i=Er(n),s=this.interpolationRatio,o=new Sn([r[0]*(1-s)+i[0]*s,r[1]*(1-s)+i[1]*s]);return this.createCustomCluster_?this.createCustomCluster_(o,e):new en({geometry:o,features:e})}}function R$(){return[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1]}function Iw(t,e){return t[0]=e[0],t[1]=e[1],t[4]=e[2],t[5]=e[3],t[12]=e[4],t[13]=e[5],t}function I$(t,e,n,r,i,s){const o=i.getCode().split(/:(?=\d+$)/).pop(),a=n/r,l=[Ip(Me(e)/a,zi),Ip(Gt(e)/a,zi)];s.SIZE=l[0]+","+l[1],s.BBOX=e.join(","),s.BBOXSR=o,s.IMAGESR=o,s.DPI=Math.round(s.DPI?s.DPI*r:90*r);const c=t.replace(/MapServer\/?$/,"MapServer/export").replace(/ImageServer\/?$/,"ImageServer/exportImage");return uy(c,s)}function f6(t){const e=t.load?t.load:ru,n=Ne(t.projection||"EPSG:3857"),r=t.ratio??1.5,i=t.crossOrigin??null;return function(s,o,a){a=t.hidpi?a:1;const l={F:"image",FORMAT:"PNG32",TRANSPARENT:!0};Object.assign(l,t.params),s=dE(s,o,a,r);const c=I$(t.url,s,o,a,n,l),u=new Image;return u.crossOrigin=i,e(u,c).then(d=>{const h=Me(s)/d.width*a;return{image:d,extent:s,resolution:h,pixelRatio:a}})}}class g6 extends cE{constructor(e){e=e||{},super({attributions:e.attributions,interpolate:e.interpolate,projection:e.projection,resolutions:e.resolutions}),this.crossOrigin_=e.crossOrigin!==void 0?e.crossOrigin:null,this.hidpi_=e.hidpi!==void 0?e.hidpi:!0,this.url_=e.url,this.imageLoadFunction_=e.imageLoadFunction!==void 0?e.imageLoadFunction:uE,this.params_=Object.assign({},e.params),this.imageSize_=[0,0],this.renderedRevision_=0,this.ratio_=e.ratio!==void 0?e.ratio:1.5,this.loaderProjection_=null}getParams(){return this.params_}getImageInternal(e,n,r,i){return this.url_===void 0?null:((!this.loader||this.loaderProjection_!==i)&&(this.loaderProjection_=i,this.loader=f6({crossOrigin:this.crossOrigin_,params:this.params_,projection:i,hidpi:this.hidpi_,url:this.url_,ratio:this.ratio_,load:(s,o)=>(this.image.setImage(s),this.imageLoadFunction_(this.image,o),ru(s))})),super.getImageInternal(e,n,r,i))}getImageLoadFunction(){return this.imageLoadFunction_}getUrl(){return this.url_}setImageLoadFunction(e){this.imageLoadFunction_=e,this.changed()}setUrl(e){e!=this.url_&&(this.url_=e,this.loader=null,this.changed())}setParams(e){this.params_=Object.assign({},e),this.changed()}updateParams(e){Object.assign(this.params_,e),this.changed()}changed(){this.image=null,super.changed()}}class p6 extends gy{constructor(e){e=e||{},super({attributions:e.attributions,cacheSize:e.cacheSize,crossOrigin:e.crossOrigin,interpolate:e.interpolate,projection:e.projection,reprojectionErrorThreshold:e.reprojectionErrorThreshold,tileGrid:e.tileGrid,tileLoadFunction:e.tileLoadFunction,url:e.url,urls:e.urls,wrapX:e.wrapX!==void 0?e.wrapX:!0,transition:e.transition,zDirection:e.zDirection}),this.params_=Object.assign({},e.params),this.hidpi_=e.hidpi!==void 0?e.hidpi:!0,this.tmpExtent_=Mn(),this.setKey(this.getKeyForParams_())}getKeyForParams_(){let e=0;const n=[];for(const r in this.params_)n[e++]=r+"-"+this.params_[r];return n.join("/")}getParams(){return this.params_}getRequestUrl_(e,n,r,i,s,o){const a=this.urls;if(!a)return;let l;if(a.length==1)l=a[0];else{const c=Ps(sE(e),a.length);l=a[c]}return I$(l,r,(this.tileGrid||this.getTileGridForProjection(s)).getResolution(e[0]),i,s,o)}getTilePixelRatio(e){return this.hidpi_?e:1}setParams(e){this.params_=Object.assign({},e),this.setKey(this.getKeyForParams_())}updateParams(e){Object.assign(this.params_,e),this.setKey(this.getKeyForParams_())}tileUrlFunction(e,n,r){let i=this.getTileGrid();if(i||(i=this.getTileGridForProjection(r)),i.getResolutions().length<=e[0])return;n!=1&&!this.hidpi_&&(n=1);const s=i.getTileCoordExtent(e,this.tmpExtent_);let o=dn(i.getTileSize(e[0]),this.tmpSize);n!=1&&(o=fO(o,n,this.tmpSize));const a={F:"image",FORMAT:"PNG32",TRANSPARENT:!0};return Object.assign(a,this.params_),this.getRequestUrl_(e,o,s,n,r,a)}}function A$(){const t=document.createElement("canvas");return t.width=1,t.height=1,t}class m6{constructor(e,n,r){q(this,"source_");q(this,"projection_");q(this,"fallbackProj_");q(this,"map_");q(this,"shouldRequestNextLevel");q(this,"emptyCanvas_",A$());q(this,"emptyCanvasPromise_",Promise.resolve(this.emptyCanvas_));q(this,"tilingScheme_");q(this,"ready_");q(this,"rectangle_");q(this,"errorEvent",new Cesium.Event);q(this,"credit");q(this,"proxy");this.source_=n,this.projection_=null,this.ready_=!1,this.fallbackProj_=r||null,this.tilingScheme_=new Cesium.WebMercatorTilingScheme,this.rectangle_=null,this.map_=e,this.shouldRequestNextLevel=!1;const i=this.source_.get("olcs_proxy");i&&(typeof i=="function"?this.proxy={getURL:i}:typeof i=="string"&&(this.proxy=new Cesium.DefaultProxy(i))),this.source_.on("change",s=>{this.handleSourceChanged_()}),this.handleSourceChanged_()}get ready(){return this.ready_}get rectangle(){return this.rectangle_}get tilingScheme(){return this.tilingScheme_}get _ready(){return this.ready_}get tileWidth(){const e=this.source_.getTileGrid();if(e){const n=e.getTileSize(0);return Array.isArray(n)?n[0]:n}return 256}get tileHeight(){const e=this.source_.getTileGrid();if(e){const n=e.getTileSize(0);return Array.isArray(n)?n[1]:n}return 256}get maximumLevel(){const e=this.source_.getTileGrid();return e?e.getMaxZoom():18}get minimumLevel(){return 0}get tileDiscardPolicy(){}get hasAlphaChannel(){return!0}pickFeatures(e,n,r,i,s){}handleSourceChanged_(){if(!this.ready_&&this.source_.getState()=="ready"){this.projection_=Mg(this.source_)||this.fallbackProj_;const e={numberOfLevelZeroTilesX:1,numberOfLevelZeroTilesY:1};if(this.source_.getTileGrid()!==null&&this.source_.getTileGrid().forEachTileCoord(this.projection_.getExtent(),0,([n,r,i])=>{e.numberOfLevelZeroTilesX=r+1,e.numberOfLevelZeroTilesY=i+1}),this.projection_.getCode()==="EPSG:4326")this.shouldRequestNextLevel=e.numberOfLevelZeroTilesX===1&&e.numberOfLevelZeroTilesY===1,this.tilingScheme_=new Cesium.GeographicTilingScheme(e);else if(this.projection_.getCode()==="EPSG:3857")this.shouldRequestNextLevel=!1,this.tilingScheme_=new Cesium.WebMercatorTilingScheme(e);else return;this.rectangle_=this.tilingScheme_.rectangle,this.ready_=!0}}getTileCredits(e,n,r){const i=this.source_.getAttributions();if(!i)return[];const s=this.map_.getView().calculateExtent(this.map_.getSize()),o=this.map_.getView().getCenter(),a=this.shouldRequestNextLevel?r+1:r;return G$(i,a,o,s)}requestImage(e,n,r,i){const s=this.source_.getTileUrlFunction();if(s&&this.projection_){const o=this.shouldRequestNextLevel?r+1:r;let a=s.call(this.source_,[o,e,n],1,this.projection_);return this.proxy&&(a=this.proxy.getURL(a)),a?Cesium.ImageryProvider.loadImage(this,a):this.emptyCanvasPromise_}else return this.emptyCanvasPromise_}}const Aw=65536*65536,sP=1/Aw,y6=12,oP=typeof TextDecoder>"u"?null:new TextDecoder("utf-8"),y0=0,Df=1,Ku=2,Nf=5;class _6{constructor(e=new Uint8Array(16)){this.buf=ArrayBuffer.isView(e)?e:new Uint8Array(e),this.dataView=new DataView(this.buf.buffer),this.pos=0,this.type=0,this.length=this.buf.length}readFields(e,n,r=this.length){for(;this.pos<r;){const i=this.readVarint(),s=i>>3,o=this.pos;this.type=i&7,e(s,n,this),this.pos===o&&this.skip(i)}return n}readMessage(e,n){return this.readFields(e,n,this.readVarint()+this.pos)}readFixed32(){const e=this.dataView.getUint32(this.pos,!0);return this.pos+=4,e}readSFixed32(){const e=this.dataView.getInt32(this.pos,!0);return this.pos+=4,e}readFixed64(){const e=this.dataView.getUint32(this.pos,!0)+this.dataView.getUint32(this.pos+4,!0)*Aw;return this.pos+=8,e}readSFixed64(){const e=this.dataView.getUint32(this.pos,!0)+this.dataView.getInt32(this.pos+4,!0)*Aw;return this.pos+=8,e}readFloat(){const e=this.dataView.getFloat32(this.pos,!0);return this.pos+=4,e}readDouble(){const e=this.dataView.getFloat64(this.pos,!0);return this.pos+=8,e}readVarint(e){const n=this.buf;let r,i;return i=n[this.pos++],r=i&127,i<128||(i=n[this.pos++],r|=(i&127)<<7,i<128)||(i=n[this.pos++],r|=(i&127)<<14,i<128)||(i=n[this.pos++],r|=(i&127)<<21,i<128)?r:(i=n[this.pos],r|=(i&15)<<28,v6(r,e,this))}readVarint64(){return this.readVarint(!0)}readSVarint(){const e=this.readVarint();return e%2===1?(e+1)/-2:e/2}readBoolean(){return!!this.readVarint()}readString(){const e=this.readVarint()+this.pos,n=this.pos;return this.pos=e,e-n>=y6&&oP?oP.decode(this.buf.subarray(n,e)):O6(this.buf,n,e)}readBytes(){const e=this.readVarint()+this.pos,n=this.buf.subarray(this.pos,e);return this.pos=e,n}readPackedVarint(e=[],n){const r=this.readPackedEnd();for(;this.pos<r;)e.push(this.readVarint(n));return e}readPackedSVarint(e=[]){const n=this.readPackedEnd();for(;this.pos<n;)e.push(this.readSVarint());return e}readPackedBoolean(e=[]){const n=this.readPackedEnd();for(;this.pos<n;)e.push(this.readBoolean());return e}readPackedFloat(e=[]){const n=this.readPackedEnd();for(;this.pos<n;)e.push(this.readFloat());return e}readPackedDouble(e=[]){const n=this.readPackedEnd();for(;this.pos<n;)e.push(this.readDouble());return e}readPackedFixed32(e=[]){const n=this.readPackedEnd();for(;this.pos<n;)e.push(this.readFixed32());return e}readPackedSFixed32(e=[]){const n=this.readPackedEnd();for(;this.pos<n;)e.push(this.readSFixed32());return e}readPackedFixed64(e=[]){const n=this.readPackedEnd();for(;this.pos<n;)e.push(this.readFixed64());return e}readPackedSFixed64(e=[]){const n=this.readPackedEnd();for(;this.pos<n;)e.push(this.readSFixed64());return e}readPackedEnd(){return this.type===Ku?this.readVarint()+this.pos:this.pos+1}skip(e){const n=e&7;if(n===y0)for(;this.buf[this.pos++]>127;);else if(n===Ku)this.pos=this.readVarint()+this.pos;else if(n===Nf)this.pos+=4;else if(n===Df)this.pos+=8;else throw new Error(`Unimplemented type: ${n}`)}writeTag(e,n){this.writeVarint(e<<3|n)}realloc(e){let n=this.length||16;for(;n<this.pos+e;)n*=2;if(n!==this.length){const r=new Uint8Array(n);r.set(this.buf),this.buf=r,this.dataView=new DataView(r.buffer),this.length=n}}finish(){return this.length=this.pos,this.pos=0,this.buf.subarray(0,this.length)}writeFixed32(e){this.realloc(4),this.dataView.setInt32(this.pos,e,!0),this.pos+=4}writeSFixed32(e){this.realloc(4),this.dataView.setInt32(this.pos,e,!0),this.pos+=4}writeFixed64(e){this.realloc(8),this.dataView.setInt32(this.pos,e&-1,!0),this.dataView.setInt32(this.pos+4,Math.floor(e*sP),!0),this.pos+=8}writeSFixed64(e){this.realloc(8),this.dataView.setInt32(this.pos,e&-1,!0),this.dataView.setInt32(this.pos+4,Math.floor(e*sP),!0),this.pos+=8}writeVarint(e){if(e=+e||0,e>268435455||e<0){w6(e,this);return}this.realloc(4),this.buf[this.pos++]=e&127|(e>127?128:0),!(e<=127)&&(this.buf[this.pos++]=(e>>>=7)&127|(e>127?128:0),!(e<=127)&&(this.buf[this.pos++]=(e>>>=7)&127|(e>127?128:0),!(e<=127)&&(this.buf[this.pos++]=e>>>7&127)))}writeSVarint(e){this.writeVarint(e<0?-e*2-1:e*2)}writeBoolean(e){this.writeVarint(+e)}writeString(e){e=String(e),this.realloc(e.length*4),this.pos++;const n=this.pos;this.pos=$6(this.buf,e,this.pos);const r=this.pos-n;r>=128&&aP(n,r,this),this.pos=n-1,this.writeVarint(r),this.pos+=r}writeFloat(e){this.realloc(4),this.dataView.setFloat32(this.pos,e,!0),this.pos+=4}writeDouble(e){this.realloc(8),this.dataView.setFloat64(this.pos,e,!0),this.pos+=8}writeBytes(e){const n=e.length;this.writeVarint(n),this.realloc(n);for(let r=0;r<n;r++)this.buf[this.pos++]=e[r]}writeRawMessage(e,n){this.pos++;const r=this.pos;e(n,this);const i=this.pos-r;i>=128&&aP(r,i,this),this.pos=r-1,this.writeVarint(i),this.pos+=i}writeMessage(e,n,r){this.writeTag(e,Ku),this.writeRawMessage(n,r)}writePackedVarint(e,n){n.length&&this.writeMessage(e,S6,n)}writePackedSVarint(e,n){n.length&&this.writeMessage(e,b6,n)}writePackedBoolean(e,n){n.length&&this.writeMessage(e,P6,n)}writePackedFloat(e,n){n.length&&this.writeMessage(e,C6,n)}writePackedDouble(e,n){n.length&&this.writeMessage(e,T6,n)}writePackedFixed32(e,n){n.length&&this.writeMessage(e,R6,n)}writePackedSFixed32(e,n){n.length&&this.writeMessage(e,I6,n)}writePackedFixed64(e,n){n.length&&this.writeMessage(e,A6,n)}writePackedSFixed64(e,n){n.length&&this.writeMessage(e,F6,n)}writeBytesField(e,n){this.writeTag(e,Ku),this.writeBytes(n)}writeFixed32Field(e,n){this.writeTag(e,Nf),this.writeFixed32(n)}writeSFixed32Field(e,n){this.writeTag(e,Nf),this.writeSFixed32(n)}writeFixed64Field(e,n){this.writeTag(e,Df),this.writeFixed64(n)}writeSFixed64Field(e,n){this.writeTag(e,Df),this.writeSFixed64(n)}writeVarintField(e,n){this.writeTag(e,y0),this.writeVarint(n)}writeSVarintField(e,n){this.writeTag(e,y0),this.writeSVarint(n)}writeStringField(e,n){this.writeTag(e,Ku),this.writeString(n)}writeFloatField(e,n){this.writeTag(e,Nf),this.writeFloat(n)}writeDoubleField(e,n){this.writeTag(e,Df),this.writeDouble(n)}writeBooleanField(e,n){this.writeVarintField(e,+n)}}function v6(t,e,n){const r=n.buf;let i,s;if(s=r[n.pos++],i=(s&112)>>4,s<128||(s=r[n.pos++],i|=(s&127)<<3,s<128)||(s=r[n.pos++],i|=(s&127)<<10,s<128)||(s=r[n.pos++],i|=(s&127)<<17,s<128)||(s=r[n.pos++],i|=(s&127)<<24,s<128)||(s=r[n.pos++],i|=(s&1)<<31,s<128))return Tl(t,i,e);throw new Error("Expected varint not more than 10 bytes")}function Tl(t,e,n){return n?e*4294967296+(t>>>0):(e>>>0)*4294967296+(t>>>0)}function w6(t,e){let n,r;if(t>=0?(n=t%4294967296|0,r=t/4294967296|0):(n=~(-t%4294967296),r=~(-t/4294967296),n^4294967295?n=n+1|0:(n=0,r=r+1|0)),t>=18446744073709552e3||t<-18446744073709552e3)throw new Error("Given varint doesn't fit into 10 bytes");e.realloc(10),x6(n,r,e),E6(r,e)}function x6(t,e,n){n.buf[n.pos++]=t&127|128,t>>>=7,n.buf[n.pos++]=t&127|128,t>>>=7,n.buf[n.pos++]=t&127|128,t>>>=7,n.buf[n.pos++]=t&127|128,t>>>=7,n.buf[n.pos]=t&127}function E6(t,e){const n=(t&7)<<4;e.buf[e.pos++]|=n|((t>>>=3)?128:0),t&&(e.buf[e.pos++]=t&127|((t>>>=7)?128:0),t&&(e.buf[e.pos++]=t&127|((t>>>=7)?128:0),t&&(e.buf[e.pos++]=t&127|((t>>>=7)?128:0),t&&(e.buf[e.pos++]=t&127|((t>>>=7)?128:0),t&&(e.buf[e.pos++]=t&127)))))}function aP(t,e,n){const r=e<=16383?1:e<=2097151?2:e<=268435455?3:Math.floor(Math.log(e)/(Math.LN2*7));n.realloc(r);for(let i=n.pos-1;i>=t;i--)n.buf[i+r]=n.buf[i]}function S6(t,e){for(let n=0;n<t.length;n++)e.writeVarint(t[n])}function b6(t,e){for(let n=0;n<t.length;n++)e.writeSVarint(t[n])}function C6(t,e){for(let n=0;n<t.length;n++)e.writeFloat(t[n])}function T6(t,e){for(let n=0;n<t.length;n++)e.writeDouble(t[n])}function P6(t,e){for(let n=0;n<t.length;n++)e.writeBoolean(t[n])}function R6(t,e){for(let n=0;n<t.length;n++)e.writeFixed32(t[n])}function I6(t,e){for(let n=0;n<t.length;n++)e.writeSFixed32(t[n])}function A6(t,e){for(let n=0;n<t.length;n++)e.writeFixed64(t[n])}function F6(t,e){for(let n=0;n<t.length;n++)e.writeSFixed64(t[n])}function O6(t,e,n){let r="",i=e;for(;i<n;){const s=t[i];let o=null,a=s>239?4:s>223?3:s>191?2:1;if(i+a>n)break;let l,c,u;a===1?s<128&&(o=s):a===2?(l=t[i+1],(l&192)===128&&(o=(s&31)<<6|l&63,o<=127&&(o=null))):a===3?(l=t[i+1],c=t[i+2],(l&192)===128&&(c&192)===128&&(o=(s&15)<<12|(l&63)<<6|c&63,(o<=2047||o>=55296&&o<=57343)&&(o=null))):a===4&&(l=t[i+1],c=t[i+2],u=t[i+3],(l&192)===128&&(c&192)===128&&(u&192)===128&&(o=(s&15)<<18|(l&63)<<12|(c&63)<<6|u&63,(o<=65535||o>=1114112)&&(o=null))),o===null?(o=65533,a=1):o>65535&&(o-=65536,r+=String.fromCharCode(o>>>10&1023|55296),o=56320|o&1023),r+=String.fromCharCode(o),i+=a}return r}function $6(t,e,n){for(let r=0,i,s;r<e.length;r++){if(i=e.charCodeAt(r),i>55295&&i<57344)if(s)if(i<56320){t[n++]=239,t[n++]=191,t[n++]=189,s=i;continue}else i=s-55296<<10|i-56320|65536,s=null;else{i>56319||r+1===e.length?(t[n++]=239,t[n++]=191,t[n++]=189):s=i;continue}else s&&(t[n++]=239,t[n++]=191,t[n++]=189,s=null);i<128?t[n++]=i:(i<2048?t[n++]=i>>6|192:(i<65536?t[n++]=i>>12|224:(t[n++]=i>>18|240,t[n++]=i>>12&63|128),t[n++]=i>>6&63|128),t[n++]=i&63|128)}return n}class gE{constructor(){this.dataProjection=void 0,this.defaultFeatureProjection=void 0,this.featureClass=en,this.supportedMediaTypes=null}getReadOptions(e,n){if(n){let r=n.dataProjection?Ne(n.dataProjection):this.readProjection(e);n.extent&&r&&r.getUnits()==="tile-pixels"&&(r=Ne(r),r.setWorldExtent(n.extent)),n={dataProjection:r,featureProjection:n.featureProjection}}return this.adaptOptions(n)}adaptOptions(e){return Object.assign({dataProjection:this.dataProjection,featureProjection:this.defaultFeatureProjection,featureClass:this.featureClass},e)}getType(){return Te()}readFeature(e,n){return Te()}readFeatures(e,n){return Te()}readGeometry(e,n){return Te()}readProjection(e){return Te()}writeFeature(e,n){return Te()}writeFeatures(e,n){return Te()}writeGeometry(e,n){return Te()}}function Qr(t,e,n){const r=n?Ne(n.featureProjection):null,i=n?Ne(n.dataProjection):null;let s=t;if(r&&i&&!Gn(r,i)){e&&(s=t.clone());const o=e?r:i,a=e?i:r;o.getUnits()==="tile-pixels"?s.transform(o,a):s.applyTransform(qi(o,a))}if(e&&n&&n.decimals!==void 0){const o=Math.pow(10,n.decimals),a=function(l){for(let c=0,u=l.length;c<u;++c)l[c]=Math.round(l[c]*o)/o;return l};s===t&&(s=t.clone()),s.applyTransform(a)}return s}const L6={Point:Sn,LineString:ar,Polygon:lr,MultiPoint:ol,MultiLineString:Ji,MultiPolygon:Vo};function k6(t,e,n){return Array.isArray(e[0])?(WO(t,0,e,n)||(t=t.slice(),vw(t,0,e,n)),t):(V1(t,0,e,n)||(t=t.slice(),jp(t,0,e,n)),t)}function F$(t,e){var s;const n=t.geometry;if(!n)return[];if(Array.isArray(n))return n.map(o=>F$({...t,geometry:o})).flat();const r=n.type==="MultiPolygon"?"Polygon":n.type;if(r==="GeometryCollection"||r==="Circle")throw new Error("Unsupported geometry type: "+r);const i=n.layout.length;return Qr(new wn(r,r==="Polygon"?k6(n.flatCoordinates,n.ends,i):n.flatCoordinates,(s=n.ends)==null?void 0:s.flat(),i,t.properties||{},t.id).enableSimplifyTransformed(),!1,e)}function pE(t,e){if(!t)return null;if(Array.isArray(t)){const r=t.map(i=>pE(i,e));return new Wr(r)}const n=L6[t.type];return Qr(new n(t.flatCoordinates,t.layout||"XY",t.ends),!1,e)}class M6 extends gE{constructor(e){super(),e=e||{},this.dataProjection=new Qm({code:"",units:"tile-pixels"}),this.featureClass=e.featureClass?e.featureClass:wn,this.geometryName_=e.geometryName,this.layerName_=e.layerName?e.layerName:"layer",this.layers_=e.layers?e.layers:null,this.idProperty_=e.idProperty,this.supportedMediaTypes=["application/vnd.mapbox-vector-tile","application/x-protobuf"]}readRawGeometry_(e,n,r,i){e.pos=n.geometry;const s=e.readVarint()+e.pos;let o=1,a=0,l=0,c=0,u=0,d=0;for(;e.pos<s;){if(!a){const h=e.readVarint();o=h&7,a=h>>3}if(a--,o===1||o===2)l+=e.readSVarint(),c+=e.readSVarint(),o===1&&u>d&&(i.push(u),d=u),r.push(l,c),u+=2;else if(o===7)u>d&&(r.push(r[d],r[d+1]),u+=2);else throw new Error("Invalid command found in the PBF")}u>d&&(i.push(u),d=u)}createFeature_(e,n,r){const i=n.type;if(i===0)return null;let s;const o=n.properties;let a;this.idProperty_?(a=o[this.idProperty_],delete o[this.idProperty_]):a=n.id,o[this.layerName_]=n.layer.name;const l=[],c=[];this.readRawGeometry_(e,n,l,c);const u=U6(i,c.length);if(this.featureClass===wn)s=new this.featureClass(u,l,c,2,o,a),s.transform(r.dataProjection);else{let d;if(u=="Polygon"){const p=W1(l,c);d=p.length>1?new Vo(l,"XY",p):new lr(l,"XY",c)}else d=u==="Point"?new Sn(l,"XY"):u==="LineString"?new ar(l,"XY"):u==="MultiPoint"?new ol(l,"XY"):u==="MultiLineString"?new Ji(l,"XY",c):null;const h=this.featureClass;s=new h,this.geometryName_&&s.setGeometryName(this.geometryName_);const f=Qr(d,!1,r);s.setGeometry(f),a!==void 0&&s.setId(a),s.setProperties(o,!0)}return s}getType(){return"arraybuffer"}readFeatures(e,n){const r=this.layers_;n=this.adaptOptions(n);const i=Ne(n.dataProjection);i.setWorldExtent(n.extent),n.dataProjection=i;const s=new _6(e),o=s.readFields(D6,{}),a=[];for(const l in o){if(r&&!r.includes(l))continue;const c=o[l],u=c?[0,0,c.extent,c.extent]:null;i.setExtent(u);for(let d=0,h=c.length;d<h;++d){const f=z6(s,c,d),p=this.createFeature_(s,f,n);p!==null&&a.push(p)}}return a}readProjection(e){return this.dataProjection}setLayers(e){this.layers_=e}}function D6(t,e,n){if(t===3){const r={keys:[],values:[],features:[]},i=n.readVarint()+n.pos;n.readFields(N6,r,i),r.length=r.features.length,r.length&&(e[r.name]=r)}}function N6(t,e,n){if(t===15)e.version=n.readVarint();else if(t===1)e.name=n.readString();else if(t===5)e.extent=n.readVarint();else if(t===2)e.features.push(n.pos);else if(t===3)e.keys.push(n.readString());else if(t===4){let r=null;const i=n.readVarint()+n.pos;for(;n.pos<i;)t=n.readVarint()>>3,r=t===1?n.readString():t===2?n.readFloat():t===3?n.readDouble():t===4?n.readVarint64():t===5?n.readVarint():t===6?n.readSVarint():t===7?n.readBoolean():null;e.values.push(r)}}function j6(t,e,n){if(t==1)e.id=n.readVarint();else if(t==2){const r=n.readVarint()+n.pos;for(;n.pos<r;){const i=e.layer.keys[n.readVarint()],s=e.layer.values[n.readVarint()];e.properties[i]=s}}else t==3?e.type=n.readVarint():t==4&&(e.geometry=n.pos)}function z6(t,e,n){t.pos=e.features[n];const r=t.readVarint()+t.pos,i={layer:e,type:0,properties:{}};return t.readFields(j6,i,r),i}function U6(t,e){let n;return t===1?n=e===1?"Point":"MultiPoint":t===2?n=e===1?"LineString":"MultiLineString":t===3&&(n="Polygon"),n}class O${drawCustom(e,n,r,i,s){}drawGeometry(e){}setStyle(e){}drawCircle(e,n,r){}drawFeature(e,n,r){}drawGeometryCollection(e,n,r){}drawLineString(e,n,r){}drawMultiLineString(e,n,r){}drawMultiPoint(e,n,r){}drawMultiPolygon(e,n,r){}drawPoint(e,n,r){}drawPolygon(e,n,r){}drawText(e,n,r){}setFillStrokeStyle(e,n){}setImageStyle(e,n){}setTextStyle(e,n){}}class $$ extends O${constructor(e,n,r,i,s,o,a){super(),this.context_=e,this.pixelRatio_=n,this.extent_=r,this.transform_=i,this.transformRotation_=i?tu(Math.atan2(i[1],i[0]),10):0,this.viewRotation_=s,this.squaredTolerance_=o,this.userTransform_=a,this.contextFillState_=null,this.contextStrokeState_=null,this.contextTextState_=null,this.fillState_=null,this.strokeState_=null,this.image_=null,this.imageAnchorX_=0,this.imageAnchorY_=0,this.imageHeight_=0,this.imageOpacity_=0,this.imageOriginX_=0,this.imageOriginY_=0,this.imageRotateWithView_=!1,this.imageRotation_=0,this.imageScale_=[0,0],this.imageWidth_=0,this.text_="",this.textOffsetX_=0,this.textOffsetY_=0,this.textRotateWithView_=!1,this.textRotation_=0,this.textScale_=[0,0],this.textFillState_=null,this.textStrokeState_=null,this.textState_=null,this.pixelCoordinates_=[],this.tmpLocalTransform_=Bt()}drawImages_(e,n,r,i){if(!this.image_)return;const s=Ki(e,n,r,i,this.transform_,this.pixelCoordinates_),o=this.context_,a=this.tmpLocalTransform_,l=o.globalAlpha;this.imageOpacity_!=1&&(o.globalAlpha=l*this.imageOpacity_);let c=this.imageRotation_;this.transformRotation_===0&&(c-=this.viewRotation_),this.imageRotateWithView_&&(c+=this.viewRotation_);for(let u=0,d=s.length;u<d;u+=2){const h=s[u]-this.imageAnchorX_,f=s[u+1]-this.imageAnchorY_;if(c!==0||this.imageScale_[0]!=1||this.imageScale_[1]!=1){const p=h+this.imageAnchorX_,m=f+this.imageAnchorY_;Xr(a,p,m,1,1,c,-p,-m),o.save(),o.transform.apply(o,a),o.translate(p,m),o.scale(this.imageScale_[0],this.imageScale_[1]),o.drawImage(this.image_,this.imageOriginX_,this.imageOriginY_,this.imageWidth_,this.imageHeight_,-this.imageAnchorX_,-this.imageAnchorY_,this.imageWidth_,this.imageHeight_),o.restore()}else o.drawImage(this.image_,this.imageOriginX_,this.imageOriginY_,this.imageWidth_,this.imageHeight_,h,f,this.imageWidth_,this.imageHeight_)}this.imageOpacity_!=1&&(o.globalAlpha=l)}drawText_(e,n,r,i){if(!this.textState_||this.text_==="")return;this.textFillState_&&this.setContextFillState_(this.textFillState_),this.textStrokeState_&&this.setContextStrokeState_(this.textStrokeState_),this.setContextTextState_(this.textState_);const s=Ki(e,n,r,i,this.transform_,this.pixelCoordinates_),o=this.context_;let a=this.textRotation_;for(this.transformRotation_===0&&(a-=this.viewRotation_),this.textRotateWithView_&&(a+=this.viewRotation_);n<r;n+=i){const l=s[n]+this.textOffsetX_,c=s[n+1]+this.textOffsetY_;a!==0||this.textScale_[0]!=1||this.textScale_[1]!=1?(o.save(),o.translate(l-this.textOffsetX_,c-this.textOffsetY_),o.rotate(a),o.translate(this.textOffsetX_,this.textOffsetY_),o.scale(this.textScale_[0],this.textScale_[1]),this.textStrokeState_&&o.strokeText(this.text_,0,0),this.textFillState_&&o.fillText(this.text_,0,0),o.restore()):(this.textStrokeState_&&o.strokeText(this.text_,l,c),this.textFillState_&&o.fillText(this.text_,l,c))}}moveToLineTo_(e,n,r,i,s){const o=this.context_,a=Ki(e,n,r,i,this.transform_,this.pixelCoordinates_);o.moveTo(a[0],a[1]);let l=a.length;s&&(l-=2);for(let c=2;c<l;c+=2)o.lineTo(a[c],a[c+1]);return s&&o.closePath(),r}drawRings_(e,n,r,i){for(let s=0,o=r.length;s<o;++s)n=this.moveToLineTo_(e,n,r[s],i,!0);return n}drawCircle(e){if(this.squaredTolerance_&&(e=e.simplifyTransformed(this.squaredTolerance_,this.userTransform_)),!!Lt(this.extent_,e.getExtent())){if(this.fillState_||this.strokeState_){this.fillState_&&this.setContextFillState_(this.fillState_),this.strokeState_&&this.setContextStrokeState_(this.strokeState_);const n=Iz(e,this.transform_,this.pixelCoordinates_),r=n[2]-n[0],i=n[3]-n[1],s=Math.sqrt(r*r+i*i),o=this.context_;o.beginPath(),o.arc(n[0],n[1],s,0,2*Math.PI),this.fillState_&&o.fill(),this.strokeState_&&o.stroke()}this.text_!==""&&this.drawText_(e.getCenter(),0,2,2)}}setStyle(e){this.setFillStrokeStyle(e.getFill(),e.getStroke()),this.setImageStyle(e.getImage()),this.setTextStyle(e.getText())}setTransform(e){this.transform_=e}drawGeometry(e){switch(e.getType()){case"Point":this.drawPoint(e);break;case"LineString":this.drawLineString(e);break;case"Polygon":this.drawPolygon(e);break;case"MultiPoint":this.drawMultiPoint(e);break;case"MultiLineString":this.drawMultiLineString(e);break;case"MultiPolygon":this.drawMultiPolygon(e);break;case"GeometryCollection":this.drawGeometryCollection(e);break;case"Circle":this.drawCircle(e);break}}drawFeature(e,n){const r=n.getGeometryFunction()(e);r&&(this.setStyle(n),this.drawGeometry(r))}drawGeometryCollection(e){const n=e.getGeometriesArray();for(let r=0,i=n.length;r<i;++r)this.drawGeometry(n[r])}drawPoint(e){this.squaredTolerance_&&(e=e.simplifyTransformed(this.squaredTolerance_,this.userTransform_));const n=e.getFlatCoordinates(),r=e.getStride();this.image_&&this.drawImages_(n,0,n.length,r),this.text_!==""&&this.drawText_(n,0,n.length,r)}drawMultiPoint(e){this.squaredTolerance_&&(e=e.simplifyTransformed(this.squaredTolerance_,this.userTransform_));const n=e.getFlatCoordinates(),r=e.getStride();this.image_&&this.drawImages_(n,0,n.length,r),this.text_!==""&&this.drawText_(n,0,n.length,r)}drawLineString(e){if(this.squaredTolerance_&&(e=e.simplifyTransformed(this.squaredTolerance_,this.userTransform_)),!!Lt(this.extent_,e.getExtent())){if(this.strokeState_){this.setContextStrokeState_(this.strokeState_);const n=this.context_,r=e.getFlatCoordinates();n.beginPath(),this.moveToLineTo_(r,0,r.length,e.getStride(),!1),n.stroke()}if(this.text_!==""){const n=e.getFlatMidpoint();this.drawText_(n,0,2,2)}}}drawMultiLineString(e){this.squaredTolerance_&&(e=e.simplifyTransformed(this.squaredTolerance_,this.userTransform_));const n=e.getExtent();if(Lt(this.extent_,n)){if(this.strokeState_){this.setContextStrokeState_(this.strokeState_);const r=this.context_,i=e.getFlatCoordinates();let s=0;const o=e.getEnds(),a=e.getStride();r.beginPath();for(let l=0,c=o.length;l<c;++l)s=this.moveToLineTo_(i,s,o[l],a,!1);r.stroke()}if(this.text_!==""){const r=e.getFlatMidpoints();this.drawText_(r,0,r.length,2)}}}drawPolygon(e){if(this.squaredTolerance_&&(e=e.simplifyTransformed(this.squaredTolerance_,this.userTransform_)),!!Lt(this.extent_,e.getExtent())){if(this.strokeState_||this.fillState_){this.fillState_&&this.setContextFillState_(this.fillState_),this.strokeState_&&this.setContextStrokeState_(this.strokeState_);const n=this.context_;n.beginPath(),this.drawRings_(e.getOrientedFlatCoordinates(),0,e.getEnds(),e.getStride()),this.fillState_&&n.fill(),this.strokeState_&&n.stroke()}if(this.text_!==""){const n=e.getFlatInteriorPoint();this.drawText_(n,0,2,2)}}}drawMultiPolygon(e){if(this.squaredTolerance_&&(e=e.simplifyTransformed(this.squaredTolerance_,this.userTransform_)),!!Lt(this.extent_,e.getExtent())){if(this.strokeState_||this.fillState_){this.fillState_&&this.setContextFillState_(this.fillState_),this.strokeState_&&this.setContextStrokeState_(this.strokeState_);const n=this.context_,r=e.getOrientedFlatCoordinates();let i=0;const s=e.getEndss(),o=e.getStride();n.beginPath();for(let a=0,l=s.length;a<l;++a){const c=s[a];i=this.drawRings_(r,i,c,o)}this.fillState_&&n.fill(),this.strokeState_&&n.stroke()}if(this.text_!==""){const n=e.getFlatInteriorPoints();this.drawText_(n,0,n.length,2)}}}setContextFillState_(e){const n=this.context_,r=this.contextFillState_;r?r.fillStyle!=e.fillStyle&&(r.fillStyle=e.fillStyle,n.fillStyle=e.fillStyle):(n.fillStyle=e.fillStyle,this.contextFillState_={fillStyle:e.fillStyle})}setContextStrokeState_(e){const n=this.context_,r=this.contextStrokeState_;r?(r.lineCap!=e.lineCap&&(r.lineCap=e.lineCap,n.lineCap=e.lineCap),es(r.lineDash,e.lineDash)||n.setLineDash(r.lineDash=e.lineDash),r.lineDashOffset!=e.lineDashOffset&&(r.lineDashOffset=e.lineDashOffset,n.lineDashOffset=e.lineDashOffset),r.lineJoin!=e.lineJoin&&(r.lineJoin=e.lineJoin,n.lineJoin=e.lineJoin),r.lineWidth!=e.lineWidth&&(r.lineWidth=e.lineWidth,n.lineWidth=e.lineWidth),r.miterLimit!=e.miterLimit&&(r.miterLimit=e.miterLimit,n.miterLimit=e.miterLimit),r.strokeStyle!=e.strokeStyle&&(r.strokeStyle=e.strokeStyle,n.strokeStyle=e.strokeStyle)):(n.lineCap=e.lineCap,n.setLineDash(e.lineDash),n.lineDashOffset=e.lineDashOffset,n.lineJoin=e.lineJoin,n.lineWidth=e.lineWidth,n.miterLimit=e.miterLimit,n.strokeStyle=e.strokeStyle,this.contextStrokeState_={lineCap:e.lineCap,lineDash:e.lineDash,lineDashOffset:e.lineDashOffset,lineJoin:e.lineJoin,lineWidth:e.lineWidth,miterLimit:e.miterLimit,strokeStyle:e.strokeStyle})}setContextTextState_(e){const n=this.context_,r=this.contextTextState_,i=e.textAlign?e.textAlign:sh;r?(r.font!=e.font&&(r.font=e.font,n.font=e.font),r.textAlign!=i&&(r.textAlign=i,n.textAlign=i),r.textBaseline!=e.textBaseline&&(r.textBaseline=e.textBaseline,n.textBaseline=e.textBaseline)):(n.font=e.font,n.textAlign=i,n.textBaseline=e.textBaseline,this.contextTextState_={font:e.font,textAlign:i,textBaseline:e.textBaseline})}setFillStrokeStyle(e,n){if(!e)this.fillState_=null;else{const r=e.getColor();this.fillState_={fillStyle:Ni(r||Qn)}}if(!n)this.strokeState_=null;else{const r=n.getColor(),i=n.getLineCap(),s=n.getLineDash(),o=n.getLineDashOffset(),a=n.getLineJoin(),l=n.getWidth(),c=n.getMiterLimit(),u=s||Rs;this.strokeState_={lineCap:i!==void 0?i:kc,lineDash:this.pixelRatio_===1?u:u.map(d=>d*this.pixelRatio_),lineDashOffset:(o||Is)*this.pixelRatio_,lineJoin:a!==void 0?a:Mc,lineWidth:(l!==void 0?l:oh)*this.pixelRatio_,miterLimit:c!==void 0?c:rh,strokeStyle:Ni(r||ih)}}}setImageStyle(e){let n;if(!e||!(n=e.getSize())){this.image_=null;return}const r=e.getPixelRatio(this.pixelRatio_),i=e.getAnchor(),s=e.getOrigin();this.image_=e.getImage(this.pixelRatio_),this.imageAnchorX_=i[0]*r,this.imageAnchorY_=i[1]*r,this.imageHeight_=n[1]*r,this.imageOpacity_=e.getOpacity(),this.imageOriginX_=s[0],this.imageOriginY_=s[1],this.imageRotateWithView_=e.getRotateWithView(),this.imageRotation_=e.getRotation();const o=e.getScaleArray();this.imageScale_=[o[0]*this.pixelRatio_/r,o[1]*this.pixelRatio_/r],this.imageWidth_=n[0]*r}setTextStyle(e){if(!e)this.text_="";else{const n=e.getFill();if(!n)this.textFillState_=null;else{const f=n.getColor();this.textFillState_={fillStyle:Ni(f||Qn)}}const r=e.getStroke();if(!r)this.textStrokeState_=null;else{const f=r.getColor(),p=r.getLineCap(),m=r.getLineDash(),_=r.getLineDashOffset(),g=r.getLineJoin(),y=r.getWidth(),v=r.getMiterLimit();this.textStrokeState_={lineCap:p!==void 0?p:kc,lineDash:m||Rs,lineDashOffset:_||Is,lineJoin:g!==void 0?g:Mc,lineWidth:y!==void 0?y:oh,miterLimit:v!==void 0?v:rh,strokeStyle:Ni(f||ih)}}const i=e.getFont(),s=e.getOffsetX(),o=e.getOffsetY(),a=e.getRotateWithView(),l=e.getRotation(),c=e.getScaleArray(),u=e.getText(),d=e.getTextAlign(),h=e.getTextBaseline();this.textState_={font:i!==void 0?i:uO,textAlign:d!==void 0?d:sh,textBaseline:h!==void 0?h:Op},this.text_=u!==void 0?Array.isArray(u)?u.reduce((f,p,m)=>f+=m%2?" ":p,""):u:"",this.textOffsetX_=s!==void 0?this.pixelRatio_*s:0,this.textOffsetY_=o!==void 0?this.pixelRatio_*o:0,this.textRotateWithView_=a!==void 0?a:!1,this.textRotation_=l!==void 0?l:0,this.textScale_=[this.pixelRatio_*c[0],this.pixelRatio_*c[1]]}}}const G6=.5,L$={Point:Z6,LineString:K6,Polygon:J6,MultiPoint:q6,MultiLineString:Y6,MultiPolygon:X6,GeometryCollection:H6,Circle:V6};function B6(t,e){return parseInt(fe(t),10)-parseInt(fe(e),10)}function Fw(t,e){const n=k$(t,e);return n*n}function k$(t,e){return G6*t/e}function V6(t,e,n,r,i){const s=n.getFill(),o=n.getStroke();if(s||o){const l=t.getBuilder(n.getZIndex(),"Circle");l.setFillStrokeStyle(s,o),l.drawCircle(e,r,i)}const a=n.getText();if(a&&a.getText()){const l=t.getBuilder(n.getZIndex(),"Text");l.setTextStyle(a),l.drawText(e,r)}}function Xp(t,e,n,r,i,s,o,a){const l=[],c=n.getImage();if(c){let h=!0;const f=c.getImageState();f==ye.LOADED||f==ye.ERROR?h=!1:f==ye.IDLE&&c.load(),h&&l.push(c.ready())}const u=n.getFill();u&&u.loading()&&l.push(u.ready());const d=l.length>0;return d&&Promise.all(l).then(()=>i(null)),W6(t,e,n,r,s,o,a),d}function W6(t,e,n,r,i,s,o){const a=n.getGeometryFunction()(e);if(!a)return;const l=a.simplifyTransformed(r,i);if(n.getRenderer())M$(t,l,n,e,o);else{const u=L$[l.getType()];u(t,l,n,e,o,s)}}function M$(t,e,n,r,i){if(e.getType()=="GeometryCollection"){const o=e.getGeometries();for(let a=0,l=o.length;a<l;++a)M$(t,o[a],n,r,i);return}t.getBuilder(n.getZIndex(),"Default").drawCustom(e,r,n.getRenderer(),n.getHitDetectionRenderer(),i)}function H6(t,e,n,r,i,s){const o=e.getGeometriesArray();let a,l;for(a=0,l=o.length;a<l;++a){const c=L$[o[a].getType()];c(t,o[a],n,r,i,s)}}function K6(t,e,n,r,i){const s=n.getStroke();if(s){const a=t.getBuilder(n.getZIndex(),"LineString");a.setFillStrokeStyle(null,s),a.drawLineString(e,r,i)}const o=n.getText();if(o&&o.getText()){const a=t.getBuilder(n.getZIndex(),"Text");a.setTextStyle(o),a.drawText(e,r,i)}}function Y6(t,e,n,r,i){const s=n.getStroke();if(s){const a=t.getBuilder(n.getZIndex(),"LineString");a.setFillStrokeStyle(null,s),a.drawMultiLineString(e,r,i)}const o=n.getText();if(o&&o.getText()){const a=t.getBuilder(n.getZIndex(),"Text");a.setTextStyle(o),a.drawText(e,r,i)}}function X6(t,e,n,r,i){const s=n.getFill(),o=n.getStroke();if(o||s){const l=t.getBuilder(n.getZIndex(),"Polygon");l.setFillStrokeStyle(s,o),l.drawMultiPolygon(e,r,i)}const a=n.getText();if(a&&a.getText()){const l=t.getBuilder(n.getZIndex(),"Text");l.setTextStyle(a),l.drawText(e,r,i)}}function Z6(t,e,n,r,i,s){const o=n.getImage(),a=n.getText(),l=a&&a.getText(),c=s&&o&&l?{}:void 0;if(o){if(o.getImageState()!=ye.LOADED)return;const u=t.getBuilder(n.getZIndex(),"Image");u.setImageStyle(o,c),u.drawPoint(e,r,i)}if(l){const u=t.getBuilder(n.getZIndex(),"Text");u.setTextStyle(a,c),u.drawText(e,r,i)}}function q6(t,e,n,r,i,s){const o=n.getImage(),a=o&&o.getOpacity()!==0,l=n.getText(),c=l&&l.getText(),u=s&&a&&c?{}:void 0;if(a){if(o.getImageState()!=ye.LOADED)return;const d=t.getBuilder(n.getZIndex(),"Image");d.setImageStyle(o,u),d.drawMultiPoint(e,r,i)}if(c){const d=t.getBuilder(n.getZIndex(),"Text");d.setTextStyle(l,u),d.drawText(e,r,i)}}function J6(t,e,n,r,i){const s=n.getFill(),o=n.getStroke();if(s||o){const l=t.getBuilder(n.getZIndex(),"Polygon");l.setFillStrokeStyle(s,o),l.drawPolygon(e,r,i)}const a=n.getText();if(a&&a.getText()){const l=t.getBuilder(n.getZIndex(),"Text");l.setTextStyle(a),l.drawText(e,r,i)}}function Q6(t,e){const n=t.canvas;e=e||{};const r=e.pixelRatio||eO,i=e.size;i&&(n.width=i[0]*r,n.height=i[1]*r,n.style.width=i[0]+"px",n.style.height=i[1]+"px");const s=[0,0,n.width,n.height],o=kg(Bt(),r,r);return new $$(t,r,s,o,0)}const eB=new M6({featureClass:wn}),tB=[new nt({stroke:new yt({color:"blue",width:2})})];class nB{constructor(e){q(this,"urls");q(this,"emptyCanvas_",A$());q(this,"emptyCanvasPromise_",Promise.resolve(this.emptyCanvas_));q(this,"tilingScheme_",new Cesium.WebMercatorTilingScheme);q(this,"ready_",!0);q(this,"rectangle_");q(this,"tileRectangle_");q(this,"tileWidth",256);q(this,"tileHeight",256);q(this,"maximumLevel",20);q(this,"minimumLevel_",0);q(this,"featureCache");q(this,"tileCache");q(this,"tileFunction_");q(this,"styleFunction_");q(this,"projection_",Ne("EPSG:3857"));q(this,"errorEvent",new Cesium.Event);q(this,"credit");q(this,"proxy");this.urls=e.urls,this.rectangle_=e.rectangle||this.tilingScheme.rectangle,this.credit=e.credit,this.styleFunction_=e.styleFunction||(()=>tB),this.tileRectangle_=new Cesium.Rectangle;const n=e.cacheSize!==void 0?e.cacheSize:50;this.tileCache=new Vp(n),this.featureCache=e.featureCache||new Vp(n),this.minimumLevel_=e.minimumLevel||0;const r=dy(this.projection_);this.tileFunction_=b$(this.urls,r)}get minimumLevel(){return this.minimumLevel_}get ready(){return this.ready_}get rectangle(){return this.rectangle_}get tilingScheme(){return this.tilingScheme_}getTileCredits(e,n,r){return[]}get _ready(){return this.ready_}get tileDiscardPolicy(){}get hasAlphaChannel(){return!0}pickFeatures(e,n,r,i,s){}getTileFeatures(e,n,r){const i=this.getCacheKey_(e,n,r);let s;if(this.featureCache.containsKey(i)&&(s=this.featureCache.get(i)),!s){const o=this.getUrl_(e,n,r);if(s=fetch(o).then(a=>a.ok?a:Promise.reject(a)).then(a=>a.arrayBuffer()).then(a=>this.readFeaturesFromBuffer(a)),this.featureCache.set(i,s),this.featureCache.getCount()>2*this.featureCache.highWaterMark)for(;this.featureCache.canExpireCache();)this.featureCache.pop()}return s}readFeaturesFromBuffer(e){const n=eB.readFeatures(e),r=this.tileWidth/4096;return n.forEach(i=>{const s=i.getFlatCoordinates();for(let o=0;o<s.length;++o)s[o]*=r}),n}getUrl_(e,n,r){return this.tileFunction_([e,n,r],1,this.projection_)}getCacheKey_(e,n,r){return`${e}_${n}_${r}`}requestImage(e,n,r,i){if(r<this.minimumLevel_)return this.emptyCanvasPromise_;try{const s=this.getCacheKey_(r,e,n);let o;if(this.tileCache.containsKey(s)&&(o=this.tileCache.get(s)),!o&&(o=this.getTileFeatures(r,e,n).then(a=>{this.tilingScheme.tileXYToNativeRectangle(e,n,r,this.tileRectangle_);const l=(this.tileRectangle_.east-this.tileRectangle_.west)/this.tileWidth;return this.rasterizeFeatures(a,this.styleFunction_,l)}),this.tileCache.set(s,o),this.tileCache.getCount()>2*this.tileCache.highWaterMark))for(;this.tileCache.canExpireCache();)this.tileCache.pop();return o}catch(s){console.trace(s),this.errorEvent.raiseEvent("could not render pbf to tile",s)}}rasterizeFeatures(e,n,r){const i=document.createElement("canvas"),s=Q6(i.getContext("2d"),{size:[this.tileWidth,this.tileHeight]});return e.forEach(o=>{const a=n(o,r);a&&(Array.isArray(a)?a.forEach(l=>{s.setStyle(l),s.drawGeometry(o)}):(s.setStyle(a),s.drawGeometry(o)))}),i}}const be={BEGIN_GEOMETRY:0,BEGIN_PATH:1,CIRCLE:2,CLOSE_PATH:3,CUSTOM:4,DRAW_CHARS:5,DRAW_IMAGE:6,END_GEOMETRY:7,FILL:8,MOVE_TO_LINE_TO:9,SET_FILL_STYLE:10,SET_STROKE_STYLE:11,STROKE:12},jf=[be.FILL],Eo=[be.STROKE],Pa=[be.BEGIN_PATH],lP=[be.CLOSE_PATH];class Bh extends O${constructor(e,n,r,i){super(),this.tolerance=e,this.maxExtent=n,this.pixelRatio=i,this.maxLineWidth=0,this.resolution=r,this.beginGeometryInstruction1_=null,this.beginGeometryInstruction2_=null,this.bufferedMaxExtent_=null,this.instructions=[],this.coordinates=[],this.tmpCoordinate_=[],this.hitDetectionInstructions=[],this.state={}}applyPixelRatio(e){const n=this.pixelRatio;return n==1?e:e.map(function(r){return r*n})}appendFlatPointCoordinates(e,n){const r=this.getBufferedMaxExtent(),i=this.tmpCoordinate_,s=this.coordinates;let o=s.length;for(let a=0,l=e.length;a<l;a+=n)i[0]=e[a],i[1]=e[a+1],za(r,i)&&(s[o++]=i[0],s[o++]=i[1]);return o}appendFlatLineCoordinates(e,n,r,i,s,o){const a=this.coordinates;let l=a.length;const c=this.getBufferedMaxExtent();o&&(n+=i);let u=e[n],d=e[n+1];const h=this.tmpCoordinate_;let f=!0,p,m,_;for(p=n+i;p<r;p+=i)h[0]=e[p],h[1]=e[p+1],_=uw(c,h),_!==m?(f&&(a[l++]=u,a[l++]=d,f=!1),a[l++]=h[0],a[l++]=h[1]):_===ln.INTERSECTING?(a[l++]=h[0],a[l++]=h[1],f=!1):f=!0,u=h[0],d=h[1],m=_;return(s&&f||p===n+i)&&(a[l++]=u,a[l++]=d),l}drawCustomCoordinates_(e,n,r,i,s){for(let o=0,a=r.length;o<a;++o){const l=r[o],c=this.appendFlatLineCoordinates(e,n,l,i,!1,!1);s.push(c),n=l}return n}drawCustom(e,n,r,i,s){this.beginGeometry(e,n,s);const o=e.getType(),a=e.getStride(),l=this.coordinates.length;let c,u,d,h,f;switch(o){case"MultiPolygon":c=e.getOrientedFlatCoordinates(),h=[];const p=e.getEndss();f=0;for(let m=0,_=p.length;m<_;++m){const g=[];f=this.drawCustomCoordinates_(c,f,p[m],a,g),h.push(g)}this.instructions.push([be.CUSTOM,l,h,e,r,_w,s]),this.hitDetectionInstructions.push([be.CUSTOM,l,h,e,i||r,_w,s]);break;case"Polygon":case"MultiLineString":d=[],c=o=="Polygon"?e.getOrientedFlatCoordinates():e.getFlatCoordinates(),f=this.drawCustomCoordinates_(c,0,e.getEnds(),a,d),this.instructions.push([be.CUSTOM,l,d,e,r,ch,s]),this.hitDetectionInstructions.push([be.CUSTOM,l,d,e,i||r,ch,s]);break;case"LineString":case"Circle":c=e.getFlatCoordinates(),u=this.appendFlatLineCoordinates(c,0,c.length,a,!1,!1),this.instructions.push([be.CUSTOM,l,u,e,r,wo,s]),this.hitDetectionInstructions.push([be.CUSTOM,l,u,e,i||r,wo,s]);break;case"MultiPoint":c=e.getFlatCoordinates(),u=this.appendFlatPointCoordinates(c,a),u>l&&(this.instructions.push([be.CUSTOM,l,u,e,r,wo,s]),this.hitDetectionInstructions.push([be.CUSTOM,l,u,e,i||r,wo,s]));break;case"Point":c=e.getFlatCoordinates(),this.coordinates.push(c[0],c[1]),u=this.coordinates.length,this.instructions.push([be.CUSTOM,l,u,e,r,void 0,s]),this.hitDetectionInstructions.push([be.CUSTOM,l,u,e,i||r,void 0,s]);break}this.endGeometry(n)}beginGeometry(e,n,r){this.beginGeometryInstruction1_=[be.BEGIN_GEOMETRY,n,0,e,r],this.instructions.push(this.beginGeometryInstruction1_),this.beginGeometryInstruction2_=[be.BEGIN_GEOMETRY,n,0,e,r],this.hitDetectionInstructions.push(this.beginGeometryInstruction2_)}finish(){return{instructions:this.instructions,hitDetectionInstructions:this.hitDetectionInstructions,coordinates:this.coordinates}}reverseHitDetectionInstructions(){const e=this.hitDetectionInstructions;e.reverse();let n;const r=e.length;let i,s,o=-1;for(n=0;n<r;++n)i=e[n],s=i[0],s==be.END_GEOMETRY?o=n:s==be.BEGIN_GEOMETRY&&(i[2]=n,d4(this.hitDetectionInstructions,o,n),o=-1)}fillStyleToState(e,n={}){if(e){const r=e.getColor();n.fillPatternScale=r&&typeof r=="object"&&"src"in r?this.pixelRatio:1,n.fillStyle=Ni(r||Qn)}else n.fillStyle=void 0;return n}strokeStyleToState(e,n={}){if(e){const r=e.getColor();n.strokeStyle=Ni(r||ih);const i=e.getLineCap();n.lineCap=i!==void 0?i:kc;const s=e.getLineDash();n.lineDash=s?s.slice():Rs;const o=e.getLineDashOffset();n.lineDashOffset=o||Is;const a=e.getLineJoin();n.lineJoin=a!==void 0?a:Mc;const l=e.getWidth();n.lineWidth=l!==void 0?l:oh;const c=e.getMiterLimit();n.miterLimit=c!==void 0?c:rh,n.lineWidth>this.maxLineWidth&&(this.maxLineWidth=n.lineWidth,this.bufferedMaxExtent_=null)}else n.strokeStyle=void 0,n.lineCap=void 0,n.lineDash=null,n.lineDashOffset=void 0,n.lineJoin=void 0,n.lineWidth=void 0,n.miterLimit=void 0;return n}setFillStrokeStyle(e,n){const r=this.state;this.fillStyleToState(e,r),this.strokeStyleToState(n,r)}createFill(e){const n=e.fillStyle,r=[be.SET_FILL_STYLE,n];return typeof n!="string"&&r.push(e.fillPatternScale),r}applyStroke(e){this.instructions.push(this.createStroke(e))}createStroke(e){return[be.SET_STROKE_STYLE,e.strokeStyle,e.lineWidth*this.pixelRatio,e.lineCap,e.lineJoin,e.miterLimit,e.lineDash?this.applyPixelRatio(e.lineDash):null,e.lineDashOffset*this.pixelRatio]}updateFillStyle(e,n){const r=e.fillStyle;(typeof r!="string"||e.currentFillStyle!=r)&&(this.instructions.push(n.call(this,e)),e.currentFillStyle=r)}updateStrokeStyle(e,n){const r=e.strokeStyle,i=e.lineCap,s=e.lineDash,o=e.lineDashOffset,a=e.lineJoin,l=e.lineWidth,c=e.miterLimit;(e.currentStrokeStyle!=r||e.currentLineCap!=i||s!=e.currentLineDash&&!es(e.currentLineDash,s)||e.currentLineDashOffset!=o||e.currentLineJoin!=a||e.currentLineWidth!=l||e.currentMiterLimit!=c)&&(n.call(this,e),e.currentStrokeStyle=r,e.currentLineCap=i,e.currentLineDash=s,e.currentLineDashOffset=o,e.currentLineJoin=a,e.currentLineWidth=l,e.currentMiterLimit=c)}endGeometry(e){this.beginGeometryInstruction1_[2]=this.instructions.length,this.beginGeometryInstruction1_=null,this.beginGeometryInstruction2_[2]=this.hitDetectionInstructions.length,this.beginGeometryInstruction2_=null;const n=[be.END_GEOMETRY,e];this.instructions.push(n),this.hitDetectionInstructions.push(n)}getBufferedMaxExtent(){if(!this.bufferedMaxExtent_&&(this.bufferedMaxExtent_=mO(this.maxExtent),this.maxLineWidth>0)){const e=this.resolution*(this.maxLineWidth+1)/2;wr(this.bufferedMaxExtent_,e,this.bufferedMaxExtent_)}return this.bufferedMaxExtent_}}class rB extends Bh{constructor(e,n,r,i){super(e,n,r,i),this.hitDetectionImage_=null,this.image_=null,this.imagePixelRatio_=void 0,this.anchorX_=void 0,this.anchorY_=void 0,this.height_=void 0,this.opacity_=void 0,this.originX_=void 0,this.originY_=void 0,this.rotateWithView_=void 0,this.rotation_=void 0,this.scale_=void 0,this.width_=void 0,this.declutterMode_=void 0,this.declutterImageWithText_=void 0}drawPoint(e,n,r){if(!this.image_||this.maxExtent&&!za(this.maxExtent,e.getFlatCoordinates()))return;this.beginGeometry(e,n,r);const i=e.getFlatCoordinates(),s=e.getStride(),o=this.coordinates.length,a=this.appendFlatPointCoordinates(i,s);this.instructions.push([be.DRAW_IMAGE,o,a,this.image_,this.anchorX_*this.imagePixelRatio_,this.anchorY_*this.imagePixelRatio_,Math.ceil(this.height_*this.imagePixelRatio_),this.opacity_,this.originX_*this.imagePixelRatio_,this.originY_*this.imagePixelRatio_,this.rotateWithView_,this.rotation_,[this.scale_[0]*this.pixelRatio/this.imagePixelRatio_,this.scale_[1]*this.pixelRatio/this.imagePixelRatio_],Math.ceil(this.width_*this.imagePixelRatio_),this.declutterMode_,this.declutterImageWithText_]),this.hitDetectionInstructions.push([be.DRAW_IMAGE,o,a,this.hitDetectionImage_,this.anchorX_,this.anchorY_,this.height_,1,this.originX_,this.originY_,this.rotateWithView_,this.rotation_,this.scale_,this.width_,this.declutterMode_,this.declutterImageWithText_]),this.endGeometry(n)}drawMultiPoint(e,n,r){if(!this.image_)return;this.beginGeometry(e,n,r);const i=e.getFlatCoordinates(),s=[];for(let l=0,c=i.length;l<c;l+=e.getStride())(!this.maxExtent||za(this.maxExtent,i.slice(l,l+2)))&&s.push(i[l],i[l+1]);const o=this.coordinates.length,a=this.appendFlatPointCoordinates(s,2);this.instructions.push([be.DRAW_IMAGE,o,a,this.image_,this.anchorX_*this.imagePixelRatio_,this.anchorY_*this.imagePixelRatio_,Math.ceil(this.height_*this.imagePixelRatio_),this.opacity_,this.originX_*this.imagePixelRatio_,this.originY_*this.imagePixelRatio_,this.rotateWithView_,this.rotation_,[this.scale_[0]*this.pixelRatio/this.imagePixelRatio_,this.scale_[1]*this.pixelRatio/this.imagePixelRatio_],Math.ceil(this.width_*this.imagePixelRatio_),this.declutterMode_,this.declutterImageWithText_]),this.hitDetectionInstructions.push([be.DRAW_IMAGE,o,a,this.hitDetectionImage_,this.anchorX_,this.anchorY_,this.height_,1,this.originX_,this.originY_,this.rotateWithView_,this.rotation_,this.scale_,this.width_,this.declutterMode_,this.declutterImageWithText_]),this.endGeometry(n)}finish(){return this.reverseHitDetectionInstructions(),this.anchorX_=void 0,this.anchorY_=void 0,this.hitDetectionImage_=null,this.image_=null,this.imagePixelRatio_=void 0,this.height_=void 0,this.scale_=void 0,this.opacity_=void 0,this.originX_=void 0,this.originY_=void 0,this.rotateWithView_=void 0,this.rotation_=void 0,this.width_=void 0,super.finish()}setImageStyle(e,n){const r=e.getAnchor(),i=e.getSize(),s=e.getOrigin();this.imagePixelRatio_=e.getPixelRatio(this.pixelRatio),this.anchorX_=r[0],this.anchorY_=r[1],this.hitDetectionImage_=e.getHitDetectionImage(),this.image_=e.getImage(this.pixelRatio),this.height_=i[1],this.opacity_=e.getOpacity(),this.originX_=s[0],this.originY_=s[1],this.rotateWithView_=e.getRotateWithView(),this.rotation_=e.getRotation(),this.scale_=e.getScaleArray(),this.width_=i[0],this.declutterMode_=e.getDeclutterMode(),this.declutterImageWithText_=n}}class iB extends Bh{constructor(e,n,r,i){super(e,n,r,i)}drawFlatCoordinates_(e,n,r,i){const s=this.coordinates.length,o=this.appendFlatLineCoordinates(e,n,r,i,!1,!1),a=[be.MOVE_TO_LINE_TO,s,o];return this.instructions.push(a),this.hitDetectionInstructions.push(a),r}drawLineString(e,n,r){const i=this.state,s=i.strokeStyle,o=i.lineWidth;if(s===void 0||o===void 0)return;this.updateStrokeStyle(i,this.applyStroke),this.beginGeometry(e,n,r),this.hitDetectionInstructions.push([be.SET_STROKE_STYLE,i.strokeStyle,i.lineWidth,i.lineCap,i.lineJoin,i.miterLimit,Rs,Is],Pa);const a=e.getFlatCoordinates(),l=e.getStride();this.drawFlatCoordinates_(a,0,a.length,l),this.hitDetectionInstructions.push(Eo),this.endGeometry(n)}drawMultiLineString(e,n,r){const i=this.state,s=i.strokeStyle,o=i.lineWidth;if(s===void 0||o===void 0)return;this.updateStrokeStyle(i,this.applyStroke),this.beginGeometry(e,n,r),this.hitDetectionInstructions.push([be.SET_STROKE_STYLE,i.strokeStyle,i.lineWidth,i.lineCap,i.lineJoin,i.miterLimit,Rs,Is],Pa);const a=e.getEnds(),l=e.getFlatCoordinates(),c=e.getStride();let u=0;for(let d=0,h=a.length;d<h;++d)u=this.drawFlatCoordinates_(l,u,a[d],c);this.hitDetectionInstructions.push(Eo),this.endGeometry(n)}finish(){const e=this.state;return e.lastStroke!=null&&e.lastStroke!=this.coordinates.length&&this.instructions.push(Eo),this.reverseHitDetectionInstructions(),this.state=null,super.finish()}applyStroke(e){e.lastStroke!=null&&e.lastStroke!=this.coordinates.length&&(this.instructions.push(Eo),e.lastStroke=this.coordinates.length),e.lastStroke=0,super.applyStroke(e),this.instructions.push(Pa)}}class cP extends Bh{constructor(e,n,r,i){super(e,n,r,i)}drawFlatCoordinatess_(e,n,r,i){const s=this.state,o=s.fillStyle!==void 0,a=s.strokeStyle!==void 0,l=r.length;this.instructions.push(Pa),this.hitDetectionInstructions.push(Pa);for(let c=0;c<l;++c){const u=r[c],d=this.coordinates.length,h=this.appendFlatLineCoordinates(e,n,u,i,!0,!a),f=[be.MOVE_TO_LINE_TO,d,h];this.instructions.push(f),this.hitDetectionInstructions.push(f),a&&(this.instructions.push(lP),this.hitDetectionInstructions.push(lP)),n=u}return o&&(this.instructions.push(jf),this.hitDetectionInstructions.push(jf)),a&&(this.instructions.push(Eo),this.hitDetectionInstructions.push(Eo)),n}drawCircle(e,n,r){const i=this.state,s=i.fillStyle,o=i.strokeStyle;if(s===void 0&&o===void 0)return;this.setFillStrokeStyles_(),this.beginGeometry(e,n,r),i.fillStyle!==void 0&&this.hitDetectionInstructions.push([be.SET_FILL_STYLE,Qn]),i.strokeStyle!==void 0&&this.hitDetectionInstructions.push([be.SET_STROKE_STYLE,i.strokeStyle,i.lineWidth,i.lineCap,i.lineJoin,i.miterLimit,Rs,Is]);const a=e.getFlatCoordinates(),l=e.getStride(),c=this.coordinates.length;this.appendFlatLineCoordinates(a,0,a.length,l,!1,!1);const u=[be.CIRCLE,c];this.instructions.push(Pa,u),this.hitDetectionInstructions.push(Pa,u),i.fillStyle!==void 0&&(this.instructions.push(jf),this.hitDetectionInstructions.push(jf)),i.strokeStyle!==void 0&&(this.instructions.push(Eo),this.hitDetectionInstructions.push(Eo)),this.endGeometry(n)}drawPolygon(e,n,r){const i=this.state,s=i.fillStyle,o=i.strokeStyle;if(s===void 0&&o===void 0)return;this.setFillStrokeStyles_(),this.beginGeometry(e,n,r),i.fillStyle!==void 0&&this.hitDetectionInstructions.push([be.SET_FILL_STYLE,Qn]),i.strokeStyle!==void 0&&this.hitDetectionInstructions.push([be.SET_STROKE_STYLE,i.strokeStyle,i.lineWidth,i.lineCap,i.lineJoin,i.miterLimit,Rs,Is]);const a=e.getEnds(),l=e.getOrientedFlatCoordinates(),c=e.getStride();this.drawFlatCoordinatess_(l,0,a,c),this.endGeometry(n)}drawMultiPolygon(e,n,r){const i=this.state,s=i.fillStyle,o=i.strokeStyle;if(s===void 0&&o===void 0)return;this.setFillStrokeStyles_(),this.beginGeometry(e,n,r),i.fillStyle!==void 0&&this.hitDetectionInstructions.push([be.SET_FILL_STYLE,Qn]),i.strokeStyle!==void 0&&this.hitDetectionInstructions.push([be.SET_STROKE_STYLE,i.strokeStyle,i.lineWidth,i.lineCap,i.lineJoin,i.miterLimit,Rs,Is]);const a=e.getEndss(),l=e.getOrientedFlatCoordinates(),c=e.getStride();let u=0;for(let d=0,h=a.length;d<h;++d)u=this.drawFlatCoordinatess_(l,u,a[d],c);this.endGeometry(n)}finish(){this.reverseHitDetectionInstructions(),this.state=null;const e=this.tolerance;if(e!==0){const n=this.coordinates;for(let r=0,i=n.length;r<i;++r)n[r]=ha(n[r],e)}return super.finish()}setFillStrokeStyles_(){const e=this.state;this.updateFillStyle(e,this.createFill),this.updateStrokeStyle(e,this.applyStroke)}}function sB(t,e,n,r,i){const s=[];let o=n,a=0,l=e.slice(n,2);for(;a<t&&o+i<r;){const[c,u]=l.slice(-2),d=e[o+i],h=e[o+i+1],f=Math.sqrt((d-c)*(d-c)+(h-u)*(h-u));if(a+=f,a>=t){const p=(t-a+f)/f,m=fr(c,d,p),_=fr(u,h,p);l.push(m,_),s.push(l),l=[m,_],a==t&&(o+=i),a=0}else if(a<t)l.push(e[o+i],e[o+i+1]),o+=i;else{const p=f-a,m=fr(c,d,p/f),_=fr(u,h,p/f);l.push(m,_),s.push(l),l=[m,_],a=0,o+=i}}return a>0&&s.push(l),s}function oB(t,e,n,r,i){let s=n,o=n,a=0,l=0,c=n,u,d,h,f,p,m,_,g,y,v;for(d=n;d<r;d+=i){const w=e[d],x=e[d+1];p!==void 0&&(y=w-p,v=x-m,f=Math.sqrt(y*y+v*v),_!==void 0&&(l+=h,u=Math.acos((_*y+g*v)/(h*f)),u>t&&(l>a&&(a=l,s=c,o=d),l=0,c=d-i)),h=f,_=y,g=v),p=w,m=x}return l+=f,l>a?[c,d]:[s,o]}const Zp={left:0,center:.5,right:1,top:0,middle:.5,hanging:.2,alphabetic:.8,ideographic:.8,bottom:1};class aB extends Bh{constructor(e,n,r,i){super(e,n,r,i),this.labels_=null,this.text_="",this.textOffsetX_=0,this.textOffsetY_=0,this.textRotateWithView_=void 0,this.textKeepUpright_=void 0,this.textRotation_=0,this.textFillState_=null,this.fillStates={},this.fillStates[Qn]={fillStyle:Qn},this.textStrokeState_=null,this.strokeStates={},this.textState_={},this.textStates={},this.textKey_="",this.fillKey_="",this.strokeKey_="",this.declutterMode_=void 0,this.declutterImageWithText_=void 0}finish(){const e=super.finish();return e.textStates=this.textStates,e.fillStates=this.fillStates,e.strokeStates=this.strokeStates,e}drawText(e,n,r){const i=this.textFillState_,s=this.textStrokeState_,o=this.textState_;if(this.text_===""||!o||!i&&!s)return;const a=this.coordinates;let l=a.length;const c=e.getType();let u=null,d=e.getStride();if(o.placement==="line"&&(c=="LineString"||c=="MultiLineString"||c=="Polygon"||c=="MultiPolygon")){if(!Lt(this.maxExtent,e.getExtent()))return;let h;if(u=e.getFlatCoordinates(),c=="LineString")h=[u.length];else if(c=="MultiLineString")h=e.getEnds();else if(c=="Polygon")h=e.getEnds().slice(0,1);else if(c=="MultiPolygon"){const _=e.getEndss();h=[];for(let g=0,y=_.length;g<y;++g)h.push(_[g][0])}this.beginGeometry(e,n,r);const f=o.repeat,p=f?void 0:o.textAlign;let m=0;for(let _=0,g=h.length;_<g;++_){let y;f?y=sB(f*this.resolution,u,m,h[_],d):y=[u.slice(m,h[_])];for(let v=0,w=y.length;v<w;++v){const x=y[v];let S=0,C=x.length;if(p==null){const P=oB(o.maxAngle,x,0,x.length,2);S=P[0],C=P[1]}for(let P=S;P<C;P+=d)a.push(x[P],x[P+1]);const T=a.length;m=h[_],this.drawChars_(l,T),l=T}}this.endGeometry(n)}else{let h=o.overflow?null:[];switch(c){case"Point":case"MultiPoint":u=e.getFlatCoordinates();break;case"LineString":u=e.getFlatMidpoint();break;case"Circle":u=e.getCenter();break;case"MultiLineString":u=e.getFlatMidpoints(),d=2;break;case"Polygon":u=e.getFlatInteriorPoint(),o.overflow||h.push(u[2]/this.resolution),d=3;break;case"MultiPolygon":const w=e.getFlatInteriorPoints();u=[];for(let x=0,S=w.length;x<S;x+=3)o.overflow||h.push(w[x+2]/this.resolution),u.push(w[x],w[x+1]);if(u.length===0)return;d=2;break}const f=this.appendFlatPointCoordinates(u,d);if(f===l)return;if(h&&(f-l)/2!==u.length/d){let w=l/2;h=h.filter((x,S)=>{const C=a[(w+S)*2]===u[S*d]&&a[(w+S)*2+1]===u[S*d+1];return C||--w,C})}this.saveTextStates_();const p=o.backgroundFill?this.createFill(this.fillStyleToState(o.backgroundFill)):null,m=o.backgroundStroke?this.createStroke(this.strokeStyleToState(o.backgroundStroke)):null;this.beginGeometry(e,n,r);let _=o.padding;if(_!=ba&&(o.scale[0]<0||o.scale[1]<0)){let w=o.padding[0],x=o.padding[1],S=o.padding[2],C=o.padding[3];o.scale[0]<0&&(x=-x,C=-C),o.scale[1]<0&&(w=-w,S=-S),_=[w,x,S,C]}const g=this.pixelRatio;this.instructions.push([be.DRAW_IMAGE,l,f,null,NaN,NaN,NaN,1,0,0,this.textRotateWithView_,this.textRotation_,[1,1],NaN,this.declutterMode_,this.declutterImageWithText_,_==ba?ba:_.map(function(w){return w*g}),p,m,this.text_,this.textKey_,this.strokeKey_,this.fillKey_,this.textOffsetX_,this.textOffsetY_,h]);const y=1/g,v=p?p.slice(0):null;v&&(v[1]=Qn),this.hitDetectionInstructions.push([be.DRAW_IMAGE,l,f,null,NaN,NaN,NaN,1,0,0,this.textRotateWithView_,this.textRotation_,[y,y],NaN,this.declutterMode_,this.declutterImageWithText_,_,v,m,this.text_,this.textKey_,this.strokeKey_,this.fillKey_?Qn:this.fillKey_,this.textOffsetX_,this.textOffsetY_,h]),this.endGeometry(n)}}saveTextStates_(){const e=this.textStrokeState_,n=this.textState_,r=this.textFillState_,i=this.strokeKey_;e&&(i in this.strokeStates||(this.strokeStates[i]={strokeStyle:e.strokeStyle,lineCap:e.lineCap,lineDashOffset:e.lineDashOffset,lineWidth:e.lineWidth,lineJoin:e.lineJoin,miterLimit:e.miterLimit,lineDash:e.lineDash}));const s=this.textKey_;s in this.textStates||(this.textStates[s]={font:n.font,textAlign:n.textAlign||sh,justify:n.justify,textBaseline:n.textBaseline||Op,scale:n.scale});const o=this.fillKey_;r&&(o in this.fillStates||(this.fillStates[o]={fillStyle:r.fillStyle}))}drawChars_(e,n){const r=this.textStrokeState_,i=this.textState_,s=this.strokeKey_,o=this.textKey_,a=this.fillKey_;this.saveTextStates_();const l=this.pixelRatio,c=Zp[i.textBaseline],u=this.textOffsetY_*l,d=this.text_,h=r?r.lineWidth*Math.abs(i.scale[0])/2:0;this.instructions.push([be.DRAW_CHARS,e,n,c,i.overflow,a,i.maxAngle,l,u,s,h*l,d,o,1,this.declutterMode_,this.textKeepUpright_]),this.hitDetectionInstructions.push([be.DRAW_CHARS,e,n,c,i.overflow,a&&Qn,i.maxAngle,l,u,s,h*l,d,o,1/l,this.declutterMode_,this.textKeepUpright_])}setTextStyle(e,n){let r,i,s;if(!e)this.text_="";else{const o=e.getFill();o?(i=this.textFillState_,i||(i={},this.textFillState_=i),i.fillStyle=Ni(o.getColor()||Qn)):(i=null,this.textFillState_=i);const a=e.getStroke();if(!a)s=null,this.textStrokeState_=s;else{s=this.textStrokeState_,s||(s={},this.textStrokeState_=s);const m=a.getLineDash(),_=a.getLineDashOffset(),g=a.getWidth(),y=a.getMiterLimit();s.lineCap=a.getLineCap()||kc,s.lineDash=m?m.slice():Rs,s.lineDashOffset=_===void 0?Is:_,s.lineJoin=a.getLineJoin()||Mc,s.lineWidth=g===void 0?oh:g,s.miterLimit=y===void 0?rh:y,s.strokeStyle=Ni(a.getColor()||ih)}r=this.textState_;const l=e.getFont()||uO;E4(l);const c=e.getScaleArray();r.overflow=e.getOverflow(),r.font=l,r.maxAngle=e.getMaxAngle(),r.placement=e.getPlacement(),r.textAlign=e.getTextAlign(),r.repeat=e.getRepeat(),r.justify=e.getJustify(),r.textBaseline=e.getTextBaseline()||Op,r.backgroundFill=e.getBackgroundFill(),r.backgroundStroke=e.getBackgroundStroke(),r.padding=e.getPadding()||ba,r.scale=c===void 0?[1,1]:c;const u=e.getOffsetX(),d=e.getOffsetY(),h=e.getRotateWithView(),f=e.getKeepUpright(),p=e.getRotation();this.text_=e.getText()||"",this.textOffsetX_=u===void 0?0:u,this.textOffsetY_=d===void 0?0:d,this.textRotateWithView_=h===void 0?!1:h,this.textKeepUpright_=f===void 0?!0:f,this.textRotation_=p===void 0?0:p,this.strokeKey_=s?(typeof s.strokeStyle=="string"?s.strokeStyle:fe(s.strokeStyle))+s.lineCap+s.lineDashOffset+"|"+s.lineWidth+s.lineJoin+s.miterLimit+"["+s.lineDash.join()+"]":"",this.textKey_=r.font+r.scale+(r.textAlign||"?")+(r.repeat||"?")+(r.justify||"?")+(r.textBaseline||"?"),this.fillKey_=i&&i.fillStyle?typeof i.fillStyle=="string"?i.fillStyle:"|"+fe(i.fillStyle):""}this.declutterMode_=e.getDeclutterMode(),this.declutterImageWithText_=n}}const lB={Circle:cP,Default:Bh,Image:rB,LineString:iB,Polygon:cP,Text:aB};class D${constructor(e,n,r,i){this.tolerance_=e,this.maxExtent_=n,this.pixelRatio_=i,this.resolution_=r,this.buildersByZIndex_={}}finish(){const e={};for(const n in this.buildersByZIndex_){e[n]=e[n]||{};const r=this.buildersByZIndex_[n];for(const i in r){const s=r[i].finish();e[n][i]=s}}return e}getBuilder(e,n){const r=e!==void 0?e.toString():"0";let i=this.buildersByZIndex_[r];i===void 0&&(i={},this.buildersByZIndex_[r]=i);let s=i[n];if(s===void 0){const o=lB[n];s=new o(this.tolerance_,this.maxExtent_,this.resolution_,this.pixelRatio_),i[n]=s}return s}}function cB(t,e,n,r,i,s,o,a,l,c,u,d,h=!0){let f=t[e],p=t[e+1],m=0,_=0,g=0,y=0;function v(){m=f,_=p,e+=r,f=t[e],p=t[e+1],y+=g,g=Math.sqrt((f-m)*(f-m)+(p-_)*(p-_))}do v();while(e<n-r&&y+g<s);let w=g===0?0:(s-y)/g;const x=fr(m,f,w),S=fr(_,p,w),C=e-r,T=y,P=s+a*l(c,i,u);for(;e<n-r&&y+g<P;)v();w=g===0?0:(P-y)/g;const F=fr(m,f,w),k=fr(_,p,w);let A=!1;if(h)if(d){const H=[x,S,F,k];k1(H,0,4,2,d,H,H),A=H[0]>H[2]}else A=x>F;const M=Math.PI,b=[],j=C+r===e;e=C,g=0,y=T,f=t[e],p=t[e+1];let V;if(j){v(),V=Math.atan2(p-_,f-m),A&&(V+=V>0?-M:M);const H=(F+x)/2,U=(k+S)/2;return b[0]=[H,U,(P-s)/2,V,i],b}i=i.replace(/\n/g," ");for(let H=0,U=i.length;H<U;){v();let B=Math.atan2(p-_,f-m);if(A&&(B+=B>0?-M:M),V!==void 0){let L=B-V;if(L+=L>M?-2*M:L<-M?2*M:0,Math.abs(L)>o)return null}V=B;const N=H;let O=0;for(;H<U;++H){const L=A?U-H-1:H,W=a*l(c,i[L],u);if(e+r<n&&y+g<s+O+W/2)break;O+=W}if(H===N)continue;const $=A?i.substring(U-N,U-H):i.substring(N,H);w=g===0?0:(s+O/2-y)/g;const G=fr(m,f,w),R=fr(_,p,w);b.push([G,R,O/2,B,$]),s+=O}return b}const Pl=Mn(),no=[],cs=[],us=[],ro=[];function uP(t){return t[3].declutterBox}const dP=new RegExp("[-----]");function _0(t,e){return e==="start"?e=dP.test(t)?"right":"left":e==="end"&&(e=dP.test(t)?"left":"right"),Zp[e]}function uB(t,e,n){return n>0&&t.push(`
`,""),t.push(e,""),t}function dB(t,e,n){return n%2===0&&(t+=e),t}class hB{constructor(e,n,r,i,s){this.overlaps=r,this.pixelRatio=n,this.resolution=e,this.alignAndScaleFill_,this.instructions=i.instructions,this.coordinates=i.coordinates,this.coordinateCache_={},this.renderedTransform_=Bt(),this.hitDetectionInstructions=i.hitDetectionInstructions,this.pixelCoordinates_=null,this.viewRotation_=0,this.fillStates=i.fillStates||{},this.strokeStates=i.strokeStates||{},this.textStates=i.textStates||{},this.widths_={},this.labels_={},this.zIndexContext_=s?new oE:null}getZIndexContext(){return this.zIndexContext_}createLabel(e,n,r,i){const s=e+n+r+i;if(this.labels_[s])return this.labels_[s];const o=i?this.strokeStates[i]:null,a=r?this.fillStates[r]:null,l=this.textStates[n],c=this.pixelRatio,u=[l.scale[0]*c,l.scale[1]*c],d=l.justify?Zp[l.justify]:_0(Array.isArray(e)?e[0]:e,l.textAlign||sh),h=i&&o.lineWidth?o.lineWidth:0,f=Array.isArray(e)?e:String(e).split(`
`).reduce(uB,[]),{width:p,height:m,widths:_,heights:g,lineWidths:y}=b4(l,f),v=p+h,w=[],x=(v+2)*u[0],S=(m+h)*u[1],C={width:x<0?Math.floor(x):Math.ceil(x),height:S<0?Math.floor(S):Math.ceil(S),contextInstructions:w};(u[0]!=1||u[1]!=1)&&w.push("scale",u),i&&(w.push("strokeStyle",o.strokeStyle),w.push("lineWidth",h),w.push("lineCap",o.lineCap),w.push("lineJoin",o.lineJoin),w.push("miterLimit",o.miterLimit),w.push("setLineDash",[o.lineDash]),w.push("lineDashOffset",o.lineDashOffset)),r&&w.push("fillStyle",a.fillStyle),w.push("textBaseline","middle"),w.push("textAlign","center");const T=.5-d;let P=d*v+T*h;const F=[],k=[];let A=0,M=0,b=0,j=0,V;for(let H=0,U=f.length;H<U;H+=2){const B=f[H];if(B===`
`){M+=A,A=0,P=d*v+T*h,++j;continue}const N=f[H+1]||l.font;N!==V&&(i&&F.push("font",N),r&&k.push("font",N),V=N),A=Math.max(A,g[b]);const O=[B,P+T*_[b]+d*(_[b]-y[j]),.5*(h+A)+M];P+=_[b],i&&F.push("strokeText",O),r&&k.push("fillText",O),++b}return Array.prototype.push.apply(w,F),Array.prototype.push.apply(w,k),this.labels_[s]=C,C}replayTextBackground_(e,n,r,i,s,o,a){e.beginPath(),e.moveTo.apply(e,n),e.lineTo.apply(e,r),e.lineTo.apply(e,i),e.lineTo.apply(e,s),e.lineTo.apply(e,n),o&&(this.alignAndScaleFill_=o[2],e.fillStyle=o[1],this.fill_(e)),a&&(this.setStrokeStyle_(e,a),e.stroke())}calculateImageOrLabelDimensions_(e,n,r,i,s,o,a,l,c,u,d,h,f,p,m,_){a*=h[0],l*=h[1];let g=r-a,y=i-l;const v=s+c>e?e-c:s,w=o+u>n?n-u:o,x=p[3]+v*h[0]+p[1],S=p[0]+w*h[1]+p[2],C=g-p[3],T=y-p[0];(m||d!==0)&&(no[0]=C,ro[0]=C,no[1]=T,cs[1]=T,cs[0]=C+x,us[0]=cs[0],us[1]=T+S,ro[1]=us[1]);let P;return d!==0?(P=Xr(Bt(),r,i,1,1,d,-r,-i),$t(P,no),$t(P,cs),$t(P,us),$t(P,ro),Zi(Math.min(no[0],cs[0],us[0],ro[0]),Math.min(no[1],cs[1],us[1],ro[1]),Math.max(no[0],cs[0],us[0],ro[0]),Math.max(no[1],cs[1],us[1],ro[1]),Pl)):Zi(Math.min(C,C+x),Math.min(T,T+S),Math.max(C,C+x),Math.max(T,T+S),Pl),f&&(g=Math.round(g),y=Math.round(y)),{drawImageX:g,drawImageY:y,drawImageW:v,drawImageH:w,originX:c,originY:u,declutterBox:{minX:Pl[0],minY:Pl[1],maxX:Pl[2],maxY:Pl[3],value:_},canvasTransform:P,scale:h}}replayImageOrLabel_(e,n,r,i,s,o,a){const l=!!(o||a),c=i.declutterBox,u=a?a[2]*i.scale[0]/2:0;return c.minX-u<=n[0]&&c.maxX+u>=0&&c.minY-u<=n[1]&&c.maxY+u>=0&&(l&&this.replayTextBackground_(e,no,cs,us,ro,o,a),C4(e,i.canvasTransform,s,r,i.originX,i.originY,i.drawImageW,i.drawImageH,i.drawImageX,i.drawImageY,i.scale)),!0}fill_(e){const n=this.alignAndScaleFill_;if(n){const r=$t(this.renderedTransform_,[0,0]),i=512*this.pixelRatio;e.save(),e.translate(r[0]%i,r[1]%i),n!==1&&e.scale(n,n),e.rotate(this.viewRotation_)}e.fill(),n&&e.restore()}setStrokeStyle_(e,n){e.strokeStyle=n[1],n[1]&&(e.lineWidth=n[2],e.lineCap=n[3],e.lineJoin=n[4],e.miterLimit=n[5],e.lineDashOffset=n[7],e.setLineDash(n[6]))}drawLabelWithPointPlacement_(e,n,r,i){const s=this.textStates[n],o=this.createLabel(e,n,i,r),a=this.strokeStates[r],l=this.pixelRatio,c=_0(Array.isArray(e)?e[0]:e,s.textAlign||sh),u=Zp[s.textBaseline||Op],d=a&&a.lineWidth?a.lineWidth:0,h=o.width/l-2*s.scale[0],f=c*h+2*(.5-c)*d,p=u*o.height/l+2*(.5-u)*d;return{label:o,anchorX:f,anchorY:p}}execute_(e,n,r,i,s,o,a,l){const c=this.zIndexContext_;let u;this.pixelCoordinates_&&es(r,this.renderedTransform_)?u=this.pixelCoordinates_:(this.pixelCoordinates_||(this.pixelCoordinates_=[]),u=Ki(this.coordinates,0,this.coordinates.length,2,r,this.pixelCoordinates_),LO(this.renderedTransform_,r));let d=0;const h=i.length;let f=0,p,m,_,g,y,v,w,x,S,C,T,P,F,k=0,A=0;const M=this.coordinateCache_,b=this.viewRotation_,j=Math.round(Math.atan2(-r[1],r[0])*1e12)/1e12,V={context:e,pixelRatio:this.pixelRatio,resolution:this.resolution,rotation:b},H=this.instructions!=i||this.overlaps?0:200;let U,B,N,O;for(;d<h;){const $=i[d];switch($[0]){case be.BEGIN_GEOMETRY:U=$[1],O=$[3],U.getGeometry()?a!==void 0&&!Lt(a,O.getExtent())?d=$[2]+1:++d:d=$[2],c&&(c.zIndex=$[4]);break;case be.BEGIN_PATH:k>H&&(this.fill_(e),k=0),A>H&&(e.stroke(),A=0),!k&&!A&&(e.beginPath(),y=NaN,v=NaN),++d;break;case be.CIRCLE:f=$[1];const R=u[f],L=u[f+1],W=u[f+2],te=u[f+3],ee=W-R,ce=te-L,ge=Math.sqrt(ee*ee+ce*ce);e.moveTo(R+ge,L),e.arc(R,L,ge,0,2*Math.PI,!0),++d;break;case be.CLOSE_PATH:e.closePath(),++d;break;case be.CUSTOM:f=$[1],p=$[2];const Ce=$[3],_t=$[4],vt=$[5];V.geometry=Ce,V.feature=U,d in M||(M[d]=[]);const I=M[d];vt?vt(u,f,p,2,I):(I[0]=u[f],I[1]=u[f+1],I.length=2),c&&(c.zIndex=$[6]),_t(I,V),++d;break;case be.DRAW_IMAGE:f=$[1],p=$[2],S=$[3],m=$[4],_=$[5];let Q=$[6];const J=$[7],z=$[8],D=$[9],Y=$[10];let ne=$[11];const re=$[12];let X=$[13];g=$[14]||"declutter";const ie=$[15];if(!S&&$.length>=20){C=$[19],T=$[20],P=$[21],F=$[22];const Ir=this.drawLabelWithPointPlacement_(C,T,P,F);S=Ir.label,$[3]=S;const sa=$[23];m=(Ir.anchorX-sa)*this.pixelRatio,$[4]=m;const Ar=$[24];_=(Ir.anchorY-Ar)*this.pixelRatio,$[5]=_,Q=S.height,$[6]=Q,X=S.width,$[13]=X}let he;$.length>25&&(he=$[25]);let le,ve,Ge;$.length>17?(le=$[16],ve=$[17],Ge=$[18]):(le=ba,ve=null,Ge=null),Y&&j?ne+=b:!Y&&!j&&(ne-=b);let ke=0;for(;f<p;f+=2){if(he&&he[ke++]<X/this.pixelRatio)continue;const Ir=this.calculateImageOrLabelDimensions_(S.width,S.height,u[f],u[f+1],X,Q,m,_,z,D,ne,re,s,le,!!ve||!!Ge,U),sa=[e,n,S,Ir,J,ve,Ge];if(l){let Ar,Ri,Fr;if(ie){const Dt=p-f;if(!ie[Dt]){ie[Dt]={args:sa,declutterMode:g};continue}const Dn=ie[Dt];Ar=Dn.args,Ri=Dn.declutterMode,delete ie[Dt],Fr=uP(Ar)}let os,as;if(Ar&&(Ri!=="declutter"||!l.collides(Fr))&&(os=!0),(g!=="declutter"||!l.collides(Ir.declutterBox))&&(as=!0),Ri==="declutter"&&g==="declutter"){const Dt=os&&as;os=Dt,as=Dt}os&&(Ri!=="none"&&l.insert(Fr),this.replayImageOrLabel_.apply(this,Ar)),as&&(g!=="none"&&l.insert(Ir.declutterBox),this.replayImageOrLabel_.apply(this,sa))}else this.replayImageOrLabel_.apply(this,sa)}++d;break;case be.DRAW_CHARS:const sn=$[1],Pi=$[2],Yn=$[3],ta=$[4];F=$[5];const At=$[6],na=$[7],_l=$[8];P=$[9];const dr=$[10];C=$[11],Array.isArray(C)&&(C=C.reduce(dB,"")),T=$[12];const Ru=[$[13],$[13]];g=$[14]||"declutter";const p_=$[15],Iu=this.textStates[T],ra=Iu.font,qs=[Iu.scale[0]*na,Iu.scale[1]*na];let ti;ra in this.widths_?ti=this.widths_[ra]:(ti={},this.widths_[ra]=ti);const ia=fE(u,sn,Pi,2),Vb=Math.abs(qs[0])*uT(ra,C,ti);if(ta||Vb<=ia){const Ir=this.textStates[T].textAlign,sa=(ia-Vb)*_0(C,Ir),Ar=cB(u,sn,Pi,2,C,sa,At,Math.abs(qs[0]),uT,ra,ti,j?0:this.viewRotation_,p_);e:if(Ar){const Ri=[];let Fr,os,as,Dt,Dn;if(P)for(Fr=0,os=Ar.length;Fr<os;++Fr){Dn=Ar[Fr],as=Dn[4],Dt=this.createLabel(as,T,"",P),m=Dn[2]+(qs[0]<0?-dr:dr),_=Yn*Dt.height+(.5-Yn)*2*dr*qs[1]/qs[0]-_l;const ls=this.calculateImageOrLabelDimensions_(Dt.width,Dt.height,Dn[0],Dn[1],Dt.width,Dt.height,m,_,0,0,Dn[3],Ru,!1,ba,!1,U);if(l&&g==="declutter"&&l.collides(ls.declutterBox))break e;Ri.push([e,n,Dt,ls,1,null,null])}if(F)for(Fr=0,os=Ar.length;Fr<os;++Fr){Dn=Ar[Fr],as=Dn[4],Dt=this.createLabel(as,T,F,""),m=Dn[2],_=Yn*Dt.height-_l;const ls=this.calculateImageOrLabelDimensions_(Dt.width,Dt.height,Dn[0],Dn[1],Dt.width,Dt.height,m,_,0,0,Dn[3],Ru,!1,ba,!1,U);if(l&&g==="declutter"&&l.collides(ls.declutterBox))break e;Ri.push([e,n,Dt,ls,1,null,null])}l&&g!=="none"&&l.load(Ri.map(uP));for(let ls=0,VN=Ri.length;ls<VN;++ls)this.replayImageOrLabel_.apply(this,Ri[ls])}}++d;break;case be.END_GEOMETRY:if(o!==void 0){U=$[1];const Ir=o(U,O,g);if(Ir)return Ir}++d;break;case be.FILL:H?k++:this.fill_(e),++d;break;case be.MOVE_TO_LINE_TO:for(f=$[1],p=$[2],B=u[f],N=u[f+1],e.moveTo(B,N),y=B+.5|0,v=N+.5|0,f+=2;f<p;f+=2)B=u[f],N=u[f+1],w=B+.5|0,x=N+.5|0,(f==p-2||w!==y||x!==v)&&(e.lineTo(B,N),y=w,v=x);++d;break;case be.SET_FILL_STYLE:this.alignAndScaleFill_=$[2],k&&(this.fill_(e),k=0,A&&(e.stroke(),A=0)),e.fillStyle=$[1],++d;break;case be.SET_STROKE_STYLE:A&&(e.stroke(),A=0),this.setStrokeStyle_(e,$),++d;break;case be.STROKE:H?A++:e.stroke(),++d;break;default:++d;break}}k&&this.fill_(e),A&&e.stroke()}execute(e,n,r,i,s,o){this.viewRotation_=i,this.execute_(e,n,r,this.instructions,s,void 0,void 0,o)}executeHitDetection(e,n,r,i,s){return this.viewRotation_=r,this.execute_(e,[e.canvas.width,e.canvas.height],n,this.hitDetectionInstructions,!0,i,s)}}const pa=["Polygon","Circle","LineString","Image","Text","Default"],qp=["Image","Text"],fB=pa.filter(t=>!qp.includes(t));class N${constructor(e,n,r,i,s,o,a){this.maxExtent_=e,this.overlaps_=i,this.pixelRatio_=r,this.resolution_=n,this.renderBuffer_=o,this.executorsByZIndex_={},this.hitDetectionContext_=null,this.hitDetectionTransform_=Bt(),this.renderedContext_=null,this.deferredZIndexContexts_={},this.createExecutors_(s,a)}clip(e,n){const r=this.getClipCoords(n);e.beginPath(),e.moveTo(r[0],r[1]),e.lineTo(r[2],r[3]),e.lineTo(r[4],r[5]),e.lineTo(r[6],r[7]),e.clip()}createExecutors_(e,n){for(const r in e){let i=this.executorsByZIndex_[r];i===void 0&&(i={},this.executorsByZIndex_[r]=i);const s=e[r];for(const o in s){const a=s[o];i[o]=new hB(this.resolution_,this.pixelRatio_,this.overlaps_,a,n)}}}hasExecutors(e){for(const n in this.executorsByZIndex_){const r=this.executorsByZIndex_[n];for(let i=0,s=e.length;i<s;++i)if(e[i]in r)return!0}return!1}forEachFeatureAtCoordinate(e,n,r,i,s,o){i=Math.round(i);const a=i*2+1,l=Xr(this.hitDetectionTransform_,i+.5,i+.5,1/n,-1/n,-r,-e[0],-e[1]),c=!this.hitDetectionContext_;c&&(this.hitDetectionContext_=Vt(a,a));const u=this.hitDetectionContext_;u.canvas.width!==a||u.canvas.height!==a?(u.canvas.width=a,u.canvas.height=a):c||u.clearRect(0,0,a,a);let d;this.renderBuffer_!==void 0&&(d=Mn(),Ed(d,e),wr(d,n*(this.renderBuffer_+i),d));const h=gB(i);let f;function p(x,S,C){const T=u.getImageData(0,0,a,a).data;for(let P=0,F=h.length;P<F;P++)if(T[h[P]]>0){if(!o||C==="none"||f!=="Image"&&f!=="Text"||o.includes(x)){const k=(h[P]-3)/4,A=i-k%a,M=i-(k/a|0),b=s(x,S,A*A+M*M);if(b)return b}u.clearRect(0,0,a,a);break}}const m=Object.keys(this.executorsByZIndex_).map(Number);m.sort(Hi);let _,g,y,v,w;for(_=m.length-1;_>=0;--_){const x=m[_].toString();for(y=this.executorsByZIndex_[x],g=pa.length-1;g>=0;--g)if(f=pa[g],v=y[f],v!==void 0&&(w=v.executeHitDetection(u,l,r,p,d),w))return w}}getClipCoords(e){const n=this.maxExtent_;if(!n)return null;const r=n[0],i=n[1],s=n[2],o=n[3],a=[r,i,r,o,s,o,s,i];return Ki(a,0,8,2,e,a),a}isEmpty(){return Uo(this.executorsByZIndex_)}execute(e,n,r,i,s,o,a){const l=Object.keys(this.executorsByZIndex_).map(Number);l.sort(a?u4:Hi),o=o||pa;const c=pa.length;for(let u=0,d=l.length;u<d;++u){const h=l[u].toString(),f=this.executorsByZIndex_[h];for(let p=0,m=o.length;p<m;++p){const _=o[p],g=f[_];if(g!==void 0){const y=a===null?void 0:g.getZIndexContext(),v=y?y.getContext():e,w=this.maxExtent_&&_!=="Image"&&_!=="Text";if(w&&(v.save(),this.clip(v,r)),!y||_==="Text"||_==="Image"?g.execute(v,n,r,i,s,a):y.pushFunction(x=>g.execute(x,n,r,i,s,a)),w&&v.restore(),y){y.offset();const x=l[u]*c+pa.indexOf(_);this.deferredZIndexContexts_[x]||(this.deferredZIndexContexts_[x]=[]),this.deferredZIndexContexts_[x].push(y)}}}}this.renderedContext_=e}getDeferredZIndexContexts(){return this.deferredZIndexContexts_}getRenderedContext(){return this.renderedContext_}renderDeferred(){const e=this.deferredZIndexContexts_,n=Object.keys(e).map(Number).sort(Hi);for(let r=0,i=n.length;r<i;++r)e[n[r]].forEach(s=>{s.draw(this.renderedContext_),s.clear()}),e[n[r]].length=0}}const v0={};function gB(t){if(v0[t]!==void 0)return v0[t];const e=t*2+1,n=t*t,r=new Array(n+1);for(let s=0;s<=t;++s)for(let o=0;o<=t;++o){const a=s*s+o*o;if(a>n)break;let l=r[a];l||(l=[],r[a]=l),l.push(((t+s)*e+(t+o))*4+3),s>0&&l.push(((t-s)*e+(t+o))*4+3),o>0&&(l.push(((t+s)*e+(t-o))*4+3),s>0&&l.push(((t-s)*e+(t-o))*4+3))}const i=[];for(let s=0,o=r.length;s<o;++s)r[s]&&i.push(...r[s]);return v0[t]=i,i}const pr=.5;function j$(t,e,n,r,i,s,o,a,l){const c=l?ry(i):i,u=t[0]*pr,d=t[1]*pr,h=Vt(u,d);h.imageSmoothingEnabled=!1;const f=h.canvas,p=new $$(h,pr,i,null,o,a,l?ny(wz(),l):null),m=n.length,_=Math.floor((256*256*256-1)/m),g={};for(let v=1;v<=m;++v){const w=n[v-1],x=w.getStyleFunction()||r;if(!x)continue;let S=x(w,s);if(!S)continue;Array.isArray(S)||(S=[S]);const T=(v*_).toString(16).padStart(7,"#00000");for(let P=0,F=S.length;P<F;++P){const k=S[P],A=k.getGeometryFunction()(w);if(!A||!Lt(c,A.getExtent()))continue;const M=k.clone(),b=M.getFill();b&&b.setColor(T);const j=M.getStroke();j&&(j.setColor(T),j.setLineDash(null)),M.setText(void 0);const V=k.getImage();if(V){const N=V.getImageSize();if(!N)continue;const O=Vt(N[0],N[1],void 0,{alpha:!1}),$=O.canvas;O.fillStyle=T,O.fillRect(0,0,$.width,$.height),M.setImage(new Go({img:$,anchor:V.getAnchor(),anchorXUnits:"pixels",anchorYUnits:"pixels",offset:V.getOrigin(),opacity:1,size:V.getSize(),scale:V.getScale(),rotation:V.getRotation(),rotateWithView:V.getRotateWithView()}))}const H=M.getZIndex()||0;let U=g[H];U||(U={},g[H]=U,U.Polygon=[],U.Circle=[],U.LineString=[],U.Point=[]);const B=A.getType();if(B==="GeometryCollection"){const N=A.getGeometriesArrayRecursive();for(let O=0,$=N.length;O<$;++O){const G=N[O];U[G.getType().replace("Multi","")].push(G,M)}}else U[B.replace("Multi","")].push(A,M)}}const y=Object.keys(g).map(Number).sort(Hi);for(let v=0,w=y.length;v<w;++v){const x=g[y[v]];for(const S in x){const C=x[S];for(let T=0,P=C.length;T<P;T+=2){p.setStyle(C[T+1]);for(let F=0,k=e.length;F<k;++F)p.setTransform(e[F]),p.drawGeometry(C[T])}}}return h.getImageData(0,0,f.width,f.height)}function z$(t,e,n){const r=[];if(n){const i=Math.floor(Math.round(t[0])*pr),s=Math.floor(Math.round(t[1])*pr),o=(ct(i,0,n.width-1)+ct(s,0,n.height-1)*n.width)*4,a=n.data[o],l=n.data[o+1],u=n.data[o+2]+256*(l+256*a),d=Math.floor((256*256*256-1)/e.length);u&&u%d===0&&r.push(e[u/d-1])}return r}const pB={image:["Polygon","Circle","LineString","Image","Text"],hybrid:["Polygon","LineString"],vector:[]},hP={hybrid:["Image","Text","Default"],vector:["Polygon","Circle","LineString","Image","Text","Default"]};class mB extends _${constructor(e,n){super(e,n),this.boundHandleStyleImageChange_=this.handleStyleImageChange_.bind(this),this.renderedLayerRevision_,this.renderedPixelToCoordinateTransform_=null,this.renderedRotation_,this.renderedOpacity_=1,this.tmpTransform_=Bt(),this.tileClipContexts_=null}enqueueTilesForNextExtent(){return this.getLayer().getRenderMode()!=="vector"}drawTile(e,n,r,i,s,o,a,l){this.updateExecutorGroup_(e,n.pixelRatio,n.viewState.projection),this.tileImageNeedsRender_(e)&&this.renderTileImage_(e,n),super.drawTile(e,n,r,i,s,o,a,l)}getTile(e,n,r,i){const s=this.getOrCreateTile(e,n,r,i);if(!s)return null;const o=i.viewState,a=o.resolution,l=i.viewHints,c=this.getLayer().getSource(),u=c.getTileGridForProjection(o.projection),d=!(l[gt.ANIMATING]||l[gt.INTERACTING]),h=u.getZForResolution(a,c.zDirection)===e;return d&&h?s.wantedResolution=a:s.wantedResolution||(s.wantedResolution=u.getResolution(e)),s}prepareFrame(e){const n=this.getLayer().getRevision();return this.renderedLayerRevision_!==n&&(this.renderedLayerRevision_=n,this.renderedTiles.length=0),super.prepareFrame(e)}updateExecutorGroup_(e,n,r){const i=this.getLayer(),s=i.getRevision(),o=i.getRenderOrder()||null,a=e.wantedResolution,l=e.getReplayState(i);if(!l.dirty&&l.renderedResolution===a&&l.renderedRevision==s&&l.renderedRenderOrder==o)return;const c=i.getSource(),u=!!i.getDeclutter(),d=c.getTileGrid(),f=c.getTileGridForProjection(r).getTileCoordExtent(e.wrappedTileCoord),p=c.getSourceTiles(n,r,e),m=fe(i);delete e.hitDetectionImageData[m],e.executorGroups[m]=[],l.dirty=!1;for(let _=0,g=p.length;_<g;++_){const y=p[_];if(y.getState()!=ue.LOADED)continue;const v=c.getProjection(),w=y.tileCoord;let x=d.getTileCoordExtent(w);r&&v&&!Gn(r,v)&&(x=Sd(x,v,r,32));const S=_i(f,x),C=wr(S,i.getRenderBuffer()*a,this.tempExtent),T=Bo(x,S)?null:C,P=new D$(0,S,a,n),F=Fw(a,n),k=function(V,H){let U;const B=V.getStyleFunction()||i.getStyleFunction();if(B&&(U=B(V,a)),U){const N=this.renderFeature(V,F,U,P,u,H);l.dirty=l.dirty||N}},A=y.getFeatures();o&&o!==l.renderedRenderOrder&&A.sort(o);for(let V=0,H=A.length;V<H;++V){let U=A[V];r&&y.projection&&!Gn(r,y.projection)&&(U=U.clone(),U.getGeometry().applyTransform(qi(y.projection,r))),(!T||Lt(T,U.getGeometry().getExtent()))&&k.call(this,U,V)}const M=P.finish(),b=i.getRenderMode()!=="vector"&&u&&p.length===1?null:S,j=new N$(b,a,n,c.getOverlaps(),M,i.getRenderBuffer(),!0);e.executorGroups[m].push(j)}l.renderedRevision=s,l.renderedRenderOrder=o,l.renderedResolution=a}forEachFeatureAtCoordinate(e,n,r,i,s){var v,w;const o=n.viewState.resolution,a=n.viewState.rotation;r=r??0;const l=this.getLayer(),u=l.getSource().getTileGridForProjection(n.viewState.projection),d=_n([e]);wr(d,o*r,d);const h={},f=function(x,S,C){let T=x.getId();T===void 0&&(T=fe(x));const P=h[T];if(P){if(P!==!0&&C<P.distanceSq){if(C===0)return h[T]=!0,s.splice(s.lastIndexOf(P),1),i(x,l,S);P.geometry=S,P.distanceSq=C}}else{if(C===0)return h[T]=!0,i(x,l,S);s.push(h[T]={feature:x,layer:l,geometry:S,distanceSq:C,callback:i})}},p=this.renderedTiles,m=fe(l),_=l.getDeclutter(),g=_?(w=(v=n.declutter)==null?void 0:v[_])==null?void 0:w.all().map(x=>x.value):null;let y;e:for(let x=0,S=p.length;x<S;++x){const C=p[x],T=u.getTileCoordExtent(C.wrappedTileCoord);if(!Lt(T,d))continue;const P=C.executorGroups[m];for(let F=0,k=P.length;F<k;++F)if(y=P[F].forEachFeatureAtCoordinate(e,o,a,r,f,g),y)break e}return y}getFeatures(e){return this.renderedTiles.length===0?Promise.resolve([]):new Promise((n,r)=>{const i=this.getLayer(),s=i.getSource(),o=this.renderedProjection,a=o.getExtent(),l=this.renderedResolution,c=s.getTileGridForProjection(o),u=$t(this.renderedPixelToCoordinateTransform_,e.slice()),d=c.getTileCoordForCoordAndResolution(u,l).toString(),h=this.renderedTiles.find(v=>v.tileCoord.toString()===d&&v.getState()===ue.LOADED);if(!h||h.loadingSourceTiles>0){n([]);return}s.getWrapX()&&o.canWrapX()&&!ji(a,c.getTileCoordExtent(h.tileCoord))&&P1(u,o);const f=fe(i),p=c.getTileCoordExtent(h.wrappedTileCoord),m=qo(p),_=[(u[0]-m[0])/l,(m[1]-u[1])/l],g=h.getSourceTiles().reduce((v,w)=>v.concat(w.getFeatures()),[]);let y=h.hitDetectionImageData[f];if(!y){const v=dn(c.getTileSize(c.getZForResolution(l,s.zDirection))),w=this.renderedRotation_,x=[this.getRenderTransform(c.getTileCoordCenter(h.wrappedTileCoord),l,0,pr,v[0]*pr,v[1]*pr,0)];y=j$(v,x,g,i.getStyleFunction(),c.getTileCoordExtent(h.wrappedTileCoord),h.getReplayState(i).renderedResolution,w),h.hitDetectionImageData[f]=y}n(z$(_,g,y))})}getFeaturesInExtent(e){const n=[],r=this.getTileCache();if(r.getCount()===0)return n;const s=this.getLayer().getSource().getTileGridForProjection(this.frameState.viewState.projection),o=s.getZForResolution(this.renderedResolution),a={};return r.forEach(l=>{if(l.tileCoord[0]!==o||l.getState()!==ue.LOADED)return;const c=l.getSourceTiles();for(let u=0,d=c.length;u<d;++u){const h=c[u],f=h.getKey();if(f in a)continue;a[f]=!0;const p=h.tileCoord;if(Lt(e,s.getTileCoordExtent(p))){const m=h.getFeatures();if(m)for(let _=0,g=m.length;_<g;++_){const y=m[_],v=y.getGeometry();Lt(e,v.getExtent())&&n.push(y)}}}}),n}handleFontsChanged(){const e=this.getLayer();e.getVisible()&&this.renderedLayerRevision_!==void 0&&e.changed()}handleStyleImageChange_(e){this.renderIfReadyAndVisible()}renderDeclutter(e,n){var h;const r=this.context,i=r.globalAlpha;r.globalAlpha=n.opacity;const s=e.viewHints,o=!(s[gt.ANIMATING]||s[gt.INTERACTING]),a=[this.context.canvas.width,this.context.canvas.height],l=this.getLayer().getDeclutter(),c=l?(h=e.declutter)==null?void 0:h[l]:void 0,u=fe(this.getLayer()),d=this.renderedTiles;for(let f=0,p=d.length;f<p;++f){const m=d[f],_=m.executorGroups[u];if(_)for(let g=_.length-1;g>=0;--g)_[g].execute(this.context,a,this.getTileRenderTransform(m,e),e.viewState.rotation,o,qp,c)}r.globalAlpha=i}renderDeferredInternal(e){const n=this.renderedTiles,r=fe(this.getLayer()),i=n.reduce((l,c,u)=>(c.executorGroups[r].forEach(d=>l.push({executorGroup:d,index:u})),l),[]),s=i.map(({executorGroup:l})=>l.getDeferredZIndexContexts()),o={};for(let l=0,c=i.length;l<c;++l){const u=i[l].executorGroup.getDeferredZIndexContexts();for(const d in u)o[d]=!0}Object.keys(o).map(Number).sort(Hi).forEach(l=>{s.forEach((c,u)=>{c[l]&&(c[l].forEach(d=>{const{executorGroup:h,index:f}=i[u],p=h.getRenderedContext(),m=p.globalAlpha;p.globalAlpha=this.renderedOpacity_;const _=this.tileClipContexts_[f];_&&_.draw(p),d.draw(p),_&&p.restore(),p.globalAlpha=m,d.clear()}),c[l].length=0)})})}getTileRenderTransform(e,n){const r=n.pixelRatio,i=n.viewState,s=i.center,o=i.resolution,a=i.rotation,l=n.size,c=Math.round(l[0]*r),u=Math.round(l[1]*r),h=this.getLayer().getSource().getTileGridForProjection(n.viewState.projection),f=e.tileCoord,p=h.getTileCoordExtent(e.wrappedTileCoord),m=h.getTileCoordExtent(f,this.tempExtent)[0]-p[0];return iy(kg(this.inversePixelTransform.slice(),1/r,1/r),this.getRenderTransform(s,o,a,r,c,u,m))}postRender(e,n){var x;const r=n.viewHints,i=!(r[gt.ANIMATING]||r[gt.INTERACTING]);this.renderedPixelToCoordinateTransform_=n.pixelToCoordinateTransform.slice(),this.renderedRotation_=n.viewState.rotation,this.renderedOpacity_=n.layerStatesArray[n.layerIndex].opacity;const s=this.getLayer(),o=s.getRenderMode(),a=e.globalAlpha;e.globalAlpha=this.renderedOpacity_;const l=s.getDeclutter(),c=l?hP[o].filter(S=>!qp.includes(S)):hP[o],u=n.viewState,d=u.rotation,h=s.getSource(),p=h.getTileGridForProjection(u.projection).getZForResolution(u.resolution,h.zDirection),m=this.renderedTiles,_=[],g=[],y=[],v=fe(s);let w=!0;for(let S=m.length-1;S>=0;--S){const C=m[S];w=w&&!C.getReplayState(s).dirty;const T=C.executorGroups[v].filter(j=>j.hasExecutors(c));if(T.length===0)continue;const P=this.getTileRenderTransform(C,n),F=C.tileCoord[0];let k=!1;const A=T[0].getClipCoords(P);let M=e,b;if(A){b=new oE,M=b.getContext();for(let j=0,V=_.length;j<V;++j)if(p!==F&&F<g[j]){const H=_[j];Lt([A[0],A[3],A[4],A[7]],[H[0],H[3],H[4],H[7]])&&(k||(M.save(),k=!0),M.beginPath(),M.moveTo(A[0],A[1]),M.lineTo(A[2],A[3]),M.lineTo(A[4],A[5]),M.lineTo(A[6],A[7]),M.moveTo(H[6],H[7]),M.lineTo(H[4],H[5]),M.lineTo(H[2],H[3]),M.lineTo(H[0],H[1]),M.clip())}_.push(A),g.push(F)}for(let j=0,V=T.length;j<V;++j)T[j].execute(e,[e.canvas.width,e.canvas.height],P,d,i,c,(x=n.declutter)==null?void 0:x[l]);k&&(M===e?M.restore():y[S]=b)}e.globalAlpha=a,this.ready=w,this.tileClipContexts_=y,n.declutter||this.renderDeferredInternal(n),super.postRender(e,n)}renderFeature(e,n,r,i,s,o){if(!r)return!1;let a=!1;if(Array.isArray(r))for(let l=0,c=r.length;l<c;++l)a=Xp(i,e,r[l],n,this.boundHandleStyleImageChange_,void 0,s,o)||a;else a=Xp(i,e,r,n,this.boundHandleStyleImageChange_,void 0,s,o);return a}tileImageNeedsRender_(e){const n=this.getLayer();if(n.getRenderMode()==="vector")return!1;const r=e.getReplayState(n),i=n.getRevision(),s=e.wantedResolution;return r.renderedTileResolution!==s||r.renderedTileRevision!==i}renderTileImage_(e,n){const r=this.getLayer(),i=e.getReplayState(r),s=r.getRevision(),o=e.executorGroups[fe(r)];i.renderedTileRevision=s;const a=e.wrappedTileCoord,l=a[0],c=r.getSource();let u=n.pixelRatio;const h=n.viewState.projection,f=c.getTileGridForProjection(h),p=f.getResolution(e.tileCoord[0]),m=n.pixelRatio/e.wantedResolution*p,_=f.getResolution(l),g=e.getContext();u=Math.round(Math.max(u,m/u));const y=c.getTilePixelSize(l,u,h);g.canvas.width=y[0],g.canvas.height=y[1];const v=u/m;if(v!==1){const C=AT(this.tmpTransform_);kg(C,v,v),g.setTransform.apply(g,C)}const w=f.getTileCoordExtent(a,this.tempExtent),x=m/_,S=AT(this.tmpTransform_);kg(S,x,-x),kO(S,-w[0],-w[3]);for(let C=0,T=o.length;C<T;++C)o[C].execute(g,[g.canvas.width*v,g.canvas.height*v],S,0,!0,pB[r.getRenderMode()],null);i.renderedTileResolution=e.wantedResolution}}class mE extends cu{constructor(e){e=e||{};const n=Object.assign({},e);delete n.preload;const r=e.cacheSize===void 0?0:e.cacheSize;delete e.cacheSize,delete n.useInterimTilesOnError,super(n),this.on,this.once,this.un,this.cacheSize_=r;const i=e.renderMode||"hybrid";ze(i=="hybrid"||i=="vector","`renderMode` must be `'hybrid'` or `'vector'`"),this.renderMode_=i,this.setPreload(e.preload?e.preload:0),this.setUseInterimTilesOnError(e.useInterimTilesOnError!==void 0?e.useInterimTilesOnError:!0),this.getBackground,this.setBackground}createRenderer(){return new mB(this,{cacheSize:this.cacheSize_})}getFeatures(e){return super.getFeatures(e)}getFeaturesInExtent(e){return this.getRenderer().getFeaturesInExtent(e)}getRenderMode(){return this.renderMode_}getPreload(){return this.get(xo.PRELOAD)}getUseInterimTilesOnError(){return this.get(xo.USE_INTERIM_TILES_ON_ERROR)}setPreload(e){this.set(xo.PRELOAD,e)}setUseInterimTilesOnError(e){this.set(xo.USE_INTERIM_TILES_ON_ERROR,e)}}function yB(t,e){const n=t.camera.getPickRay(e);return t.globe.pick(n,t)||t.camera.pickEllipsoid(e)}function _B(t){const e=t.canvas,n=new Cesium.Cartesian2(e.clientWidth/2,e.clientHeight/2);return yB(t,n)}function U$(t,e){if(t&&e){const n=Sd(t,e,"EPSG:4326");return Cesium.Rectangle.fromDegrees(n[0],n[1],n[2],n[3])}else return null}function vB(t,e,n,r){const i=e.get("olcs_skip");if(i)return null;let s=null;if(e instanceof XG&&e.getUrl()){const o={olcs_proxy:e.get("olcs_proxy"),olcs_extent:e.get("olcs_extent"),olcs_projection:e.get("olcs_projection"),"olcs.imagesource":e},a=e.getImageLoadFunction(),l=e.get("olcs_tileLoadFunction")||function(u,d){a(u,d)};e=new i6({url:e.getUrl(),attributions:e.getAttributions(),projection:e.getProjection(),tileLoadFunction:l,params:e.getParams()}),e.setProperties(o)}if(e instanceof gy){let o=Mg(e);if(o||(o=n),pP(o))s=new m6(t,e,n);else return null}else if(e instanceof jG){let o=Mg(e);if(o||(o=n),pP(o)){const a=Cesium.Rectangle.fromDegrees(e.getImageExtent()[0],e.getImageExtent()[1],e.getImageExtent()[2],e.getImageExtent()[3],new Cesium.Rectangle);s=new Cesium.SingleTileImageryProvider({url:e.getUrl(),rectangle:a})}else return null}else if(e instanceof l6&&r instanceof mE){let o=Mg(e);if(o||(o=n),i===!1){const a=o.getCode().split(":")[1],l=e.urls.map(m=>m.replace(a,"3857")),c=r.getExtent(),u=U$(c,o),d=e.get("olcs_minimumLevel"),h=e.getAttributions(),f=r.getStyleFunction();let p;if(c&&h){const m=Er(c);p=G$(h,0,m,c)[0]}return s=new nB({credit:p,rectangle:u,minimumLevel:d,styleFunction:f,urls:l}),s}return null}else return null;return s}function wB(t,e,n){if(!(e instanceof jl)&&!(e instanceof v$)&&!(e instanceof mE))return null;const r=e.getSource();if(!r)return null;let i=r.get("olcs_provider");if(i||(i=vB(t,r,n,e)),!i)return null;const s={},a=e.get("olcs_extent")||e.getExtent();return a&&(s.rectangle=U$(a,n)),new Cesium.ImageryLayer(i,s)}function fP(t,e){let n=1,r=!0;[t.layer].concat(t.parents).forEach(i=>{const s=i.getOpacity();s!==void 0&&(n*=s);const o=i.getVisible();o!==void 0&&(r=r&&o)}),e.alpha=n,e.show=r}function rc(t){const e=t;return e.length>2?Cesium.Cartesian3.fromDegrees(e[0],e[1],e[2]):Cesium.Cartesian3.fromDegrees(e[0],e[1])}function w0(t){console.assert(t!==null);const e=rc,n=[];for(let r=0;r<t.length;++r)n.push(e(t[r]));return n}function zf(t,e){console.assert(e);const n=Ne("EPSG:4326"),r=Ne(e);if(r.getCode()!==n.getCode()){const i=t.getProperties();t=t.clone(),t.transform(r,n),t.setProperties(i)}return t}function gP(t){if(t=t||"black",Array.isArray(t))return new Cesium.Color(Cesium.Color.byteToFloat(t[0]),Cesium.Color.byteToFloat(t[1]),Cesium.Color.byteToFloat(t[2]),t[3]);if(typeof t=="string")return Cesium.Color.fromCssColorString(t);if(t instanceof CanvasPattern||t instanceof CanvasGradient){const e=document.createElement("canvas"),n=e.getContext("2d");return e.width=e.height=256,n.fillStyle=t,n.fillRect(0,0,e.width,e.height),new Cesium.ImageMaterialProperty({image:e})}console.assert(!1,"impossible")}function pP(t){const e=t.getCode()==="EPSG:3857",n=t.getCode()==="EPSG:4326";return e||n}function G$(t,e,n,r){if(!t)return[];let i=t({viewState:{zoom:e,center:n,projection:void 0,resolution:void 0,rotation:void 0},extent:r});return Array.isArray(i)||(i=[i]),i.map(s=>new Cesium.Credit(s,!0))}function xB(t,e,n,r){const i=n.canvas,o=n.camera.frustum.fovy;console.assert(!isNaN(o));const a=r.getMetersPerUnit(),l=t*i.clientHeight,c=Math.cos(Math.abs(e));return l*a*c/2/Math.tan(o/2)}function EB(t,e,n,r){const i=n.canvas,o=n.camera.frustum.fovy;console.assert(!isNaN(o));const a=r.getMetersPerUnit(),l=2*t*Math.tan(o/2),c=Math.cos(Math.abs(e));return l/a/c/i.clientHeight}class SB{constructor(e){q(this,"ol3d");q(this,"scene_");q(this,"canvas_");q(this,"_boundNotifyRepaintRequired");q(this,"repaintEventNames_",["mousemove","mousedown","mouseup","touchstart","touchend","touchmove","pointerdown","pointerup","pointermove","wheel"]);this.ol3d=e,this.scene_=e.getCesiumScene(),this.canvas_=this.scene_.canvas,this._boundNotifyRepaintRequired=this.notifyRepaintRequired.bind(this),this.enable()}enable(){this.scene_.requestRenderMode=!0,this.scene_.maximumRenderTimeChange=1e3;for(const e of this.repaintEventNames_)this.canvas_.addEventListener(e,this._boundNotifyRepaintRequired,!1);window.addEventListener("resize",this._boundNotifyRepaintRequired,!1),this.ol3d.getOlMap().getLayerGroup().on("change",this._boundNotifyRepaintRequired)}disable(){for(const e of this.repaintEventNames_)this.canvas_.removeEventListener(e,this._boundNotifyRepaintRequired,!1);window.removeEventListener("resize",this._boundNotifyRepaintRequired,!1),this.ol3d.getOlMap().getLayerGroup().un("change",this._boundNotifyRepaintRequired),this.scene_.requestRenderMode=!1}restartRenderLoop(){this.notifyRepaintRequired()}notifyRepaintRequired(){this.scene_.isDestroyed()||this.scene_.requestRender()}}function Uf(t){return t*180/Math.PI}function Yu(t){return t*Math.PI/180}function Gf(t,e,n){const r=n||t.length;if(e)for(let i=0;i<r;++i)e[i]=t[i];return t}class bB{constructor(e,n){q(this,"scene_");q(this,"cam_");q(this,"map_");q(this,"view_");q(this,"viewListenKey_",null);q(this,"toLonLat_",Gf);q(this,"fromLonLat_",Gf);q(this,"tilt_",0);q(this,"distance_",0);q(this,"lastCameraViewMatrix_",null);q(this,"viewUpdateInProgress_",!1);this.scene_=e,this.cam_=e.camera,this.map_=n,this.map_.on("change:view",r=>{this.setView_(this.map_.getView())}),this.setView_(this.map_.getView())}destroy(){ui(this.viewListenKey_),this.viewListenKey_=null}setView_(e){if(ui(this.viewListenKey_),this.viewListenKey_=null,this.view_=e,e){const n=qi(e.getProjection(),"EPSG:4326"),r=qi("EPSG:4326",e.getProjection());console.assert(n&&r),this.toLonLat_=n,this.fromLonLat_=r,this.viewListenKey_=e.on("propertychange",i=>this.handleViewChangedEvent_()),this.readFromView()}else this.toLonLat_=Gf,this.fromLonLat_=Gf}handleViewChangedEvent_(){this.viewUpdateInProgress_||this.readFromView()}setHeading(e){this.view_&&this.view_.setRotation(e)}getHeading(){return this.view_?this.view_.getRotation()||0:void 0}setTilt(e){this.tilt_=e,this.updateCamera_()}getTilt(){return this.tilt_}setDistance(e){this.distance_=e,this.updateCamera_(),this.updateView()}getDistance(){return this.distance_}setCenter(e){this.view_&&this.view_.setCenter(e)}getCenter(){if(this.view_)return this.view_.getCenter()}setPosition(e){if(!this.toLonLat_)return;const n=this.toLonLat_(e);console.assert(n);const r=new Cesium.Cartographic(Yu(n[0]),Yu(n[1]),this.getAltitude());this.cam_.setView({destination:Cesium.Ellipsoid.WGS84.cartographicToCartesian(r)}),this.updateView()}getPosition(){if(!this.fromLonLat_)return;const e=Cesium.Ellipsoid.WGS84.cartesianToCartographic(this.cam_.position),n=this.fromLonLat_([Uf(e.longitude),Uf(e.latitude)]);return console.assert(n),n}setAltitude(e){const n=Cesium.Ellipsoid.WGS84.cartesianToCartographic(this.cam_.position);n.height=e,this.cam_.position=Cesium.Ellipsoid.WGS84.cartographicToCartesian(n),this.updateView()}getAltitude(){return Cesium.Ellipsoid.WGS84.cartesianToCartographic(this.cam_.position).height}updateCamera_(){if(!this.view_||!this.toLonLat_)return;const e=this.view_.getCenter();if(!e)return;const n=this.toLonLat_(e);console.assert(n);const r=new Cesium.Cartographic(Yu(n[0]),Yu(n[1]));if(this.scene_.globe){const o=this.scene_.globe.getHeight(r);r.height=o||0}const i=Cesium.Ellipsoid.WGS84.cartographicToCartesian(r),s={pitch:this.tilt_-Cesium.Math.PI_OVER_TWO,heading:-this.view_.getRotation(),roll:void 0};this.cam_.setView({destination:i,orientation:s}),this.cam_.moveBackward(this.distance_),this.checkCameraChange(!0)}readFromView(){if(!this.view_||!this.toLonLat_)return;const e=this.view_.getCenter();if(e==null)return;const n=this.toLonLat_(e);console.assert(n);const r=this.view_.getResolution();this.distance_=this.calcDistanceForResolution(r||0,Yu(n[1])),this.updateCamera_()}updateView(){if(!this.view_||!this.fromLonLat_)return;this.viewUpdateInProgress_=!0;const e=Cesium.Ellipsoid.WGS84,n=this.scene_,r=_B(n);let i=r;if(!i){const o=n.globe,a=this.cam_.positionCartographic.clone(),l=o.getHeight(a);a.height=l||0,i=Cesium.Ellipsoid.WGS84.cartographicToCartesian(a)}this.distance_=Cesium.Cartesian3.distance(i,this.cam_.position);const s=e.cartesianToCartographic(i);if(this.view_.setCenter(this.fromLonLat_([Uf(s.longitude),Uf(s.latitude)])),this.view_.setResolution(this.calcResolutionForDistance(this.distance_,s?s.latitude:0)),r){const o=this.cam_.position,a=new Cesium.Cartesian3;e.geocentricSurfaceNormal(r,a);const l=new Cesium.Cartesian3;Cesium.Cartesian3.subtract(o,r,l),Cesium.Cartesian3.normalize(l,l);const c=this.cam_.up,u=this.cam_.right,d=new Cesium.Cartesian3(-r.y,r.x,0),h=Cesium.Cartesian3.angleBetween(u,d),p=Cesium.Cartesian3.cross(r,c,new Cesium.Cartesian3).z;this.view_.setRotation(p<0?h:-h);const m=Math.acos(Cesium.Cartesian3.dot(a,l));this.tilt_=isNaN(m)?0:m}else this.view_.setRotation(this.cam_.heading),this.tilt_=-this.cam_.pitch+Math.PI/2;setTimeout(()=>this.viewUpdateInProgress_=!1,1e3)}checkCameraChange(e){const n=this.lastCameraViewMatrix_,r=this.cam_.viewMatrix;(!n||!Cesium.Matrix4.equalsEpsilon(n,r,1e-7))&&(this.lastCameraViewMatrix_=r.clone(),e!==!0&&this.updateView())}calcDistanceForResolution(e,n){return xB(e,n,this.scene_,this.view_.getProjection())}calcResolutionForDistance(e,n){return EB(e,n,this.scene_,this.view_.getProjection())}}class B${constructor(e,n){q(this,"map");q(this,"view");q(this,"scene");q(this,"olLayers");q(this,"mapLayerGroup");q(this,"layerMap",{});q(this,"olLayerListenKeys",{});q(this,"olGroupListenKeys_",{});this.map=e,this.view=e.getView(),this.scene=n,this.olLayers=e.getLayerGroup().getLayers(),this.mapLayerGroup=e.getLayerGroup()}synchronize(){this.destroyAll(),this.addLayers_(this.mapLayerGroup)}orderLayers(){}addLayers_(e){const n=[{layer:e,parents:[]}];for(;n.length>0;){const r=n.splice(0,1)[0],i=r.layer,s=Qt(i).toString();this.olLayerListenKeys[s]=[],console.assert(!this.layerMap[s]);let o=null;if(i instanceof Ds)this.listenForGroupChanges_(i),i!==this.mapLayerGroup&&(o=this.createSingleLayerCounterparts(r)),o||i.getLayers().forEach(a=>{if(a){const l={layer:a,parents:i===this.mapLayerGroup?[]:[r.layer].concat(r.parents)};n.push(l)}});else if(o=this.createSingleLayerCounterparts(r),!o){const a=s,l=r,c=()=>{const u=this.createSingleLayerCounterparts(l);u&&(l.layer.un("change",c),this.addCesiumObjects_(u,a,l.layer),this.orderLayers())};this.olLayerListenKeys[s].push(l.layer.on("change",c))}o&&this.addCesiumObjects_(o,s,i)}this.orderLayers()}addCesiumObjects_(e,n,r){this.layerMap[n]=e,this.olLayerListenKeys[n].push(r.on("change:zIndex",()=>this.orderLayers())),e.forEach(i=>{this.addCesiumObject(i)})}removeAndDestroySingleLayer_(e){const n=Qt(e).toString(),r=this.layerMap[n];return r&&(r.forEach(i=>{this.removeSingleCesiumObject(i,!1),this.destroyCesiumObject(i)}),this.olLayerListenKeys[n].forEach(ui),delete this.olLayerListenKeys[n]),delete this.layerMap[n],!!r}unlistenSingleGroup_(e){if(e===this.mapLayerGroup)return;const n=Qt(e).toString();this.olGroupListenKeys_[n].forEach(i=>{ui(i)}),delete this.olGroupListenKeys_[n],delete this.layerMap[n]}removeLayer_(e){if(e){const n=[e];for(;n.length>0;){const r=n.splice(0,1)[0],i=this.removeAndDestroySingleLayer_(r);r instanceof Ds&&(this.unlistenSingleGroup_(r),i||r.getLayers().forEach(s=>{n.push(s)}))}}}listenForGroupChanges_(e){const n=Qt(e).toString();console.assert(this.olGroupListenKeys_[n]===void 0);const r=[];this.olGroupListenKeys_[n]=r;let i=[];const s=(function(){const o=e.getLayers();o&&(i=[o.on("add",a=>{this.addLayers_(a.element)}),o.on("remove",a=>{this.removeLayer_(a.element)})],r.push(...i))}).bind(this);s(),r.push(e.on("change:layers",o=>{i.forEach(a=>{const l=r.indexOf(a);l>=0&&r.splice(l,1),ui(a)}),s()}))}destroyAll(){this.removeAllCesiumObjects(!0);let e;for(e in this.olGroupListenKeys_)this.olGroupListenKeys_[e].forEach(ui);for(e in this.olLayerListenKeys)this.olLayerListenKeys[e].forEach(ui);this.olGroupListenKeys_={},this.olLayerListenKeys={},this.layerMap={}}}class CB extends B${constructor(n,r){super(n,r);q(this,"cesiumLayers_");q(this,"ourLayers_");this.cesiumLayers_=r.imageryLayers,this.ourLayers_=new Cesium.ImageryLayerCollection}addCesiumObject(n){this.cesiumLayers_.add(n),this.ourLayers_.add(n)}destroyCesiumObject(n){n.destroy()}removeSingleCesiumObject(n,r){this.cesiumLayers_.remove(n,r),this.ourLayers_.remove(n,!1)}removeAllCesiumObjects(n){for(let r=0;r<this.ourLayers_.length;++r)this.cesiumLayers_.remove(this.ourLayers_.get(r),n);this.ourLayers_.removeAll(!1)}convertLayerToCesiumImageries(n,r){const i=wB(this.map,n,r);return i?[i]:null}createSingleLayerCounterparts(n){const r=n.layer,i=Qt(r).toString(),s=this.view.getProjection();console.assert(s);const o=this.convertLayerToCesiumImageries(r,s);if(o){const a=[];if([n.layer].concat(n.parents).forEach(l=>{a.push(l.on(["change:opacity","change:visible"],()=>{console.assert(o);for(let c=0;c<o.length;++c)fP(n,o[c])}))}),r instanceof cu){let l=r.getStyleFunction();a.push(r.on("change",()=>{var u;const c=r.getStyleFunction();if(l!==c){l=c;for(let d=0;d<o.length;++d){const h=o[d];h._imageryCache&&(h._imageryCache={});const f=h.imageryProvider;f&&((u=f.tileCache)==null||u.clear(),f.styleFunction_=c)}this.scene.requestRender()}}))}for(let l=0;l<o.length;++l)fP(n,o[l]);a.push(r.on("change:extent",l=>{for(let c=0;c<o.length;++c)this.cesiumLayers_.remove(o[c],!0),this.ourLayers_.remove(o[c],!1);delete this.layerMap[Qt(r)],this.synchronize()})),a.push(r.on("change",l=>{for(let c=0;c<o.length;++c){const u=this.cesiumLayers_.indexOf(o[c]);u>=0&&(this.cesiumLayers_.remove(o[c],!1),this.cesiumLayers_.add(o[c],u))}})),this.olLayerListenKeys[i].push(...a)}return Array.isArray(o)?o:null}orderLayers(){const n=[],r={},i=[this.mapLayerGroup];for(;i.length>0;){const s=i.splice(0,1)[0];if(n.push(s),r[Qt(s)]=s.getZIndex()||0,s instanceof Ds){const o=s.getLayers();o&&i.unshift(...o.getArray())}}n.sort((s,o)=>r[Qt(s)]-r[Qt(o)]),n.forEach(s=>{const o=Qt(s).toString(),a=this.layerMap[o];a&&a.forEach(l=>{this.raiseToTop(l)})})}raiseToTop(n){this.cesiumLayers_.raiseToTop(n)}}class TB extends aE{constructor(e){super(e),this.boundHandleStyleImageChange_=this.handleStyleImageChange_.bind(this),this.animatingOrInteracting_,this.hitDetectionImageData_=null,this.clipped_=!1,this.renderedFeatures_=null,this.renderedRevision_=-1,this.renderedResolution_=NaN,this.renderedExtent_=Mn(),this.wrappedRenderedExtent_=Mn(),this.renderedRotation_,this.renderedCenter_=null,this.renderedProjection_=null,this.renderedPixelRatio_=1,this.renderedRenderOrder_=null,this.renderedFrameDeclutter_,this.replayGroup_=null,this.replayGroupChanged=!0,this.clipping=!0,this.targetContext_=null,this.opacity_=1}renderWorlds(e,n,r){const i=n.extent,s=n.viewState,o=s.center,a=s.resolution,l=s.projection,c=s.rotation,u=l.getExtent(),d=this.getLayer().getSource(),h=this.getLayer().getDeclutter(),f=n.pixelRatio,p=n.viewHints,m=!(p[gt.ANIMATING]||p[gt.INTERACTING]),_=this.context,g=Math.round(Me(i)/a*f),y=Math.round(Gt(i)/a*f),v=d.getWrapX()&&l.canWrapX(),w=v?Me(u):null,x=v?Math.ceil((i[2]-u[2])/w)+1:1;let S=v?Math.floor((i[0]-u[0])/w):0;do{let C=this.getRenderTransform(o,a,0,f,g,y,S*w);n.declutter&&(C=C.slice(0)),e.execute(_,[_.canvas.width,_.canvas.height],C,c,m,r===void 0?pa:r?qp:fB,r?h&&n.declutter[h]:void 0)}while(++S<x)}setDrawContext_(){this.opacity_!==1&&(this.targetContext_=this.context,this.context=Vt(this.context.canvas.width,this.context.canvas.height,JT))}resetDrawContext_(){if(this.opacity_!==1&&this.targetContext_){const e=this.targetContext_.globalAlpha;this.targetContext_.globalAlpha=this.opacity_,this.targetContext_.drawImage(this.context.canvas,0,0),this.targetContext_.globalAlpha=e,$h(this.context),JT.push(this.context.canvas),this.context=this.targetContext_,this.targetContext_=null}}renderDeclutter(e){!this.replayGroup_||!this.getLayer().getDeclutter()||this.renderWorlds(this.replayGroup_,e,!0)}renderDeferredInternal(e){this.replayGroup_&&(this.replayGroup_.renderDeferred(),this.clipped_&&this.context.restore(),this.resetDrawContext_())}renderFrame(e,n){const r=e.layerStatesArray[e.layerIndex];this.opacity_=r.opacity;const i=e.viewState;this.prepareContainer(e,n);const s=this.context,o=this.replayGroup_;let a=o&&!o.isEmpty();if(!a&&!(this.getLayer().hasListener(un.PRERENDER)||this.getLayer().hasListener(un.POSTRENDER)))return this.container;if(this.setDrawContext_(),this.preRender(s,e),i.projection,this.clipped_=!1,a&&r.extent&&this.clipping){const l=fi(r.extent);a=Lt(l,e.extent),this.clipped_=a&&!ji(l,e.extent),this.clipped_&&this.clipUnrotated(s,e,l)}return a&&this.renderWorlds(o,e,this.getLayer().getDeclutter()?!1:void 0),!e.declutter&&this.clipped_&&s.restore(),this.postRender(s,e),this.renderedRotation_!==i.rotation&&(this.renderedRotation_=i.rotation,this.hitDetectionImageData_=null),e.declutter||this.resetDrawContext_(),this.container}getFeatures(e){return new Promise(n=>{if(this.frameState&&!this.hitDetectionImageData_&&!this.animatingOrInteracting_){const r=this.frameState.size.slice(),i=this.renderedCenter_,s=this.renderedResolution_,o=this.renderedRotation_,a=this.renderedProjection_,l=this.wrappedRenderedExtent_,c=this.getLayer(),u=[],d=r[0]*pr,h=r[1]*pr;u.push(this.getRenderTransform(i,s,o,pr,d,h,0).slice());const f=c.getSource(),p=a.getExtent();if(f.getWrapX()&&a.canWrapX()&&!ji(p,l)){let m=l[0];const _=Me(p);let g=0,y;for(;m<p[0];)--g,y=_*g,u.push(this.getRenderTransform(i,s,o,pr,d,h,y).slice()),m+=_;for(g=0,m=l[2];m>p[2];)++g,y=_*g,u.push(this.getRenderTransform(i,s,o,pr,d,h,y).slice()),m-=_}this.hitDetectionImageData_=j$(r,u,this.renderedFeatures_,c.getStyleFunction(),l,s,o,Fw(s,this.renderedPixelRatio_),null)}n(z$(e,this.renderedFeatures_,this.hitDetectionImageData_))})}forEachFeatureAtCoordinate(e,n,r,i,s){var h,f;if(!this.replayGroup_)return;const o=n.viewState.resolution,a=n.viewState.rotation,l=this.getLayer(),c={},u=function(p,m,_){const g=fe(p),y=c[g];if(y){if(y!==!0&&_<y.distanceSq){if(_===0)return c[g]=!0,s.splice(s.lastIndexOf(y),1),i(p,l,m);y.geometry=m,y.distanceSq=_}}else{if(_===0)return c[g]=!0,i(p,l,m);s.push(c[g]={feature:p,layer:l,geometry:m,distanceSq:_,callback:i})}},d=this.getLayer().getDeclutter();return this.replayGroup_.forEachFeatureAtCoordinate(e,o,a,r,u,d?(f=(h=n.declutter)==null?void 0:h[d])==null?void 0:f.all().map(p=>p.value):null)}handleFontsChanged(){const e=this.getLayer();e.getVisible()&&this.replayGroup_&&e.changed()}handleStyleImageChange_(e){this.renderIfReadyAndVisible()}prepareFrame(e){const n=this.getLayer(),r=n.getSource();if(!r)return!1;const i=e.viewHints[gt.ANIMATING],s=e.viewHints[gt.INTERACTING],o=n.getUpdateWhileAnimating(),a=n.getUpdateWhileInteracting();if(this.ready&&!o&&i||!a&&s)return this.animatingOrInteracting_=!0,!0;this.animatingOrInteracting_=!1;const l=e.extent,c=e.viewState,u=c.projection,d=c.resolution,h=e.pixelRatio,f=n.getRevision(),p=n.getRenderBuffer();let m=n.getRenderOrder();m===void 0&&(m=B6);const _=c.center.slice(),g=wr(l,p*d),y=g.slice(),v=[g.slice()],w=u.getExtent();if(r.getWrapX()&&u.canWrapX()&&!ji(w,e.extent)){const b=Me(w),j=Math.max(Me(g)/2,b);g[0]=w[0]-j,g[2]=w[2]+j,P1(_,u);const V=wO(v[0],u);V[0]<w[0]&&V[2]<w[2]?v.push([V[0]+b,V[1],V[2]+b,V[3]]):V[0]>w[0]&&V[2]>w[2]&&v.push([V[0]-b,V[1],V[2]-b,V[3]])}if(this.ready&&this.renderedResolution_==d&&this.renderedRevision_==f&&this.renderedRenderOrder_==m&&this.renderedFrameDeclutter_===!!e.declutter&&ji(this.wrappedRenderedExtent_,g))return es(this.renderedExtent_,y)||(this.hitDetectionImageData_=null,this.renderedExtent_=y),this.renderedCenter_=_,this.replayGroupChanged=!1,!0;this.replayGroup_=null;const x=new D$(k$(d,h),g,d,h);let S;for(let b=0,j=v.length;b<j;++b)r.loadFeatures(v[b],d,u);const C=Fw(d,h);let T=!0;const P=(b,j)=>{let V;const H=b.getStyleFunction()||n.getStyleFunction();if(H&&(V=H(b,d)),V){const U=this.renderFeature(b,C,V,x,S,this.getLayer().getDeclutter(),j);T=T&&!U}},F=ry(g),k=r.getFeaturesInExtent(F);m&&k.sort(m);for(let b=0,j=k.length;b<j;++b)P(k[b],b);this.renderedFeatures_=k,this.ready=T;const A=x.finish(),M=new N$(g,d,h,r.getOverlaps(),A,n.getRenderBuffer(),!!e.declutter);return this.renderedResolution_=d,this.renderedRevision_=f,this.renderedRenderOrder_=m,this.renderedFrameDeclutter_=!!e.declutter,this.renderedExtent_=y,this.wrappedRenderedExtent_=g,this.renderedCenter_=_,this.renderedProjection_=u,this.renderedPixelRatio_=h,this.replayGroup_=M,this.hitDetectionImageData_=null,this.replayGroupChanged=!0,!0}renderFeature(e,n,r,i,s,o,a){if(!r)return!1;let l=!1;if(Array.isArray(r))for(let c=0,u=r.length;c<u;++c)l=Xp(i,e,r[c],n,this.boundHandleStyleImageChange_,s,o,a)||l;else l=Xp(i,e,r,n,this.boundHandleStyleImageChange_,s,o,a);return l}}class Pr extends cu{constructor(e){super(e)}createRenderer(){return new TB(this)}}class PB{constructor(e,n){q(this,"olListenKeys",[]);q(this,"context");q(this,"rootCollection_");const r=new Cesium.BillboardCollection({scene:n}),i=new Cesium.PrimitiveCollection;this.rootCollection_=new Cesium.PrimitiveCollection,this.context={projection:e,billboards:r,featureToCesiumMap:{},primitives:i},this.rootCollection_.add(r),this.rootCollection_.add(i)}destroy(){this.olListenKeys.forEach(ui),this.olListenKeys.length=0}getRootPrimitive(){return this.rootCollection_}}class RB{constructor(e){q(this,"scene");q(this,"boundOnRemoveOrClearFeatureListener_",this.onRemoveOrClearFeature_.bind(this));q(this,"defaultBillboardEyeOffset_",new Cesium.Cartesian3(0,0,10));this.scene=e,this.scene=e}onRemoveOrClearFeature_(e){const n=e.target;console.assert(n instanceof Cn);const r=n.olcs_cancellers;if(r){const i=e.feature;if(i){const s=Qt(i),o=r[s];o&&(o(),delete r[s])}else{for(const s in r)r.hasOwnProperty(s)&&r[s]();n.olcs_cancellers={}}}}setReferenceForPicking(e,n,r){r.olLayer=e,r.olFeature=n}createColoredPrimitive(e,n,r,i,s,o){const a=function(h,f){const p=new Cesium.GeometryInstance({geometry:h});return f&&!(f instanceof Cesium.ImageMaterialProperty)&&(p.attributes={color:Cesium.ColorGeometryInstanceAttribute.fromColor(f)}),p},l={flat:!0,renderState:{depthTest:{enabled:!0}}};o!==void 0&&(l.renderState.lineWidth=o);const c=a(i,s),u=this.getHeightReference(e,n,r);let d;if(u===Cesium.HeightReference.CLAMP_TO_GROUND){if(!("createShadowVolume"in c.geometry.constructor))return null;d=new Cesium.GroundPrimitive({geometryInstances:c})}else d=new Cesium.Primitive({geometryInstances:c});if(s instanceof Cesium.ImageMaterialProperty){const h=s.image.getValue().toDataURL();d.appearance=new Cesium.MaterialAppearance({flat:!0,renderState:{depthTest:{enabled:!0}},material:new Cesium.Material({fabric:{type:"Image",uniforms:{image:h}}})})}else d.appearance=new Cesium.MaterialAppearance({...l,material:new Cesium.Material({translucent:s.alpha!==1,fabric:{type:"Color",uniforms:{color:s}}})}),d instanceof Cesium.Primitive&&(n.get("olcs_shadows")||e.get("olcs_shadows"))&&(d.shadows=1);return this.setReferenceForPicking(e,n,d),d}extractColorFromOlStyle(e,n){var a;const r=(a=e.getFill())==null?void 0:a.getColor(),i=e.getStroke()?e.getStroke().getColor():null;let s="black";i&&n?s=i:r&&(s=r);const o=gP(s);return"red"in o?o:Cesium.Color.BLACK}extractLineWidthFromOlStyle(e){const n=e.getStroke()?e.getStroke().getWidth():void 0;return n!==void 0?n:1}wrapFillAndOutlineGeometries(e,n,r,i,s,o){const a=this.extractColorFromOlStyle(o,!1),l=this.extractColorFromOlStyle(o,!0),c=new Cesium.PrimitiveCollection;if(o.getFill()){const u=this.createColoredPrimitive(e,n,r,i,a);console.assert(!!u),c.add(u)}if(o.getStroke()&&s){const u=this.extractLineWidthFromOlStyle(o),d=this.createColoredPrimitive(e,n,r,s,l,u);d&&c.add(d)}return c}addTextStyle(e,n,r,i,s){let o;if(s instanceof Cesium.PrimitiveCollection?o=s:(o=new Cesium.PrimitiveCollection,o.add(s)),!i.getText())return o;const a=i.getText(),l=this.olGeometry4326TextPartToCesium(e,n,r,a);return l&&o.add(l),o}csAddBillboard(e,n,r,i,s,o){n.eyeOffset||(n.eyeOffset=this.defaultBillboardEyeOffset_);const a=e.add(n);return this.setReferenceForPicking(r,i,a),a}olCircleGeometryToCesium(e,n,r,i,s){r=zf(r,i),console.assert(r.getType()=="Circle");const o=r.getCenter(),a=o.length==3?o[2]:0,l=o.slice();l[0]+=r.getRadius();const c=rc(o),u=rc(l),d=Cesium.Cartesian3.distance(c,u),h=new Cesium.CircleGeometry({center:c,radius:d,height:a});let f,p;if(this.getHeightReference(e,n,r)===Cesium.HeightReference.CLAMP_TO_GROUND){const _=this.extractLineWidthFromOlStyle(s);if(_){const g=zz(r.getCenter(),d),y=w0(g.getLinearRing(0).getCoordinates()),v=f=new Cesium.GroundPolylinePrimitive({geometryInstances:new Cesium.GeometryInstance({geometry:new Cesium.GroundPolylineGeometry({positions:y,width:_})}),appearance:new Cesium.PolylineMaterialAppearance({material:this.olStyleToCesium(n,s,!0)}),classificationType:Cesium.ClassificationType.TERRAIN});u0(f).then(()=>{this.setReferenceForPicking(e,n,v._primitive)})}}else p=new Cesium.CircleOutlineGeometry({center:c,radius:d,extrudedHeight:a,height:a});const m=this.wrapFillAndOutlineGeometries(e,n,r,h,p,s);return f&&m.add(f),this.addTextStyle(e,n,r,s,m)}olLineStringGeometryToCesium(e,n,r,i,s){r=zf(r,i),console.assert(r.getType()=="LineString");const o=w0(r.getCoordinates()),a=this.extractLineWidthFromOlStyle(s);let l;const c=this.getHeightReference(e,n,r),u=new Cesium.PolylineMaterialAppearance({material:this.olStyleToCesium(n,s,!0)});if(c===Cesium.HeightReference.CLAMP_TO_GROUND){const d=new Cesium.GroundPolylineGeometry({positions:o,width:a}),h=l=new Cesium.GroundPolylinePrimitive({appearance:u,geometryInstances:new Cesium.GeometryInstance({geometry:d})});u0(l).then(()=>{this.setReferenceForPicking(e,n,h._primitive)})}else{const d=new Cesium.PolylineGeometry({positions:o,width:a,vertexFormat:u.vertexFormat});l=new Cesium.Primitive({appearance:u,geometryInstances:new Cesium.GeometryInstance({geometry:d})})}return this.setReferenceForPicking(e,n,l),this.addTextStyle(e,n,r,s,l)}olPolygonGeometryToCesium(e,n,r,i,s){r=zf(r,i),console.assert(r.getType()=="Polygon");const o=this.getHeightReference(e,n,r);let a,l,c;if(r.getCoordinates()[0].length==5&&n.get("olcs_polygon_kind")==="rectangle"){const d=r.getCoordinates()[0],h=_n(d),f=Cesium.Rectangle.fromDegrees(h[0],h[1],h[2],h[3]);let p=0;if(d[0].length==3)for(let _=0;_<d.length;_++)p=Math.max(p,d[_][2]);const m=n.get("olcs_extruded_height");a=new Cesium.RectangleGeometry({ellipsoid:Cesium.Ellipsoid.WGS84,rectangle:f,height:p,extrudedHeight:m}),l=new Cesium.RectangleOutlineGeometry({ellipsoid:Cesium.Ellipsoid.WGS84,rectangle:f,height:p,extrudedHeight:m})}else{const d=r.getLinearRings(),h={positions:[],holes:[]},f=h;console.assert(d.length>0);for(let m=0;m<d.length;++m){const _=d[m].getCoordinates(),g=w0(_);console.assert(g&&g.length>0),m===0?h.positions=g:h.holes.push({positions:g,holes:[]})}const p=n.get("olcs_extruded_height");if(a=new Cesium.PolygonGeometry({polygonHierarchy:f,perPositionHeight:!0,extrudedHeight:p}),o===Cesium.HeightReference.CLAMP_TO_GROUND){const m=this.extractLineWidthFromOlStyle(s);if(m>0){const _=[h.positions];if(h.holes)for(let v=0;v<h.holes.length;++v)_.push(h.holes[v].positions);const g=new Cesium.PolylineMaterialAppearance({material:this.olStyleToCesium(n,s,!0)}),y=[];for(const v of _){const w=new Cesium.GroundPolylineGeometry({positions:v,width:m});y.push(new Cesium.GeometryInstance({geometry:w}))}c=new Cesium.GroundPolylinePrimitive({appearance:g,geometryInstances:y}),u0(c).then(()=>{this.setReferenceForPicking(e,n,c._primitive)})}}else l=new Cesium.PolygonOutlineGeometry({polygonHierarchy:h,perPositionHeight:!0,extrudedHeight:p})}const u=this.wrapFillAndOutlineGeometries(e,n,r,a,l,s);return c&&u.add(c),this.addTextStyle(e,n,r,s,u)}getHeightReference(e,n,r){let i=r.get("altitudeMode");i===void 0&&(i=n.get("altitudeMode")),i===void 0&&(i=e.get("altitudeMode"));let s=Cesium.HeightReference.NONE;return i==="clampToGround"?s=Cesium.HeightReference.CLAMP_TO_GROUND:i==="relativeToGround"&&(s=Cesium.HeightReference.RELATIVE_TO_GROUND),s}createBillboardFromImage(e,n,r,i,s,o,a,l){o instanceof Go&&o.load();const c=o.getImage(1),u=function(h){return h.src!=""&&h.naturalHeight!=0&&h.naturalWidth!=0&&h.complete},d=(function(){if(!c||!(c instanceof HTMLCanvasElement||c instanceof Image||c instanceof HTMLImageElement))return;const h=r.getCoordinates(),f=rc(h);let p;const m=o.getOpacity();m!==void 0&&(p=new Cesium.Color(1,1,1,m));const _=o.getScale(),g=this.getHeightReference(e,n,r),y={image:c,color:p,scale:Array.isArray(_)?(_[0]+_[1])/2:_,heightReference:g,position:f};if(Object.assign(y,n.get("cesiumOptions")),o instanceof Go){const w=o.getAnchor();if(w){const x=Array.isArray(_)?_[0]:_,S=Array.isArray(_)?_[1]:_;y.pixelOffset=new Cesium.Cartesian2((c.width/2-w[0])*x,(c.height/2-w[1])*S)}}const v=this.csAddBillboard(a,y,e,n,r,s);l&&l(v)}).bind(this);if(c instanceof Image&&!u(c)){let h=!1;const f=e.getSource(),p=function(){h=!0};f.on(["removefeature","clear"],this.boundOnRemoveOrClearFeatureListener_);let m=f.olcs_cancellers;m||(m=f.olcs_cancellers={});const _=Qt(n);m[_]&&m[_](),m[_]=p;const g=function(){c.removeEventListener("load",g),!a.isDestroyed()&&!h&&d()};c.addEventListener("load",g)}else d()}olPointGeometryToCesium(e,n,r,i,s,o,a){console.assert(r.getType()=="Point"),r=zf(r,i);let l=null;const c=s.getImage();if(c){const u=r.get("olcs_model")||n.get("olcs_model");if(u){l=new Cesium.PrimitiveCollection;const d=u(),h=Object.assign({},{scene:this.scene},d.cesiumOptions);if("fromGltf"in Cesium.Model){const f=Cesium.Model.fromGltf(h);l.add(f)}else Cesium.Model.fromGltfAsync(h).then(f=>{l.add(f)});d.debugModelMatrix&&l.add(new Cesium.DebugModelMatrixPrimitive({modelMatrix:d.debugModelMatrix}))}else this.createBillboardFromImage(e,n,r,i,s,c,o,a)}return s.getText()?this.addTextStyle(e,n,r,s,l||new Cesium.Primitive):l}olMultiGeometryToCesium(e,n,r,i,s,o,a){switch(r.getType()){case"MultiPoint":{const l=r.getPoints();if(s.getText()){const c=new Cesium.PrimitiveCollection;return l.forEach(u=>{console.assert(u);const d=this.olPointGeometryToCesium(e,n,u,i,s,o,a);d&&c.add(d)}),c}else return l.forEach(c=>{console.assert(c),this.olPointGeometryToCesium(e,n,c,i,s,o,a)}),null}case"MultiLineString":{const l=r.getLineStrings(),c=new Cesium.PrimitiveCollection;return l.forEach(u=>{const d=this.olLineStringGeometryToCesium(e,n,u,i,s);c.add(d)}),c}case"MultiPolygon":{const l=r.getPolygons(),c=new Cesium.PrimitiveCollection;return l.forEach(u=>{const d=this.olPolygonGeometryToCesium(e,n,u,i,s);c.add(d)}),c}default:console.assert(!1,`Unhandled multi geometry type${r.getType()}`)}}olGeometry4326TextPartToCesium(e,n,r,i){const s=i.getText();if(!s)return null;const o=new Cesium.LabelCollection({scene:this.scene}),a=Er(r.getExtent());if(r instanceof Vs){const p=r.getFirstCoordinate();a[2]=p.length==3?p[2]:0}const l={position:rc(a)};l.text=Array.isArray(s)?s.join(" "):s,l.heightReference=this.getHeightReference(e,n,r);const c=i.getOffsetX(),u=i.getOffsetY();if(c!=0||u!=0){const p=new Cesium.Cartesian2(c,u);l.pixelOffset=p}l.font=i.getFont()||"10px sans-serif";let d;i.getFill()&&(l.fillColor=this.extractColorFromOlStyle(i,!1),d=Cesium.LabelStyle.FILL),i.getStroke()&&(l.outlineWidth=this.extractLineWidthFromOlStyle(i),l.outlineColor=this.extractColorFromOlStyle(i,!0),d=Cesium.LabelStyle.OUTLINE),i.getFill()&&i.getStroke()&&(d=Cesium.LabelStyle.FILL_AND_OUTLINE),l.style=d;let h;switch(i.getTextAlign()){case"left":h=Cesium.HorizontalOrigin.LEFT;break;case"right":h=Cesium.HorizontalOrigin.RIGHT;break;case"center":default:h=Cesium.HorizontalOrigin.CENTER}if(l.horizontalOrigin=h,i.getTextBaseline()){let p;switch(i.getTextBaseline()){case"top":p=Cesium.VerticalOrigin.TOP;break;case"middle":p=Cesium.VerticalOrigin.CENTER;break;case"bottom":p=Cesium.VerticalOrigin.BOTTOM;break;case"alphabetic":p=Cesium.VerticalOrigin.TOP;break;case"hanging":p=Cesium.VerticalOrigin.BOTTOM;break;default:console.assert(!1,`unhandled baseline ${i.getTextBaseline()}`)}l.verticalOrigin=p}const f=o.add(l);return this.setReferenceForPicking(e,n,f),o}olStyleToCesium(e,n,r){const i=n.getFill(),s=n.getStroke();if(r&&!s||!r&&!i)return null;const o=r?s.getColor():i.getColor(),a=gP(o),l=s.getLineDash();return r&&l?Cesium.Material.fromType("PolylineDash",{dashPattern:IB(l),color:a}):Cesium.Material.fromType("Color",{color:a})}computePlainStyle(e,n,r,i){const s=n.getStyleFunction();let o=null;return s&&(o=s(n,i)),!o&&r&&(o=r(n,i)),o?Array.isArray(o)?o:[o]:null}getGeometryFromFeature(e,n,r){if(r)return r;const i=e.get("olcs_3d_geometry");if(i&&i instanceof Dp)return i;if(n){const s=n.getGeometryFunction()(e);if(s instanceof Dp)return s}return e.getGeometry()}olFeatureToCesium(e,n,r,i,s){const o=this.getGeometryFromFeature(n,r,s);if(!o)return null;const a=i.projection,l=function(c){const u=i.featureToCesiumMap[Qt(n)];u instanceof Array?u.push(c):i.featureToCesiumMap[Qt(n)]=[c]};switch(o.getType()){case"GeometryCollection":const c=new Cesium.PrimitiveCollection;return o.getGeometriesArray().forEach(h=>{if(h){const f=this.olFeatureToCesium(e,n,r,i,h);f&&c.add(f)}}),c;case"Point":const u=i.billboards,d=this.olPointGeometryToCesium(e,n,o,a,r,u,l);return d||null;case"Circle":return this.olCircleGeometryToCesium(e,n,o,a,r);case"LineString":return this.olLineStringGeometryToCesium(e,n,o,a,r);case"Polygon":return this.olPolygonGeometryToCesium(e,n,o,a,r);case"MultiPoint":return this.olMultiGeometryToCesium(e,n,o,a,r,i.billboards,l)||null;case"MultiLineString":return this.olMultiGeometryToCesium(e,n,o,a,r,i.billboards,l)||null;case"MultiPolygon":return this.olMultiGeometryToCesium(e,n,o,a,r,i.billboards,l)||null;case"LinearRing":throw new Error("LinearRing should only be part of polygon.");default:throw new Error(`Ol geom type not handled : ${o.getType()}`)}}olVectorLayerToCesium(e,n,r){const i=n.getProjection(),s=n.getResolution();if(s===void 0||!i)throw console.assert(!1,"View not ready"),new Error("View not ready");let o=e.getSource();o instanceof P$&&(o=o.getSource()),console.assert(o instanceof Cn);const a=o.getFeatures(),l=new PB(i,this.scene),c=l.context;for(let u=0;u<a.length;++u){const d=a[u];if(!d)continue;const h=e.getStyleFunction(),f=this.computePlainStyle(e,d,h,s);if(!f||!f.length)continue;let p=null;for(let m=0;m<f.length;m++){const _=this.olFeatureToCesium(e,d,f[m],c);if(_){if(!p)p=_;else if(_){let g=0,y;for(;y=_.get(g);)p.add(y),g++}}}p&&(r[Qt(d)]=p,l.getRootPrimitive().add(p))}return l}convert(e,n,r,i){const s=n.getProjection(),o=n.getResolution();if(o==null||!s)return null;const a=e.getStyleFunction(),l=this.computePlainStyle(e,r,a,o);if(!l||!l.length)return null;i.projection=s;let c=null;for(let u=0;u<l.length;u++){const d=this.olFeatureToCesium(e,r,l[u],i);if(!c)c=d;else if(d){let h=0,f;for(;f=d.get(h);)c.add(f),h++}}return c}}function IB(t){t.length<2&&(t=[1,1]);const e=t.length%2===0?t:[...t,...t],r=e.reduce((s,o)=>s+o,0)/16;let i=e.map((s,o)=>{const a=o%2===0?"1":"0";let l=Math.round(s/r);return o===0&&l===0&&(l=1),a.repeat(l)}).join("");return i.length<16?i=i.padEnd(16,"0"):i.length>16&&(i=i.substring(0,16)),i[15]==="1"&&(i=i.substring(0,15)+"0"),console.assert(i.length===16),parseInt(i,2)}class AB extends B${constructor(n,r,i){super(n,r);q(this,"converter");q(this,"csAllPrimitives_");this.converter=i||new RB(r),this.csAllPrimitives_=new Cesium.PrimitiveCollection,r.primitives.add(this.csAllPrimitives_),this.csAllPrimitives_.destroyPrimitives=!1}addCesiumObject(n){console.assert(n);const r=n.getRootPrimitive();r.counterpart=n,this.csAllPrimitives_.add(n.getRootPrimitive())}destroyCesiumObject(n){n.getRootPrimitive().destroy()}removeSingleCesiumObject(n,r){n.destroy(),this.csAllPrimitives_.destroyPrimitives=r,this.csAllPrimitives_.remove(n.getRootPrimitive()),this.csAllPrimitives_.destroyPrimitives=!1}removeAllCesiumObjects(n){if(this.csAllPrimitives_.destroyPrimitives=n,n)for(let r=0;r<this.csAllPrimitives_.length;++r)this.csAllPrimitives_.get(r).counterpart.destroy();this.csAllPrimitives_.removeAll(),this.csAllPrimitives_.destroyPrimitives=!1}updateLayerVisibility(n,r){let i=!0;[n.layer].concat(n.parents).forEach(s=>{const o=s.getVisible();o!==void 0?i=i&&o:i=!1}),r.show=i}createSingleLayerCounterparts(n){const r=n.layer;if(!(r instanceof Pr)||r instanceof mE)return null;console.assert(r instanceof lu);let i=r.getSource();if(i instanceof P$&&(i=i.getSource()),!i)return null;console.assert(i instanceof Cn),console.assert(this.view);const s=this.view,o={},a=this.converter.olVectorLayerToCesium(r,s,o),l=a.getRootPrimitive(),c=a.olListenKeys;[n.layer].concat(n.parents).forEach(h=>{c.push(h.on("change:visible",()=>{this.updateLayerVisibility(n,l)}))}),this.updateLayerVisibility(n,l);const u=h=>{const f=a.context,p=this.converter.convert(r,s,h,f);p&&(o[Qt(h)]=p,l.add(p))},d=h=>{const f=Qt(h),p=a.context,m=p.featureToCesiumMap[f];m&&(delete p.featureToCesiumMap[f],m.forEach(g=>{g instanceof Cesium.Billboard&&p.billboards.remove(g)}));const _=o[f];delete o[f],_&&l.remove(_)};return c.push(i.on("addfeature",h=>{console.assert(h.feature),u(h.feature)})),c.push(i.on("removefeature",h=>{console.assert(h.feature),d(h.feature)})),c.push(i.on("changefeature",h=>{const f=h.feature;console.assert(f),d(f),u(f)})),a?[a]:null}}function FB(t){return t&&t.parentNode?t.parentNode.removeChild(t):null}function OB(t){for(;t.lastChild;)t.removeChild(t.lastChild)}function V$(t,e){const n=t.cloneNode();t.nodeName==="CANVAS"&&n.getContext("2d").drawImage(t,0,0),e&&e.appendChild(n),t.nodeType!==Node.TEXT_NODE&&n.addEventListener("click",i=>{t.dispatchEvent(new MouseEvent("click",i)),i.stopPropagation()});const r=t.childNodes;for(let i=0;i<r.length;i++)r[i]&&V$(r[i],n);return n}class $B extends mG{constructor(n){const r=n.parent;super(r.getOptions());q(this,"scenePostRenderListenerRemover_",null);q(this,"scene_");q(this,"synchronizer_");q(this,"parent_");q(this,"positionWGS84_");q(this,"observer_");q(this,"attributeObserver_",[]);q(this,"listenerKeys_");this.scene_=n.scene,this.synchronizer_=n.synchronizer,this.parent_=r,this.positionWGS84_=void 0,this.observer_=new MutationObserver(this.handleElementChanged.bind(this)),this.attributeObserver_=[],this.listenerKeys_=[];const i=s=>this.setPropertyFromEvent_(s);this.listenerKeys_.push(this.parent_.on("change:element",i)),this.listenerKeys_.push(this.parent_.on("change:offset",i)),this.listenerKeys_.push(this.parent_.on("change:position",i)),this.listenerKeys_.push(this.parent_.on("change:positioning",i)),this.setProperties(this.parent_.getProperties()),this.handleMapChanged(),this.handleElementChanged(),this.handlePositionChanged()}observeTarget_(n){if(this.observer_){this.observer_.disconnect(),this.observer_.observe(n,{attributes:!1,childList:!0,characterData:!0,subtree:!0}),this.attributeObserver_.forEach(r=>{r.disconnect()}),this.attributeObserver_.length=0;for(let r=0;r<n.childNodes.length;r++){const i=n.childNodes[r];if(i.nodeType===1){const s=new MutationObserver(this.handleElementChanged.bind(this));s.observe(i,{attributes:!0,subtree:!0}),this.attributeObserver_.push(s)}}}}setPropertyFromEvent_(n){n.target&&n.key&&this.set(n.key,n.target.get(n.key))}getScene(){return this.scene_}handleMapChanged(){this.scenePostRenderListenerRemover_&&(this.scenePostRenderListenerRemover_(),FB(this.element)),this.scenePostRenderListenerRemover_=null;const n=this.getScene();if(n){this.scenePostRenderListenerRemover_=n.postRender.addEventListener(this.updatePixelPosition.bind(this)),this.updatePixelPosition();const r=this.stopEvent?this.synchronizer_.getOverlayContainerStopEvent():this.synchronizer_.getOverlayContainer();this.insertFirst?r.insertBefore(this.element,r.childNodes[0]||null):r.appendChild(this.element)}}handlePositionChanged(){if(!this.parent_)return;const n=this.getPosition();if(n){const r=this.parent_.getMap().getView().getProjection();this.positionWGS84_=nl(n,r,"EPSG:4326")}else this.positionWGS84_=void 0;this.updatePixelPosition()}handleElementChanged(){OB(this.element);const n=this.getElement();if(n&&n.parentNode&&n.parentNode.childNodes)for(const r of Array.from(n.parentNode.childNodes)){const i=V$(r,null);this.element.appendChild(i)}n.parentNode&&this.observeTarget_(n.parentNode)}updatePixelPosition(){const n=this.positionWGS84_;if(!this.scene_||!n){this.setVisible(!1);return}let r=0;if(n.length===2){const h=this.scene_.globe.getHeight(Cesium.Cartographic.fromDegrees(n[0],n[1]));h&&this.scene_.globe.tilesLoaded&&(n[2]=h),h&&(r=h)}else r=n[2];const i=Cesium.Cartesian3.fromDegrees(n[0],n[1],r),s=this.scene_.camera,o=new Cesium.BoundingSphere(new Cesium.Cartesian3,6356752);if(!new Cesium.Occluder(o,s.position).isPointVisible(i)){this.setVisible(!1);return}if(s.frustum.computeCullingVolume(s.position,s.direction,s.up).computeVisibility(new Cesium.BoundingSphere(i))!==1){this.setVisible(!1);return}this.setVisible(!0);const c=this.scene_.cartesianToCanvasCoordinates(i),u=[c.x,c.y],d=[this.scene_.canvas.width,this.scene_.canvas.height];this.updateRenderedPosition(u,d)}destroy(){this.scenePostRenderListenerRemover_&&this.scenePostRenderListenerRemover_(),this.observer_&&this.observer_.disconnect(),ui(this.listenerKeys_),this.listenerKeys_.splice(0),"removeNode"in this.element?this.element.removeNode(!0):this.element.remove(),this.element=null}}class LB{constructor(e,n){q(this,"map");q(this,"scene");q(this,"overlayCollection_");q(this,"overlayContainerStopEvent_");q(this,"overlayContainer_");q(this,"overlayMap_",new Map);q(this,"overlayEvents",["click","dblclick","mousedown","touchstart","pointerdown","mousewheel","wheel"]);q(this,"listenerKeys_",[]);this.map=e,this.scene=n,this.map=e,this.overlayCollection_=this.map.getOverlays(),this.scene=n,this.overlayContainerStopEvent_=document.createElement("div"),this.overlayContainerStopEvent_.className="ol-overlaycontainer-stopevent",this.overlayEvents.forEach(r=>{this.overlayContainerStopEvent_.addEventListener(r,i=>i.stopPropagation())}),this.scene.canvas.parentElement.appendChild(this.overlayContainerStopEvent_),this.overlayContainer_=document.createElement("div"),this.overlayContainer_.className="ol-overlaycontainer",this.scene.canvas.parentElement.appendChild(this.overlayContainer_)}getOverlayContainerStopEvent(){return this.overlayContainerStopEvent_}getOverlayContainer(){return this.overlayContainer_}synchronize(){this.destroyAll(),this.overlayCollection_.forEach(e=>{this.addOverlay(e)}),this.listenerKeys_.push(this.overlayCollection_.on("add",e=>this.addOverlay(e.element))),this.listenerKeys_.push(this.overlayCollection_.on("remove",e=>this.removeOverlay(e.element)))}addOverlay(e){if(!e)return;const n=new $B({scene:this.scene,synchronizer:this,parent:e});this.overlayMap_.set(Qt(e),n)}removeOverlay(e){const n=Qt(e),r=this.overlayMap_.get(n);r&&(r.destroy(),this.overlayMap_.delete(n))}destroyAll(){this.overlayMap_.forEach(e=>{e.destroy()}),this.overlayMap_.clear(),ui(this.listenerKeys_),this.listenerKeys_.length=0}}const x0={DONE:0,PENDING:1,FAILED:2};class yE{constructor(e){q(this,"autoRenderLoop_",null);q(this,"map_");q(this,"time_");q(this,"to4326Transform_");q(this,"resolutionScale_",1);q(this,"canvasClientWidth_",0);q(this,"canvasClientHeight_",0);q(this,"resolutionScaleChanged_",!0);q(this,"container_");q(this,"isOverMap_");q(this,"canvas_");q(this,"enabled_",!1);q(this,"pausedInteractions_",[]);q(this,"hiddenRootGroup_",null);q(this,"scene_");q(this,"camera_");q(this,"globe_");q(this,"dataSourceCollection_");q(this,"dataSourceDisplay_");q(this,"lastFrameTime_",0);q(this,"renderId_");q(this,"targetFrameRate_",Number.POSITIVE_INFINITY);q(this,"blockCesiumRendering_",!1);q(this,"warmingUp_",!1);q(this,"trackedFeature_",null);q(this,"trackedEntity_",null);q(this,"entityView_",null);q(this,"needTrackedEntityUpdate_",!1);q(this,"boundingSphereScratch_",new Cesium.BoundingSphere);q(this,"synchronizers_");q(this,"refresh2DAfterCameraMoveEndOnly",!1);q(this,"moveEndRemoveCallback_");this.map_=e.map,this.time_=e.time||function(){return Cesium.JulianDate.now()},this.to4326Transform_=qi(this.map_.getView().getProjection(),"EPSG:4326");const n="position:absolute;top:0;left:0;width:100%;height:100%;touch-action:none;";this.container_=document.createElement("DIV");const r=document.createAttribute("style");r.value=`${n}visibility:hidden;`,this.container_.setAttributeNode(r);let i=e.target||this.map_.getViewport();if(typeof i=="string"&&(i=document.getElementById(i)),i.appendChild(this.container_),this.isOverMap_=!e.target,this.isOverMap_&&e.stopOpenLayersEventsPropagation){const u=["click","dblclick","mousedown","touchstart","pointerdown","mousewheel","wheel"];for(let d=0,h=u.length;d<h;++d)this.container_.addEventListener(u[d],f=>f.stopPropagation())}this.canvas_=document.createElement("canvas");const s=document.createAttribute("style");s.value=n,this.canvas_.setAttributeNode(s),bw()&&(this.canvas_.style.imageRendering=vG()),this.canvas_.oncontextmenu=function(){return!1},this.canvas_.onselectstart=function(){return!1},this.container_.appendChild(this.canvas_);const o=e.sceneOptions!==void 0?{...e.sceneOptions,canvas:this.canvas_,scene3DOnly:!0}:{canvas:this.canvas_,scene3DOnly:!0};this.scene_=new Cesium.Scene(o);const a=this.scene_.screenSpaceCameraController;Array.isArray(a.tiltEventTypes)?(a.tiltEventTypes.push({eventType:Cesium.CameraEventType.LEFT_DRAG,modifier:Cesium.KeyboardEventModifier.SHIFT}),a.tiltEventTypes.push({eventType:Cesium.CameraEventType.LEFT_DRAG,modifier:Cesium.KeyboardEventModifier.ALT})):console.log("sscc is not an array"),a.enableLook=!1,this.scene_.camera.constrainedAxis=Cesium.Cartesian3.UNIT_Z,this.camera_=new bB(this.scene_,this.map_),this.globe_=new Cesium.Globe(Cesium.Ellipsoid.WGS84),this.globe_.baseColor=Cesium.Color.WHITE,this.scene_.globe=this.globe_,this.scene_.skyAtmosphere=new Cesium.SkyAtmosphere;const l=new Cesium.SingleTileImageryProvider({tileHeight:1,tileWidth:1,url:"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAQAAAC1HAwCAAAAC0lEQVR42mNkYAAAAAYAAjCB0C8AAAAASUVORK5CYII=",rectangle:Cesium.Rectangle.fromDegrees(0,0,1,1)});this.globe_.imageryLayers.addImageryProvider(l,0),this.dataSourceCollection_=new Cesium.DataSourceCollection,this.dataSourceDisplay_=new Cesium.DataSourceDisplay({scene:this.scene_,dataSourceCollection:this.dataSourceCollection_}),this.synchronizers_=e.createSynchronizers?e.createSynchronizers(this.map_,this.scene_,this.dataSourceCollection_):[new CB(this.map_,this.scene_),new AB(this.map_,this.scene_),new LB(this.map_,this.scene_)],this.handleResize_();for(let u=this.synchronizers_.length-1;u>=0;--u)this.synchronizers_[u].synchronize();new Cesium.EventHelper().add(this.scene_.postRender,yE.prototype.updateTrackedEntity_,this),this.moveEndRemoveCallback_=this.scene_.camera.moveEnd.addEventListener(()=>{this.refresh2DAfterCameraMoveEndOnly&&this.camera_.checkCameraChange()})}destroy(){cancelAnimationFrame(this.renderId_),this.renderId_=void 0,this.synchronizers_.forEach(e=>e.destroyAll()),this.camera_.destroy(),this.scene_.destroy(),this.scene_._postRender=null,this.moveEndRemoveCallback_(),this.container_.remove()}render_(){this.renderId_!==void 0&&(cancelAnimationFrame(this.renderId_),this.renderId_=void 0),(this.enabled_||this.warmingUp_)&&!this.blockCesiumRendering_&&(this.renderId_=requestAnimationFrame(this.onAnimationFrame_.bind(this)))}onAnimationFrame_(e){this.renderId_=void 0;const n=1e3/this.targetFrameRate_;if(e-this.lastFrameTime_<n){this.render_();return}this.lastFrameTime_=e;const i=this.time_();if(this.scene_.initializeFrame(),this.handleResize_(),this.dataSourceDisplay_.update(i),this.entityView_){const s=this.trackedEntity_;this.dataSourceDisplay_.getBoundingSphere(s,!1,this.boundingSphereScratch_)===x0.DONE&&(this.boundingSphereScratch_.radius=1,this.entityView_.update(i,this.boundingSphereScratch_))}this.scene_.render(i),this.refresh2DAfterCameraMoveEndOnly||this.camera_.checkCameraChange(),this.render_()}updateTrackedEntity_(){if(!this.needTrackedEntityUpdate_)return;const e=this.trackedEntity_,n=this.scene_,r=this.dataSourceDisplay_.getBoundingSphere(e,!1,this.boundingSphereScratch_);if(r===x0.PENDING)return;n.screenSpaceCameraController.enableTilt=!1;const i=r!==x0.FAILED?this.boundingSphereScratch_:void 0;i&&(i.radius=1),this.entityView_=new Cesium.EntityView(e,n,n.mapProjection.ellipsoid),this.entityView_.update(this.time_(),i),this.needTrackedEntityUpdate_=!1}handleResize_(){let e=this.canvas_.clientWidth,n=this.canvas_.clientHeight;if(e===0||n===0||e===this.canvasClientWidth_&&n===this.canvasClientHeight_&&!this.resolutionScaleChanged_)return;let r=this.resolutionScale_;bw()||(r*=window.devicePixelRatio||1),this.resolutionScaleChanged_=!1,this.canvasClientWidth_=e,this.canvasClientHeight_=n,e*=r,n*=r,this.canvas_.width=e,this.canvas_.height=n,this.scene_.camera.frustum.aspectRatio=e/n}getCamera(){return this.camera_}getOlMap(){return this.map_}getOlView(){const e=this.map_.getView();return console.assert(e),e}getCesiumScene(){return this.scene_}getDataSources(){return this.dataSourceCollection_}getDataSourceDisplay(){return this.dataSourceDisplay_}getEnabled(){return this.enabled_}setEnabled(e){if(this.enabled_===e)return;this.enabled_=e,this.container_.style.visibility=this.enabled_?"visible":"hidden";let n;if(this.enabled_){if(this.throwOnUnitializedMap_(),this.isOverMap_){n=this.map_.getInteractions(),n.forEach((i,s,o)=>{this.pausedInteractions_.push(i)}),n.clear(),this.map_.addInteraction=i=>this.pausedInteractions_.push(i),this.map_.removeInteraction=i=>{let s=!1;return this.pausedInteractions_=this.pausedInteractions_.filter(o=>{const a=o!==i;return s||(s=a),a}),s?i:void 0};const r=this.map_.getLayerGroup();r.getVisible()&&(this.hiddenRootGroup_=r,this.hiddenRootGroup_.setVisible(!1)),this.map_.getOverlayContainer().classList.add("olcs-hideoverlay")}this.camera_.readFromView(),this.render_()}else this.isOverMap_&&(n=this.map_.getInteractions(),this.pausedInteractions_.forEach(r=>{n.push(r)}),this.pausedInteractions_.length=0,this.map_.addInteraction=r=>this.map_.getInteractions().push(r),this.map_.removeInteraction=r=>this.map_.getInteractions().remove(r),this.map_.getOverlayContainer().classList.remove("olcs-hideoverlay"),this.hiddenRootGroup_&&(this.hiddenRootGroup_.setVisible(!0),this.hiddenRootGroup_=null)),this.camera_.updateView()}warmUp(e,n){if(this.enabled_)return;this.throwOnUnitializedMap_(),this.camera_.readFromView();const r=this.globe_.ellipsoid,i=this.scene_.camera,s=r.cartesianToCartographic(i.position);s.height<e&&(s.height=e,i.position=r.cartographicToCartesian(s)),this.warmingUp_=!0,this.render_(),setTimeout(()=>{this.warmingUp_=!1},n)}setBlockCesiumRendering(e){this.blockCesiumRendering_!==e&&(this.blockCesiumRendering_=e,this.render_())}enableAutoRenderLoop(){this.autoRenderLoop_||(this.autoRenderLoop_=new SB(this))}getAutoRenderLoop(){return this.autoRenderLoop_}setResolutionScale(e){e=Math.max(0,e),e!==this.resolutionScale_&&(this.resolutionScale_=Math.max(0,e),this.resolutionScaleChanged_=!0,this.autoRenderLoop_&&this.autoRenderLoop_.restartRenderLoop())}setTargetFrameRate(e){this.targetFrameRate_!==e&&(this.targetFrameRate_=e,this.render_())}setRefresh2DAfterCameraMoveEndOnly(e){this.refresh2DAfterCameraMoveEndOnly=e}throwOnUnitializedMap_(){const n=this.map_.getView(),r=n.getCenter();if(!n.isDef()||isNaN(r[0])||isNaN(r[1]))throw new Error(`The OpenLayers map is not properly initialized: ${r} / ${n.getResolution()}`)}get trackedFeature(){return this.trackedFeature_}set trackedFeature(e){if(this.trackedFeature_!==e){const n=this.scene_;if(!e||!e.getGeometry()){this.needTrackedEntityUpdate_=!1,n.screenSpaceCameraController.enableTilt=!0,this.trackedEntity_&&this.dataSourceDisplay_.defaultDataSource.entities.remove(this.trackedEntity_),this.trackedEntity_=null,this.trackedFeature_=null,this.entityView_=null,n.camera.lookAtTransform(Cesium.Matrix4.IDENTITY);return}this.trackedFeature_=e,this.needTrackedEntityUpdate_=!0;const r=this.to4326Transform_,i=function(){const o=e.getGeometry();console.assert(o instanceof Sn);const a=o instanceof Sn?o.getCoordinates():[],l=r(a,void 0,a.length);return rc(l)},s={position:new Cesium.CallbackProperty((o,a)=>i(),!1),point:{pixelSize:1,color:Cesium.Color.TRANSPARENT}};this.trackedEntity_=this.dataSourceDisplay_.defaultDataSource.entities.add(s)}}}const kB="eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJqdGkiOiIyNWY4MTA5MS0zNWRiLTQ2YWItYTI0Zi02YTZhZTU3N2UyNGMiLCJpZCI6MzU5NTExLCJpYXQiOjE3NjI5OTQ0MTd9.rXpfUhg3KPJWF7GOQQLGx3raY5I-aL2lRSjBBoS6N8k",MB=void 0,mP="4075747",DB=void 0,W$="https://s3.amazonaws.com/elevation-tiles-prod/terrarium/{z}/{x}/{y}.png",Oa=t=>typeof t=="string"&&t.trim().length?t.trim():void 0,NB=t=>Math.min(8,Math.max(.5,Number.isFinite(t)?t:1)),jB=t=>Math.min(89,Math.max(30,Number.isFinite(t)?t:85)),zB=typeof window<"u"?Oa(window.localStorage.getItem("ion.token")||void 0):void 0,yP=Oa(kB)??zB,_P=Oa(MB),vP=Oa(DB)??W$,_E=f1(t=>({enabled:!!(yP||_P||vP),verticalExaggeration:1.6,maxPitch:85,ionToken:yP,terrainUrl:_P,terrariumUrl:vP,terrainAssetId:(()=>{const e=mP.trim()?Number.parseInt(mP,10):void 0;if(typeof e=="number"&&!Number.isNaN(e))return e;if(typeof window<"u"){const n=window.localStorage.getItem("ion.assetId");if(n&&n.trim()&&!Number.isNaN(Number(n)))return Number(n)}})(),setEnabled:e=>t({enabled:e}),setVerticalExaggeration:e=>t({verticalExaggeration:NB(e)}),setMaxPitch:e=>t({maxPitch:jB(e)}),setIonToken:e=>t(()=>{const n=Oa(e);try{typeof window<"u"&&(n?window.localStorage.setItem("ion.token",n):window.localStorage.removeItem("ion.token"))}catch{}return{ionToken:n}}),setTerrainUrl:e=>t({terrainUrl:Oa(e)}),setTerrainAssetId:e=>t(()=>{const n=e==null||Number.isNaN(Number(e))?void 0:Number(e);try{typeof window<"u"&&(typeof n=="number"?window.localStorage.setItem("ion.assetId",String(n)):window.localStorage.removeItem("ion.assetId"))}catch{}return{terrainAssetId:n}}),setTerrariumUrl:e=>t({terrariumUrl:Oa(e)??W$})})),UB=t=>g1(_E,t),wP=()=>_E.getState(),GB=_E.subscribe,BB="https://s3.amazonaws.com/elevation-tiles-prod/terrarium/{z}/{x}/{y}.png",xP=256,VB=15,WB=4;class HB extends Cesium.TerrainProvider{constructor(n={}){var i;super();q(this,"tilingScheme");q(this,"errorEvent");q(this,"credit");q(this,"hasWaterMask",!1);q(this,"hasVertexNormals",!1);q(this,"ready",!0);q(this,"urlTemplate");q(this,"minimumLevel");q(this,"maximumLevel");q(this,"tileWidth");q(this,"tileHeight");q(this,"levelZeroError");q(this,"cache");q(this,"maxCacheEntries");q(this,"canvas");q(this,"context");this.tilingScheme=new Cesium.WebMercatorTilingScheme,this.errorEvent=new Cesium.Event,this.credit=n.credit?new Cesium.Credit(n.credit):new Cesium.Credit("Mapzen Terrain (AWS)"),this.urlTemplate=(i=n.urlTemplate)!=null&&i.trim().length?n.urlTemplate:BB,this.minimumLevel=Math.max(0,n.minimumLevel??0),this.maximumLevel=Math.max(this.minimumLevel,n.maximumLevel??VB),this.tileWidth=xP,this.tileHeight=xP,this.levelZeroError=Cesium.TerrainProvider.getEstimatedLevelZeroGeometricErrorForAHeightmap(this.tilingScheme.ellipsoid,this.tileWidth,this.tileHeight),this.cache=new Map,this.maxCacheEntries=Math.max(32,n.cacheSize??256),this.canvas=document.createElement("canvas"),this.canvas.width=this.tileWidth,this.canvas.height=this.tileHeight;const r=this.canvas.getContext("2d");if(!r)throw new Error("Unable to get 2D context for terrain decoding");this.context=r}isDestroyed(){return!1}destroy(){this.cache.clear(),this.context.clearRect(0,0,this.tileWidth,this.tileHeight)}getLevelMaximumGeometricError(n){return this.levelZeroError/Math.pow(2,n)}async requestTileGeometry(n,r,i,s){if(i<this.minimumLevel||i>this.maximumLevel)return;const o=`${i}:${n}:${r}`,a=this.cache.get(o);if(a)return a;const l=this.fetchAndDecodeTile(n,r,i,s).then(c=>(this.pruneCache(o),c)).catch(c=>{this.cache.delete(o),this.errorEvent.raiseEvent(c)});return this.cache.set(o,l),l}getTileDataAvailable(){return!0}pruneCache(n){if(!(this.cache.size<=this.maxCacheEntries)){for(const r of this.cache.keys())if(r!==n&&(this.cache.delete(r),this.cache.size<=this.maxCacheEntries))break}}async fetchAndDecodeTile(n,r,i,s){const o=this.urlTemplate.replace("{z}",String(i)).replace("{x}",String(n)).replace("{y}",String(r)),l=await new Cesium.Resource({url:o,request:s}).fetchImage({preferBlob:!0}),c=l.width??this.tileWidth,u=l.height??this.tileHeight;(c!==this.tileWidth||u!==this.tileHeight)&&(this.canvas.width=c,this.canvas.height=u),this.context.clearRect(0,0,c,u),this.context.drawImage(l,0,0,c,u),"close"in l&&typeof l.close=="function"&&l.close();const d=this.context.getImageData(0,0,c,u).data,h=c*u,f=new Float32Array(h);for(let p=0,m=0;p<h;p+=1,m+=WB){const _=d[m],g=d[m+1],y=d[m+2],v=_*256+g+y/256-32768;f[p]=v}return new Cesium.HeightmapTerrainData({width:c,height:u,childTileMask:15,structure:{heightScale:1,heightOffset:0,elementsPerHeight:1,stride:1,elementMultiplier:1,isBigEndian:!1},buffer:f,skirtHeight:Math.max(20,this.getLevelMaximumGeometricError(i)*.5)})}}const H$=t=>{if(!Number.isFinite(t))return 0;const e=t%360;return e<0?e+360:e},K$=t=>Number.isFinite(t)?Math.min(85,Math.max(5,t)):45,Y$=t=>Number.isFinite(t)?Math.min(2e4,Math.max(60,t)):1200,gh=f1(t=>({heading:315,pitch:45,height:1200,setHeading:e=>t({heading:H$(e)}),setPitch:e=>t({pitch:K$(e)}),setHeight:e=>t({height:Y$(e)})})),KB=t=>g1(gh,t),Bf=()=>gh.getState();gh.subscribe;const YB=t=>{const e=gh.getState(),n=t.heading!==void 0?H$(t.heading):e.heading,r=t.pitch!==void 0?K$(t.pitch):e.pitch,i=t.height!==void 0?Y$(t.height):e.height;gh.setState({heading:n,pitch:r,height:i})},Wo=Qi(t=>({visible:{topo:!0,aerial:!1,hillshade:!0,slope:!1,contours:!0},setVisible:(e,n)=>t(r=>({visible:{...r.visible,[e]:n}}))}));typeof window<"u"&&!window.Cesium&&(window.Cesium=Cesium);let Ra=null;async function EP(t,e,n){const r=t.getCesiumScene();e.ionToken&&(Cesium.Ion.defaultAccessToken=e.ionToken);const i=(s,o)=>{const a=s;if(Ra){try{Ra()}catch{}Ra=null}if(r.terrainProvider=s,r.requestRender(),a!=null&&a.errorEvent){const l=c=>{n.cancelled||console.error(`[terrain] Provider error for ${o}`,c)};a.errorEvent.addEventListener(l),Ra=()=>{try{a.errorEvent.removeEventListener(l)}catch{}}}a&&"readyPromise"in a&&a.readyPromise?a.readyPromise.then(()=>{n.cancelled||console.info(`[terrain] ${o} ready.`)}).catch(l=>{n.cancelled||console.error(`[terrain] ${o} failed to become ready`,l)}):console.info(`[terrain] ${o} set (synchronous provider).`)};try{if(e.terrainUrl){const s=await Cesium.CesiumTerrainProvider.fromUrl(e.terrainUrl,{requestVertexNormals:!0,requestWaterMask:!1});n.cancelled||(i(s,`Custom terrain URL ${e.terrainUrl}`),console.debug("[terrain] Provider details:",s))}else if(e.terrainAssetId!==void 0&&e.terrainAssetId!==null&&e.ionToken){const s=await Cesium.CesiumTerrainProvider.fromIonAssetId(e.terrainAssetId,{requestVertexNormals:!0,requestWaterMask:!0});n.cancelled||(i(s,`Cesium Ion asset ${e.terrainAssetId}`),console.debug("[terrain] Provider details:",s),console.info(`[terrain] Cesium Ion asset ${e.terrainAssetId} active with token (usage should appear in Ion dashboard).`))}else if(e.ionToken){const s=await Cesium.createWorldTerrainAsync();n.cancelled||(i(s,"Cesium World Terrain"),console.info("[terrain] Using Cesium World Terrain (Ion token provided, no asset id)."))}else if(e.terrariumUrl){const s=new HB({urlTemplate:e.terrariumUrl});n.cancelled||(i(s,"Terrarium fallback tiles"),console.info("[terrain] Using Terrarium fallback tiles:",e.terrariumUrl))}else n.cancelled||(i(new Cesium.EllipsoidTerrainProvider,"Ellipsoid terrain"),console.warn("[terrain] No terrain source configured; falling back to ellipsoid."))}catch(s){n.cancelled||(console.error("[terrain] Failed to load requested terrain provider. Falling back to ellipsoid.",s),i(new Cesium.EllipsoidTerrainProvider,"Ellipsoid fallback"))}}function XB(){const t=Xm(),e=t==null?void 0:t.getView().getCenter();if(!e)return[0,0];const[n,r]=$1(e);return[Number.isFinite(n)?n:0,Number.isFinite(r)?r:0]}function Vf(t,e,n={}){const r=t.getCesiumScene(),i=r.screenSpaceCameraController,s=Cesium.Math.toRadians(e.heading),o=-Cesium.Math.toRadians(e.pitch),[a,l]=n.lonLat??XB(),c=Math.max(40,n.heightOverride??e.height),u=Cesium.Cartesian3.fromDegrees(a,l,c),d={heading:s,pitch:o,roll:0};n.animate?r.camera.flyTo({destination:u,orientation:d,duration:n.duration??1.2,easingFunction:Cesium.EasingFunction.QUADRATIC_OUT}):r.camera.setView({destination:u,orientation:d}),i.minimumPitch=Cesium.Math.toRadians(-89.5)}function ZB(){const t=K.useRef(null);return K.useEffect(()=>{if(!t.current)return;const e=new Map;let n=!1;const r=w=>{try{switch(w){case"topo":return{provider:new Cesium.ArcGisMapServerImageryProvider({url:"https://basemap.nationalmap.gov/arcgis/rest/services/USGSTopo/MapServer",maximumLevel:16,usePreCachedTilesIfAvailable:!0,tilingScheme:new Cesium.WebMercatorTilingScheme,credit:new Cesium.Credit("USGS Topographic Map")})};case"aerial":return{provider:new Cesium.ArcGisMapServerImageryProvider({url:"https://basemap.nationalmap.gov/arcgis/rest/services/USGSImageryOnly/MapServer",maximumLevel:17,usePreCachedTilesIfAvailable:!0,tilingScheme:new Cesium.WebMercatorTilingScheme,credit:new Cesium.Credit("USGS Imagery")})};default:return null}}catch(x){return console.error(`[cesium] Failed to create basemap provider for ${w}`,x),null}};let i=null;const s=()=>{if(!i)return;const w=i.getCesiumScene();for(const x of e.values())try{w.imageryLayers.remove(x,!0)}catch(S){console.warn("[cesium] Failed to remove basemap layer",S)}e.clear(),w.requestRender()},o=async()=>{if(!i||!i.getEnabled())return;const w=i.getCesiumScene();s();let x=!1;if(wP().ionToken)try{const C=await Cesium.createWorldImageryAsync({style:Cesium.IonWorldImageryStyle.AERIAL_WITH_LABELS}),T=w.imageryLayers.addImageryProvider(C);w.imageryLayers.lowerToBottom(T),e.set("__ion_base",T),x=!0,console.info("[cesium] Added Cesium ion world imagery base (single layer for performance).")}catch(C){console.error("[cesium] Failed to attach ion world imagery base",C)}if(!x){const C=Wo.getState().visible;if(C.topo){const T=r("topo");if(T)try{const P=w.imageryLayers.addImageryProvider(T.provider);e.set("topo",P),x=!0,console.info("[cesium] Added USGS Topo (single layer).")}catch(P){console.error("[cesium] Failed to attach topo layer",P)}}if(!x&&C.aerial){const T=r("aerial");if(T)try{const P=w.imageryLayers.addImageryProvider(T.provider);e.set("aerial",P),x=!0,console.info("[cesium] Added USGS Aerial (single layer).")}catch(P){console.error("[cesium] Failed to attach aerial layer",P)}}if(!x)try{const T=w.imageryLayers.addImageryProvider(new Cesium.OpenStreetMapImageryProvider({url:"https://tile.openstreetmap.org/"}));e.set("__fallback_osm",T),x=!0,console.info("[cesium] Added OpenStreetMap fallback (single layer).")}catch(T){console.error("[cesium] Failed to attach fallback imagery layer",T)}}w.requestRender()},a=()=>{!i||!i.getEnabled()||n||(n=!0,requestAnimationFrame(()=>{n=!1,o()}))},l=IT([-98,39]),c=new dG({target:t.current,controls:KO().extend([new _G,new fG]),view:new ki({center:l,zoom:4})});mT(c);const u={cancelled:!1},d=wP();let h=null,f=null;try{i=new yE({map:c,target:t.current});const w=i.getCesiumScene();w.screenSpaceCameraController.enableTilt=!0,w.screenSpaceCameraController.minimumZoomDistance=50,w.screenSpaceCameraController.maximumZoomDistance=2e7,w.screenSpaceCameraController.enableCollisionDetection=!0,w.screenSpaceCameraController.maximumPitch=Cesium.Math.toRadians(d.maxPitch),w.screenSpaceCameraController.inertiaSpin=.92,w.screenSpaceCameraController.inertiaTranslate=.9,w.screenSpaceCameraController.inertiaZoom=.85,w.screenSpaceCameraController.minimumPitch=Cesium.Math.toRadians(-89.5),w.globe.depthTestAgainstTerrain=!0,w.globe.enableLighting=!1,w.globe.showSkirts=!1,w.globe.maximumScreenSpaceError=2.5,w.requestRenderMode=!0,w.maximumRenderTimeChange=Number.POSITIVE_INFINITY,w.globe.baseColor=Cesium.Color.BLACK,w.globe.tileCacheSize=100,w.verticalExaggeration=d.verticalExaggeration,i.setEnabled(d.enabled),yT(i);let x=-1;const S=T=>{T!==x&&(x=T,console.debug(`[terrain] Tile load progress: ${T}`))};w.globe.tileLoadProgressEvent.addEventListener(S),f=()=>{try{w.globe.tileLoadProgressEvent.removeEventListener(S)}catch{}};const C=Bf();Vf(i,C,{animate:!1}),EP(i,d,u),d.enabled&&a(),h=Wo.subscribe(()=>{!i||!i.getEnabled()||a()},T=>T.visible)}catch(w){console.error("Failed to start Cesium overlay",w),i=null}const p=w=>{const x=w.detail;if(!x)return;const S=c.getView(),C=IT([x.lon,x.lat]);if(S.animate({center:C,zoom:x.zoom??16,duration:600}),i&&i.getEnabled()){const T=Bf(),P=x.zoom?Math.max(40,T.height*Math.pow(.55,Math.max(0,x.zoom-(S.getZoom()??16)))):T.height;y=!0,Vf(i,T,{animate:!0,lonLat:[x.lon,x.lat],heightOverride:P,duration:1.35}),setTimeout(()=>{y=!1},1500)}};window.addEventListener("map:jump-to",p);const m=w=>{if(!i||!i.getEnabled())return;const x=w.detail??{},S=Bf(),C={heading:x.heading!==void 0?x.heading:S.heading,pitch:x.pitch!==void 0?x.pitch:S.pitch,height:x.height!==void 0?x.height:S.height,setHeading:S.setHeading,setPitch:S.setPitch,setHeight:S.setHeight};y=!0,Vf(i,C,{animate:x.animate??!1,heightOverride:C.height}),setTimeout(()=>{y=!1},x.animate?1500:100)};window.addEventListener("map:set-camera-pose",m);const _=GB((w,x)=>{if(!i)return;const S=i.getCesiumScene();w.enabled!==x.enabled&&(i.setEnabled(w.enabled),w.enabled?(S.requestRender(),requestAnimationFrame(()=>{const C=Bf();y=!0,Vf(i,C,{animate:!0,duration:1.3}),a(),setTimeout(()=>{y=!1},1500)})):s()),w.verticalExaggeration!==x.verticalExaggeration&&(S.verticalExaggeration=w.verticalExaggeration,S.requestRender()),w.maxPitch!==x.maxPitch&&(S.screenSpaceCameraController.maximumPitch=Cesium.Math.toRadians(w.maxPitch)),(w.terrainUrl!==x.terrainUrl||w.terrainAssetId!==x.terrainAssetId||w.ionToken!==x.ionToken||w.terrariumUrl!==x.terrariumUrl)&&EP(i,w,u)});let g=!1,y=!1;const v=()=>{g||y||(g=!0,requestAnimationFrame(()=>{if(g=!1,y||!i||!i.getEnabled())return;const w=i.getCesiumScene(),x=w.camera,S=w.globe.ellipsoid.cartesianToCartographic(x.position);if(!S)return;const C=(Cesium.Math.toDegrees(x.heading)%360+360)%360,T=Math.min(85,Math.max(5,-Cesium.Math.toDegrees(x.pitch))),P=Math.max(40,S.height);YB({heading:C,pitch:T,height:P})}))};return i&&i.getCesiumScene().camera.changed.addEventListener(v),()=>{if(u.cancelled=!0,_(),i&&i.getCesiumScene().camera.changed.removeEventListener(v),Ra){try{Ra()}catch{}Ra=null}if(window.removeEventListener("map:set-camera-pose",m),window.removeEventListener("map:jump-to",p),yT(null),mT(null),h&&h(),s(),f)try{f()}catch{}i&&(i.setEnabled(!1),i.destroy()),c.setTarget(void 0)}},[]),E.jsx("div",{ref:t,style:{width:"100vw",height:"100vh"}})}class qB extends gE{constructor(){super()}getType(){return"json"}readFeature(e,n){return this.readFeatureFromObject(Wf(e),this.getReadOptions(e,n))}readFeatures(e,n){return this.readFeaturesFromObject(Wf(e),this.getReadOptions(e,n))}readFeatureFromObject(e,n){return Te()}readFeaturesFromObject(e,n){return Te()}readGeometry(e,n){return this.readGeometryFromObject(Wf(e),this.getReadOptions(e,n))}readGeometryFromObject(e,n){return Te()}readProjection(e){return this.readProjectionFromObject(Wf(e))}readProjectionFromObject(e){return Te()}writeFeature(e,n){return JSON.stringify(this.writeFeatureObject(e,n))}writeFeatureObject(e,n){return Te()}writeFeatures(e,n){return JSON.stringify(this.writeFeaturesObject(e,n))}writeFeaturesObject(e,n){return Te()}writeGeometry(e,n){return JSON.stringify(this.writeGeometryObject(e,n))}writeGeometryObject(e,n){return Te()}}function Wf(t){if(typeof t=="string"){const e=JSON.parse(t);return e||null}return t!==null?t:null}class ut extends qB{constructor(e){e=e||{},super(),this.dataProjection=Ne(e.dataProjection?e.dataProjection:"EPSG:4326"),e.featureProjection&&(this.defaultFeatureProjection=Ne(e.featureProjection)),e.featureClass&&(this.featureClass=e.featureClass),this.geometryName_=e.geometryName,this.extractGeometryName_=e.extractGeometryName,this.supportedMediaTypes=["application/geo+json","application/vnd.geo+json"]}readFeatureFromObject(e,n){let r=null;e.type==="Feature"?r=e:r={type:"Feature",geometry:e,properties:null};const i=vE(r.geometry);if(this.featureClass===wn)return F$({geometry:i,id:r.id,properties:r.properties},n);const s=new en;return this.geometryName_?s.setGeometryName(this.geometryName_):this.extractGeometryName_&&r.geometry_name&&s.setGeometryName(r.geometry_name),s.setGeometry(pE(i,n)),"id"in r&&s.setId(r.id),r.properties&&s.setProperties(r.properties,!0),s}readFeaturesFromObject(e,n){const r=e;let i=null;if(r.type==="FeatureCollection"){const s=e;i=[];const o=s.features;for(let a=0,l=o.length;a<l;++a){const c=this.readFeatureFromObject(o[a],n);c&&i.push(c)}}else i=[this.readFeatureFromObject(e,n)];return i.flat()}readGeometryFromObject(e,n){return JB(e,n)}readProjectionFromObject(e){const n=e.crs;let r;if(n)if(n.type=="name")r=Ne(n.properties.name);else if(n.type==="EPSG")r=Ne("EPSG:"+n.properties.code);else throw new Error("Unknown SRS type");else r=this.dataProjection;return r}writeFeatureObject(e,n){n=this.adaptOptions(n);const r={type:"Feature",geometry:null,properties:null},i=e.getId();if(i!==void 0&&(r.id=i),!e.hasProperties())return r;const s=e.getProperties(),o=e.getGeometry();return o&&(r.geometry=Ow(o,n),delete s[e.getGeometryName()]),Uo(s)||(r.properties=s),r}writeFeaturesObject(e,n){n=this.adaptOptions(n);const r=[];for(let i=0,s=e.length;i<s;++i)r.push(this.writeFeatureObject(e[i],n));return{type:"FeatureCollection",features:r}}writeGeometryObject(e,n){return Ow(e,this.adaptOptions(n))}}function vE(t,e){if(!t)return null;let n;switch(t.type){case"Point":{n=e8(t);break}case"LineString":{n=t8(t);break}case"Polygon":{n=s8(t);break}case"MultiPoint":{n=r8(t);break}case"MultiLineString":{n=n8(t);break}case"MultiPolygon":{n=i8(t);break}case"GeometryCollection":{n=QB(t);break}default:throw new Error("Unsupported GeoJSON type: "+t.type)}return n}function JB(t,e){const n=vE(t);return pE(n,e)}function QB(t,e){return t.geometries.map(function(r){return vE(r)})}function e8(t){const e=t.coordinates;return{type:"Point",flatCoordinates:e,layout:rl(e.length)}}function t8(t){var r;const e=t.coordinates,n=e.flat();return{type:"LineString",flatCoordinates:n,ends:[n.length],layout:rl(((r=e[0])==null?void 0:r.length)||2)}}function n8(t){var s,o;const e=t.coordinates,n=((o=(s=e[0])==null?void 0:s[0])==null?void 0:o.length)||2,r=[],i=jh(r,0,e,n);return{type:"MultiLineString",flatCoordinates:r,ends:i,layout:rl(n)}}function r8(t){var n;const e=t.coordinates;return{type:"MultiPoint",flatCoordinates:e.flat(),layout:rl(((n=e[0])==null?void 0:n.length)||2)}}function i8(t){var s,o;const e=t.coordinates,n=[],r=((o=(s=e[0])==null?void 0:s[0])==null?void 0:o[0].length)||2,i=jO(n,0,e,r);return{type:"MultiPolygon",flatCoordinates:n,ends:i,layout:rl(r)}}function s8(t){var s,o;const e=t.coordinates,n=[],r=(o=(s=e[0])==null?void 0:s[0])==null?void 0:o.length,i=jh(n,0,e,r);return{type:"Polygon",flatCoordinates:n,ends:i,layout:rl(r)}}function Ow(t,e){t=Qr(t,!0,e);const n=t.getType();let r;switch(n){case"Point":{r=d8(t);break}case"LineString":{r=a8(t);break}case"Polygon":{r=h8(t,e);break}case"MultiPoint":{r=c8(t);break}case"MultiLineString":{r=l8(t);break}case"MultiPolygon":{r=u8(t,e);break}case"GeometryCollection":{r=o8(t,e);break}case"Circle":{r={type:"GeometryCollection",geometries:[]};break}default:throw new Error("Unsupported geometry type: "+n)}return r}function o8(t,e){return e=Object.assign({},e),delete e.featureProjection,{type:"GeometryCollection",geometries:t.getGeometriesArray().map(function(r){return Ow(r,e)})}}function a8(t,e){return{type:"LineString",coordinates:t.getCoordinates()}}function l8(t,e){return{type:"MultiLineString",coordinates:t.getCoordinates()}}function c8(t,e){return{type:"MultiPoint",coordinates:t.getCoordinates()}}function u8(t,e){let n;return e&&(n=e.rightHanded),{type:"MultiPolygon",coordinates:t.getCoordinates(n)}}function d8(t,e){return{type:"Point",coordinates:t.getCoordinates()}}function h8(t,e){let n;return e&&(n=e.rightHanded),{type:"Polygon",coordinates:t.getCoordinates(n)}}const Jp="http://www.w3.org/2001/XMLSchema-instance";function al(t,e){return uu().createElementNS(t,e)}function Ci(t,e){return X$(t,e,[]).join("")}function X$(t,e,n){if(t.nodeType==Node.CDATA_SECTION_NODE||t.nodeType==Node.TEXT_NODE)n.push(t.nodeValue);else{let r;for(r=t.firstChild;r;r=r.nextSibling)X$(r,e,n)}return n}function Es(t){return"documentElement"in t}function Ss(t){return new DOMParser().parseFromString(t,"application/xml")}function SP(t,e){return function(n,r){const i=t.call(e??this,n,r);if(i!==void 0){const s=r[r.length-1];We(s,i)}}}function di(t,e){return function(n,r){const i=t.call(e??this,n,r);i!==void 0&&r[r.length-1].push(i)}}function wE(t,e){return function(n,r){const i=t.call(this,n,r);i!==void 0&&(r[r.length-1]=i)}}function se(t,e,n){return function(r,i){const s=t.call(this,r,i);if(s!==void 0){const o=i[i.length-1],a=e!==void 0?e:r.localName;o[a]=s}}}function ae(t,e){return function(n,r,i){t.call(this,n,r,i),i[i.length-1].node.appendChild(n)}}function Z$(t,e){let n,r;return function(i,s,o){if(n===void 0){n={};const a={};a[i.localName]=t,n[i.namespaceURI]=a,r=Ti(i.localName)}q$(n,r,s,o)}}function Ti(t,e){return function(n,r,i){const o=r[r.length-1].node;let a=t;a===void 0&&(a=i);const l=o.namespaceURI;return al(l,a)}}const $n=Ti();function ur(t,e){const n=e.length,r=new Array(n);for(let i=0;i<n;++i)r[i]=t[e[i]];return r}function de(t,e,n){n=n!==void 0?n:{};let r,i;for(r=0,i=t.length;r<i;++r)n[t[r]]=e;return n}function Jo(t,e,n,r){let i;for(i=e.firstElementChild;i;i=i.nextElementSibling){const s=t[i.namespaceURI];if(s!==void 0){const o=s[i.localName];o!==void 0&&o.call(r,i,n)}}}function Ue(t,e,n,r,i){return r.push(t),Jo(e,n,r,i),r.pop()}function q$(t,e,n,r,i,s){const o=(i!==void 0?i:n).length;let a,l;for(let c=0;c<o;++c)a=n[c],a!==void 0&&(l=e.call(s,a,r,i!==void 0?i[c]:void 0),l!==void 0&&t[l.namespaceURI][l.localName].call(s,l,a,r))}function dt(t,e,n,r,i,s,o){return i.push(t),q$(e,n,r,i,s,o),i.pop()}let E0;function f8(){return E0===void 0&&typeof XMLSerializer<"u"&&(E0=new XMLSerializer),E0}let S0;function uu(){return S0===void 0&&typeof document<"u"&&(S0=document.implementation.createDocument("","",null)),S0}class J$ extends gE{constructor(){super(),this.xmlSerializer_=f8()}getType(){return"xml"}readFeature(e,n){if(!e)return null;if(typeof e=="string"){const r=Ss(e);return this.readFeatureFromDocument(r,n)}return Es(e)?this.readFeatureFromDocument(e,n):this.readFeatureFromNode(e,n)}readFeatureFromDocument(e,n){const r=this.readFeaturesFromDocument(e,n);return r.length>0?r[0]:null}readFeatureFromNode(e,n){return null}readFeatures(e,n){if(!e)return[];if(typeof e=="string"){const r=Ss(e);return this.readFeaturesFromDocument(r,n)}return Es(e)?this.readFeaturesFromDocument(e,n):this.readFeaturesFromNode(e,n)}readFeaturesFromDocument(e,n){const r=[];for(let i=e.firstChild;i;i=i.nextSibling)i.nodeType==Node.ELEMENT_NODE&&We(r,this.readFeaturesFromNode(i,n));return r}readFeaturesFromNode(e,n){return Te()}readGeometry(e,n){if(!e)return null;if(typeof e=="string"){const r=Ss(e);return this.readGeometryFromDocument(r,n)}return Es(e)?this.readGeometryFromDocument(e,n):this.readGeometryFromNode(e,n)}readGeometryFromDocument(e,n){return null}readGeometryFromNode(e,n){return null}readProjection(e){if(!e)return null;if(typeof e=="string"){const n=Ss(e);return this.readProjectionFromDocument(n)}return Es(e)?this.readProjectionFromDocument(e):this.readProjectionFromNode(e)}readProjectionFromDocument(e){return this.dataProjection}readProjectionFromNode(e){return this.dataProjection}writeFeature(e,n){const r=this.writeFeatureNode(e,n);return this.xmlSerializer_.serializeToString(r)}writeFeatureNode(e,n){return null}writeFeatures(e,n){const r=this.writeFeaturesNode(e,n);return this.xmlSerializer_.serializeToString(r)}writeFeaturesNode(e,n){return null}writeGeometry(e,n){const r=this.writeGeometryNode(e,n);return this.xmlSerializer_.serializeToString(r)}writeGeometryNode(e,n){return null}}function Ho(t){const e=Ci(t,!1);return g8(e)}function g8(t){const e=/^\s*(true|1)|(false|0)\s*$/.exec(t);if(e)return e[1]!==void 0||!1}function my(t){const e=Ci(t,!1),n=Date.parse(e);return isNaN(n)?void 0:n/1e3}function qe(t){const e=Ci(t,!1);return p8(e)}function p8(t){const e=/^\s*([+\-]?\d*\.?\d+(?:e[+\-]?\d+)?)\s*$/i.exec(t);if(e)return parseFloat(e[1])}function ph(t){const e=Ci(t,!1);return m8(e)}function m8(t){const e=/^\s*(\d+)\s*$/.exec(t);if(e)return parseInt(e[1],10)}function $e(t){return Ci(t,!1).trim()}function zc(t,e){et(t,e?"1":"0")}function y8(t,e){t.appendChild(uu().createCDATASection(e))}function _8(t,e){const n=new Date(e*1e3),r=n.getUTCFullYear()+"-"+Gu(n.getUTCMonth()+1,2)+"-"+Gu(n.getUTCDate(),2)+"T"+Gu(n.getUTCHours(),2)+":"+Gu(n.getUTCMinutes(),2)+":"+Gu(n.getUTCSeconds(),2)+"Z";t.appendChild(uu().createTextNode(r))}function qn(t,e){const n=e.toPrecision();t.appendChild(uu().createTextNode(n))}function Qp(t,e){const n=e.toString();t.appendChild(uu().createTextNode(n))}const v8=/^\s/,w8=/\s$/,x8=/(\n|\t|\r|<|&| {2})/;function et(t,e){typeof e=="string"&&(v8.test(e)||w8.test(e)||x8.test(e))?e.split("]]>").forEach((n,r,i)=>{r<i.length-1&&(n+="]]"),r>0&&(n=">"+n),y8(t,n)}):t.appendChild(uu().createTextNode(e))}const Hs=["http://www.google.com/kml/ext/2.2"],xe=[null,"http://earth.google.com/kml/2.0","http://earth.google.com/kml/2.1","http://earth.google.com/kml/2.2","http://www.opengis.net/kml/2.2"],E8="http://www.opengis.net/kml/2.2 https://developers.google.com/kml/schema/kml22gx.xsd",bP={fraction:"fraction",pixels:"pixels",insetPixels:"pixels"},S8=de(xe,{ExtendedData:fL,Region:gL,MultiGeometry:se(uL,"geometry"),LineString:se(lL,"geometry"),LinearRing:se(cL,"geometry"),Point:se(dL,"geometry"),Polygon:se(hL,"geometry"),Style:se(SE),StyleMap:oV,address:se($e),description:se($e),name:se($e),open:se(Ho),phoneNumber:se($e),styleUrl:se(rL),visibility:se(Ho)},de(Hs,{MultiTrack:se(K8,"geometry"),Track:se(aL,"geometry")})),b8=de(xe,{ExtendedData:fL,Region:gL,Link:_V,address:se($e),description:se($e),name:se($e),open:se(Ho),phoneNumber:se($e),visibility:se(Ho)}),C8=de(xe,{href:se(nL)}),T8=de(xe,{Altitude:se(qe),Longitude:se(qe),Latitude:se(qe),Tilt:se(qe),AltitudeMode:se($e),Heading:se(qe),Roll:se(qe)}),Q$=de(xe,{LatLonAltBox:dV,Lod:fV}),P8=de(xe,["Document","Placemark"]),R8=de(xe,{Document:ae(TV),Placemark:ae(yL)});let vc,Ng=null,$w,Cd,Td,Pd,em,Lw=null,xE,kw=null,Mw,Ia=null,CP=null,Dw=null;function tm(t){return 32/Math.min(t[0],t[1])}function I8(){vc=[255,255,255,1],Ng=new Wt({color:vc}),$w=[20,2],Cd="pixels",Td="pixels",Pd=[64,64],em="https://maps.google.com/mapfiles/kml/pushpin/ylw-pushpin.png",Lw=new Go({anchor:$w,anchorOrigin:"bottom-left",anchorXUnits:Cd,anchorYUnits:Td,crossOrigin:"anonymous",rotation:0,scale:tm(Pd),size:Pd,src:em}),xE="NO_IMAGE",kw=new yt({color:vc,width:1}),Mw=new yt({color:[51,51,51,1],width:2}),Ia=new Zo({font:"bold 16px Helvetica",fill:Ng,stroke:Mw,scale:.8}),CP=new nt({fill:Ng,image:Lw,text:Ia,stroke:kw,zIndex:0}),Dw=[CP]}let Hf;function A8(t){return t}class F8 extends J${constructor(e){super(),e=e||{},Dw||I8(),this.dataProjection=Ne("EPSG:4326"),this.defaultStyle_=e.defaultStyle?e.defaultStyle:Dw,this.extractStyles_=e.extractStyles!==void 0?e.extractStyles:!0,this.writeStyles_=e.writeStyles!==void 0?e.writeStyles:!0,this.sharedStyles_={},this.showPointNames_=e.showPointNames!==void 0?e.showPointNames:!0,this.crossOrigin_=e.crossOrigin!==void 0?e.crossOrigin:"anonymous",this.iconUrlFunction_=e.iconUrlFunction?e.iconUrlFunction:A8,this.supportedMediaTypes=["application/vnd.google-earth.kml+xml"]}readDocumentOrFolder_(e,n){const r=de(xe,{Document:SP(this.readDocumentOrFolder_,this),Folder:SP(this.readDocumentOrFolder_,this),Placemark:di(this.readPlacemark_,this),Style:this.readSharedStyle_.bind(this),StyleMap:this.readSharedStyleMap_.bind(this)}),i=Ue([],r,e,n,this);if(i)return i}readPlacemark_(e,n){const r=Ue({geometry:null},S8,e,n,this);if(!r)return;const i=new en,s=e.getAttribute("id");s!==null&&i.setId(s);const o=n[0],a=r.geometry;if(a&&Qr(a,!1,o),i.setGeometry(a),delete r.geometry,this.extractStyles_){const l=r.Style,c=r.styleUrl,u=$8(l,c,this.defaultStyle_,this.sharedStyles_,this.showPointNames_);i.setStyle(u)}return delete r.Style,i.setProperties(r,!0),i}readSharedStyle_(e,n){const r=e.getAttribute("id");if(r!==null){const i=SE.call(this,e,n);if(i){let s,o=e.baseURI;(!o||o=="about:blank")&&(o=window.location.href),o?s=new URL("#"+r,o).href:s="#"+r,this.sharedStyles_[s]=i}}}readSharedStyleMap_(e,n){const r=e.getAttribute("id");if(r===null)return;const i=sL.call(this,e,n);if(!i)return;let s,o=e.baseURI;(!o||o=="about:blank")&&(o=window.location.href),o?s=new URL("#"+r,o).href:s="#"+r,this.sharedStyles_[s]=i}readFeatureFromNode(e,n){if(!xe.includes(e.namespaceURI))return null;const r=this.readPlacemark_(e,[this.getReadOptions(e,n)]);return r||null}readFeaturesFromNode(e,n){if(!xe.includes(e.namespaceURI))return[];let r;const i=e.localName;if(i=="Document"||i=="Folder")return r=this.readDocumentOrFolder_(e,[this.getReadOptions(e,n)]),r||[];if(i=="Placemark"){const s=this.readPlacemark_(e,[this.getReadOptions(e,n)]);return s?[s]:[]}if(i=="kml"){r=[];for(let s=e.firstElementChild;s;s=s.nextElementSibling){const o=this.readFeaturesFromNode(s,n);o&&We(r,o)}return r}return[]}readName(e){if(e){if(typeof e=="string"){const n=Ss(e);return this.readNameFromDocument(n)}return Es(e)?this.readNameFromDocument(e):this.readNameFromNode(e)}}readNameFromDocument(e){for(let n=e.firstChild;n;n=n.nextSibling)if(n.nodeType==Node.ELEMENT_NODE){const r=this.readNameFromNode(n);if(r)return r}}readNameFromNode(e){for(let n=e.firstElementChild;n;n=n.nextElementSibling)if(xe.includes(n.namespaceURI)&&n.localName=="name")return $e(n);for(let n=e.firstElementChild;n;n=n.nextElementSibling){const r=n.localName;if(xe.includes(n.namespaceURI)&&(r=="Document"||r=="Folder"||r=="Placemark"||r=="kml")){const i=this.readNameFromNode(n);if(i)return i}}}readNetworkLinks(e){const n=[];if(typeof e=="string"){const r=Ss(e);We(n,this.readNetworkLinksFromDocument(r))}else Es(e)?We(n,this.readNetworkLinksFromDocument(e)):We(n,this.readNetworkLinksFromNode(e));return n}readNetworkLinksFromDocument(e){const n=[];for(let r=e.firstChild;r;r=r.nextSibling)r.nodeType==Node.ELEMENT_NODE&&We(n,this.readNetworkLinksFromNode(r));return n}readNetworkLinksFromNode(e){const n=[];for(let r=e.firstElementChild;r;r=r.nextElementSibling)if(xe.includes(r.namespaceURI)&&r.localName=="NetworkLink"){const i=Ue({},b8,r,[]);n.push(i)}for(let r=e.firstElementChild;r;r=r.nextElementSibling){const i=r.localName;xe.includes(r.namespaceURI)&&(i=="Document"||i=="Folder"||i=="kml")&&We(n,this.readNetworkLinksFromNode(r))}return n}readRegion(e){const n=[];if(typeof e=="string"){const r=Ss(e);We(n,this.readRegionFromDocument(r))}else Es(e)?We(n,this.readRegionFromDocument(e)):We(n,this.readRegionFromNode(e));return n}readRegionFromDocument(e){const n=[];for(let r=e.firstChild;r;r=r.nextSibling)r.nodeType==Node.ELEMENT_NODE&&We(n,this.readRegionFromNode(r));return n}readRegionFromNode(e){const n=[];for(let r=e.firstElementChild;r;r=r.nextElementSibling)if(xe.includes(r.namespaceURI)&&r.localName=="Region"){const i=Ue({},Q$,r,[]);n.push(i)}for(let r=e.firstElementChild;r;r=r.nextElementSibling){const i=r.localName;xe.includes(r.namespaceURI)&&(i=="Document"||i=="Folder"||i=="kml")&&We(n,this.readRegionFromNode(r))}return n}readCamera(e){const n=[];if(typeof e=="string"){const r=Ss(e);We(n,this.readCameraFromDocument(r))}else Es(e)?We(n,this.readCameraFromDocument(e)):We(n,this.readCameraFromNode(e));return n}readCameraFromDocument(e){const n=[];for(let r=e.firstChild;r;r=r.nextSibling)r.nodeType===Node.ELEMENT_NODE&&We(n,this.readCameraFromNode(r));return n}readCameraFromNode(e){const n=[];for(let r=e.firstElementChild;r;r=r.nextElementSibling)if(xe.includes(r.namespaceURI)&&r.localName==="Camera"){const i=Ue({},T8,r,[]);n.push(i)}for(let r=e.firstElementChild;r;r=r.nextElementSibling){const i=r.localName;xe.includes(r.namespaceURI)&&(i==="Document"||i==="Folder"||i==="Placemark"||i==="kml")&&We(n,this.readCameraFromNode(r))}return n}writeFeaturesNode(e,n){n=this.adaptOptions(n);const r=al(xe[4],"kml"),i="http://www.w3.org/2000/xmlns/";r.setAttributeNS(i,"xmlns:gx",Hs[0]),r.setAttributeNS(i,"xmlns:xsi",Jp),r.setAttributeNS(Jp,"xsi:schemaLocation",E8);const s={node:r},o={};e.length>1?o.Document=e:e.length==1&&(o.Placemark=e[0]);const a=P8[r.namespaceURI],l=ur(o,a);return dt(s,R8,$n,l,[n],a,this),r}}function O8(t,e){const n=[0,0];let r="start";const i=t.getImage();if(i){const a=i.getSize();if(a&&a.length==2){const l=i.getScaleArray(),c=i.getAnchor();n[0]=l[0]*(a[0]-c[0]),n[1]=l[1]*(a[1]/2-c[1]),r="left"}}let s=t.getText();return s?(s=s.clone(),s.setFont(s.getFont()||Ia.getFont()),s.setScale(s.getScale()||Ia.getScale()),s.setFill(s.getFill()||Ia.getFill()),s.setStroke(s.getStroke()||Mw)):s=Ia.clone(),s.setText(e),s.setOffsetX(n[0]),s.setOffsetY(n[1]),s.setTextAlign(r),new nt({image:i,text:s})}function $8(t,e,n,r,i){return function(s,o){let a=i,l="",c=[];if(a){const d=s.getGeometry();if(d)if(d instanceof Wr)c=d.getGeometriesArrayRecursive().filter(function(h){const f=h.getType();return f==="Point"||f==="MultiPoint"}),a=c.length>0;else{const h=d.getType();a=h==="Point"||h==="MultiPoint"}}a&&(l=s.get("name"),a=a&&!!l,a&&/&[^&]+;/.test(l)&&(Hf||(Hf=document.createElement("textarea")),Hf.innerHTML=l,l=Hf.value));let u=n;if(t?u=t:e&&(u=eL(e,n,r)),a){const d=O8(u[0],l);if(c.length>0){d.setGeometry(new Wr(c));const h=new nt({geometry:u[0].getGeometry(),image:null,fill:u[0].getFill(),stroke:u[0].getStroke(),text:null});return[d,h].concat(u.slice(1))}return d}return u}}function eL(t,e,n){return Array.isArray(t)?t:typeof t=="string"?eL(n[t],e,n):e}function yy(t){const e=Ci(t,!1),n=/^\s*#?\s*([0-9A-Fa-f]{8})\s*$/.exec(e);if(n){const r=n[1];return[parseInt(r.substr(6,2),16),parseInt(r.substr(4,2),16),parseInt(r.substr(2,2),16),parseInt(r.substr(0,2),16)/255]}}function tL(t){let e=Ci(t,!1);const n=[];e=e.replace(/\s*,\s*/g,",");const r=/^\s*([+\-]?\d*\.?\d+(?:e[+\-]?\d+)?),([+\-]?\d*\.?\d+(?:e[+\-]?\d+)?)(?:\s+|,|$)(?:([+\-]?\d*\.?\d+(?:e[+\-]?\d+)?)(?:\s+|$))?\s*/i;let i;for(;i=r.exec(e);){const s=parseFloat(i[1]),o=parseFloat(i[2]),a=i[3]?parseFloat(i[3]):0;n.push(s,o,a),e=e.substr(i[0].length)}if(e==="")return n}function nL(t){const e=Ci(t,!1).trim();let n=t.baseURI;return(!n||n=="about:blank")&&(n=window.location.href),n?new URL(e,n).href:e}function rL(t){const e=Ci(t,!1).trim().replace(/^(?!.*#)/,"#");let n=t.baseURI;return(!n||n=="about:blank")&&(n=window.location.href),n?new URL(e,n).href:e}function L8(t){const e=t.getAttribute("xunits"),n=t.getAttribute("yunits");let r;return e!=="insetPixels"?n!=="insetPixels"?r="bottom-left":r="top-left":n!=="insetPixels"?r="bottom-right":r="top-right",{x:parseFloat(t.getAttribute("x")),xunits:bP[e],y:parseFloat(t.getAttribute("y")),yunits:bP[n],origin:r}}function iL(t){return qe(t)}const k8=de(xe,{Pair:sV});function sL(t,e){return Ue(void 0,k8,t,e,this)}const M8=de(xe,{Icon:se(Z8),color:se(yy),heading:se(qe),hotSpot:se(L8),scale:se(iL)});function D8(t,e){const n=Ue({},M8,t,e);if(!n)return;const r=e[e.length-1],i="Icon"in n?n.Icon:{},s=!("Icon"in n)||Object.keys(i).length>0;let o;const a=i.href;a?o=a:s&&(o=em);let l,c,u,d="bottom-left";const h=n.hotSpot;h?(l=[h.x,h.y],c=h.xunits,u=h.yunits,d=h.origin):/^https?:\/\/maps\.(?:google|gstatic)\.com\//.test(o)&&(o.includes("pushpin")?(l=$w,c=Cd,u=Td):o.includes("arrow-reverse")?(l=[54,42],c=Cd,u=Td):o.includes("paddle")&&(l=[32,1],c=Cd,u=Td));let f;const p=i.x,m=i.y;p!==void 0&&m!==void 0&&(f=[p,m]);let _;const g=i.w,y=i.h;g!==void 0&&y!==void 0&&(_=[g,y]);let v;const w=n.heading;w!==void 0&&(v=or(w));const x=n.scale,S=n.color;if(s){o==em&&(_=Pd);const C=new Go({anchor:l,anchorOrigin:d,anchorXUnits:c,anchorYUnits:u,crossOrigin:this.crossOrigin_,offset:f,offsetOrigin:"bottom-left",rotation:v,scale:x,size:_,src:this.iconUrlFunction_(o),color:S}),T=C.getScaleArray()[0],P=C.getSize();if(P===null){const F=C.getImageState();if(F===ye.IDLE||F===ye.LOADING){const k=function(){const A=C.getImageState();if(!(A===ye.IDLE||A===ye.LOADING)){const M=C.getSize();if(M&&M.length==2){const b=tm(M);C.setScale(T*b)}C.unlistenImageChange(k)}};C.listenImageChange(k),F===ye.IDLE&&C.load()}}else if(P.length==2){const F=tm(P);C.setScale(T*F)}r.imageStyle=C}else r.imageStyle=xE}const N8=de(xe,{color:se(yy),scale:se(iL)});function j8(t,e){const n=Ue({},N8,t,e);if(!n)return;const r=e[e.length-1],i=new Zo({fill:new Wt({color:"color"in n?n.color:vc}),scale:n.scale});r.textStyle=i}const z8=de(xe,{color:se(yy),width:se(qe)});function U8(t,e){const n=Ue({},z8,t,e);if(!n)return;const r=e[e.length-1],i=new yt({color:"color"in n?n.color:vc,width:"width"in n?n.width:1});r.strokeStyle=i}const G8=de(xe,{color:se(yy),fill:se(Ho),outline:se(Ho)});function B8(t,e){const n=Ue({},G8,t,e);if(!n)return;const r=e[e.length-1],i=new Wt({color:"color"in n?n.color:vc});r.fillStyle=i;const s=n.fill;s!==void 0&&(r.fill=s);const o=n.outline;o!==void 0&&(r.outline=o)}const V8=de(xe,{coordinates:wE(tL)});function oL(t,e){return Ue(null,V8,t,e)}function W8(t,e){const r=e[e.length-1].coordinates,i=Ci(t,!1),o=/^\s*([+\-]?\d+(?:\.\d*)?(?:e[+\-]?\d*)?)\s+([+\-]?\d+(?:\.\d*)?(?:e[+\-]?\d*)?)\s+([+\-]?\d+(?:\.\d*)?(?:e[+\-]?\d*)?)\s*$/i.exec(i);if(o){const a=parseFloat(o[1]),l=parseFloat(o[2]),c=parseFloat(o[3]);r.push([a,l,c])}else r.push([])}const H8=de(Hs,{Track:di(aL)});function K8(t,e){const n=Ue([],H8,t,e);if(n)return new Ji(n)}const Y8=de(xe,{when:vV},de(Hs,{coord:W8}));function aL(t,e){const n=Ue({coordinates:[],whens:[]},Y8,t,e);if(!n)return;const r=[],i=n.coordinates,s=n.whens;for(let o=0,a=Math.min(i.length,s.length);o<a;++o)i[o].length==3&&r.push(i[o][0],i[o][1],i[o][2],s[o]);return new ar(r,"XYZM")}const X8=de(xe,{href:se(nL)},de(Hs,{x:se(qe),y:se(qe),w:se(qe),h:se(qe)}));function Z8(t,e){const n=Ue({},X8,t,e);return n||null}const q8=de(xe,{coordinates:wE(tL)});function EE(t,e){return Ue(null,q8,t,e)}const _y=de(xe,{extrude:se(Ho),tessellate:se(Ho),altitudeMode:se($e)});function lL(t,e){const n=Ue({},_y,t,e),r=EE(t,e);if(r){const i=new ar(r,"XYZ");return i.setProperties(n,!0),i}}function cL(t,e){const n=Ue({},_y,t,e),r=EE(t,e);if(r){const i=new lr(r,"XYZ",[r.length]);return i.setProperties(n,!0),i}}const J8=de(xe,{LineString:di(lL),LinearRing:di(cL),MultiGeometry:di(uL),Point:di(dL),Polygon:di(hL)});function uL(t,e){const n=Ue([],J8,t,e);if(!n)return null;if(n.length===0)return new Wr(n);let r,i=!0;const s=n[0].getType();let o;for(let a=1,l=n.length;a<l;++a)if(o=n[a],o.getType()!=s){i=!1;break}if(i){let a,l;if(s=="Point"){const c=n[0];a=c.getLayout(),l=c.getFlatCoordinates();for(let u=1,d=n.length;u<d;++u)o=n[u],We(l,o.getFlatCoordinates());r=new ol(l,a),b0(r,n)}else if(s=="LineString")r=new Ji(n),b0(r,n);else if(s=="Polygon")r=new Vo(n),b0(r,n);else if(s=="GeometryCollection"||s.startsWith("Multi"))r=new Wr(n);else throw new Error("Unknown geometry type found")}else r=new Wr(n);return r}function dL(t,e){const n=Ue({},_y,t,e),r=EE(t,e);if(r){const i=new Sn(r,"XYZ");return i.setProperties(n,!0),i}}const Q8=de(xe,{innerBoundaryIs:pV,outerBoundaryIs:yV});function hL(t,e){const n=Ue({},_y,t,e),r=Ue([null],Q8,t,e);if(r&&r[0]){const i=r[0],s=[i.length];for(let a=1,l=r.length;a<l;++a)We(i,r[a]),s.push(i.length);const o=new lr(i,"XYZ",s);return o.setProperties(n,!0),o}}const eV=de(xe,{IconStyle:D8,LabelStyle:j8,LineStyle:U8,PolyStyle:B8});function SE(t,e){const n=Ue({},eV,t,e,this);if(!n)return null;let r="fillStyle"in n?n.fillStyle:Ng;const i=n.fill;i!==void 0&&!i&&(r=null);let s;"imageStyle"in n?n.imageStyle!=xE&&(s=n.imageStyle):s=Lw;const o="textStyle"in n?n.textStyle:Ia,a="strokeStyle"in n?n.strokeStyle:kw,l=n.outline;return l!==void 0&&!l?[new nt({geometry:function(c){const u=c.getGeometry(),d=u.getType();if(d==="GeometryCollection"){const h=u;return new Wr(h.getGeometriesArrayRecursive().filter(function(f){const p=f.getType();return p!=="Polygon"&&p!=="MultiPolygon"}))}if(d!=="Polygon"&&d!=="MultiPolygon")return u},fill:r,image:s,stroke:a,text:o,zIndex:void 0}),new nt({geometry:function(c){const u=c.getGeometry(),d=u.getType();if(d==="GeometryCollection"){const h=u;return new Wr(h.getGeometriesArrayRecursive().filter(function(f){const p=f.getType();return p==="Polygon"||p==="MultiPolygon"}))}if(d==="Polygon"||d==="MultiPolygon")return u},fill:r,stroke:null,zIndex:void 0})]:[new nt({fill:r,image:s,stroke:a,text:o,zIndex:void 0})]}function b0(t,e){const n=e.length,r=new Array(e.length),i=new Array(e.length),s=new Array(e.length);let o,a,l;o=!1,a=!1,l=!1;for(let c=0;c<n;++c){const u=e[c];r[c]=u.get("extrude"),i[c]=u.get("tessellate"),s[c]=u.get("altitudeMode"),o=o||r[c]!==void 0,a=a||i[c]!==void 0,l=l||s[c]}o&&t.set("extrude",r),a&&t.set("tessellate",i),l&&t.set("altitudeMode",s)}const tV=de(xe,{displayName:se($e),value:se($e)});function nV(t,e){const n=t.getAttribute("name");Jo(tV,t,e);const r=e[e.length-1];n&&r.displayName?r[n]={value:r.value,displayName:r.displayName,toString:function(){return r.value}}:n!==null?r[n]=r.value:r.displayName!==null&&(r[r.displayName]=r.value),delete r.value}const rV=de(xe,{Data:nV,SchemaData:lV});function fL(t,e){Jo(rV,t,e)}function gL(t,e){Jo(Q$,t,e)}const iV=de(xe,{Style:se(SE),key:se($e),styleUrl:se(rL)});function sV(t,e){const n=Ue({},iV,t,e,this);if(!n)return;const r=n.key;if(r&&r=="normal"){const i=n.styleUrl;i&&(e[e.length-1]=i);const s=n.Style;s&&(e[e.length-1]=s)}}function oV(t,e){const n=sL.call(this,t,e);if(!n)return;const r=e[e.length-1];if(Array.isArray(n))r.Style=n;else if(typeof n=="string")r.styleUrl=n;else throw new Error("`styleMapValue` has an unknown type")}const aV=de(xe,{SimpleData:cV});function lV(t,e){Jo(aV,t,e)}function cV(t,e){const n=t.getAttribute("name");if(n!==null){const r=$e(t),i=e[e.length-1];i[n]=r}}const uV=de(xe,{altitudeMode:se($e),minAltitude:se(qe),maxAltitude:se(qe),north:se(qe),south:se(qe),east:se(qe),west:se(qe)});function dV(t,e){const n=Ue({},uV,t,e);if(!n)return;const r=e[e.length-1],i=[parseFloat(n.west),parseFloat(n.south),parseFloat(n.east),parseFloat(n.north)];r.extent=i,r.altitudeMode=n.altitudeMode,r.minAltitude=parseFloat(n.minAltitude),r.maxAltitude=parseFloat(n.maxAltitude)}const hV=de(xe,{minLodPixels:se(qe),maxLodPixels:se(qe),minFadeExtent:se(qe),maxFadeExtent:se(qe)});function fV(t,e){const n=Ue({},hV,t,e);if(!n)return;const r=e[e.length-1];r.minLodPixels=parseFloat(n.minLodPixels),r.maxLodPixels=parseFloat(n.maxLodPixels),r.minFadeExtent=parseFloat(n.minFadeExtent),r.maxFadeExtent=parseFloat(n.maxFadeExtent)}const gV=de(xe,{LinearRing:di(oL)});function pV(t,e){const n=Ue([],gV,t,e);n.length>0&&e[e.length-1].push(...n)}const mV=de(xe,{LinearRing:wE(oL)});function yV(t,e){const n=Ue(void 0,mV,t,e);if(n){const r=e[e.length-1];r[0]=n}}function _V(t,e){Jo(C8,t,e)}function vV(t,e){const r=e[e.length-1].whens,i=Ci(t,!1),s=Date.parse(i);r.push(isNaN(s)?0:s)}function vy(t,e){const n=Yr(e),i=[(n.length==4?n[3]:1)*255,n[2],n[1],n[0]];for(let s=0;s<4;++s){const o=Math.floor(i[s]).toString(16);i[s]=o.length==1?"0"+o:o}et(t,i.join(""))}function wV(t,e,n){const r=n[n.length-1],i=r.layout,s=r.stride;let o;if(i=="XY"||i=="XYM")o=2;else if(i=="XYZ"||i=="XYZM")o=3;else throw new Error("Invalid geometry layout");const a=e.length;let l="";if(a>0){l+=e[0];for(let c=1;c<o;++c)l+=","+e[c];for(let c=s;c<a;c+=s){l+=" "+e[c];for(let u=1;u<o;++u)l+=","+e[c+u]}}et(t,l)}const jg=de(xe,{Data:ae(xV),value:ae(SV),displayName:ae(EV)});function xV(t,e,n){t.setAttribute("name",e.name);const r={node:t},i=e.value;typeof i=="object"?(i!==null&&i.displayName&&dt(r,jg,$n,[i.displayName],n,["displayName"]),i!==null&&i.value&&dt(r,jg,$n,[i.value],n,["value"])):dt(r,jg,$n,[i],n,["value"])}function EV(t,e){et(t,e)}function SV(t,e){et(t,e)}const bV=de(xe,{Placemark:ae(yL)}),CV=function(t,e,n){const r=e[e.length-1].node;return al(r.namespaceURI,"Placemark")};function TV(t,e,n){dt({node:t},bV,CV,e,n,void 0,this)}const PV=Ti("Data");function RV(t,e,n){const r={node:t},i=e.names,s=e.values,o=i.length;for(let a=0;a<o;a++)dt(r,jg,PV,[{name:i[a],value:s[a]}],n)}const TP=de(xe,["href"],de(Hs,["x","y","w","h"])),PP=de(xe,{href:ae(et)},de(Hs,{x:ae(qn),y:ae(qn),w:ae(qn),h:ae(qn)})),IV=function(t,e,n){return al(Hs[0],"gx:"+n)};function AV(t,e,n){const r={node:t},i=n[n.length-1].node;let s=TP[i.namespaceURI],o=ur(e,s);dt(r,PP,$n,o,n,s),s=TP[Hs[0]],o=ur(e,s),dt(r,PP,IV,o,n,s)}const FV=de(xe,["scale","heading","Icon","color","hotSpot"]),OV=de(xe,{Icon:ae(AV),color:ae(vy),heading:ae(qn),hotSpot:ae(sW),scale:ae(vL)});function $V(t,e,n){const r={node:t},i={},s=e.getSrc(),o=e.getSize(),a=e.getImageSize(),l={href:s};if(o){l.w=o[0],l.h=o[1];const _=e.getAnchor(),g=e.getOrigin();if(g&&a&&g[0]!==0&&g[1]!==o[1]&&(l.x=g[0],l.y=a[1]-(g[1]+o[1])),_&&(_[0]!==o[0]/2||_[1]!==o[1]/2)){const y={x:_[0],xunits:"pixels",y:o[1]-_[1],yunits:"pixels"};i.hotSpot=y}}i.Icon=l;let c=e.getScaleArray()[0],u=o;if(u===null&&(u=Pd),u.length==2){const _=tm(u);c=c/_}c!==1&&(i.scale=c);const d=e.getRotation();d!==0&&(i.heading=d);const h=e.getColor();h&&(i.color=h);const f=n[n.length-1].node,p=FV[f.namespaceURI],m=ur(i,p);dt(r,OV,$n,m,n,p)}const LV=de(xe,["color","scale"]),kV=de(xe,{color:ae(vy),scale:ae(vL)});function MV(t,e,n){const r={node:t},i={},s=e.getFill();s&&(i.color=s.getColor());const o=e.getScale();o&&o!==1&&(i.scale=o);const a=n[n.length-1].node,l=LV[a.namespaceURI],c=ur(i,l);dt(r,kV,$n,c,n,l)}const DV=de(xe,["color","width"]),NV=de(xe,{color:ae(vy),width:ae(qn)});function jV(t,e,n){const r={node:t},i={color:e.getColor(),width:Number(e.getWidth())||1},s=n[n.length-1].node,o=DV[s.namespaceURI],a=ur(i,o);dt(r,NV,$n,a,n,o)}const zV={Point:"Point",LineString:"LineString",LinearRing:"LinearRing",Polygon:"Polygon",MultiPoint:"MultiGeometry",MultiLineString:"MultiGeometry",MultiPolygon:"MultiGeometry",GeometryCollection:"MultiGeometry"},pL=function(t,e,n){if(t){const r=e[e.length-1].node;return al(r.namespaceURI,zV[t.getType()])}},UV=Ti("Point"),GV=Ti("LineString"),BV=Ti("LinearRing"),VV=Ti("Polygon"),WV=de(xe,{LineString:ae(wc),Point:ae(wc),Polygon:ae(_L),GeometryCollection:ae(mL)});function mL(t,e,n){const r={node:t},i=e.getType();let s=[],o;if(i==="GeometryCollection")e.getGeometriesArrayRecursive().forEach(function(a){const l=a.getType();if(l==="MultiPoint")s=s.concat(a.getPoints());else if(l==="MultiLineString")s=s.concat(a.getLineStrings());else if(l==="MultiPolygon")s=s.concat(a.getPolygons());else if(l==="Point"||l==="LineString"||l==="Polygon")s.push(a);else throw new Error("Unknown geometry type")}),o=pL;else if(i==="MultiPoint")s=e.getPoints(),o=UV;else if(i==="MultiLineString")s=e.getLineStrings(),o=GV;else if(i==="MultiPolygon")s=e.getPolygons(),o=VV;else throw new Error("Unknown geometry type");dt(r,WV,o,s,n)}const HV=de(xe,{LinearRing:ae(wc)});function RP(t,e,n){dt({node:t},HV,BV,[e],n)}const C0=de(xe,{ExtendedData:ae(RV),MultiGeometry:ae(mL),LineString:ae(wc),LinearRing:ae(wc),Point:ae(wc),Polygon:ae(_L),Style:ae(iW),address:ae(et),description:ae(et),name:ae(et),open:ae(zc),phoneNumber:ae(et),styleUrl:ae(et),visibility:ae(zc)}),KV=de(xe,["name","open","visibility","address","phoneNumber","description","styleUrl","Style"]),YV=Ti("ExtendedData");function yL(t,e,n){const r={node:t};e.getId()&&t.setAttribute("id",e.getId());const i=e.getProperties(),s={address:1,description:1,name:1,open:1,phoneNumber:1,styleUrl:1,visibility:1};s[e.getGeometryName()]=1;const o=Object.keys(i||{}).sort().filter(function(f){return!s[f]}),a=e.getStyleFunction();if(a){const f=a(e,0);if(f){const p=Array.isArray(f)?f:[f];let m=p;if(e.getGeometry()&&(m=p.filter(function(_){const g=_.getGeometryFunction()(e);if(g){const y=g.getType();return y==="GeometryCollection"?g.getGeometriesArrayRecursive().filter(function(v){const w=v.getType();return w==="Point"||w==="MultiPoint"}).length:y==="Point"||y==="MultiPoint"}})),this.writeStyles_){let _=p,g=p;e.getGeometry()&&(_=p.filter(function(y){const v=y.getGeometryFunction()(e);if(v){const w=v.getType();return w==="GeometryCollection"?v.getGeometriesArrayRecursive().filter(function(x){const S=x.getType();return S==="LineString"||S==="MultiLineString"}).length:w==="LineString"||w==="MultiLineString"}}),g=p.filter(function(y){const v=y.getGeometryFunction()(e);if(v){const w=v.getType();return w==="GeometryCollection"?v.getGeometriesArrayRecursive().filter(function(x){const S=x.getType();return S==="Polygon"||S==="MultiPolygon"}).length:w==="Polygon"||w==="MultiPolygon"}})),i.Style={pointStyles:m,lineStyles:_,polyStyles:g}}if(m.length&&i.name===void 0){const _=m[0].getText();_&&(i.name=_.getText())}}}const l=n[n.length-1].node,c=KV[l.namespaceURI],u=ur(i,c);if(dt(r,C0,$n,u,n,c),o.length>0){const f=ur(i,o);dt(r,C0,YV,[{names:o,values:f}],n)}const d=n[0];let h=e.getGeometry();h&&(h=Qr(h,!0,d)),dt(r,C0,pL,[h],n)}const XV=de(xe,["extrude","tessellate","altitudeMode","coordinates"]),ZV=de(xe,{extrude:ae(zc),tessellate:ae(zc),altitudeMode:ae(et),coordinates:ae(wV)});function wc(t,e,n){const r=e.getFlatCoordinates(),i={node:t};i.layout=e.getLayout(),i.stride=e.getStride();const s=e.getProperties();s.coordinates=r;const o=n[n.length-1].node,a=XV[o.namespaceURI],l=ur(s,a);dt(i,ZV,$n,l,n,a)}const qV=de(xe,["color","fill","outline"]),IP=de(xe,{outerBoundaryIs:ae(RP),innerBoundaryIs:ae(RP)}),JV=Ti("innerBoundaryIs"),QV=Ti("outerBoundaryIs");function _L(t,e,n){const r=e.getLinearRings(),i=r.shift(),s={node:t};dt(s,IP,JV,r,n),dt(s,IP,QV,[i],n)}const eW=de(xe,{color:ae(vy),fill:ae(zc),outline:ae(zc)});function tW(t,e,n){const r={node:t},i=e.getFill(),s=e.getStroke(),o={color:i?i.getColor():void 0,fill:i?void 0:!1,outline:s?void 0:!1},a=n[n.length-1].node,l=qV[a.namespaceURI],c=ur(o,l);dt(r,eW,$n,c,n,l)}function vL(t,e){qn(t,Math.round(e*1e6)/1e6)}const nW=de(xe,["IconStyle","LabelStyle","LineStyle","PolyStyle"]),rW=de(xe,{IconStyle:ae($V),LabelStyle:ae(MV),LineStyle:ae(jV),PolyStyle:ae(tW)});function iW(t,e,n){const r={node:t},i={};if(e.pointStyles.length){const l=e.pointStyles[0].getText();l&&(i.LabelStyle=l);const c=e.pointStyles[0].getImage();c&&typeof c.getSrc=="function"&&(i.IconStyle=c)}if(e.lineStyles.length){const l=e.lineStyles[0].getStroke();l&&(i.LineStyle=l)}if(e.polyStyles.length){const l=e.polyStyles[0].getStroke();l&&!i.LineStyle&&(i.LineStyle=l),i.PolyStyle=e.polyStyles[0]}const s=n[n.length-1].node,o=nW[s.namespaceURI],a=ur(i,o);dt(r,rW,$n,a,n,o)}function sW(t,e){t.setAttribute("x",String(e.x)),t.setAttribute("y",String(e.y)),t.setAttribute("xunits",e.xunits),t.setAttribute("yunits",e.yunits)}const Tt=[null,"http://www.topografix.com/GPX/1/0","http://www.topografix.com/GPX/1/1"],oW="http://www.topografix.com/GPX/1/1 http://www.topografix.com/GPX/1/1/gpx.xsd",aW={rte:xL,trk:EL,wpt:SL},lW=de(Tt,{rte:di(xL),trk:di(EL),wpt:di(SL)}),cW=de(Tt,{text:se($e,"linkText"),type:se($e,"linkType")}),uW=de(Tt,{name:se($e),email:MW,link:Vh}),dW=de(Tt,{name:se($e),desc:se($e),author:se($W),copyright:se(LW),link:Vh,time:se(my),keywords:se($e),bounds:kW,extensions:wy}),hW=de(Tt,{year:se(ph),license:se($e)}),fW=de(Tt,{rte:ae(zW),trk:ae(UW),wpt:ae(BW)});class wL extends J${constructor(e){super(),e=e||{},this.dataProjection=Ne("EPSG:4326"),this.readExtensions_=e.readExtensions}handleReadExtensions_(e){e||(e=[]);for(let n=0,r=e.length;n<r;++n){const i=e[n];if(this.readExtensions_){const s=i.get("extensionsNode_")||null;this.readExtensions_(i,s)}i.set("extensionsNode_",void 0)}}readMetadata(e){return e?typeof e=="string"?this.readMetadataFromDocument(Ss(e)):Es(e)?this.readMetadataFromDocument(e):this.readMetadataFromNode(e):null}readMetadataFromDocument(e){for(let n=e.firstChild;n;n=n.nextSibling)if(n.nodeType===Node.ELEMENT_NODE){const r=this.readMetadataFromNode(n);if(r)return r}return null}readMetadataFromNode(e){if(!Tt.includes(e.namespaceURI))return null;for(let n=e.firstElementChild;n;n=n.nextElementSibling)if(Tt.includes(n.namespaceURI)&&n.localName==="metadata")return Ue({},dW,n,[]);return null}readFeatureFromNode(e,n){if(!Tt.includes(e.namespaceURI))return null;const r=aW[e.localName];if(!r)return null;const i=r(e,[this.getReadOptions(e,n)]);return i?(this.handleReadExtensions_([i]),i):null}readFeaturesFromNode(e,n){if(!Tt.includes(e.namespaceURI))return[];if(e.localName=="gpx"){const r=Ue([],lW,e,[this.getReadOptions(e,n)]);return r?(this.handleReadExtensions_(r),r):[]}return[]}writeFeaturesNode(e,n){n=this.adaptOptions(n);const r=al("http://www.topografix.com/GPX/1/1","gpx");return r.setAttributeNS("http://www.w3.org/2000/xmlns/","xmlns:xsi",Jp),r.setAttributeNS(Jp,"xsi:schemaLocation",oW),r.setAttribute("version","1.1"),r.setAttribute("creator","OpenLayers"),dt({node:r},fW,OW,e,[n]),r}}const gW=de(Tt,{name:se($e),cmt:se($e),desc:se($e),src:se($e),link:Vh,number:se(ph),extensions:wy,type:se($e),rtept:DW}),pW=de(Tt,{ele:se(qe),time:se(my)}),mW=de(Tt,{name:se($e),cmt:se($e),desc:se($e),src:se($e),link:Vh,number:se(ph),type:se($e),extensions:wy,trkseg:jW}),yW=de(Tt,{trkpt:NW}),_W=de(Tt,{ele:se(qe),time:se(my)}),vW=de(Tt,{ele:se(qe),time:se(my),magvar:se(qe),geoidheight:se(qe),name:se($e),cmt:se($e),desc:se($e),src:se($e),link:Vh,sym:se($e),type:se($e),fix:se($e),sat:se(ph),hdop:se(qe),vdop:se(qe),pdop:se(qe),ageofdgpsdata:se(qe),dgpsid:se(ph),extensions:wy}),wW=["text","type"],xW=de(Tt,{text:ae(et),type:ae(et)}),EW=de(Tt,["name","cmt","desc","src","link","number","type","rtept"]),SW=de(Tt,{name:ae(et),cmt:ae(et),desc:ae(et),src:ae(et),link:ae(TE),number:ae(Qp),type:ae(et),rtept:Z$(ae(PE))}),bW=de(Tt,["ele","time"]),CW=de(Tt,["name","cmt","desc","src","link","number","type","trkseg"]),TW=de(Tt,{name:ae(et),cmt:ae(et),desc:ae(et),src:ae(et),link:ae(TE),number:ae(Qp),type:ae(et),trkseg:Z$(ae(GW))}),PW=Ti("trkpt"),RW=de(Tt,{trkpt:ae(PE)}),IW=de(Tt,["ele","time","magvar","geoidheight","name","cmt","desc","src","link","sym","type","fix","sat","hdop","vdop","pdop","ageofdgpsdata","dgpsid"]),AW=de(Tt,{ele:ae(qn),time:ae(_8),magvar:ae(qn),geoidheight:ae(qn),name:ae(et),cmt:ae(et),desc:ae(et),src:ae(et),link:ae(TE),sym:ae(et),type:ae(et),fix:ae(et),sat:ae(Qp),hdop:ae(qn),vdop:ae(qn),pdop:ae(qn),ageofdgpsdata:ae(qn),dgpsid:ae(Qp)}),FW={Point:"wpt",LineString:"rte",MultiLineString:"trk"};function OW(t,e,n){const r=t.getGeometry();if(r){const i=FW[r.getType()];if(i){const s=e[e.length-1].node;return al(s.namespaceURI,i)}}}function bE(t,e,n,r){return t.push(parseFloat(n.getAttribute("lon")),parseFloat(n.getAttribute("lat"))),"ele"in r?(t.push(r.ele),delete r.ele,e.hasZ=!0):t.push(0),"time"in r?(t.push(r.time),delete r.time,e.hasM=!0):t.push(0),t}function CE(t,e,n){let r="XY",i=2;if(t.hasZ&&t.hasM?(r="XYZM",i=4):t.hasZ?(r="XYZ",i=3):t.hasM&&(r="XYM",i=3),i!==4){for(let s=0,o=e.length/4;s<o;s++)e[s*i]=e[s*4],e[s*i+1]=e[s*4+1],t.hasZ&&(e[s*i+2]=e[s*4+2]),t.hasM&&(e[s*i+2]=e[s*4+3]);if(e.length=e.length/4*i,n)for(let s=0,o=n.length;s<o;s++)n[s]=n[s]/4*i}return r}function $W(t,e){const n=Ue({},uW,t,e);if(n)return n}function LW(t,e){const n=Ue({},hW,t,e);if(n){const r=t.getAttribute("author");return r!==null&&(n.author=r),n}}function kW(t,e){const n=e[e.length-1],r=t.getAttribute("minlat"),i=t.getAttribute("minlon"),s=t.getAttribute("maxlat"),o=t.getAttribute("maxlon");i!==null&&r!==null&&o!==null&&s!==null&&(n.bounds=[[parseFloat(i),parseFloat(r)],[parseFloat(o),parseFloat(s)]])}function MW(t,e){const n=e[e.length-1],r=t.getAttribute("id"),i=t.getAttribute("domain");r!==null&&i!==null&&(n.email=`${r}@${i}`)}function Vh(t,e){const n=e[e.length-1],r=t.getAttribute("href");r!==null&&(n.link=r),Jo(cW,t,e)}function wy(t,e){const n=e[e.length-1];n.extensionsNode_=t}function DW(t,e){const n=Ue({},pW,t,e);if(n){const r=e[e.length-1],i=r.flatCoordinates,s=r.layoutOptions;bE(i,s,t,n)}}function NW(t,e){const n=Ue({},_W,t,e);if(n){const r=e[e.length-1],i=r.flatCoordinates,s=r.layoutOptions;bE(i,s,t,n)}}function jW(t,e){const n=e[e.length-1];Jo(yW,t,e);const r=n.flatCoordinates;n.ends.push(r.length)}function xL(t,e){const n=e[0],r=Ue({flatCoordinates:[],layoutOptions:{}},gW,t,e);if(!r)return;const i=r.flatCoordinates;delete r.flatCoordinates;const s=r.layoutOptions;delete r.layoutOptions;const o=CE(s,i),a=new ar(i,o);Qr(a,!1,n);const l=new en(a);return l.setProperties(r,!0),l}function EL(t,e){const n=e[0],r=Ue({flatCoordinates:[],ends:[],layoutOptions:{}},mW,t,e);if(!r)return;const i=r.flatCoordinates;delete r.flatCoordinates;const s=r.ends;delete r.ends;const o=r.layoutOptions;delete r.layoutOptions;const a=CE(o,i,s),l=new Ji(i,a,s);Qr(l,!1,n);const c=new en(l);return c.setProperties(r,!0),c}function SL(t,e){const n=e[0],r=Ue({},vW,t,e);if(!r)return;const i={},s=bE([],i,t,r),o=CE(i,s),a=new Sn(s,o);Qr(a,!1,n);const l=new en(a);return l.setProperties(r,!0),l}function TE(t,e,n){t.setAttribute("href",e);const i=n[n.length-1].properties,s=[i.linkText,i.linkType];dt({node:t},xW,$n,s,n,wW)}function PE(t,e,n){const r=n[n.length-1],s=r.node.namespaceURI,o=r.properties;switch(t.setAttributeNS(null,"lat",String(e[1])),t.setAttributeNS(null,"lon",String(e[0])),r.geometryLayout){case"XYZM":e[3]!==0&&(o.time=e[3]);case"XYZ":e[2]!==0&&(o.ele=e[2]);break;case"XYM":e[2]!==0&&(o.time=e[2]);break}const l=t.nodeName=="rtept"?bW[s]:IW[s],c=ur(o,l);dt({node:t,properties:o},AW,$n,c,n,l)}function zW(t,e,n){const r=n[0],i=e.getProperties(),s={node:t};s.properties=i;const o=e.getGeometry();if(o.getType()=="LineString"){const u=Qr(o,!0,r);s.geometryLayout=u.getLayout(),i.rtept=u.getCoordinates()}const a=n[n.length-1].node,l=EW[a.namespaceURI],c=ur(i,l);dt(s,SW,$n,c,n,l)}function UW(t,e,n){const r=n[0],i=e.getProperties(),s={node:t};s.properties=i;const o=e.getGeometry();if(o.getType()=="MultiLineString"){const u=Qr(o,!0,r);i.trkseg=u.getLineStrings()}const a=n[n.length-1].node,l=CW[a.namespaceURI],c=ur(i,l);dt(s,TW,$n,c,n,l)}function GW(t,e,n){const r={node:t};r.geometryLayout=e.getLayout(),r.properties={},dt(r,RW,PW,e.getCoordinates(),n)}function BW(t,e,n){const r=n[0],i=n[n.length-1];i.properties=e.getProperties();const s=e.getGeometry();if(s.getType()=="Point"){const o=Qr(s,!0,r);i.geometryLayout=o.getLayout(),PE(t,o.getCoordinates(),n)}}function So(t,e){const n=t.length;return e<0?t[e+n]:e>=n?t[e-n]:t[e]}function ic(t,e){const n=t.length;let r=Math.floor(e);const i=e-r;r>=n?r-=n:r<0&&(r+=n);let s=r+1;s>=n&&(s-=n);const o=t[r],a=o[0],l=o[1],c=t[s],u=c[0]-a,d=c[1]-l;return[a+u*i,l+d*i]}const Kf={index:-1,endIndex:NaN,closestTargetDistance:1/0};function bL(t,e,n,r){const i=t[0],s=t[1];let o=1/0,a=-1,l=NaN;for(let d=0;d<e.targets.length;++d){const h=e.targets[d],f=h.coordinates;let p=1/0,m;for(let _=0;_<f.length-1;++_){const g=f[_],y=f[_+1],v=PL(i,s,g,y);v.squaredDistance<p&&(p=v.squaredDistance,m=_+v.along)}p<o&&(o=p,h.ring&&e.targetIndex===d&&(h.endIndex>h.startIndex?m<h.startIndex&&(m+=f.length):h.endIndex<h.startIndex&&m>h.startIndex&&(m-=f.length)),l=m,a=d)}const c=e.targets[a];let u=c.ring;if(e.targetIndex===a&&u){const d=ic(c.coordinates,l),h=n.getPixelFromCoordinate(d),f=n.getPixelFromCoordinate(e.startCoord);ec(h,f)>r&&(u=!1)}if(u){const d=c.coordinates,h=d.length,f=c.startIndex,p=l;if(f<p){const m=Zf(d,f,p);Zf(d,f,p-h)<m&&(l-=h)}else{const m=Zf(d,f,p);Zf(d,f,p+h)<m&&(l+=h)}}return Kf.index=a,Kf.endIndex=l,Kf.closestTargetDistance=o,Kf}function CL(t,e){const n=[];for(let r=0;r<e.length;++r){const s=e[r].getGeometry();TL(t,s,n)}return n}function TL(t,e,n){if(e instanceof ar){Yf(t,e.getCoordinates(),!1,n);return}if(e instanceof Ji){const r=e.getCoordinates();for(let i=0,s=r.length;i<s;++i)Yf(t,r[i],!1,n);return}if(e instanceof lr){const r=e.getCoordinates();for(let i=0,s=r.length;i<s;++i)Yf(t,r[i],!0,n);return}if(e instanceof Vo){const r=e.getCoordinates();for(let i=0,s=r.length;i<s;++i){const o=r[i];for(let a=0,l=o.length;a<l;++a)Yf(t,o[a],!0,n)}return}if(e instanceof Wr){const r=e.getGeometries();for(let i=0;i<r.length;++i)TL(t,r[i],n);return}}function Yf(t,e,n,r){const i=t[0],s=t[1];for(let o=0,a=e.length-1;o<a;++o){const l=e[o],c=e[o+1],u=PL(i,s,l,c);if(u.squaredDistance===0){const d=o+u.along;r.push({coordinates:e,ring:n,startIndex:d,endIndex:d});return}}}function Xf(t,e){return Ts(t[0],t[1],e[0],e[1])}function Zf(t,e,n){let r,i;e<n?(r=e,i=n):(r=n,i=e);const s=Math.ceil(r),o=Math.floor(i);if(s>o){const l=ic(t,r),c=ic(t,i);return Xf(l,c)}let a=0;if(r<s){const l=ic(t,r),c=So(t,s);a+=Xf(l,c)}if(o<i){const l=So(t,o),c=ic(t,i);a+=Xf(l,c)}for(let l=s;l<o-1;++l){const c=So(t,l),u=So(t,l+1);a+=Xf(c,u)}return a}const T0={along:0,squaredDistance:0};function PL(t,e,n,r){const i=n[0],s=n[1],o=r[0],a=r[1],l=o-i,c=a-s;let u=0,d=i,h=s;return(l!==0||c!==0)&&(u=ct(((t-i)*l+(e-s)*c)/(l*l+c*c),0,1),d+=l*u,h+=c*u),T0.along=u,T0.squaredDistance=tu(Ts(t,e,d,h),10),T0}const qf={DRAWSTART:"drawstart",DRAWEND:"drawend",DRAWABORT:"drawabort"};class Jf extends Cr{constructor(e,n){super(e),this.feature=n}}class Qo extends il{constructor(e){const n=e;n.stopDown||(n.stopDown=nu),super(n),this.on,this.once,this.un,this.options_=e,this.shouldHandle_=!1,this.downPx_=null,this.downTimeout_,this.lastDragTime_,this.pointerType_,this.freehand_=!1,this.source_=e.source?e.source:null,this.features_=e.features?e.features:null,this.snapTolerance_=e.snapTolerance?e.snapTolerance:12,this.type_=e.type,this.mode_=WW(this.type_),this.stopClick_=!!e.stopClick,this.ignoreNextUpEvent_=!1,this.minPoints_=e.minPoints?e.minPoints:this.mode_==="Polygon"?3:2,this.maxPoints_=this.mode_==="Circle"?2:e.maxPoints?e.maxPoints:1/0,this.finishCondition_=e.finishCondition?e.finishCondition:zo,this.geometryLayout_=e.geometryLayout?e.geometryLayout:"XY";let r=e.geometryFunction;if(!r){const i=this.mode_;if(i==="Circle")r=(s,o,a)=>{const l=o||new py([NaN,NaN]),c=Ot(s[0]),u=Dc(c,Ot(s[s.length-1]));return l.setCenterAndRadius(c,Math.sqrt(u),this.geometryLayout_),l};else{let s;i==="Point"?s=Sn:i==="LineString"?s=ar:i==="Polygon"&&(s=lr),r=(o,a,l)=>(a?i==="Polygon"?o[0].length?a.setCoordinates([o[0].concat([o[0][0]])],this.geometryLayout_):a.setCoordinates([],this.geometryLayout_):a.setCoordinates(o,this.geometryLayout_):a=new s(o,this.geometryLayout_),a)}}this.geometryFunction_=r,this.dragVertexDelay_=e.dragVertexDelay!==void 0?e.dragVertexDelay:500,this.finishCoordinate_=null,this.sketchFeature_=null,this.sketchPoint_=null,this.sketchCoords_=null,this.sketchLine_=null,this.sketchLineCoords_=null,this.squaredClickTolerance_=e.clickTolerance?e.clickTolerance*e.clickTolerance:36,this.overlay_=new Pr({source:new Cn({useSpatialIndex:!1,wrapX:e.wrapX?e.wrapX:!1}),style:e.style?e.style:VW(),updateWhileInteracting:!0}),this.geometryName_=e.geometryName,this.condition_=e.condition?e.condition:q1,this.freehandCondition_,e.freehand?this.freehandCondition_=mc:this.freehandCondition_=e.freehandCondition?e.freehandCondition:Up,this.traceCondition_,this.setTrace(e.trace||!1),this.traceState_={active:!1},this.traceSource_=e.traceSource||e.source||null,this.addChangeListener(ww.ACTIVE,this.updateState_)}setTrace(e){let n;e?e===!0?n=mc:n=e:n=zp,this.traceCondition_=n}setMap(e){super.setMap(e),this.updateState_()}setFreehand(e){this.freehand_=e,this.freehand_?this.freehandCondition_=mc:this.freehandCondition_=this.options_&&this.options_.freehandCondition?this.options_.freehandCondition:Up}getOverlay(){return this.overlay_}getFreehand(){return this.freehand_}handleEvent(e){e.originalEvent.type===Se.CONTEXTMENU&&e.originalEvent.preventDefault(),this.freehand_=this.mode_!=="Point"&&this.freehandCondition_(e);let n=e.type===Be.POINTERMOVE,r=!0;return!this.freehand_&&this.lastDragTime_&&e.type===Be.POINTERDRAG&&(Date.now()-this.lastDragTime_>=this.dragVertexDelay_?(this.downPx_=e.pixel,this.shouldHandle_=!this.freehand_,n=!0):this.lastDragTime_=void 0,this.shouldHandle_&&this.downTimeout_!==void 0&&(clearTimeout(this.downTimeout_),this.downTimeout_=void 0)),this.freehand_&&e.type===Be.POINTERDRAG&&this.sketchFeature_!==null?(this.addToDrawing_(e.coordinate),r=!1):this.freehand_&&e.type===Be.POINTERDOWN?r=!1:n&&this.getPointerCount()<2?(r=e.type===Be.POINTERMOVE,r&&this.freehand_?(this.handlePointerMove_(e),this.shouldHandle_&&e.originalEvent.preventDefault()):(e.originalEvent.pointerType==="mouse"||e.type===Be.POINTERDRAG&&this.downTimeout_===void 0)&&this.handlePointerMove_(e)):e.type===Be.DBLCLICK&&(r=!1),super.handleEvent(e)&&r}handleDownEvent(e){return this.shouldHandle_=!this.freehand_,this.freehand_?(this.downPx_=e.pixel,this.finishCoordinate_||this.startDrawing_(e.coordinate),!0):this.condition_(e)?(this.lastDragTime_=Date.now(),this.downTimeout_=setTimeout(()=>{this.handlePointerMove_(new ps(Be.POINTERMOVE,e.map,e.originalEvent,!1,e.frameState))},this.dragVertexDelay_),this.downPx_=e.pixel,!0):(this.lastDragTime_=void 0,!1)}deactivateTrace_(){this.traceState_={active:!1}}toggleTraceState_(e){if(!this.traceSource_||!this.traceCondition_(e))return;if(this.traceState_.active){this.deactivateTrace_();return}const n=this.getMap(),r=n.getCoordinateFromPixel([e.pixel[0]-this.snapTolerance_,e.pixel[1]+this.snapTolerance_]),i=n.getCoordinateFromPixel([e.pixel[0]+this.snapTolerance_,e.pixel[1]-this.snapTolerance_]),s=_n([r,i]),o=this.traceSource_.getFeaturesInExtent(s);if(o.length===0)return;const a=CL(e.coordinate,o);a.length&&(this.traceState_={active:!0,startCoord:e.coordinate.slice(),targets:a,targetIndex:-1})}addOrRemoveTracedCoordinates_(e,n){const r=e.startIndex<=e.endIndex,i=e.startIndex<=n;r===i?r&&n>e.endIndex||!r&&n<e.endIndex?this.addTracedCoordinates_(e,e.endIndex,n):(r&&n<e.endIndex||!r&&n>e.endIndex)&&this.removeTracedCoordinates_(n,e.endIndex):(this.removeTracedCoordinates_(e.startIndex,e.endIndex),this.addTracedCoordinates_(e,e.startIndex,n))}removeTracedCoordinates_(e,n){if(e===n)return;let r=0;if(e<n){const i=Math.ceil(e);let s=Math.floor(n);s===n&&(s-=1),r=s-i+1}else{const i=Math.floor(e);let s=Math.ceil(n);s===n&&(s+=1),r=i-s+1}r>0&&this.removeLastPoints_(r)}addTracedCoordinates_(e,n,r){if(n===r)return;const i=[];if(n<r){const s=Math.ceil(n);let o=Math.floor(r);o===r&&(o-=1);for(let a=s;a<=o;++a)i.push(So(e.coordinates,a))}else{const s=Math.floor(n);let o=Math.ceil(r);o===r&&(o+=1);for(let a=s;a>=o;--a)i.push(So(e.coordinates,a))}i.length&&this.appendCoordinates(i)}updateTrace_(e){const n=this.traceState_;if(!n.active)return;if(n.targetIndex===-1){const a=e.map.getPixelFromCoordinate(n.startCoord);if(ec(a,e.pixel)<this.snapTolerance_)return}const r=bL(e.coordinate,n,this.getMap(),this.snapTolerance_);if(n.targetIndex!==r.index){if(n.targetIndex!==-1){const l=n.targets[n.targetIndex];this.removeTracedCoordinates_(l.startIndex,l.endIndex)}const a=n.targets[r.index];this.addTracedCoordinates_(a,a.startIndex,r.endIndex)}else{const a=n.targets[n.targetIndex];this.addOrRemoveTracedCoordinates_(a,r.endIndex)}n.targetIndex=r.index;const i=n.targets[n.targetIndex];i.endIndex=r.endIndex;const s=ic(i.coordinates,i.endIndex),o=this.getMap().getPixelFromCoordinate(s);e.coordinate=s,e.pixel=[Math.round(o[0]),Math.round(o[1])]}handleDragEvent(e){this.ignoreNextUpEvent_=!0,super.handleDragEvent(e)}handleUpEvent(e){let n=!0;if(this.getPointerCount()===0){this.downTimeout_&&(clearTimeout(this.downTimeout_),this.downTimeout_=void 0),this.handlePointerMove_(e);const r=this.traceState_.active;if(this.ignoreNextUpEvent_||this.toggleTraceState_(e),this.shouldHandle_){const i=!this.finishCoordinate_;i&&this.startDrawing_(e.coordinate),!i&&this.freehand_?this.finishDrawing():!this.freehand_&&(!i||this.mode_==="Point")&&(this.atFinish_(e.pixel,r)?this.finishCondition_(e)&&this.finishDrawing():this.addToDrawing_(e.coordinate)),n=!1}else this.freehand_&&this.abortDrawing()}return this.ignoreNextUpEvent_=!1,!n&&this.stopClick_&&e.preventDefault(),n}handlePointerMove_(e){if(this.pointerType_=e.originalEvent.pointerType,this.downPx_&&(!this.freehand_&&this.shouldHandle_||this.freehand_&&!this.shouldHandle_)){const n=this.downPx_,r=e.pixel,i=n[0]-r[0],s=n[1]-r[1],o=i*i+s*s;if(this.shouldHandle_=this.freehand_?o>this.squaredClickTolerance_:o<=this.squaredClickTolerance_,!this.shouldHandle_)return}if(!this.finishCoordinate_){this.createOrUpdateSketchPoint_(e.coordinate.slice());return}this.updateTrace_(e),this.modifyDrawing_(e.coordinate)}atFinish_(e,n){let r=!1;if(this.sketchFeature_){let i=!1,s=[this.finishCoordinate_];const o=this.mode_;if(o==="Point")r=!0;else if(o==="Circle")r=this.sketchCoords_.length===2;else if(o==="LineString")i=!n&&this.sketchCoords_.length>this.minPoints_;else if(o==="Polygon"){const a=this.sketchCoords_;i=a[0].length>this.minPoints_,s=[a[0][0],a[0][a[0].length-2]],n?s=[a[0][0]]:s=[a[0][0],a[0][a[0].length-2]]}if(i){const a=this.getMap();for(let l=0,c=s.length;l<c;l++){const u=s[l],d=a.getPixelFromCoordinate(u),h=e[0]-d[0],f=e[1]-d[1],p=this.freehand_?1:this.snapTolerance_;if(r=Math.sqrt(h*h+f*f)<=p,r){this.finishCoordinate_=u;break}}}}return r}createOrUpdateSketchPoint_(e){this.sketchPoint_?this.sketchPoint_.getGeometry().setCoordinates(e):(this.sketchPoint_=new en(new Sn(e)),this.updateSketchFeatures_())}createOrUpdateCustomSketchLine_(e){this.sketchLine_||(this.sketchLine_=new en);const n=e.getLinearRing(0);let r=this.sketchLine_.getGeometry();r?(r.setFlatCoordinates(n.getLayout(),n.getFlatCoordinates()),r.changed()):(r=new ar(n.getFlatCoordinates(),n.getLayout()),this.sketchLine_.setGeometry(r))}startDrawing_(e){const n=this.getMap().getView().getProjection(),r=Np(this.geometryLayout_);for(;e.length<r;)e.push(0);this.finishCoordinate_=e,this.mode_==="Point"?this.sketchCoords_=e.slice():this.mode_==="Polygon"?(this.sketchCoords_=[[e.slice(),e.slice()]],this.sketchLineCoords_=this.sketchCoords_[0]):this.sketchCoords_=[e.slice(),e.slice()],this.sketchLineCoords_&&(this.sketchLine_=new en(new ar(this.sketchLineCoords_)));const i=this.geometryFunction_(this.sketchCoords_,void 0,n);this.sketchFeature_=new en,this.geometryName_&&this.sketchFeature_.setGeometryName(this.geometryName_),this.sketchFeature_.setGeometry(i),this.updateSketchFeatures_(),this.dispatchEvent(new Jf(qf.DRAWSTART,this.sketchFeature_))}modifyDrawing_(e){const n=this.getMap(),r=this.sketchFeature_.getGeometry(),i=n.getView().getProjection(),s=Np(this.geometryLayout_);let o,a;for(;e.length<s;)e.push(0);this.mode_==="Point"?a=this.sketchCoords_:this.mode_==="Polygon"?(o=this.sketchCoords_[0],a=o[o.length-1],this.atFinish_(n.getPixelFromCoordinate(e))&&(e=this.finishCoordinate_.slice())):(o=this.sketchCoords_,a=o[o.length-1]),a[0]=e[0],a[1]=e[1],this.geometryFunction_(this.sketchCoords_,r,i),this.sketchPoint_&&this.sketchPoint_.getGeometry().setCoordinates(e),r.getType()==="Polygon"&&this.mode_!=="Polygon"?this.createOrUpdateCustomSketchLine_(r):this.sketchLineCoords_&&this.sketchLine_.getGeometry().setCoordinates(this.sketchLineCoords_),this.updateSketchFeatures_()}addToDrawing_(e){const n=this.sketchFeature_.getGeometry(),r=this.getMap().getView().getProjection();let i,s;const o=this.mode_;return o==="LineString"||o==="Circle"?(this.finishCoordinate_=e.slice(),s=this.sketchCoords_,s.length>=this.maxPoints_&&(this.freehand_?s.pop():i=!0),s.push(e.slice()),this.geometryFunction_(s,n,r)):o==="Polygon"&&(s=this.sketchCoords_[0],s.length>=this.maxPoints_&&(this.freehand_?s.pop():i=!0),s.push(e.slice()),i&&(this.finishCoordinate_=s[0]),this.geometryFunction_(this.sketchCoords_,n,r)),this.createOrUpdateSketchPoint_(e.slice()),this.updateSketchFeatures_(),i?this.finishDrawing():this.sketchFeature_}removeLastPoints_(e){if(!this.sketchFeature_)return;const n=this.sketchFeature_.getGeometry(),r=this.getMap().getView().getProjection(),i=this.mode_;for(let s=0;s<e;++s){let o;if(i==="LineString"||i==="Circle"){if(o=this.sketchCoords_,o.splice(-2,1),o.length>=2){this.finishCoordinate_=o[o.length-2].slice();const a=this.finishCoordinate_.slice();o[o.length-1]=a,this.createOrUpdateSketchPoint_(a)}this.geometryFunction_(o,n,r),n.getType()==="Polygon"&&this.sketchLine_&&this.createOrUpdateCustomSketchLine_(n)}else if(i==="Polygon"){o=this.sketchCoords_[0],o.splice(-2,1);const a=this.sketchLine_.getGeometry();if(o.length>=2){const l=o[o.length-2].slice();o[o.length-1]=l,this.createOrUpdateSketchPoint_(l)}a.setCoordinates(o),this.geometryFunction_(this.sketchCoords_,n,r)}if(o.length===1){this.abortDrawing();break}}this.updateSketchFeatures_()}removeLastPoint(){this.removeLastPoints_(1)}finishDrawing(){const e=this.abortDrawing_();if(!e)return null;let n=this.sketchCoords_;const r=e.getGeometry(),i=this.getMap().getView().getProjection();return this.mode_==="LineString"?(n.pop(),this.geometryFunction_(n,r,i)):this.mode_==="Polygon"&&(n[0].pop(),this.geometryFunction_(n,r,i),n=r.getCoordinates()),this.type_==="MultiPoint"?e.setGeometry(new ol([n])):this.type_==="MultiLineString"?e.setGeometry(new Ji([n])):this.type_==="MultiPolygon"&&e.setGeometry(new Vo([n])),this.dispatchEvent(new Jf(qf.DRAWEND,e)),this.features_&&this.features_.push(e),this.source_&&this.source_.addFeature(e),e}abortDrawing_(){this.finishCoordinate_=null;const e=this.sketchFeature_;return this.sketchFeature_=null,this.sketchPoint_=null,this.sketchLine_=null,this.overlay_.getSource().clear(!0),this.deactivateTrace_(),e}abortDrawing(){const e=this.abortDrawing_();e&&this.dispatchEvent(new Jf(qf.DRAWABORT,e))}appendCoordinates(e){const n=this.mode_,r=!this.sketchFeature_;r&&this.startDrawing_(e[0]);let i;if(n==="LineString"||n==="Circle")i=this.sketchCoords_;else if(n==="Polygon")i=this.sketchCoords_&&this.sketchCoords_.length?this.sketchCoords_[0]:[];else return;r&&i.shift(),i.pop();for(let o=0;o<e.length;o++)this.addToDrawing_(e[o]);const s=e[e.length-1];this.sketchFeature_=this.addToDrawing_(s),this.modifyDrawing_(s)}extend(e){const r=e.getGeometry();this.sketchFeature_=e,this.sketchCoords_=r.getCoordinates();const i=this.sketchCoords_[this.sketchCoords_.length-1];this.finishCoordinate_=i.slice(),this.sketchCoords_.push(i.slice()),this.sketchPoint_=new en(new Sn(i)),this.updateSketchFeatures_(),this.dispatchEvent(new Jf(qf.DRAWSTART,this.sketchFeature_))}updateSketchFeatures_(){const e=[];this.sketchFeature_&&e.push(this.sketchFeature_),this.sketchLine_&&e.push(this.sketchLine_),this.sketchPoint_&&e.push(this.sketchPoint_);const n=this.overlay_.getSource();n.clear(!0),n.addFeatures(e)}updateState_(){const e=this.getMap(),n=this.getActive();(!e||!n)&&this.abortDrawing(),this.overlay_.setMap(n?e:null)}}function VW(){const t=w1();return function(e,n){return t[e.getGeometry().getType()]}}function WW(t){switch(t){case"Point":case"MultiPoint":return"Point";case"LineString":case"MultiLineString":return"LineString";case"Polygon":case"MultiPolygon":return"Polygon";case"Circle":return"Circle";default:throw new Error("Invalid type: "+t)}}const AP=0,Rd=1,FP=[0,0,0,0],xc=[],P0={MODIFYSTART:"modifystart",MODIFYEND:"modifyend"};function R0(t,e,n){let r;switch(e){case"LineString":r=t;break;case"MultiLineString":case"Polygon":r=t[n[0]];break;case"MultiPolygon":r=t[n[1]][n[0]];break}return r}class I0 extends Cr{constructor(e,n,r){super(e),this.features=n,this.mapBrowserEvent=r}}class RL extends il{constructor(e){super(e),this.on,this.once,this.un,this.boundHandleFeatureChange_=this.handleFeatureChange_.bind(this),this.condition_=e.condition?e.condition:JO,this.defaultDeleteCondition_=function(r){return tU(r)&&ZO(r)},this.deleteCondition_=e.deleteCondition?e.deleteCondition:this.defaultDeleteCondition_,this.insertVertexCondition_=e.insertVertexCondition?e.insertVertexCondition:mc,this.vertexFeature_=null,this.vertexSegments_=null,this.lastCoordinate_=[0,0],this.ignoreNextSingleClick_=!1,this.featuresBeingModified_=null,this.rBush_=new Rw,this.pixelTolerance_=e.pixelTolerance!==void 0?e.pixelTolerance:10,this.snappedToVertex_=!1,this.changingFeature_=!1,this.dragSegments_=[],this.overlay_=new Pr({source:new Cn({useSpatialIndex:!1,wrapX:!!e.wrapX}),style:e.style?e.style:KW(),updateWhileAnimating:!0,updateWhileInteracting:!0}),this.SEGMENT_WRITERS_={Point:this.writePointGeometry_.bind(this),LineString:this.writeLineStringGeometry_.bind(this),LinearRing:this.writeLineStringGeometry_.bind(this),Polygon:this.writePolygonGeometry_.bind(this),MultiPoint:this.writeMultiPointGeometry_.bind(this),MultiLineString:this.writeMultiLineStringGeometry_.bind(this),MultiPolygon:this.writeMultiPolygonGeometry_.bind(this),Circle:this.writeCircleGeometry_.bind(this),GeometryCollection:this.writeGeometryCollectionGeometry_.bind(this)},this.source_=null,this.traceSource_=e.traceSource||e.source||null,this.traceCondition_,this.setTrace(e.trace||!1),this.traceState_={active:!1},this.traceSegments_=null,this.hitDetection_=null;let n;if(e.features?n=e.features:e.source&&(this.source_=e.source,n=new Bn(this.source_.getFeatures()),this.source_.addEventListener(an.ADDFEATURE,this.handleSourceAdd_.bind(this)),this.source_.addEventListener(an.REMOVEFEATURE,this.handleSourceRemove_.bind(this))),!n)throw new Error("The modify interaction requires features, a source or a layer");e.hitDetection&&(this.hitDetection_=e.hitDetection),this.features_=n,this.features_.forEach(this.addFeature_.bind(this)),this.features_.addEventListener(Ht.ADD,this.handleFeatureAdd_.bind(this)),this.features_.addEventListener(Ht.REMOVE,this.handleFeatureRemove_.bind(this)),this.lastPointerEvent_=null,this.delta_=[0,0],this.snapToPointer_=e.snapToPointer===void 0?!this.hitDetection_:e.snapToPointer}setTrace(e){let n;e?e===!0?n=mc:n=e:n=zp,this.traceCondition_=n}addFeature_(e){const n=e.getGeometry();if(n){const i=this.SEGMENT_WRITERS_[n.getType()];i&&i(e,n)}const r=this.getMap();r&&r.isRendered()&&this.getActive()&&this.handlePointerAtPixel_(this.lastCoordinate_),e.addEventListener(Se.CHANGE,this.boundHandleFeatureChange_)}willModifyFeatures_(e,n){if(!this.featuresBeingModified_){this.featuresBeingModified_=new Bn;const r=this.featuresBeingModified_.getArray();for(let i=0,s=n.length;i<s;++i){const o=n[i].feature;o&&!r.includes(o)&&this.featuresBeingModified_.push(o)}this.featuresBeingModified_.getLength()===0?this.featuresBeingModified_=null:this.dispatchEvent(new I0(P0.MODIFYSTART,this.featuresBeingModified_,e))}}removeFeature_(e){this.removeFeatureSegmentData_(e),this.vertexFeature_&&this.features_.getLength()===0&&(this.overlay_.getSource().removeFeature(this.vertexFeature_),this.vertexFeature_=null),e.removeEventListener(Se.CHANGE,this.boundHandleFeatureChange_)}removeFeatureSegmentData_(e){const n=this.rBush_,r=[];n.forEach(function(i){e===i.feature&&r.push(i)});for(let i=r.length-1;i>=0;--i){const s=r[i];for(let o=this.dragSegments_.length-1;o>=0;--o)this.dragSegments_[o][0]===s&&this.dragSegments_.splice(o,1);n.remove(s)}}setActive(e){this.vertexFeature_&&!e&&(this.overlay_.getSource().removeFeature(this.vertexFeature_),this.vertexFeature_=null),super.setActive(e)}setMap(e){this.overlay_.setMap(e),super.setMap(e)}getOverlay(){return this.overlay_}handleSourceAdd_(e){e.feature&&this.features_.push(e.feature)}handleSourceRemove_(e){e.feature&&this.features_.remove(e.feature)}handleFeatureAdd_(e){this.addFeature_(e.element)}handleFeatureChange_(e){if(!this.changingFeature_){const n=e.target;this.removeFeature_(n),this.addFeature_(n)}}handleFeatureRemove_(e){this.removeFeature_(e.element)}writePointGeometry_(e,n){const r=n.getCoordinates(),i={feature:e,geometry:n,segment:[r,r]};this.rBush_.insert(n.getExtent(),i)}writeMultiPointGeometry_(e,n){const r=n.getCoordinates();for(let i=0,s=r.length;i<s;++i){const o=r[i],a={feature:e,geometry:n,depth:[i],index:i,segment:[o,o]};this.rBush_.insert(n.getExtent(),a)}}writeLineStringGeometry_(e,n){const r=n.getCoordinates();for(let i=0,s=r.length-1;i<s;++i){const o=r.slice(i,i+2),a={feature:e,geometry:n,index:i,segment:o};this.rBush_.insert(_n(o),a)}}writeMultiLineStringGeometry_(e,n){const r=n.getCoordinates();for(let i=0,s=r.length;i<s;++i){const o=r[i];for(let a=0,l=o.length-1;a<l;++a){const c=o.slice(a,a+2),u={feature:e,geometry:n,depth:[i],index:a,segment:c};this.rBush_.insert(_n(c),u)}}}writePolygonGeometry_(e,n){const r=n.getCoordinates();for(let i=0,s=r.length;i<s;++i){const o=r[i];for(let a=0,l=o.length-1;a<l;++a){const c=o.slice(a,a+2),u={feature:e,geometry:n,depth:[i],index:a,segment:c};this.rBush_.insert(_n(c),u)}}}writeMultiPolygonGeometry_(e,n){const r=n.getCoordinates();for(let i=0,s=r.length;i<s;++i){const o=r[i];for(let a=0,l=o.length;a<l;++a){const c=o[a];for(let u=0,d=c.length-1;u<d;++u){const h=c.slice(u,u+2),f={feature:e,geometry:n,depth:[a,i],index:u,segment:h};this.rBush_.insert(_n(h),f)}}}}writeCircleGeometry_(e,n){const r=n.getCenter(),i={feature:e,geometry:n,index:AP,segment:[r,r]},s={feature:e,geometry:n,index:Rd,segment:[r,r]},o=[i,s];i.featureSegments=o,s.featureSegments=o,this.rBush_.insert(gc(r),i);let a=n;this.rBush_.insert(a.getExtent(),s)}writeGeometryCollectionGeometry_(e,n){const r=n.getGeometriesArray();for(let i=0;i<r.length;++i){const s=r[i],o=this.SEGMENT_WRITERS_[s.getType()];o(e,s)}}createOrUpdateVertexFeature_(e,n,r,i){let s=this.vertexFeature_;return s?s.getGeometry().setCoordinates(e):(s=new en(new Sn(e)),this.vertexFeature_=s,this.overlay_.getSource().addFeature(s)),s.set("features",n),s.set("geometries",r),s.set("existing",i),s}handleEvent(e){if(!e.originalEvent)return!0;this.lastPointerEvent_=e;let n;return!e.map.getView().getInteracting()&&e.type==Be.POINTERMOVE&&!this.handlingDownUpSequence&&this.handlePointerMove_(e),this.vertexFeature_&&this.deleteCondition_(e)&&(e.type!=Be.SINGLECLICK||!this.ignoreNextSingleClick_?n=this.removePoint():n=!0),e.type==Be.SINGLECLICK&&(this.ignoreNextSingleClick_=!1),super.handleEvent(e)&&!n}findInsertVerticesAndUpdateDragSegments_(e){if(this.handlePointerAtPixel_(e),this.dragSegments_.length=0,this.featuresBeingModified_=null,!this.vertexFeature_)return;this.getMap().getView().getProjection();const r=[],i=this.vertexFeature_.getGeometry().getCoordinates(),s=_n([i]),o=this.rBush_.getInExtent(s),a={};o.sort(HW);for(let l=0,c=o.length;l<c;++l){const u=o[l],d=u.segment;let h=fe(u.geometry);const f=u.depth;if(f&&(h+="-"+f.join("-")),a[h]||(a[h]=new Array(2)),u.geometry.getType()==="Circle"&&u.index===Rd){const p=$P(e,u);Nn(p,i)&&!a[h][0]&&(this.dragSegments_.push([u,0]),a[h][0]=u);continue}if(Nn(d[0],i)&&!a[h][0]){this.dragSegments_.push([u,0]),a[h][0]=u;continue}if(Nn(d[1],i)&&!a[h][1]){if(a[h][0]&&a[h][0].index===0){let p=u.geometry.getCoordinates();switch(u.geometry.getType()){case"LineString":case"MultiLineString":continue;case"MultiPolygon":p=p[f[1]];case"Polygon":if(u.index!==p[f[0]].length-2)continue;break}}this.dragSegments_.push([u,1]),a[h][1]=u;continue}fe(d)in this.vertexSegments_&&!a[h][0]&&!a[h][1]&&r.push(u)}return r}deactivateTrace_(){this.traceState_={active:!1}}updateTrace_(e){const n=this.traceState_;if(!n.active)return;if(n.targetIndex===-1){const s=e.map.getPixelFromCoordinate(n.startCoord);if(ec(s,e.pixel)<this.pixelTolerance_)return}const r=bL(e.coordinate,n,e.map,this.pixelTolerance_);if(n.targetIndex===-1&&Math.sqrt(r.closestTargetDistance)/e.map.getView().getResolution()>this.pixelTolerance_)return;if(n.targetIndex!==r.index){if(n.targetIndex!==-1){const o=n.targets[n.targetIndex];this.removeTracedCoordinates_(o.startIndex,o.endIndex)}else for(const o of this.traceSegments_){const a=o[0],l=a.geometry,c=o[1],u=l.getCoordinates();R0(u,l.getType(),a.depth).splice(a.index+c,1),l.setCoordinates(u),c===0&&(a.index-=1)}const s=n.targets[r.index];this.addTracedCoordinates_(s,s.startIndex,r.endIndex)}else{const s=n.targets[n.targetIndex];this.addOrRemoveTracedCoordinates_(s,r.endIndex)}n.targetIndex=r.index;const i=n.targets[n.targetIndex];i.endIndex=r.endIndex}getTraceCandidates_(e){const n=this.getMap(),r=this.pixelTolerance_,i=n.getCoordinateFromPixel([e.pixel[0]-r,e.pixel[1]+r]),s=n.getCoordinateFromPixel([e.pixel[0]+r,e.pixel[1]-r]),o=_n([i,s]);return this.traceSource_.getFeaturesInExtent(o)}toggleTraceState_(e){if(!this.traceSource_||!this.traceCondition_(e))return;if(this.traceState_.active){this.deactivateTrace_(),this.traceSegments_=null;return}const n=this.getTraceCandidates_(e);if(n.length===0)return;const r=CL(e.coordinate,n);r.length&&(this.traceState_={active:!0,startCoord:e.coordinate.slice(),targets:r,targetIndex:-1})}addOrRemoveTracedCoordinates_(e,n){const r=e.startIndex<=e.endIndex,i=e.startIndex<=n;r===i?r&&n>e.endIndex||!r&&n<e.endIndex?this.addTracedCoordinates_(e,e.endIndex,n):(r&&n<e.endIndex||!r&&n>e.endIndex)&&this.removeTracedCoordinates_(n,e.endIndex):(this.removeTracedCoordinates_(e.startIndex,e.endIndex),this.addTracedCoordinates_(e,e.startIndex,n))}removeTracedCoordinates_(e,n){if(e===n)return;let r=0;if(e<n){const i=Math.ceil(e);let s=Math.floor(n);s===n&&(s-=1),r=s-i+1}else{const i=Math.floor(e);let s=Math.ceil(n);s===n&&(s+=1),r=i-s+1}if(r>0)for(const i of this.traceSegments_){const s=i[0],o=s.geometry,a=i[1];let l=i[0].index+1;a===1&&(l-=r);const c=o.getCoordinates();R0(c,o.getType(),s.depth).splice(l,r),o.setCoordinates(c),a===1&&(s.index-=r)}}addTracedCoordinates_(e,n,r){if(n===r)return;const i=[];if(n<r){const s=Math.ceil(n);let o=Math.floor(r);o===r&&(o-=1);for(let a=s;a<=o;++a)i.push(So(e.coordinates,a))}else{const s=Math.floor(n);let o=Math.ceil(r);o===r&&(o+=1);for(let a=s;a>=o;--a)i.push(So(e.coordinates,a))}if(i.length)for(const s of this.traceSegments_){const o=s[0],a=o.geometry,l=s[1],c=o.index+1;l===0&&i.reverse();const u=a.getCoordinates();R0(u,a.getType(),o.depth).splice(c,0,...i),a.setCoordinates(u),l===1&&(o.index+=i.length)}}updateGeometry_(e,n){const r=n[0],i=r.depth;let s;const o=r.segment,a=r.geometry,l=n[1];for(;e.length<a.getStride();)e.push(o[l][e.length]);switch(a.getType()){case"Point":s=e,o[0]=e,o[1]=e;break;case"MultiPoint":s=a.getCoordinates(),s[r.index]=e,o[0]=e,o[1]=e;break;case"LineString":s=a.getCoordinates(),s[r.index+l]=e,o[l]=e;break;case"MultiLineString":s=a.getCoordinates(),s[i[0]][r.index+l]=e,o[l]=e;break;case"Polygon":s=a.getCoordinates(),s[i[0]][r.index+l]=e,o[l]=e;break;case"MultiPolygon":s=a.getCoordinates(),s[i[1]][i[0]][r.index+l]=e,o[l]=e;break;case"Circle":const c=a;if(o[0]=e,o[1]=e,r.index===AP)this.changingFeature_=!0,c.setCenter(e),this.changingFeature_=!1;else{this.changingFeature_=!0,this.getMap().getView().getProjection();let u=ec(Ot(c.getCenter()),Ot(e));c.setRadius(u),this.changingFeature_=!1}break}s&&this.setGeometryCoordinates_(a,s)}handleDragEvent(e){this.ignoreNextSingleClick_=!1,this.willModifyFeatures_(e,this.dragSegments_.map(([o])=>o));const n=[e.coordinate[0]+this.delta_[0],e.coordinate[1]+this.delta_[1]],r=[],i=[],s=this.traceState_.active&&!this.traceSegments_?this.traceState_.startCoord:null;if(s){this.traceSegments_=[];for(const o of this.dragSegments_){const a=o[0];ec(C1(s,a.segment),s)/e.map.getView().getResolution()<1&&this.traceSegments_.push(o)}}for(let o=0,a=this.dragSegments_.length;o<a;++o){const l=this.dragSegments_[o],c=l[0],u=c.feature;r.includes(u)||r.push(u);const d=c.geometry;i.includes(d)||i.push(d),this.updateGeometry_(n,l)}this.updateTrace_(e),this.createOrUpdateVertexFeature_(n,r,i,!0)}handleDownEvent(e){if(!this.condition_(e))return!1;const n=e.coordinate,r=this.findInsertVerticesAndUpdateDragSegments_(n);if(r!=null&&r.length&&this.insertVertexCondition_(e)&&(this.willModifyFeatures_(e,r),this.vertexFeature_)){const i=this.vertexFeature_.getGeometry().getCoordinates();for(let s=r.length-1;s>=0;--s)this.insertVertex_(r[s],i);this.ignoreNextSingleClick_=!0}return!!this.vertexFeature_}handleUpEvent(e){for(let n=this.dragSegments_.length-1;n>=0;--n){const r=this.dragSegments_[n][0],i=r.geometry;if(i.getType()==="Circle"){const s=i,o=s.getCenter(),a=r.featureSegments[0],l=r.featureSegments[1];a.segment[0]=o,a.segment[1]=o,l.segment[0]=o,l.segment[1]=o,this.rBush_.update(gc(o),a);let c=s;this.rBush_.update(c.getExtent(),l)}else this.rBush_.update(_n(r.segment),r)}return this.featuresBeingModified_&&(this.toggleTraceState_(e),this.dispatchEvent(new I0(P0.MODIFYEND,this.featuresBeingModified_,e)),this.featuresBeingModified_=null),!1}handlePointerMove_(e){this.lastCoordinate_=e.coordinate,this.handlePointerAtPixel_(this.lastCoordinate_)}handlePointerAtPixel_(e){const n=this.getMap(),r=n.getPixelFromCoordinate(e);n.getView().getProjection();const i=function(a,l){return OP(e,a)-OP(e,l)};let s,o;if(this.hitDetection_){const a=typeof this.hitDetection_=="object"?l=>l===this.hitDetection_:void 0;n.forEachFeatureAtPixel(r,(l,c,u)=>{u&&u.getType()==="Point"&&(u=new Sn(Ga(u.getCoordinates())));const d=u||l.getGeometry();if(d&&d.getType()==="Point"&&l instanceof en&&this.features_.getArray().includes(l)){o=d;const h=l.getGeometry().getFlatCoordinates().slice(0,2);s=[{feature:l,geometry:o,segment:[h,h]}]}return!0},{layerFilter:a})}if(!s){const a=fi(gc(e,FP)),l=n.getView().getResolution()*this.pixelTolerance_,c=ry(wr(a,l,FP));s=this.rBush_.getInExtent(c)}if(s&&s.length>0){const a=s.sort(i)[0],l=a.segment;let c=$P(e,a);const u=n.getPixelFromCoordinate(c);let d=ec(r,u);if(o||d<=this.pixelTolerance_){const h={};if(h[fe(l)]=!0,this.snapToPointer_||(this.delta_[0]=c[0]-e[0],this.delta_[1]=c[1]-e[1]),a.geometry.getType()==="Circle"&&a.index===Rd)this.snappedToVertex_=!0,this.createOrUpdateVertexFeature_(c,[a.feature],[a.geometry],this.snappedToVertex_);else{const f=n.getPixelFromCoordinate(l[0]),p=n.getPixelFromCoordinate(l[1]),m=Dc(u,f),_=Dc(u,p);if(d=Math.sqrt(Math.min(m,_)),this.snappedToVertex_=d<=this.pixelTolerance_,!this.snappedToVertex_&&!this.insertVertexCondition_(this.lastPointerEvent_)){this.vertexFeature_&&(this.overlay_.getSource().removeFeature(this.vertexFeature_),this.vertexFeature_=null);return}this.snappedToVertex_&&(c=m>_?l[1]:l[0]),this.createOrUpdateVertexFeature_(c,[a.feature],[a.geometry],this.snappedToVertex_);const g={};g[fe(a.geometry)]=!0;for(let y=1,v=s.length;y<v;++y){const w=s[y].segment;if(Nn(l[0],w[0])&&Nn(l[1],w[1])||Nn(l[0],w[1])&&Nn(l[1],w[0])){const x=fe(s[y].geometry);x in g||(g[x]=!0,h[fe(w)]=!0)}else break}}this.vertexSegments_=h;return}}this.vertexFeature_&&(this.overlay_.getSource().removeFeature(this.vertexFeature_),this.vertexFeature_=null)}insertVertex_(e,n){const r=e.segment,i=e.feature,s=e.geometry,o=e.depth,a=e.index;let l;for(;n.length<s.getStride();)n.push(0);switch(s.getType()){case"MultiLineString":l=s.getCoordinates(),l[o[0]].splice(a+1,0,n);break;case"Polygon":l=s.getCoordinates(),l[o[0]].splice(a+1,0,n);break;case"MultiPolygon":l=s.getCoordinates(),l[o[1]][o[0]].splice(a+1,0,n);break;case"LineString":l=s.getCoordinates(),l.splice(a+1,0,n);break;default:return!1}this.setGeometryCoordinates_(s,l);const c=this.rBush_;c.remove(e),this.updateSegmentIndices_(s,a,o,1);const u={segment:[r[0],n],feature:i,geometry:s,depth:o,index:a};c.insert(_n(u.segment),u),this.dragSegments_.push([u,1]);const d={segment:[n,r[1]],feature:i,geometry:s,depth:o,index:a+1};return c.insert(_n(d.segment),d),this.dragSegments_.push([d,0]),!0}updatePointer_(e){var n;return e&&this.findInsertVerticesAndUpdateDragSegments_(e),(n=this.vertexFeature_)==null?void 0:n.getGeometry().getCoordinates()}getPoint(){var n;const e=(n=this.vertexFeature_)==null?void 0:n.getGeometry().getCoordinates();return e?Ga(e,this.getMap().getView().getProjection()):null}canRemovePoint(){if(!this.vertexFeature_||this.vertexFeature_.get("geometries").every(r=>r.getType()==="Circle"||r.getType().endsWith("Point")))return!1;const e=this.vertexFeature_.getGeometry().getCoordinates();return this.rBush_.getInExtent(_n([e])).some(({segment:r})=>Nn(r[0],e)||Nn(r[1],e))}removePoint(e){if(e&&(e=Ot(e,this.getMap().getView().getProjection()),this.updatePointer_(e)),!this.lastPointerEvent_||this.lastPointerEvent_&&this.lastPointerEvent_.type!=Be.POINTERDRAG){const n=this.lastPointerEvent_;this.willModifyFeatures_(n,this.dragSegments_.map(([i])=>i));const r=this.removeVertex_();return this.featuresBeingModified_&&this.dispatchEvent(new I0(P0.MODIFYEND,this.featuresBeingModified_,n)),this.featuresBeingModified_=null,r}return!1}removeVertex_(){const e=this.dragSegments_,n={};let r=!1,i,s,o,a,l,c,u,d,h,f,p;for(l=e.length-1;l>=0;--l)o=e[l],f=o[0],p=fe(f.feature),f.depth&&(p+="-"+f.depth.join("-")),p in n||(n[p]={}),o[1]===0?(n[p].right=f,n[p].index=f.index):o[1]==1&&(n[p].left=f,n[p].index=f.index+1);for(p in n){switch(h=n[p].right,u=n[p].left,c=n[p].index,d=c-1,u!==void 0?f=u:f=h,d<0&&(d=0),a=f.geometry,s=a.getCoordinates(),i=s,r=!1,a.getType()){case"MultiLineString":s[f.depth[0]].length>2&&(s[f.depth[0]].splice(c,1),r=!0);break;case"LineString":s.length>2&&(s.splice(c,1),r=!0);break;case"MultiPolygon":i=i[f.depth[1]];case"Polygon":i=i[f.depth[0]],i.length>4&&(c==i.length-1&&(c=0),i.splice(c,1),r=!0,c===0&&(i.pop(),i.push(i[0]),d=i.length-1));break}if(r){this.setGeometryCoordinates_(a,s);const m=[];if(u!==void 0&&(this.rBush_.remove(u),m.push(u.segment[0])),h!==void 0&&(this.rBush_.remove(h),m.push(h.segment[1])),u!==void 0&&h!==void 0){const _={depth:f.depth,feature:f.feature,geometry:f.geometry,index:d,segment:m};this.rBush_.insert(_n(_.segment),_)}this.updateSegmentIndices_(a,c,f.depth,-1),this.vertexFeature_&&(this.overlay_.getSource().removeFeature(this.vertexFeature_),this.vertexFeature_=null),e.length=0}}return r}canInsertPoint(){if(!this.vertexFeature_||this.vertexFeature_.get("geometries").every(r=>r.getType()==="Circle"||r.getType().endsWith("Point")))return!1;const e=this.vertexFeature_.getGeometry().getCoordinates();return this.rBush_.getInExtent(_n([e])).some(({segment:r})=>!(Nn(r[0],e)||Nn(r[1],e)))}insertPoint(e){var i;const n=e?Ot(e,this.getMap().getView().getProjection()):(i=this.vertexFeature_)==null?void 0:i.getGeometry().getCoordinates();return n?this.findInsertVerticesAndUpdateDragSegments_(n).reduce((s,o)=>s||this.insertVertex_(o,n),!1):!1}setGeometryCoordinates_(e,n){this.changingFeature_=!0,e.setCoordinates(n),this.changingFeature_=!1}updateSegmentIndices_(e,n,r,i){this.rBush_.forEachInExtent(e.getExtent(),function(s){s.geometry===e&&(r===void 0||s.depth===void 0||es(s.depth,r))&&s.index>n&&(s.index+=i)})}}function HW(t,e){return t.index-e.index}function OP(t,e,n){const r=e.geometry;if(r.getType()==="Circle"){let s=r;if(e.index===Rd){const o=Dc(s.getCenter(),Ot(t)),a=Math.sqrt(o)-s.getRadius();return a*a}}const i=Ot(t);return xc[0]=Ot(e.segment[0]),xc[1]=Ot(e.segment[1]),B4(i,xc)}function $P(t,e,n){const r=e.geometry;if(r.getType()==="Circle"&&e.index===Rd)return Ga(r.getClosestPoint(Ot(t)));const i=Ot(t);return xc[0]=Ot(e.segment[0]),xc[1]=Ot(e.segment[1]),Ga(C1(i,xc))}function KW(){const t=w1();return function(e,n){return t.Point}}const Qf={SELECT:"select"};class eg extends Cr{constructor(e,n,r,i){super(e),this.selected=n,this.deselected=r,this.mapBrowserEvent=i}}const tg={};class Ks extends au{constructor(e){super(),this.on,this.once,this.un,e=e||{},this.boundAddFeature_=this.addFeature_.bind(this),this.boundRemoveFeature_=this.removeFeature_.bind(this),this.condition_=e.condition?e.condition:ZO,this.addCondition_=e.addCondition?e.addCondition:zp,this.removeCondition_=e.removeCondition?e.removeCondition:zp,this.toggleCondition_=e.toggleCondition?e.toggleCondition:Up,this.multi_=e.multi?e.multi:!1,this.filter_=e.filter?e.filter:zo,this.hitTolerance_=e.hitTolerance?e.hitTolerance:0,this.style_=e.style!==void 0?e.style:YW(),this.features_=e.features||new Bn;let n;if(e.layers)if(typeof e.layers=="function")n=e.layers;else{const r=e.layers;n=function(i){return r.includes(i)}}else n=zo;this.layerFilter_=n,this.featureLayerAssociation_={}}addFeatureLayerAssociation_(e,n){this.featureLayerAssociation_[fe(e)]=n}getFeatures(){return this.features_}getHitTolerance(){return this.hitTolerance_}getLayer(e){return this.featureLayerAssociation_[fe(e)]}setHitTolerance(e){this.hitTolerance_=e}setMap(e){this.getMap()&&this.style_&&this.features_.forEach(this.restorePreviousStyle_.bind(this)),super.setMap(e),e?(this.features_.addEventListener(Ht.ADD,this.boundAddFeature_),this.features_.addEventListener(Ht.REMOVE,this.boundRemoveFeature_),this.style_&&this.features_.forEach(this.applySelectedStyle_.bind(this))):(this.features_.removeEventListener(Ht.ADD,this.boundAddFeature_),this.features_.removeEventListener(Ht.REMOVE,this.boundRemoveFeature_))}addFeature_(e){const n=e.element;if(this.style_&&this.applySelectedStyle_(n),!this.getLayer(n)){const r=this.findLayerOfFeature_(n);r&&this.addFeatureLayerAssociation_(n,r)}}removeFeature_(e){this.style_&&this.restorePreviousStyle_(e.element)}findLayerOfFeature_(e){return this.getMap().getAllLayers().find(function(r){if(r instanceof Pr&&r.getSource()&&r.getSource().hasFeature(e))return r})}getStyle(){return this.style_}applySelectedStyle_(e){const n=fe(e);n in tg||(tg[n]=e.getStyle()),e.setStyle(this.style_)}restorePreviousStyle_(e){const n=this.getMap().getInteractions().getArray();for(let i=n.length-1;i>=0;--i){const s=n[i];if(s!==this&&s instanceof Ks&&s.getStyle()&&s.getFeatures().getArray().lastIndexOf(e)!==-1){e.setStyle(s.getStyle());return}}const r=fe(e);e.setStyle(tg[r]),delete tg[r]}removeFeatureLayerAssociation_(e){delete this.featureLayerAssociation_[fe(e)]}selectFeatureInternal_(e,n,r){if(!(e instanceof en)||!this.filter_(e,n))return;const i=this.getFeatures();return i.getArray().includes(e)||(this.addFeatureLayerAssociation_(e,n),i.push(e),r==null||r.push(e)),e}selectFeature(e){const n=this.findLayerOfFeature_(e);if(!this.layerFilter_(n))return!1;const r=this.selectFeatureInternal_(e,n);return r&&this.dispatchEvent(new eg(Qf.SELECT,[r],[],void 0)),!!r}removeFeatureInternal_(e,n){const r=this.getFeatures();if(!(!(e instanceof en)||!r.getArray().includes(e)))return r.remove(e),this.removeFeatureLayerAssociation_(e),n==null||n.push(e),e}deselectFeature(e){const n=this.removeFeatureInternal_(e);return n&&this.dispatchEvent(new eg(Qf.SELECT,[],[n],void 0)),!!n}toggleFeature(e){this.deselectFeature(e)||this.selectFeature(e)}clearSelection(){Qa(this.featureLayerAssociation_);const e=this.getFeatures(),n=e.getArray().slice();e.clear(),n.length!==0&&this.dispatchEvent(new eg(Qf.SELECT,[],n,void 0))}handleEvent(e){if(!this.condition_(e))return!0;const n=this.addCondition_(e),r=this.removeCondition_(e),i=this.toggleCondition_(e),s=!n&&!r&&!i,o=e.map,a=this.getFeatures(),l=[],c=[];if(s){let u=!1;o.forEachFeatureAtPixel(e.pixel,(d,h)=>{if(u=!0,!!this.selectFeatureInternal_(d,h,c))return!this.multi_},{layerFilter:this.layerFilter_,hitTolerance:this.hitTolerance_});for(let d=a.getLength()-1;d>=0;--d){const h=a.item(d);(c.length>0&&!c.includes(h)||!u)&&this.removeFeatureInternal_(h,l)}}else o.forEachFeatureAtPixel(e.pixel,(u,d)=>{let h;if((r||i)&&(h=this.removeFeatureInternal_(u,l)),(n||i)&&!h&&(h=this.selectFeatureInternal_(u,d,c)),!!h)return!this.multi_},{layerFilter:this.layerFilter_,hitTolerance:this.hitTolerance_});return(c.length>0||l.length>0)&&this.dispatchEvent(new eg(Qf.SELECT,c,l,e)),!0}}function YW(){const t=w1();return We(t.Polygon,t.LineString),We(t.GeometryCollection,t.LineString),function(e){return e.getGeometry()?t[e.getGeometry().getType()]:null}}var Xn=63710088e-1,IL={centimeters:Xn*100,centimetres:Xn*100,degrees:Xn/111325,feet:Xn*3.28084,inches:Xn*39.37,kilometers:Xn/1e3,kilometres:Xn/1e3,meters:Xn,metres:Xn,miles:Xn/1609.344,millimeters:Xn*1e3,millimetres:Xn*1e3,nauticalmiles:Xn/1852,radians:1,yards:Xn*1.0936};function nm(t,e,n){n===void 0&&(n={});var r={type:"Feature"};return(n.id===0||n.id)&&(r.id=n.id),n.bbox&&(r.bbox=n.bbox),r.properties=e||{},r.geometry=t,r}function rm(t,e,n){if(n===void 0&&(n={}),!t)throw new Error("coordinates is required");if(!Array.isArray(t))throw new Error("coordinates must be an Array");if(t.length<2)throw new Error("coordinates must be at least 2 numbers long");if(!LP(t[0])||!LP(t[1]))throw new Error("coordinates must contain numbers");var r={type:"Point",coordinates:t};return nm(r,e,n)}function XW(t,e,n){if(n===void 0&&(n={}),t.length<2)throw new Error("coordinates must be an array of two or more positions");var r={type:"LineString",coordinates:t};return nm(r,e,n)}function ZW(t,e){e===void 0&&(e="kilometers");var n=IL[e];if(!n)throw new Error(e+" units is invalid");return t*n}function qW(t,e){e===void 0&&(e="kilometers");var n=IL[e];if(!n)throw new Error(e+" units is invalid");return t/n}function Nw(t){var e=t%(2*Math.PI);return e*180/Math.PI}function gi(t){var e=t%360;return e*Math.PI/180}function LP(t){return!isNaN(t)&&t!==null&&!Array.isArray(t)}function RE(t,e,n){if(t!==null)for(var r,i,s,o,a,l,c,u=0,d=0,h,f=t.type,p=f==="FeatureCollection",m=f==="Feature",_=p?t.features.length:1,g=0;g<_;g++){c=p?t.features[g].geometry:m?t.geometry:t,h=c?c.type==="GeometryCollection":!1,a=h?c.geometries.length:1;for(var y=0;y<a;y++){var v=0,w=0;if(o=h?c.geometries[y]:c,o!==null){l=o.coordinates;var x=o.type;switch(u=n&&(x==="Polygon"||x==="MultiPolygon")?1:0,x){case null:break;case"Point":if(e(l,d,g,v,w)===!1)return!1;d++,v++;break;case"LineString":case"MultiPoint":for(r=0;r<l.length;r++){if(e(l[r],d,g,v,w)===!1)return!1;d++,x==="MultiPoint"&&v++}x==="LineString"&&v++;break;case"Polygon":case"MultiLineString":for(r=0;r<l.length;r++){for(i=0;i<l[r].length-u;i++){if(e(l[r][i],d,g,v,w)===!1)return!1;d++}x==="MultiLineString"&&v++,x==="Polygon"&&w++}x==="Polygon"&&v++;break;case"MultiPolygon":for(r=0;r<l.length;r++){for(w=0,i=0;i<l[r].length;i++){for(s=0;s<l[r][i].length-u;s++){if(e(l[r][i][s],d,g,v,w)===!1)return!1;d++}w++}v++}break;case"GeometryCollection":for(r=0;r<o.geometries.length;r++)if(RE(o.geometries[r],e,n)===!1)return!1;break;default:throw new Error("Unknown Geometry Type")}}}}}function AL(t,e){var n,r,i,s,o,a,l,c,u,d,h=0,f=t.type==="FeatureCollection",p=t.type==="Feature",m=f?t.features.length:1;for(n=0;n<m;n++){for(a=f?t.features[n].geometry:p?t.geometry:t,c=f?t.features[n].properties:p?t.properties:{},u=f?t.features[n].bbox:p?t.bbox:void 0,d=f?t.features[n].id:p?t.id:void 0,l=a?a.type==="GeometryCollection":!1,o=l?a.geometries.length:1,i=0;i<o;i++){if(s=l?a.geometries[i]:a,s===null){if(e(null,h,c,u,d)===!1)return!1;continue}switch(s.type){case"Point":case"LineString":case"MultiPoint":case"Polygon":case"MultiLineString":case"MultiPolygon":{if(e(s,h,c,u,d)===!1)return!1;break}case"GeometryCollection":{for(r=0;r<s.geometries.length;r++)if(e(s.geometries[r],h,c,u,d)===!1)return!1;break}default:throw new Error("Unknown Geometry Type")}}h++}}function JW(t,e,n){var r=n;return AL(t,function(i,s,o,a,l){s===0&&n===void 0?r=i:r=e(r,i,s,o,a,l)}),r}function QW(t,e){AL(t,function(n,r,i,s,o){var a=n===null?null:n.type;switch(a){case null:case"Point":case"LineString":case"Polygon":return e(nm(n,i,{bbox:s,id:o}),r,0)===!1?!1:void 0}var l;switch(a){case"MultiPoint":l="Point";break;case"MultiLineString":l="LineString";break;case"MultiPolygon":l="Polygon";break}for(var c=0;c<n.coordinates.length;c++){var u=n.coordinates[c],d={type:l,coordinates:u};if(e(nm(d,i),r,c)===!1)return!1}})}function eH(t,e){QW(t,function(n,r,i){var s=0;if(n.geometry){var o=n.geometry.type;if(!(o==="Point"||o==="MultiPoint")){var a,l=0,c=0,u=0;if(RE(n,function(d,h,f,p,m){if(a===void 0||r>l||p>c||m>u){a=d,l=r,c=p,u=m,s=0;return}var _=XW([a,d],n.properties);if(e(_,r,i,m,s)===!1)return!1;s++,a=d})===!1)return!1}}})}function tH(t,e,n){var r=n,i=!1;return eH(t,function(s,o,a,l,c){i===!1&&n===void 0?r=s:r=e(r,s,o,a,l,c),i=!0}),r}function mh(t){if(!t)throw new Error("coord is required");if(!Array.isArray(t)){if(t.type==="Feature"&&t.geometry!==null&&t.geometry.type==="Point")return t.geometry.coordinates;if(t.type==="Point")return t.coordinates}if(Array.isArray(t)&&t.length>=2&&!Array.isArray(t[0])&&!Array.isArray(t[1]))return t;throw new Error("coord must be GeoJSON Point or an Array of numbers")}function nH(t){return t.type==="Feature"?t.geometry:t}function FL(t,e,n){n===void 0&&(n={});var r=mh(t),i=mh(e),s=gi(i[1]-r[1]),o=gi(i[0]-r[0]),a=gi(r[1]),l=gi(i[1]),c=Math.pow(Math.sin(s/2),2)+Math.pow(Math.sin(o/2),2)*Math.cos(a)*Math.cos(l);return ZW(2*Math.atan2(Math.sqrt(c),Math.sqrt(1-c)),n.units)}function rH(t,e,n,r){r===void 0&&(r={});var i=mh(t),s=gi(i[0]),o=gi(i[1]),a=gi(n),l=qW(e,r.units),c=Math.asin(Math.sin(o)*Math.cos(l)+Math.cos(o)*Math.sin(l)*Math.cos(a)),u=s+Math.atan2(Math.sin(a)*Math.sin(l)*Math.cos(o),Math.cos(l)-Math.sin(o)*Math.sin(c)),d=Nw(u),h=Nw(c);return rm([d,h],r.properties)}function OL(t,e,n){if(n===void 0&&(n={}),n.final===!0)return iH(t,e);var r=mh(t),i=mh(e),s=gi(r[0]),o=gi(i[0]),a=gi(r[1]),l=gi(i[1]),c=Math.sin(o-s)*Math.cos(l),u=Math.cos(a)*Math.sin(l)-Math.sin(a)*Math.cos(l)*Math.cos(o-s);return Nw(Math.atan2(c,u))}function iH(t,e){var n=OL(e,t);return n=(n+180)%360,n}function sH(t,e){e===void 0&&(e={});var n=0,r=0,i=0;return RE(t,function(s){n+=s[0],r+=s[1],i++},!0),rm([n/i,r/i],e.properties)}var kP=6378137;function oH(t){return JW(t,function(e,n){return e+aH(n)},0)}function aH(t){var e=0,n;switch(t.type){case"Polygon":return MP(t.coordinates);case"MultiPolygon":for(n=0;n<t.coordinates.length;n++)e+=MP(t.coordinates[n]);return e;case"Point":case"MultiPoint":case"LineString":case"MultiLineString":return 0}return 0}function MP(t){var e=0;if(t&&t.length>0){e+=Math.abs(DP(t[0]));for(var n=1;n<t.length;n++)e-=Math.abs(DP(t[n]))}return e}function DP(t){var e,n,r,i,s,o,a,l=0,c=t.length;if(c>2){for(a=0;a<c;a++)a===c-2?(i=c-2,s=c-1,o=0):a===c-1?(i=c-1,s=0,o=1):(i=a,s=a+1,o=a+2),e=t[i],n=t[s],r=t[o],l+=(A0(r[0])-A0(e[0]))*Math.sin(A0(n[1]));l=l*kP*kP/2}return l}function A0(t){return t*Math.PI/180}function lH(t,e,n){n===void 0&&(n={});for(var r=nH(t),i=r.coordinates,s=0,o=0;o<i.length&&!(e>=s&&o===i.length-1);o++)if(s>=e){var a=e-s;if(a){var l=OL(i[o],i[o-1])-180,c=rH(i[o],a,l,n);return c}else return rm(i[o])}else s+=FL(i[o],i[o+1],n);return rm(i[i.length-1])}function cH(t,e){return e===void 0&&(e={}),tH(t,function(n,r){var i=r.geometry.coordinates;return n+FL(i[0],i[1],e)},0)}const uH=new nt({stroke:new yt({color:"rgba(200, 120, 0, 1)",width:2}),fill:new Wt({color:"rgba(200, 120, 0, 0.15)"})});function dH({useExternalToggle:t=!1}={}){const e=K.useRef(null),[n,r]=K.useState(!1),[i,s]=K.useState(!0),o=K.useRef(new Cn),a=K.useRef(null),l=K.useRef(null),{projectPath:c,setCrsFromLonLat:u,hasBoundary:d,setHasBoundary:h}=He(),f=Tr();K.useEffect(()=>{if(t){s(!1);return}s(!d)},[d,t]),K.useEffect(()=>{if(!t)return;const T=()=>s(!0),P=()=>s(!1);return window.addEventListener("boundarytools:open",T),window.addEventListener("boundarytools:close",P),()=>{window.removeEventListener("boundarytools:open",T),window.removeEventListener("boundarytools:close",P)}},[t]);const p=K.useCallback(()=>{f&&(a.current||(a.current=new Pr({source:o.current,style:uH}),f.addLayer(a.current)))},[f]),m=K.useMemo(()=>({".geojson":new ut,".json":new ut,".kml":new F8,".gpx":new wL}),[]),_=T=>{const P=T.toLowerCase();for(const F of Object.keys(m))if(P.endsWith(F))return m[F];return new ut},g=K.useCallback(async T=>{if(!c||!f)return;const P=f.getView().getProjection(),F=new ut().writeFeatureObject(T,{dataProjection:"EPSG:4326",featureProjection:P}),k=sH(F).geometry.coordinates,M=oH(F)/4046.8564224;F.properties??(F.properties={}),F.properties.name="Property",F.properties.acres=Number(M.toFixed(2)),F.properties.notes="";const b={type:"FeatureCollection",features:[F]};await window.api.writeTextFile(c,"data/property_boundary.geojson",JSON.stringify(b,null,2)),u(k[0],k[1]),h(!0)},[c,f,u,h]),y=()=>{var T;(T=e.current)==null||T.click()},v=async T=>{var k;const P=T.currentTarget,F=(k=P.files)==null?void 0:k[0];if(!(!F||!f))try{const A=_(F.name),M=await F.text(),b=A.readFeatures(M,{dataProjection:"EPSG:4326",featureProjection:f.getView().getProjection()});let j=null;for(const V of b){const H=V.getGeometry();if(!H)continue;const U=H.getType();if(U==="Polygon"){j=V;break}if(U==="MultiPolygon"){const N=H.getPolygon(0);if(N){j=new en(N);break}}}if(!j){window.alert("The selected file does not contain a polygon boundary the app can use.");return}if(p(),o.current.clear(),o.current.addFeature(j),f){const V=j.getGeometry();V&&f.getView().fit(V.getExtent(),{padding:[80,80,80,80],duration:500,maxZoom:18})}await g(j),window.dispatchEvent(new CustomEvent("layer:reload:property_boundary"))}catch(A){console.error("Failed to import boundary",A),window.alert(`Import failed: ${A instanceof Error?A.message:"Please make sure the file is a valid KML/GeoJSON polygon."}`)}finally{P&&(P.value="")}},w=()=>{if(!f)return;if(n){l.current&&(f.removeInteraction(l.current),l.current=null),r(!1);return}p();const T=new Qo({source:o.current,type:"Polygon"});T.on("drawend",async P=>{const F=P.feature;o.current.clear(),o.current.addFeature(F),await g(F),l.current&&(f.removeInteraction(l.current),l.current=null,r(!1))}),l.current=T,f.addInteraction(T),r(!0)};if(!f||!c)return null;const x={padding:"8px 14px",borderRadius:6,border:"1px solid rgba(15,23,42,0.12)",background:"#f7f9fc",cursor:"pointer",fontSize:13,fontWeight:500,textAlign:"left"},S=n?{...x,background:"#ffe8e6",borderColor:"#fca5a5",color:"#b91c1c"}:x;if(!f||!c||t&&!i)return null;if(!i&&d&&!t)return E.jsxs(E.Fragment,{children:[E.jsx("input",{ref:e,type:"file",accept:".geojson,.json,.kml,.gpx",style:{display:"none"},onChange:v}),E.jsx("button",{onClick:()=>s(!0),style:{position:"fixed",top:12,left:12,padding:"6px 12px",borderRadius:6,border:"1px solid rgba(15,23,42,0.12)",background:"rgba(255,255,255,0.92)",fontSize:12,cursor:"pointer",color:"rgba(15,23,42,0.75)",zIndex:1e3},children:"Boundary Tools"})]});const C=t?{position:"fixed",left:"50%",top:"50%",transform:"translate(-50%, -50%)",display:"flex",flexDirection:"column",gap:8,padding:"14px 16px",borderRadius:10,border:"1px solid rgba(15, 23, 42, 0.12)",background:"rgba(255, 255, 255, 0.98)",boxShadow:"0 22px 48px rgba(15, 23, 42, 0.28)",zIndex:1400,minWidth:280,maxWidth:360}:{position:"fixed",top:12,left:12,display:"flex",flexDirection:"column",gap:8,padding:"12px 14px",borderRadius:6,border:"1px solid rgba(15, 23, 42, 0.12)",background:"rgba(255, 255, 255, 0.94)",boxShadow:"0 10px 28px rgba(15, 23, 42, 0.12)",zIndex:1e3,maxWidth:240};return E.jsxs("div",{style:C,children:[E.jsxs("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center"},children:[E.jsx("strong",{style:{fontSize:13,color:"rgba(15,23,42,0.75)"},children:"Property Boundary"}),d||t?E.jsx("button",{onClick:()=>s(!1),style:{border:"none",background:"transparent",fontSize:11,color:"rgba(15,23,42,0.55)",cursor:"pointer"},children:t?"Close":"Hide"}):null]}),d?E.jsx("p",{style:{margin:0,fontSize:12,color:"rgba(15,23,42,0.55)"},children:"Update or replace your existing parcel outline."}):E.jsx("p",{style:{margin:0,fontSize:12,color:"rgba(15,23,42,0.55)"},children:"Import a boundary file or sketch your property outline."}),E.jsx("input",{ref:e,type:"file",accept:".geojson,.json,.kml,.gpx",style:{display:"none"},onChange:v}),E.jsx("button",{onClick:y,style:{...x,background:"#0a84ff",color:"#fff",borderColor:"#0a84ff"},children:d?"Replace Boundary":"Import Boundary"}),E.jsx("button",{onClick:w,style:S,children:n?"Cancel Drawing":d?"Redraw Boundary":"Draw Boundary"})]})}let ng;const hH=new Uint8Array(16);function fH(){if(!ng&&(ng=typeof crypto<"u"&&crypto.getRandomValues&&crypto.getRandomValues.bind(crypto),!ng))throw new Error("crypto.getRandomValues() not supported. See https://github.com/uuidjs/uuid#getrandomvalues-not-supported");return ng(hH)}const gn=[];for(let t=0;t<256;++t)gn.push((t+256).toString(16).slice(1));function gH(t,e=0){return gn[t[e+0]]+gn[t[e+1]]+gn[t[e+2]]+gn[t[e+3]]+"-"+gn[t[e+4]]+gn[t[e+5]]+"-"+gn[t[e+6]]+gn[t[e+7]]+"-"+gn[t[e+8]]+gn[t[e+9]]+"-"+gn[t[e+10]]+gn[t[e+11]]+gn[t[e+12]]+gn[t[e+13]]+gn[t[e+14]]+gn[t[e+15]]}const pH=typeof crypto<"u"&&crypto.randomUUID&&crypto.randomUUID.bind(crypto),NP={randomUUID:pH};function Ba(t,e,n){if(NP.randomUUID&&!t)return NP.randomUUID();t=t||{};const r=t.random||(t.rng||fH)();return r[6]=r[6]&15|64,r[8]=r[8]&63|128,gH(r)}const mH=["property_boundary","streams","cliffs","ravines","big_rocks","tree_stands","bedding_areas","open_woods","acorn_flats","trails"],yH=["scrapes","rubs","animal_sign","mast_check_points","beds_points","bedding_areas","trails"],_H=["hunts","harvests","animal_sightings","animal_paths","stands"],It=Qi((t,e)=>({preset:"everything",timeWindow:"all",setPreset:n=>t({preset:n}),setTimeWindow:n=>t({timeWindow:n}),overrides:{},setLayerOverride:(n,r)=>t(i=>({overrides:{...i.overrides,[n]:r}})),isLayerVisible:n=>{const r=e().preset,i=e().overrides[n];return typeof i=="boolean"?i:r==="everything"?!0:r==="terrain"?mH.includes(n):r==="sign"?yH.includes(n):r==="hunts"?_H.includes(n):!0}}));function Ye(t){return typeof t!="object"||t===null||typeof t.lastModified=="number"&&typeof File<"u"&&t instanceof File||typeof t.getMonth=="function"&&typeof Date<"u"&&t instanceof Date?!1:!Array.isArray(t)}function vH(t){return t.additionalItems===!0&&console.warn("additionalItems=true is currently not supported"),Ye(t.additionalItems)}function jP(t){if(t==="")return;if(t===null)return null;if(/\.$/.test(t)||/\.0$/.test(t)||/\.\d*0$/.test(t))return t;const e=Number(t);return typeof e=="number"&&!Number.isNaN(e)?e:t}const Wh="__additional_property",jw="additionalProperties",du="allOf",pi="anyOf",Ns="const",wH="default",xy="dependencies",xH="enum",gr="__errors",bo="$id",EH="if",Lo="items",SH="_$junk_option_schema_id$_",zg="$name",yr="oneOf",jt="properties",bH="required",im="submitButtonOptions",nn="$ref",IE="__rjsf_additionalProperties",$L="__rjsf_rootSchema",CH="ui:field",AE="ui:widget",Id="ui:options",TH="ui:globalOptions";function Ke(t={},e={}){return Object.keys(t).filter(n=>n.indexOf("ui:")===0).reduce((n,r)=>{const i=t[r];return r===AE&&Ye(i)?(console.error("Setting options via ui:widget object is no longer supported, use ui:options instead"),n):r===Id&&Ye(i)?{...n,...i}:{...n,[r.substring(3)]:i}},{...e})}function PH(t,e={},n){if(!t.additionalProperties)return!1;const{expandable:r=!0}=Ke(e);return r===!1?r:t.maxProperties!==void 0&&n?Object.keys(n).length<t.maxProperties:!0}var LL=typeof global=="object"&&global&&global.Object===Object&&global,RH=typeof self=="object"&&self&&self.Object===Object&&self,ts=LL||RH||Function("return this")(),Zr=ts.Symbol,kL=Object.prototype,IH=kL.hasOwnProperty,AH=kL.toString,Xu=Zr?Zr.toStringTag:void 0;function FH(t){var e=IH.call(t,Xu),n=t[Xu];try{t[Xu]=void 0;var r=!0}catch{}var i=AH.call(t);return r&&(e?t[Xu]=n:delete t[Xu]),i}var OH=Object.prototype,$H=OH.toString;function LH(t){return $H.call(t)}var kH="[object Null]",MH="[object Undefined]",zP=Zr?Zr.toStringTag:void 0;function Ys(t){return t==null?t===void 0?MH:kH:zP&&zP in Object(t)?FH(t):LH(t)}function ML(t,e){return function(n){return t(e(n))}}var Ey=ML(Object.getPrototypeOf,Object);function qr(t){return t!=null&&typeof t=="object"}var DH="[object Object]",NH=Function.prototype,jH=Object.prototype,DL=NH.toString,zH=jH.hasOwnProperty,UH=DL.call(Object);function Va(t){if(!qr(t)||Ys(t)!=DH)return!1;var e=Ey(t);if(e===null)return!0;var n=zH.call(e,"constructor")&&e.constructor;return typeof n=="function"&&n instanceof n&&DL.call(n)==UH}function sm(t){const e={[gr]:[],addError(n){this[gr].push(n)}};if(Array.isArray(t))return t.reduce((n,r,i)=>({...n,[i]:sm(r)}),e);if(Va(t)){const n=t;return Object.keys(n).reduce((r,i)=>({...r,[i]:sm(n[i])}),e)}return e}function GH(){this.__data__=[],this.size=0}function Hh(t,e){return t===e||t!==t&&e!==e}function Sy(t,e){for(var n=t.length;n--;)if(Hh(t[n][0],e))return n;return-1}var BH=Array.prototype,VH=BH.splice;function WH(t){var e=this.__data__,n=Sy(e,t);if(n<0)return!1;var r=e.length-1;return n==r?e.pop():VH.call(e,n,1),--this.size,!0}function HH(t){var e=this.__data__,n=Sy(e,t);return n<0?void 0:e[n][1]}function KH(t){return Sy(this.__data__,t)>-1}function YH(t,e){var n=this.__data__,r=Sy(n,t);return r<0?(++this.size,n.push([t,e])):n[r][1]=e,this}function Xs(t){var e=-1,n=t==null?0:t.length;for(this.clear();++e<n;){var r=t[e];this.set(r[0],r[1])}}Xs.prototype.clear=GH;Xs.prototype.delete=WH;Xs.prototype.get=HH;Xs.prototype.has=KH;Xs.prototype.set=YH;function XH(){this.__data__=new Xs,this.size=0}function ZH(t){var e=this.__data__,n=e.delete(t);return this.size=e.size,n}function qH(t){return this.__data__.get(t)}function JH(t){return this.__data__.has(t)}function mt(t){var e=typeof t;return t!=null&&(e=="object"||e=="function")}var QH="[object AsyncFunction]",e9="[object Function]",t9="[object GeneratorFunction]",n9="[object Proxy]";function by(t){if(!mt(t))return!1;var e=Ys(t);return e==e9||e==t9||e==QH||e==n9}var F0=ts["__core-js_shared__"],UP=function(){var t=/[^.]+$/.exec(F0&&F0.keys&&F0.keys.IE_PROTO||"");return t?"Symbol(src)_1."+t:""}();function r9(t){return!!UP&&UP in t}var i9=Function.prototype,s9=i9.toString;function ll(t){if(t!=null){try{return s9.call(t)}catch{}try{return t+""}catch{}}return""}var o9=/[\\^$.*+?()[\]{}|]/g,a9=/^\[object .+?Constructor\]$/,l9=Function.prototype,c9=Object.prototype,u9=l9.toString,d9=c9.hasOwnProperty,h9=RegExp("^"+u9.call(d9).replace(o9,"\\$&").replace(/hasOwnProperty|(function).*?(?=\\\()| for .+?(?=\\\])/g,"$1.*?")+"$");function f9(t){if(!mt(t)||r9(t))return!1;var e=by(t)?h9:a9;return e.test(ll(t))}function g9(t,e){return t==null?void 0:t[e]}function cl(t,e){var n=g9(t,e);return f9(n)?n:void 0}var yh=cl(ts,"Map"),_h=cl(Object,"create");function p9(){this.__data__=_h?_h(null):{},this.size=0}function m9(t){var e=this.has(t)&&delete this.__data__[t];return this.size-=e?1:0,e}var y9="__lodash_hash_undefined__",_9=Object.prototype,v9=_9.hasOwnProperty;function w9(t){var e=this.__data__;if(_h){var n=e[t];return n===y9?void 0:n}return v9.call(e,t)?e[t]:void 0}var x9=Object.prototype,E9=x9.hasOwnProperty;function S9(t){var e=this.__data__;return _h?e[t]!==void 0:E9.call(e,t)}var b9="__lodash_hash_undefined__";function C9(t,e){var n=this.__data__;return this.size+=this.has(t)?0:1,n[t]=_h&&e===void 0?b9:e,this}function Wa(t){var e=-1,n=t==null?0:t.length;for(this.clear();++e<n;){var r=t[e];this.set(r[0],r[1])}}Wa.prototype.clear=p9;Wa.prototype.delete=m9;Wa.prototype.get=w9;Wa.prototype.has=S9;Wa.prototype.set=C9;function T9(){this.size=0,this.__data__={hash:new Wa,map:new(yh||Xs),string:new Wa}}function P9(t){var e=typeof t;return e=="string"||e=="number"||e=="symbol"||e=="boolean"?t!=="__proto__":t===null}function Cy(t,e){var n=t.__data__;return P9(e)?n[typeof e=="string"?"string":"hash"]:n.map}function R9(t){var e=Cy(this,t).delete(t);return this.size-=e?1:0,e}function I9(t){return Cy(this,t).get(t)}function A9(t){return Cy(this,t).has(t)}function F9(t,e){var n=Cy(this,t),r=n.size;return n.set(t,e),this.size+=n.size==r?0:1,this}function Zs(t){var e=-1,n=t==null?0:t.length;for(this.clear();++e<n;){var r=t[e];this.set(r[0],r[1])}}Zs.prototype.clear=T9;Zs.prototype.delete=R9;Zs.prototype.get=I9;Zs.prototype.has=A9;Zs.prototype.set=F9;var O9=200;function $9(t,e){var n=this.__data__;if(n instanceof Xs){var r=n.__data__;if(!yh||r.length<O9-1)return r.push([t,e]),this.size=++n.size,this;n=this.__data__=new Zs(r)}return n.set(t,e),this.size=n.size,this}function vi(t){var e=this.__data__=new Xs(t);this.size=e.size}vi.prototype.clear=XH;vi.prototype.delete=ZH;vi.prototype.get=qH;vi.prototype.has=JH;vi.prototype.set=$9;var L9="__lodash_hash_undefined__";function k9(t){return this.__data__.set(t,L9),this}function M9(t){return this.__data__.has(t)}function Uc(t){var e=-1,n=t==null?0:t.length;for(this.__data__=new Zs;++e<n;)this.add(t[e])}Uc.prototype.add=Uc.prototype.push=k9;Uc.prototype.has=M9;function D9(t,e){for(var n=-1,r=t==null?0:t.length;++n<r;)if(e(t[n],n,t))return!0;return!1}function FE(t,e){return t.has(e)}var N9=1,j9=2;function NL(t,e,n,r,i,s){var o=n&N9,a=t.length,l=e.length;if(a!=l&&!(o&&l>a))return!1;var c=s.get(t),u=s.get(e);if(c&&u)return c==e&&u==t;var d=-1,h=!0,f=n&j9?new Uc:void 0;for(s.set(t,e),s.set(e,t);++d<a;){var p=t[d],m=e[d];if(r)var _=o?r(m,p,d,e,t,s):r(p,m,d,t,e,s);if(_!==void 0){if(_)continue;h=!1;break}if(f){if(!D9(e,function(g,y){if(!FE(f,y)&&(p===g||i(p,g,n,r,s)))return f.push(y)})){h=!1;break}}else if(!(p===m||i(p,m,n,r,s))){h=!1;break}}return s.delete(t),s.delete(e),h}var om=ts.Uint8Array;function z9(t){var e=-1,n=Array(t.size);return t.forEach(function(r,i){n[++e]=[i,r]}),n}function OE(t){var e=-1,n=Array(t.size);return t.forEach(function(r){n[++e]=r}),n}var U9=1,G9=2,B9="[object Boolean]",V9="[object Date]",W9="[object Error]",H9="[object Map]",K9="[object Number]",Y9="[object RegExp]",X9="[object Set]",Z9="[object String]",q9="[object Symbol]",J9="[object ArrayBuffer]",Q9="[object DataView]",GP=Zr?Zr.prototype:void 0,O0=GP?GP.valueOf:void 0;function eK(t,e,n,r,i,s,o){switch(n){case Q9:if(t.byteLength!=e.byteLength||t.byteOffset!=e.byteOffset)return!1;t=t.buffer,e=e.buffer;case J9:return!(t.byteLength!=e.byteLength||!s(new om(t),new om(e)));case B9:case V9:case K9:return Hh(+t,+e);case W9:return t.name==e.name&&t.message==e.message;case Y9:case Z9:return t==e+"";case H9:var a=z9;case X9:var l=r&U9;if(a||(a=OE),t.size!=e.size&&!l)return!1;var c=o.get(t);if(c)return c==e;r|=G9,o.set(t,e);var u=NL(a(t),a(e),r,i,s,o);return o.delete(t),u;case q9:if(O0)return O0.call(t)==O0.call(e)}return!1}function $E(t,e){for(var n=-1,r=e.length,i=t.length;++n<r;)t[i+n]=e[n];return t}var rn=Array.isArray;function jL(t,e,n){var r=e(t);return rn(t)?r:$E(r,n(t))}function tK(t,e){for(var n=-1,r=t==null?0:t.length,i=0,s=[];++n<r;){var o=t[n];e(o,n,t)&&(s[i++]=o)}return s}function zL(){return[]}var nK=Object.prototype,rK=nK.propertyIsEnumerable,BP=Object.getOwnPropertySymbols,LE=BP?function(t){return t==null?[]:(t=Object(t),tK(BP(t),function(e){return rK.call(t,e)}))}:zL;function UL(t,e){for(var n=-1,r=Array(t);++n<t;)r[n]=e(n);return r}var iK="[object Arguments]";function VP(t){return qr(t)&&Ys(t)==iK}var GL=Object.prototype,sK=GL.hasOwnProperty,oK=GL.propertyIsEnumerable,Gc=VP(function(){return arguments}())?VP:function(t){return qr(t)&&sK.call(t,"callee")&&!oK.call(t,"callee")};function aK(){return!1}var BL=typeof exports=="object"&&exports&&!exports.nodeType&&exports,WP=BL&&typeof module=="object"&&module&&!module.nodeType&&module,lK=WP&&WP.exports===BL,HP=lK?ts.Buffer:void 0,cK=HP?HP.isBuffer:void 0,Ha=cK||aK,uK=9007199254740991,dK=/^(?:0|[1-9]\d*)$/;function Ty(t,e){var n=typeof t;return e=e??uK,!!e&&(n=="number"||n!="symbol"&&dK.test(t))&&t>-1&&t%1==0&&t<e}var hK=9007199254740991;function kE(t){return typeof t=="number"&&t>-1&&t%1==0&&t<=hK}var fK="[object Arguments]",gK="[object Array]",pK="[object Boolean]",mK="[object Date]",yK="[object Error]",_K="[object Function]",vK="[object Map]",wK="[object Number]",xK="[object Object]",EK="[object RegExp]",SK="[object Set]",bK="[object String]",CK="[object WeakMap]",TK="[object ArrayBuffer]",PK="[object DataView]",RK="[object Float32Array]",IK="[object Float64Array]",AK="[object Int8Array]",FK="[object Int16Array]",OK="[object Int32Array]",$K="[object Uint8Array]",LK="[object Uint8ClampedArray]",kK="[object Uint16Array]",MK="[object Uint32Array]",xt={};xt[RK]=xt[IK]=xt[AK]=xt[FK]=xt[OK]=xt[$K]=xt[LK]=xt[kK]=xt[MK]=!0;xt[fK]=xt[gK]=xt[TK]=xt[pK]=xt[PK]=xt[mK]=xt[yK]=xt[_K]=xt[vK]=xt[wK]=xt[xK]=xt[EK]=xt[SK]=xt[bK]=xt[CK]=!1;function DK(t){return qr(t)&&kE(t.length)&&!!xt[Ys(t)]}function ME(t){return function(e){return t(e)}}var VL=typeof exports=="object"&&exports&&!exports.nodeType&&exports,Ad=VL&&typeof module=="object"&&module&&!module.nodeType&&module,NK=Ad&&Ad.exports===VL,$0=NK&&LL.process,Bc=function(){try{var t=Ad&&Ad.require&&Ad.require("util").types;return t||$0&&$0.binding&&$0.binding("util")}catch{}}(),KP=Bc&&Bc.isTypedArray,Kh=KP?ME(KP):DK,jK=Object.prototype,zK=jK.hasOwnProperty;function WL(t,e){var n=rn(t),r=!n&&Gc(t),i=!n&&!r&&Ha(t),s=!n&&!r&&!i&&Kh(t),o=n||r||i||s,a=o?UL(t.length,String):[],l=a.length;for(var c in t)(e||zK.call(t,c))&&!(o&&(c=="length"||i&&(c=="offset"||c=="parent")||s&&(c=="buffer"||c=="byteLength"||c=="byteOffset")||Ty(c,l)))&&a.push(c);return a}var UK=Object.prototype;function Py(t){var e=t&&t.constructor,n=typeof e=="function"&&e.prototype||UK;return t===n}var GK=ML(Object.keys,Object),BK=Object.prototype,VK=BK.hasOwnProperty;function HL(t){if(!Py(t))return GK(t);var e=[];for(var n in Object(t))VK.call(t,n)&&n!="constructor"&&e.push(n);return e}function hu(t){return t!=null&&kE(t.length)&&!by(t)}function Mi(t){return hu(t)?WL(t):HL(t)}function zw(t){return jL(t,Mi,LE)}var WK=1,HK=Object.prototype,KK=HK.hasOwnProperty;function YK(t,e,n,r,i,s){var o=n&WK,a=zw(t),l=a.length,c=zw(e),u=c.length;if(l!=u&&!o)return!1;for(var d=l;d--;){var h=a[d];if(!(o?h in e:KK.call(e,h)))return!1}var f=s.get(t),p=s.get(e);if(f&&p)return f==e&&p==t;var m=!0;s.set(t,e),s.set(e,t);for(var _=o;++d<l;){h=a[d];var g=t[h],y=e[h];if(r)var v=o?r(y,g,h,e,t,s):r(g,y,h,t,e,s);if(!(v===void 0?g===y||i(g,y,n,r,s):v)){m=!1;break}_||(_=h=="constructor")}if(m&&!_){var w=t.constructor,x=e.constructor;w!=x&&"constructor"in t&&"constructor"in e&&!(typeof w=="function"&&w instanceof w&&typeof x=="function"&&x instanceof x)&&(m=!1)}return s.delete(t),s.delete(e),m}var Uw=cl(ts,"DataView"),Gw=cl(ts,"Promise"),Ec=cl(ts,"Set"),Bw=cl(ts,"WeakMap"),YP="[object Map]",XK="[object Object]",XP="[object Promise]",ZP="[object Set]",qP="[object WeakMap]",JP="[object DataView]",ZK=ll(Uw),qK=ll(yh),JK=ll(Gw),QK=ll(Ec),eY=ll(Bw),Dr=Ys;(Uw&&Dr(new Uw(new ArrayBuffer(1)))!=JP||yh&&Dr(new yh)!=YP||Gw&&Dr(Gw.resolve())!=XP||Ec&&Dr(new Ec)!=ZP||Bw&&Dr(new Bw)!=qP)&&(Dr=function(t){var e=Ys(t),n=e==XK?t.constructor:void 0,r=n?ll(n):"";if(r)switch(r){case ZK:return JP;case qK:return YP;case JK:return XP;case QK:return ZP;case eY:return qP}return e});var tY=1,QP="[object Arguments]",e2="[object Array]",rg="[object Object]",nY=Object.prototype,t2=nY.hasOwnProperty;function rY(t,e,n,r,i,s){var o=rn(t),a=rn(e),l=o?e2:Dr(t),c=a?e2:Dr(e);l=l==QP?rg:l,c=c==QP?rg:c;var u=l==rg,d=c==rg,h=l==c;if(h&&Ha(t)){if(!Ha(e))return!1;o=!0,u=!1}if(h&&!u)return s||(s=new vi),o||Kh(t)?NL(t,e,n,r,i,s):eK(t,e,l,n,r,i,s);if(!(n&tY)){var f=u&&t2.call(t,"__wrapped__"),p=d&&t2.call(e,"__wrapped__");if(f||p){var m=f?t.value():t,_=p?e.value():e;return s||(s=new vi),i(m,_,n,r,s)}}return h?(s||(s=new vi),YK(t,e,n,r,i,s)):!1}function Ry(t,e,n,r,i){return t===e?!0:t==null||e==null||!qr(t)&&!qr(e)?t!==t&&e!==e:rY(t,e,n,r,Ry,i)}function iY(t,e,n){n=typeof n=="function"?n:void 0;var r=n?n(t,e):void 0;return r===void 0?Ry(t,e,void 0,n):!!r}function St(t,e){return iY(t,e,(n,r)=>{if(typeof n=="function"&&typeof r=="function")return!0})}var sY="[object Symbol]";function Yh(t){return typeof t=="symbol"||qr(t)&&Ys(t)==sY}var oY=/\.|\[(?:[^[\]]*|(["'])(?:(?!\1)[^\\]|\\.)*?\1)\]/,aY=/^\w*$/;function DE(t,e){if(rn(t))return!1;var n=typeof t;return n=="number"||n=="symbol"||n=="boolean"||t==null||Yh(t)?!0:aY.test(t)||!oY.test(t)||e!=null&&t in Object(e)}var lY="Expected a function";function NE(t,e){if(typeof t!="function"||e!=null&&typeof e!="function")throw new TypeError(lY);var n=function(){var r=arguments,i=e?e.apply(this,r):r[0],s=n.cache;if(s.has(i))return s.get(i);var o=t.apply(this,r);return n.cache=s.set(i,o)||s,o};return n.cache=new(NE.Cache||Zs),n}NE.Cache=Zs;var cY=500;function uY(t){var e=NE(t,function(r){return n.size===cY&&n.clear(),r}),n=e.cache;return e}var dY=/[^.[\]]+|\[(?:(-?\d+(?:\.\d+)?)|(["'])((?:(?!\2)[^\\]|\\.)*?)\2)\]|(?=(?:\.|\[\])(?:\.|\[\]|$))/g,hY=/\\(\\)?/g,KL=uY(function(t){var e=[];return t.charCodeAt(0)===46&&e.push(""),t.replace(dY,function(n,r,i,s){e.push(i?s.replace(hY,"$1"):r||n)}),e});function Iy(t,e){for(var n=-1,r=t==null?0:t.length,i=Array(r);++n<r;)i[n]=e(t[n],n,t);return i}var n2=Zr?Zr.prototype:void 0,r2=n2?n2.toString:void 0;function YL(t){if(typeof t=="string")return t;if(rn(t))return Iy(t,YL)+"";if(Yh(t))return r2?r2.call(t):"";var e=t+"";return e=="0"&&1/t==-1/0?"-0":e}function jE(t){return t==null?"":YL(t)}function fu(t,e){return rn(t)?t:DE(t,e)?[t]:KL(jE(t))}function ul(t){if(typeof t=="string"||Yh(t))return t;var e=t+"";return e=="0"&&1/t==-1/0?"-0":e}function Ay(t,e){e=fu(e,t);for(var n=0,r=e.length;t!=null&&n<r;)t=t[ul(e[n++])];return n&&n==r?t:void 0}function we(t,e,n){var r=t==null?void 0:Ay(t,e);return r===void 0?n:r}var fY="[object Map]",gY="[object Set]",pY=Object.prototype,mY=pY.hasOwnProperty;function Vc(t){if(t==null)return!0;if(hu(t)&&(rn(t)||typeof t=="string"||typeof t.splice=="function"||Ha(t)||Kh(t)||Gc(t)))return!t.length;var e=Dr(t);if(e==fY||e==gY)return!t.size;if(Py(t))return!HL(t).length;for(var n in t)if(mY.call(t,n))return!1;return!0}var Fy={},yY=/~/,_Y=/~[01]/g;function vY(t){switch(t){case"~1":return"/";case"~0":return"~"}throw new Error("Invalid tilde escape: "+t)}function XL(t){return yY.test(t)?t.replace(_Y,vY):t}function wY(t,e,n){for(var r,i,s=1,o=e.length;s<o;){if(e[s]==="constructor"||e[s]==="prototype"||e[s]==="__proto__")return t;if(r=XL(e[s++]),i=o>s,typeof t[r]>"u"&&(Array.isArray(t)&&r==="-"&&(r=t.length),i&&(e[s]!==""&&e[s]<1/0||e[s]==="-"?t[r]=[]:t[r]={})),!i)break;t=t[r]}var a=t[r];return n===void 0?delete t[r]:t[r]=n,a}function zE(t){if(typeof t=="string"){if(t=t.split("/"),t[0]==="")return t;throw new Error("Invalid JSON pointer.")}else if(Array.isArray(t)){for(const e of t)if(typeof e!="string"&&typeof e!="number")throw new Error("Invalid JSON pointer. Must be of type string or number.");return t}throw new Error("Invalid JSON pointer.")}function ZL(t,e){if(typeof t!="object")throw new Error("Invalid input object.");e=zE(e);var n=e.length;if(n===1)return t;for(var r=1;r<n;){if(t=t[XL(e[r++])],n===r)return t;if(typeof t!="object"||t===null)return}}function qL(t,e,n){if(typeof t!="object")throw new Error("Invalid input object.");if(e=zE(e),e.length===0)throw new Error("Invalid JSON pointer for set.");return wY(t,e,n)}function xY(t){var e=zE(t);return{get:function(n){return ZL(n,e)},set:function(n,r){return qL(n,e,r)}}}Fy.get=ZL;Fy.set=qL;Fy.compile=xY;function UE(t,e){for(var n=-1,r=t==null?0:t.length;++n<r&&e(t[n],n,t)!==!1;);return t}var am=function(){try{var t=cl(Object,"defineProperty");return t({},"",{}),t}catch{}}();function GE(t,e,n){e=="__proto__"&&am?am(t,e,{configurable:!0,enumerable:!0,value:n,writable:!0}):t[e]=n}var EY=Object.prototype,SY=EY.hasOwnProperty;function BE(t,e,n){var r=t[e];(!(SY.call(t,e)&&Hh(r,n))||n===void 0&&!(e in t))&&GE(t,e,n)}function gu(t,e,n,r){var i=!n;n||(n={});for(var s=-1,o=e.length;++s<o;){var a=e[s],l=void 0;l===void 0&&(l=t[a]),i?GE(n,a,l):BE(n,a,l)}return n}function bY(t,e){return t&&gu(e,Mi(e),t)}function CY(t){var e=[];if(t!=null)for(var n in Object(t))e.push(n);return e}var TY=Object.prototype,PY=TY.hasOwnProperty;function RY(t){if(!mt(t))return CY(t);var e=Py(t),n=[];for(var r in t)r=="constructor"&&(e||!PY.call(t,r))||n.push(r);return n}function Xh(t){return hu(t)?WL(t,!0):RY(t)}function IY(t,e){return t&&gu(e,Xh(e),t)}var JL=typeof exports=="object"&&exports&&!exports.nodeType&&exports,i2=JL&&typeof module=="object"&&module&&!module.nodeType&&module,AY=i2&&i2.exports===JL,s2=AY?ts.Buffer:void 0,o2=s2?s2.allocUnsafe:void 0;function QL(t,e){if(e)return t.slice();var n=t.length,r=o2?o2(n):new t.constructor(n);return t.copy(r),r}function VE(t,e){var n=-1,r=t.length;for(e||(e=Array(r));++n<r;)e[n]=t[n];return e}function FY(t,e){return gu(t,LE(t),e)}var OY=Object.getOwnPropertySymbols,ek=OY?function(t){for(var e=[];t;)$E(e,LE(t)),t=Ey(t);return e}:zL;function $Y(t,e){return gu(t,ek(t),e)}function WE(t){return jL(t,Xh,ek)}var LY=Object.prototype,kY=LY.hasOwnProperty;function MY(t){var e=t.length,n=new t.constructor(e);return e&&typeof t[0]=="string"&&kY.call(t,"index")&&(n.index=t.index,n.input=t.input),n}function HE(t){var e=new t.constructor(t.byteLength);return new om(e).set(new om(t)),e}function DY(t,e){var n=e?HE(t.buffer):t.buffer;return new t.constructor(n,t.byteOffset,t.byteLength)}var NY=/\w*$/;function jY(t){var e=new t.constructor(t.source,NY.exec(t));return e.lastIndex=t.lastIndex,e}var a2=Zr?Zr.prototype:void 0,l2=a2?a2.valueOf:void 0;function zY(t){return l2?Object(l2.call(t)):{}}function tk(t,e){var n=e?HE(t.buffer):t.buffer;return new t.constructor(n,t.byteOffset,t.length)}var UY="[object Boolean]",GY="[object Date]",BY="[object Map]",VY="[object Number]",WY="[object RegExp]",HY="[object Set]",KY="[object String]",YY="[object Symbol]",XY="[object ArrayBuffer]",ZY="[object DataView]",qY="[object Float32Array]",JY="[object Float64Array]",QY="[object Int8Array]",eX="[object Int16Array]",tX="[object Int32Array]",nX="[object Uint8Array]",rX="[object Uint8ClampedArray]",iX="[object Uint16Array]",sX="[object Uint32Array]";function oX(t,e,n){var r=t.constructor;switch(e){case XY:return HE(t);case UY:case GY:return new r(+t);case ZY:return DY(t,n);case qY:case JY:case QY:case eX:case tX:case nX:case rX:case iX:case sX:return tk(t,n);case BY:return new r;case VY:case KY:return new r(t);case WY:return jY(t);case HY:return new r;case YY:return zY(t)}}var c2=Object.create,nk=function(){function t(){}return function(e){if(!mt(e))return{};if(c2)return c2(e);t.prototype=e;var n=new t;return t.prototype=void 0,n}}();function rk(t){return typeof t.constructor=="function"&&!Py(t)?nk(Ey(t)):{}}var aX="[object Map]";function lX(t){return qr(t)&&Dr(t)==aX}var u2=Bc&&Bc.isMap,cX=u2?ME(u2):lX,uX="[object Set]";function dX(t){return qr(t)&&Dr(t)==uX}var d2=Bc&&Bc.isSet,hX=d2?ME(d2):dX,fX=1,gX=2,pX=4,ik="[object Arguments]",mX="[object Array]",yX="[object Boolean]",_X="[object Date]",vX="[object Error]",sk="[object Function]",wX="[object GeneratorFunction]",xX="[object Map]",EX="[object Number]",ok="[object Object]",SX="[object RegExp]",bX="[object Set]",CX="[object String]",TX="[object Symbol]",PX="[object WeakMap]",RX="[object ArrayBuffer]",IX="[object DataView]",AX="[object Float32Array]",FX="[object Float64Array]",OX="[object Int8Array]",$X="[object Int16Array]",LX="[object Int32Array]",kX="[object Uint8Array]",MX="[object Uint8ClampedArray]",DX="[object Uint16Array]",NX="[object Uint32Array]",ht={};ht[ik]=ht[mX]=ht[RX]=ht[IX]=ht[yX]=ht[_X]=ht[AX]=ht[FX]=ht[OX]=ht[$X]=ht[LX]=ht[xX]=ht[EX]=ht[ok]=ht[SX]=ht[bX]=ht[CX]=ht[TX]=ht[kX]=ht[MX]=ht[DX]=ht[NX]=!0;ht[vX]=ht[sk]=ht[PX]=!1;function Fd(t,e,n,r,i,s){var o,a=e&fX,l=e&gX,c=e&pX;if(n&&(o=i?n(t,r,i,s):n(t)),o!==void 0)return o;if(!mt(t))return t;var u=rn(t);if(u){if(o=MY(t),!a)return VE(t,o)}else{var d=Dr(t),h=d==sk||d==wX;if(Ha(t))return QL(t,a);if(d==ok||d==ik||h&&!i){if(o=l||h?{}:rk(t),!a)return l?$Y(t,IY(o,t)):FY(t,bY(o,t))}else{if(!ht[d])return i?t:{};o=oX(t,d,a)}}s||(s=new vi);var f=s.get(t);if(f)return f;s.set(t,o),hX(t)?t.forEach(function(_){o.add(Fd(_,e,n,_,t,s))}):cX(t)&&t.forEach(function(_,g){o.set(g,Fd(_,e,n,g,t,s))});var p=c?l?WE:zw:l?Xh:Mi,m=u?void 0:p(t);return UE(m||t,function(_,g){m&&(g=_,_=t[g]),BE(o,g,Fd(_,e,n,g,t,s))}),o}function jX(t){var e=t==null?0:t.length;return e?t[e-1]:void 0}function zX(t,e,n){var r=-1,i=t.length;e<0&&(e=-e>i?0:i+e),n=n>i?i:n,n<0&&(n+=i),i=e>n?0:n-e>>>0,e>>>=0;for(var s=Array(i);++r<i;)s[r]=t[r+e];return s}function UX(t,e){return e.length<2?t:Ay(t,zX(e,0,-1))}function ak(t,e){return e=fu(e,t),t=UX(t,e),t==null||delete t[ul(jX(e))]}function GX(t){return Va(t)?void 0:t}var h2=Zr?Zr.isConcatSpreadable:void 0;function BX(t){return rn(t)||Gc(t)||!!(h2&&t&&t[h2])}function Zh(t,e,n,r,i){var s=-1,o=t.length;for(n||(n=BX),i||(i=[]);++s<o;){var a=t[s];e>0&&n(a)?e>1?Zh(a,e-1,n,r,i):$E(i,a):r||(i[i.length]=a)}return i}function VX(t){var e=t==null?0:t.length;return e?Zh(t,1):[]}function WX(t,e,n){switch(n.length){case 0:return t.call(e);case 1:return t.call(e,n[0]);case 2:return t.call(e,n[0],n[1]);case 3:return t.call(e,n[0],n[1],n[2])}return t.apply(e,n)}var f2=Math.max;function lk(t,e,n){return e=f2(e===void 0?t.length-1:e,0),function(){for(var r=arguments,i=-1,s=f2(r.length-e,0),o=Array(s);++i<s;)o[i]=r[e+i];i=-1;for(var a=Array(e+1);++i<e;)a[i]=r[i];return a[e]=n(o),WX(t,this,a)}}function HX(t){return function(){return t}}function Oy(t){return t}var KX=am?function(t,e){return am(t,"toString",{configurable:!0,enumerable:!1,value:HX(e),writable:!0})}:Oy,YX=800,XX=16,ZX=Date.now;function qX(t){var e=0,n=0;return function(){var r=ZX(),i=XX-(r-n);if(n=r,i>0){if(++e>=YX)return arguments[0]}else e=0;return t.apply(void 0,arguments)}}var ck=qX(KX);function uk(t){return ck(lk(t,void 0,VX),t+"")}var JX=1,QX=2,e7=4,lm=uk(function(t,e){var n={};if(t==null)return n;var r=!1;e=Iy(e,function(s){return s=fu(s,t),r||(r=s.length>1),s}),gu(t,WE(t),n),r&&(n=Fd(n,JX|QX|e7,GX));for(var i=e.length;i--;)ak(n,e[i]);return n});function KE(t,e){const n=e[t];return[lm(e,[t]),n]}function dk(t,e={},n=[]){const r=t||"";let i;if(r.startsWith("#"))i=decodeURIComponent(r.substring(1));else throw new Error(`Could not find a definition for ${t}.`);const s=Fy.get(e,i);if(s===void 0)throw new Error(`Could not find a definition for ${t}.`);const o=s[nn];if(o){if(n.includes(o)){if(n.length===1)throw new Error(`Definition for ${t} is a circular reference`);const[u,...d]=n,h=[...d,r,u].join(" -> ");throw new Error(`Definition for ${u} contains a circular reference through ${h}`)}const[a,l]=KE(nn,s),c=dk(l,e,[...n,r]);return Object.keys(a).length>0?{...a,...c}:c}return s}function hk(t,e={}){return dk(t,e,[])}var t7=Object.prototype,n7=t7.hasOwnProperty;function r7(t,e){return t!=null&&n7.call(t,e)}function fk(t,e,n){e=fu(e,t);for(var r=-1,i=e.length,s=!1;++r<i;){var o=ul(e[r]);if(!(s=t!=null&&n(t,o)))break;t=t[o]}return s||++r!=i?s:(i=t==null?0:t.length,!!i&&kE(i)&&Ty(o,i)&&(rn(t)||Gc(t)))}function Un(t,e){return t!=null&&fk(t,e,r7)}var i7="[object Number]";function gk(t){return typeof t=="number"||qr(t)&&Ys(t)==i7}var s7="[object String]";function $y(t){return typeof t=="string"||!rn(t)&&qr(t)&&Ys(t)==s7}function o7(t,e,n,r){var i=-1,s=t==null?0:t.length;for(r&&s&&(n=t[++i]);++i<s;)n=e(n,t[i],i,t);return n}function a7(t){return function(e,n,r){for(var i=-1,s=Object(e),o=r(e),a=o.length;a--;){var l=o[++i];if(n(s[l],l,s)===!1)break}return e}}var pk=a7();function mk(t,e){return t&&pk(t,e,Mi)}function l7(t,e){return function(n,r){if(n==null)return n;if(!hu(n))return t(n,r);for(var i=n.length,s=-1,o=Object(n);++s<i&&r(o[s],s,o)!==!1;);return n}}var yk=l7(mk),c7=1,u7=2;function d7(t,e,n,r){var i=n.length,s=i;if(t==null)return!s;for(t=Object(t);i--;){var o=n[i];if(o[2]?o[1]!==t[o[0]]:!(o[0]in t))return!1}for(;++i<s;){o=n[i];var a=o[0],l=t[a],c=o[1];if(o[2]){if(l===void 0&&!(a in t))return!1}else{var u=new vi,d;if(!(d===void 0?Ry(c,l,c7|u7,r,u):d))return!1}}return!0}function _k(t){return t===t&&!mt(t)}function h7(t){for(var e=Mi(t),n=e.length;n--;){var r=e[n],i=t[r];e[n]=[r,i,_k(i)]}return e}function vk(t,e){return function(n){return n==null?!1:n[t]===e&&(e!==void 0||t in Object(n))}}function f7(t){var e=h7(t);return e.length==1&&e[0][2]?vk(e[0][0],e[0][1]):function(n){return n===t||d7(n,t,e)}}function g7(t,e){return t!=null&&e in Object(t)}function wk(t,e){return t!=null&&fk(t,e,g7)}var p7=1,m7=2;function y7(t,e){return DE(t)&&_k(e)?vk(ul(t),e):function(n){var r=we(n,t);return r===void 0&&r===e?wk(n,t):Ry(e,r,p7|m7)}}function _7(t){return function(e){return e==null?void 0:e[t]}}function v7(t){return function(e){return Ay(e,t)}}function w7(t){return DE(t)?_7(ul(t)):v7(t)}function YE(t){return typeof t=="function"?t:t==null?Oy:typeof t=="object"?rn(t)?y7(t[0],t[1]):f7(t):w7(t)}function x7(t,e,n,r,i){return i(t,function(s,o,a){n=r?(r=!1,s):e(n,s,o,a)}),n}function E7(t,e,n){var r=rn(t)?o7:x7,i=arguments.length<3;return r(t,YE(e),n,i,yk)}function xk(t){return typeof t=="function"?t:Oy}var S7=/\s/;function b7(t){for(var e=t.length;e--&&S7.test(t.charAt(e)););return e}var C7=/^\s+/;function T7(t){return t&&t.slice(0,b7(t)+1).replace(C7,"")}var g2=NaN,P7=/^[-+]0x[0-9a-f]+$/i,R7=/^0b[01]+$/i,I7=/^0o[0-7]+$/i,A7=parseInt;function F7(t){if(typeof t=="number")return t;if(Yh(t))return g2;if(mt(t)){var e=typeof t.valueOf=="function"?t.valueOf():t;t=mt(e)?e+"":e}if(typeof t!="string")return t===0?t:+t;t=T7(t);var n=R7.test(t);return n||I7.test(t)?A7(t.slice(2),n?2:8):P7.test(t)?g2:+t}var p2=1/0,O7=17976931348623157e292;function $7(t){if(!t)return t===0?t:0;if(t=F7(t),t===p2||t===-p2){var e=t<0?-1:1;return e*O7}return t===t?t:0}function L7(t){var e=$7(t),n=e%1;return e===e?n?e-n:e:0}var k7=9007199254740991,L0=4294967295,M7=Math.min;function Ek(t,e){if(t=L7(t),t<1||t>k7)return[];var n=L0,r=M7(t,L0);e=xk(e),t-=L0;for(var i=UL(r,e);++n<t;)e(n);return i}function Sk(t,e,n){var r;if(t&&n){const i=we(t,n);if(i===void 0)return;for(let s=0;s<e.length;s++){const o=e[s],a=we(o,[jt,n],{});if(!(a.type==="object"||a.type==="array")&&(a.const===i||!((r=a.enum)===null||r===void 0)&&r.includes(i)))return s}}}function bk(t,e,n,r,i){if(e===void 0)return 0;const s=Sk(e,n,i);if(gk(s))return s;for(let o=0;o<n.length;o++){const a=n[o];if(i&&Un(a,[jt,i])){const l=we(e,i),c=we(a,[jt,i],{});if(t.isValid(c,l,r))return o}else if(a[jt]){const l={anyOf:Object.keys(a[jt]).map(u=>({required:[u]}))};let c;if(a.anyOf){const{...u}=a;u.allOf?u.allOf=u.allOf.slice():u.allOf=[],u.allOf.push(l),c=u}else c=Object.assign({},a,l);if(delete c.required,t.isValid(c,e,r))return o}else if(t.isValid(a,e,r))return o}return 0}function XE(t,e,n,r,i){return bk(t,e,n,r,i)}function ZE(t,e,n,r){if(!mt(t))return t;e=fu(e,t);for(var i=-1,s=e.length,o=s-1,a=t;a!=null&&++i<s;){var l=ul(e[i]),c=n;if(l==="__proto__"||l==="constructor"||l==="prototype")return t;if(i!=o){var u=a[l];c=r?r(u,l,a):void 0,c===void 0&&(c=mt(u)?u:Ty(e[i+1])?[]:{})}BE(a,l,c),a=a[l]}return t}function vn(t,e,n){return t==null?t:ZE(t,e,n)}function D7(t,e,n){var r=rn(t),i=r||Ha(t)||Kh(t);if(e=YE(e),n==null){var s=t&&t.constructor;i?n=r?new s:[]:mt(t)?n=by(s)?nk(Ey(t)):{}:n={}}return(i?UE:mk)(t,function(o,a,l){return e(n,o,a,l)}),n}function Vw(t,e,n){(n!==void 0&&!Hh(t[e],n)||n===void 0&&!(e in t))&&GE(t,e,n)}function cm(t){return qr(t)&&hu(t)}function Ww(t,e){if(!(e==="constructor"&&typeof t[e]=="function")&&e!="__proto__")return t[e]}function N7(t){return gu(t,Xh(t))}function j7(t,e,n,r,i,s,o){var a=Ww(t,n),l=Ww(e,n),c=o.get(l);if(c){Vw(t,n,c);return}var u=s?s(a,l,n+"",t,e,o):void 0,d=u===void 0;if(d){var h=rn(l),f=!h&&Ha(l),p=!h&&!f&&Kh(l);u=l,h||f||p?rn(a)?u=a:cm(a)?u=VE(a):f?(d=!1,u=QL(l,!0)):p?(d=!1,u=tk(l,!0)):u=[]:Va(l)||Gc(l)?(u=a,Gc(a)?u=N7(a):(!mt(a)||by(a))&&(u=rk(l))):d=!1}d&&(o.set(l,u),i(u,l,r,s,o),o.delete(l)),Vw(t,n,u)}function Ck(t,e,n,r,i){t!==e&&pk(e,function(s,o){if(i||(i=new vi),mt(s))j7(t,e,o,n,Ck,r,i);else{var a=r?r(Ww(t,o),s,o+"",t,e,i):void 0;a===void 0&&(a=s),Vw(t,o,a)}},Xh)}function qE(t,e){return ck(lk(t,e,Oy),t+"")}function z7(t,e,n){if(!mt(n))return!1;var r=typeof e;return(r=="number"?hu(n)&&Ty(e,n.length):r=="string"&&e in n)?Hh(n[e],t):!1}function U7(t){return qE(function(e,n){var r=-1,i=n.length,s=i>1?n[i-1]:void 0,o=i>2?n[2]:void 0;for(s=t.length>3&&typeof s=="function"?(i--,s):void 0,o&&z7(n[0],n[1],o)&&(s=i<3?void 0:s,i=1),e=Object(e);++r<i;){var a=n[r];a&&t(e,a,r,s)}return e})}var G7=U7(function(t,e,n){Ck(t,e,n)}),B7=1/0;function V7(t){var e=t==null?0:t.length;return e?Zh(t,B7):[]}function W7(t,e,n,r){for(var i=t.length,s=n+-1;++s<i;)if(e(t[s],s,t))return s;return-1}function H7(t){return t!==t}function K7(t,e,n){for(var r=n-1,i=t.length;++r<i;)if(t[r]===e)return r;return-1}function Y7(t,e,n){return e===e?K7(t,e,n):W7(t,H7,n)}function Tk(t,e){var n=t==null?0:t.length;return!!n&&Y7(t,e,0)>-1}function X7(){}var Z7=1/0,q7=Ec&&1/OE(new Ec([,-0]))[1]==Z7?function(t){return new Ec(t)}:X7,J7=200;function Pk(t,e,n){var r=-1,i=Tk,s=t.length,o=!0,a=[],l=a;if(s>=J7){var c=q7(t);if(c)return OE(c);o=!1,i=FE,l=new Uc}else l=a;e:for(;++r<s;){var u=t[r],d=u;if(u=u!==0?u:0,o&&d===d){for(var h=l.length;h--;)if(l[h]===d)continue e;a.push(u)}else i(l,d,n)||(l!==a&&l.push(d),a.push(u))}return a}function Q7(t){return t&&t.length?Pk(t):[]}function eZ(){this.__data__=[],this.size=0}var tZ=eZ;function nZ(t,e){return t===e||t!==t&&e!==e}var pu=nZ,rZ=pu;function iZ(t,e){for(var n=t.length;n--;)if(rZ(t[n][0],e))return n;return-1}var Ly=iZ,sZ=Ly,oZ=Array.prototype,aZ=oZ.splice;function lZ(t){var e=this.__data__,n=sZ(e,t);if(n<0)return!1;var r=e.length-1;return n==r?e.pop():aZ.call(e,n,1),--this.size,!0}var cZ=lZ,uZ=Ly;function dZ(t){var e=this.__data__,n=uZ(e,t);return n<0?void 0:e[n][1]}var hZ=dZ,fZ=Ly;function gZ(t){return fZ(this.__data__,t)>-1}var pZ=gZ,mZ=Ly;function yZ(t,e){var n=this.__data__,r=mZ(n,t);return r<0?(++this.size,n.push([t,e])):n[r][1]=e,this}var _Z=yZ,vZ=tZ,wZ=cZ,xZ=hZ,EZ=pZ,SZ=_Z;function mu(t){var e=-1,n=t==null?0:t.length;for(this.clear();++e<n;){var r=t[e];this.set(r[0],r[1])}}mu.prototype.clear=vZ;mu.prototype.delete=wZ;mu.prototype.get=xZ;mu.prototype.has=EZ;mu.prototype.set=SZ;var ky=mu,bZ=ky;function CZ(){this.__data__=new bZ,this.size=0}var TZ=CZ;function PZ(t){var e=this.__data__,n=e.delete(t);return this.size=e.size,n}var RZ=PZ;function IZ(t){return this.__data__.get(t)}var AZ=IZ;function FZ(t){return this.__data__.has(t)}var OZ=FZ,$Z=typeof po=="object"&&po&&po.Object===Object&&po,Rk=$Z,LZ=Rk,kZ=typeof self=="object"&&self&&self.Object===Object&&self,MZ=LZ||kZ||Function("return this")(),ns=MZ,DZ=ns,NZ=DZ.Symbol,yu=NZ,m2=yu,Ik=Object.prototype,jZ=Ik.hasOwnProperty,zZ=Ik.toString,Zu=m2?m2.toStringTag:void 0;function UZ(t){var e=jZ.call(t,Zu),n=t[Zu];try{t[Zu]=void 0;var r=!0}catch{}var i=zZ.call(t);return r&&(e?t[Zu]=n:delete t[Zu]),i}var GZ=UZ,BZ=Object.prototype,VZ=BZ.toString;function WZ(t){return VZ.call(t)}var HZ=WZ,y2=yu,KZ=GZ,YZ=HZ,XZ="[object Null]",ZZ="[object Undefined]",_2=y2?y2.toStringTag:void 0;function qZ(t){return t==null?t===void 0?ZZ:XZ:_2&&_2 in Object(t)?KZ(t):YZ(t)}var dl=qZ;function JZ(t){var e=typeof t;return t!=null&&(e=="object"||e=="function")}var rs=JZ,QZ=dl,eq=rs,tq="[object AsyncFunction]",nq="[object Function]",rq="[object GeneratorFunction]",iq="[object Proxy]";function sq(t){if(!eq(t))return!1;var e=QZ(t);return e==nq||e==rq||e==tq||e==iq}var JE=sq,oq=ns,aq=oq["__core-js_shared__"],lq=aq,k0=lq,v2=function(){var t=/[^.]+$/.exec(k0&&k0.keys&&k0.keys.IE_PROTO||"");return t?"Symbol(src)_1."+t:""}();function cq(t){return!!v2&&v2 in t}var uq=cq,dq=Function.prototype,hq=dq.toString;function fq(t){if(t!=null){try{return hq.call(t)}catch{}try{return t+""}catch{}}return""}var Ak=fq,gq=JE,pq=uq,mq=rs,yq=Ak,_q=/[\\^$.*+?()[\]{}|]/g,vq=/^\[object .+?Constructor\]$/,wq=Function.prototype,xq=Object.prototype,Eq=wq.toString,Sq=xq.hasOwnProperty,bq=RegExp("^"+Eq.call(Sq).replace(_q,"\\$&").replace(/hasOwnProperty|(function).*?(?=\\\()| for .+?(?=\\\])/g,"$1.*?")+"$");function Cq(t){if(!mq(t)||pq(t))return!1;var e=gq(t)?bq:vq;return e.test(yq(t))}var Tq=Cq;function Pq(t,e){return t==null?void 0:t[e]}var Rq=Pq,Iq=Tq,Aq=Rq;function Fq(t,e){var n=Aq(t,e);return Iq(n)?n:void 0}var hl=Fq,Oq=hl,$q=ns,Lq=Oq($q,"Map"),QE=Lq,kq=hl,Mq=kq(Object,"create"),My=Mq,w2=My;function Dq(){this.__data__=w2?w2(null):{},this.size=0}var Nq=Dq;function jq(t){var e=this.has(t)&&delete this.__data__[t];return this.size-=e?1:0,e}var zq=jq,Uq=My,Gq="__lodash_hash_undefined__",Bq=Object.prototype,Vq=Bq.hasOwnProperty;function Wq(t){var e=this.__data__;if(Uq){var n=e[t];return n===Gq?void 0:n}return Vq.call(e,t)?e[t]:void 0}var Hq=Wq,Kq=My,Yq=Object.prototype,Xq=Yq.hasOwnProperty;function Zq(t){var e=this.__data__;return Kq?e[t]!==void 0:Xq.call(e,t)}var qq=Zq,Jq=My,Qq="__lodash_hash_undefined__";function eJ(t,e){var n=this.__data__;return this.size+=this.has(t)?0:1,n[t]=Jq&&e===void 0?Qq:e,this}var tJ=eJ,nJ=Nq,rJ=zq,iJ=Hq,sJ=qq,oJ=tJ;function _u(t){var e=-1,n=t==null?0:t.length;for(this.clear();++e<n;){var r=t[e];this.set(r[0],r[1])}}_u.prototype.clear=nJ;_u.prototype.delete=rJ;_u.prototype.get=iJ;_u.prototype.has=sJ;_u.prototype.set=oJ;var aJ=_u,x2=aJ,lJ=ky,cJ=QE;function uJ(){this.size=0,this.__data__={hash:new x2,map:new(cJ||lJ),string:new x2}}var dJ=uJ;function hJ(t){var e=typeof t;return e=="string"||e=="number"||e=="symbol"||e=="boolean"?t!=="__proto__":t===null}var fJ=hJ,gJ=fJ;function pJ(t,e){var n=t.__data__;return gJ(e)?n[typeof e=="string"?"string":"hash"]:n.map}var Dy=pJ,mJ=Dy;function yJ(t){var e=mJ(this,t).delete(t);return this.size-=e?1:0,e}var _J=yJ,vJ=Dy;function wJ(t){return vJ(this,t).get(t)}var xJ=wJ,EJ=Dy;function SJ(t){return EJ(this,t).has(t)}var bJ=SJ,CJ=Dy;function TJ(t,e){var n=CJ(this,t),r=n.size;return n.set(t,e),this.size+=n.size==r?0:1,this}var PJ=TJ,RJ=dJ,IJ=_J,AJ=xJ,FJ=bJ,OJ=PJ;function vu(t){var e=-1,n=t==null?0:t.length;for(this.clear();++e<n;){var r=t[e];this.set(r[0],r[1])}}vu.prototype.clear=RJ;vu.prototype.delete=IJ;vu.prototype.get=AJ;vu.prototype.has=FJ;vu.prototype.set=OJ;var eS=vu,$J=ky,LJ=QE,kJ=eS,MJ=200;function DJ(t,e){var n=this.__data__;if(n instanceof $J){var r=n.__data__;if(!LJ||r.length<MJ-1)return r.push([t,e]),this.size=++n.size,this;n=this.__data__=new kJ(r)}return n.set(t,e),this.size=n.size,this}var NJ=DJ,jJ=ky,zJ=TZ,UJ=RZ,GJ=AZ,BJ=OZ,VJ=NJ;function wu(t){var e=this.__data__=new jJ(t);this.size=e.size}wu.prototype.clear=zJ;wu.prototype.delete=UJ;wu.prototype.get=GJ;wu.prototype.has=BJ;wu.prototype.set=VJ;var Ny=wu;function WJ(t,e){for(var n=-1,r=t==null?0:t.length;++n<r&&e(t[n],n,t)!==!1;);return t}var Fk=WJ,HJ=hl,KJ=function(){try{var t=HJ(Object,"defineProperty");return t({},"",{}),t}catch{}}(),Ok=KJ,E2=Ok;function YJ(t,e,n){e=="__proto__"&&E2?E2(t,e,{configurable:!0,enumerable:!0,value:n,writable:!0}):t[e]=n}var tS=YJ,XJ=tS,ZJ=pu,qJ=Object.prototype,JJ=qJ.hasOwnProperty;function QJ(t,e,n){var r=t[e];(!(JJ.call(t,e)&&ZJ(r,n))||n===void 0&&!(e in t))&&XJ(t,e,n)}var $k=QJ,eQ=$k,tQ=tS;function nQ(t,e,n,r){var i=!n;n||(n={});for(var s=-1,o=e.length;++s<o;){var a=e[s],l=r?r(n[a],t[a],a,n,t):void 0;l===void 0&&(l=t[a]),i?tQ(n,a,l):eQ(n,a,l)}return n}var qh=nQ;function rQ(t,e){for(var n=-1,r=Array(t);++n<t;)r[n]=e(n);return r}var iQ=rQ;function sQ(t){return t!=null&&typeof t=="object"}var is=sQ,oQ=dl,aQ=is,lQ="[object Arguments]";function cQ(t){return aQ(t)&&oQ(t)==lQ}var uQ=cQ,S2=uQ,dQ=is,Lk=Object.prototype,hQ=Lk.hasOwnProperty,fQ=Lk.propertyIsEnumerable,gQ=S2(function(){return arguments}())?S2:function(t){return dQ(t)&&hQ.call(t,"callee")&&!fQ.call(t,"callee")},jy=gQ,pQ=Array.isArray,Rr=pQ,um={exports:{}};function mQ(){return!1}var yQ=mQ;um.exports;(function(t,e){var n=ns,r=yQ,i=e&&!e.nodeType&&e,s=i&&!0&&t&&!t.nodeType&&t,o=s&&s.exports===i,a=o?n.Buffer:void 0,l=a?a.isBuffer:void 0,c=l||r;t.exports=c})(um,um.exports);var zy=um.exports,_Q=9007199254740991,vQ=/^(?:0|[1-9]\d*)$/;function wQ(t,e){var n=typeof t;return e=e??_Q,!!e&&(n=="number"||n!="symbol"&&vQ.test(t))&&t>-1&&t%1==0&&t<e}var nS=wQ,xQ=9007199254740991;function EQ(t){return typeof t=="number"&&t>-1&&t%1==0&&t<=xQ}var rS=EQ,SQ=dl,bQ=rS,CQ=is,TQ="[object Arguments]",PQ="[object Array]",RQ="[object Boolean]",IQ="[object Date]",AQ="[object Error]",FQ="[object Function]",OQ="[object Map]",$Q="[object Number]",LQ="[object Object]",kQ="[object RegExp]",MQ="[object Set]",DQ="[object String]",NQ="[object WeakMap]",jQ="[object ArrayBuffer]",zQ="[object DataView]",UQ="[object Float32Array]",GQ="[object Float64Array]",BQ="[object Int8Array]",VQ="[object Int16Array]",WQ="[object Int32Array]",HQ="[object Uint8Array]",KQ="[object Uint8ClampedArray]",YQ="[object Uint16Array]",XQ="[object Uint32Array]",Et={};Et[UQ]=Et[GQ]=Et[BQ]=Et[VQ]=Et[WQ]=Et[HQ]=Et[KQ]=Et[YQ]=Et[XQ]=!0;Et[TQ]=Et[PQ]=Et[jQ]=Et[RQ]=Et[zQ]=Et[IQ]=Et[AQ]=Et[FQ]=Et[OQ]=Et[$Q]=Et[LQ]=Et[kQ]=Et[MQ]=Et[DQ]=Et[NQ]=!1;function ZQ(t){return CQ(t)&&bQ(t.length)&&!!Et[SQ(t)]}var qQ=ZQ;function JQ(t){return function(e){return t(e)}}var fl=JQ,dm={exports:{}};dm.exports;(function(t,e){var n=Rk,r=e&&!e.nodeType&&e,i=r&&!0&&t&&!t.nodeType&&t,s=i&&i.exports===r,o=s&&n.process,a=function(){try{var l=i&&i.require&&i.require("util").types;return l||o&&o.binding&&o.binding("util")}catch{}}();t.exports=a})(dm,dm.exports);var iS=dm.exports,QQ=qQ,eee=fl,b2=iS,C2=b2&&b2.isTypedArray,tee=C2?eee(C2):QQ,sS=tee,nee=iQ,ree=jy,iee=Rr,see=zy,oee=nS,aee=sS,lee=Object.prototype,cee=lee.hasOwnProperty;function uee(t,e){var n=iee(t),r=!n&&ree(t),i=!n&&!r&&see(t),s=!n&&!r&&!i&&aee(t),o=n||r||i||s,a=o?nee(t.length,String):[],l=a.length;for(var c in t)(e||cee.call(t,c))&&!(o&&(c=="length"||i&&(c=="offset"||c=="parent")||s&&(c=="buffer"||c=="byteLength"||c=="byteOffset")||oee(c,l)))&&a.push(c);return a}var kk=uee,dee=Object.prototype;function hee(t){var e=t&&t.constructor,n=typeof e=="function"&&e.prototype||dee;return t===n}var oS=hee;function fee(t,e){return function(n){return t(e(n))}}var Mk=fee,gee=Mk,pee=gee(Object.keys,Object),mee=pee,yee=oS,_ee=mee,vee=Object.prototype,wee=vee.hasOwnProperty;function xee(t){if(!yee(t))return _ee(t);var e=[];for(var n in Object(t))wee.call(t,n)&&n!="constructor"&&e.push(n);return e}var Eee=xee,See=JE,bee=rS;function Cee(t){return t!=null&&bee(t.length)&&!See(t)}var xu=Cee,Tee=kk,Pee=Eee,Ree=xu;function Iee(t){return Ree(t)?Tee(t):Pee(t)}var Jh=Iee,Aee=qh,Fee=Jh;function Oee(t,e){return t&&Aee(e,Fee(e),t)}var $ee=Oee;function Lee(t){var e=[];if(t!=null)for(var n in Object(t))e.push(n);return e}var kee=Lee,Mee=rs,Dee=oS,Nee=kee,jee=Object.prototype,zee=jee.hasOwnProperty;function Uee(t){if(!Mee(t))return Nee(t);var e=Dee(t),n=[];for(var r in t)r=="constructor"&&(e||!zee.call(t,r))||n.push(r);return n}var Gee=Uee,Bee=kk,Vee=Gee,Wee=xu;function Hee(t){return Wee(t)?Bee(t,!0):Vee(t)}var Eu=Hee,Kee=qh,Yee=Eu;function Xee(t,e){return t&&Kee(e,Yee(e),t)}var Zee=Xee,hm={exports:{}};hm.exports;(function(t,e){var n=ns,r=e&&!e.nodeType&&e,i=r&&!0&&t&&!t.nodeType&&t,s=i&&i.exports===r,o=s?n.Buffer:void 0,a=o?o.allocUnsafe:void 0;function l(c,u){if(u)return c.slice();var d=c.length,h=a?a(d):new c.constructor(d);return c.copy(h),h}t.exports=l})(hm,hm.exports);var Dk=hm.exports;function qee(t,e){var n=-1,r=t.length;for(e||(e=Array(r));++n<r;)e[n]=t[n];return e}var aS=qee;function Jee(t,e){for(var n=-1,r=t==null?0:t.length,i=0,s=[];++n<r;){var o=t[n];e(o,n,t)&&(s[i++]=o)}return s}var Qee=Jee;function ete(){return[]}var Nk=ete,tte=Qee,nte=Nk,rte=Object.prototype,ite=rte.propertyIsEnumerable,T2=Object.getOwnPropertySymbols,ste=T2?function(t){return t==null?[]:(t=Object(t),tte(T2(t),function(e){return ite.call(t,e)}))}:nte,lS=ste,ote=qh,ate=lS;function lte(t,e){return ote(t,ate(t),e)}var cte=lte;function ute(t,e){for(var n=-1,r=e.length,i=t.length;++n<r;)t[i+n]=e[n];return t}var cS=ute,dte=Mk,hte=dte(Object.getPrototypeOf,Object),uS=hte,fte=cS,gte=uS,pte=lS,mte=Nk,yte=Object.getOwnPropertySymbols,_te=yte?function(t){for(var e=[];t;)fte(e,pte(t)),t=gte(t);return e}:mte,jk=_te,vte=qh,wte=jk;function xte(t,e){return vte(t,wte(t),e)}var Ete=xte,Ste=cS,bte=Rr;function Cte(t,e,n){var r=e(t);return bte(t)?r:Ste(r,n(t))}var zk=Cte,Tte=zk,Pte=lS,Rte=Jh;function Ite(t){return Tte(t,Rte,Pte)}var Uk=Ite,Ate=zk,Fte=jk,Ote=Eu;function $te(t){return Ate(t,Ote,Fte)}var Lte=$te,kte=hl,Mte=ns,Dte=kte(Mte,"DataView"),Nte=Dte,jte=hl,zte=ns,Ute=jte(zte,"Promise"),Gte=Ute,Bte=hl,Vte=ns,Wte=Bte(Vte,"Set"),Gk=Wte,Hte=hl,Kte=ns,Yte=Hte(Kte,"WeakMap"),Xte=Yte,Hw=Nte,Kw=QE,Yw=Gte,Xw=Gk,Zw=Xte,Bk=dl,Su=Ak,P2="[object Map]",Zte="[object Object]",R2="[object Promise]",I2="[object Set]",A2="[object WeakMap]",F2="[object DataView]",qte=Su(Hw),Jte=Su(Kw),Qte=Su(Yw),ene=Su(Xw),tne=Su(Zw),fa=Bk;(Hw&&fa(new Hw(new ArrayBuffer(1)))!=F2||Kw&&fa(new Kw)!=P2||Yw&&fa(Yw.resolve())!=R2||Xw&&fa(new Xw)!=I2||Zw&&fa(new Zw)!=A2)&&(fa=function(t){var e=Bk(t),n=e==Zte?t.constructor:void 0,r=n?Su(n):"";if(r)switch(r){case qte:return F2;case Jte:return P2;case Qte:return R2;case ene:return I2;case tne:return A2}return e});var Uy=fa,nne=Object.prototype,rne=nne.hasOwnProperty;function ine(t){var e=t.length,n=new t.constructor(e);return e&&typeof t[0]=="string"&&rne.call(t,"index")&&(n.index=t.index,n.input=t.input),n}var sne=ine,one=ns,ane=one.Uint8Array,Vk=ane,O2=Vk;function lne(t){var e=new t.constructor(t.byteLength);return new O2(e).set(new O2(t)),e}var dS=lne,cne=dS;function une(t,e){var n=e?cne(t.buffer):t.buffer;return new t.constructor(n,t.byteOffset,t.byteLength)}var dne=une,hne=/\w*$/;function fne(t){var e=new t.constructor(t.source,hne.exec(t));return e.lastIndex=t.lastIndex,e}var gne=fne,$2=yu,L2=$2?$2.prototype:void 0,k2=L2?L2.valueOf:void 0;function pne(t){return k2?Object(k2.call(t)):{}}var mne=pne,yne=dS;function _ne(t,e){var n=e?yne(t.buffer):t.buffer;return new t.constructor(n,t.byteOffset,t.length)}var Wk=_ne,vne=dS,wne=dne,xne=gne,Ene=mne,Sne=Wk,bne="[object Boolean]",Cne="[object Date]",Tne="[object Map]",Pne="[object Number]",Rne="[object RegExp]",Ine="[object Set]",Ane="[object String]",Fne="[object Symbol]",One="[object ArrayBuffer]",$ne="[object DataView]",Lne="[object Float32Array]",kne="[object Float64Array]",Mne="[object Int8Array]",Dne="[object Int16Array]",Nne="[object Int32Array]",jne="[object Uint8Array]",zne="[object Uint8ClampedArray]",Une="[object Uint16Array]",Gne="[object Uint32Array]";function Bne(t,e,n){var r=t.constructor;switch(e){case One:return vne(t);case bne:case Cne:return new r(+t);case $ne:return wne(t,n);case Lne:case kne:case Mne:case Dne:case Nne:case jne:case zne:case Une:case Gne:return Sne(t,n);case Tne:return new r;case Pne:case Ane:return new r(t);case Rne:return xne(t);case Ine:return new r;case Fne:return Ene(t)}}var Vne=Bne,Wne=rs,M2=Object.create,Hne=function(){function t(){}return function(e){if(!Wne(e))return{};if(M2)return M2(e);t.prototype=e;var n=new t;return t.prototype=void 0,n}}(),Kne=Hne,Yne=Kne,Xne=uS,Zne=oS;function qne(t){return typeof t.constructor=="function"&&!Zne(t)?Yne(Xne(t)):{}}var Hk=qne,Jne=Uy,Qne=is,ere="[object Map]";function tre(t){return Qne(t)&&Jne(t)==ere}var nre=tre,rre=nre,ire=fl,D2=iS,N2=D2&&D2.isMap,sre=N2?ire(N2):rre,ore=sre,are=Uy,lre=is,cre="[object Set]";function ure(t){return lre(t)&&are(t)==cre}var dre=ure,hre=dre,fre=fl,j2=iS,z2=j2&&j2.isSet,gre=z2?fre(z2):hre,pre=gre,mre=Ny,yre=Fk,_re=$k,vre=$ee,wre=Zee,xre=Dk,Ere=aS,Sre=cte,bre=Ete,Cre=Uk,Tre=Lte,Pre=Uy,Rre=sne,Ire=Vne,Are=Hk,Fre=Rr,Ore=zy,$re=ore,Lre=rs,kre=pre,Mre=Jh,Dre=Eu,Nre=1,jre=2,zre=4,Kk="[object Arguments]",Ure="[object Array]",Gre="[object Boolean]",Bre="[object Date]",Vre="[object Error]",Yk="[object Function]",Wre="[object GeneratorFunction]",Hre="[object Map]",Kre="[object Number]",Xk="[object Object]",Yre="[object RegExp]",Xre="[object Set]",Zre="[object String]",qre="[object Symbol]",Jre="[object WeakMap]",Qre="[object ArrayBuffer]",eie="[object DataView]",tie="[object Float32Array]",nie="[object Float64Array]",rie="[object Int8Array]",iie="[object Int16Array]",sie="[object Int32Array]",oie="[object Uint8Array]",aie="[object Uint8ClampedArray]",lie="[object Uint16Array]",cie="[object Uint32Array]",ft={};ft[Kk]=ft[Ure]=ft[Qre]=ft[eie]=ft[Gre]=ft[Bre]=ft[tie]=ft[nie]=ft[rie]=ft[iie]=ft[sie]=ft[Hre]=ft[Kre]=ft[Xk]=ft[Yre]=ft[Xre]=ft[Zre]=ft[qre]=ft[oie]=ft[aie]=ft[lie]=ft[cie]=!0;ft[Vre]=ft[Yk]=ft[Jre]=!1;function Ug(t,e,n,r,i,s){var o,a=e&Nre,l=e&jre,c=e&zre;if(n&&(o=i?n(t,r,i,s):n(t)),o!==void 0)return o;if(!Lre(t))return t;var u=Fre(t);if(u){if(o=Rre(t),!a)return Ere(t,o)}else{var d=Pre(t),h=d==Yk||d==Wre;if(Ore(t))return xre(t,a);if(d==Xk||d==Kk||h&&!i){if(o=l||h?{}:Are(t),!a)return l?bre(t,wre(o,t)):Sre(t,vre(o,t))}else{if(!ft[d])return i?t:{};o=Ire(t,d,a)}}s||(s=new mre);var f=s.get(t);if(f)return f;s.set(t,o),kre(t)?t.forEach(function(_){o.add(Ug(_,e,n,_,t,s))}):$re(t)&&t.forEach(function(_,g){o.set(g,Ug(_,e,n,g,t,s))});var p=c?l?Tre:Cre:l?Dre:Mre,m=u?void 0:p(t);return yre(m||t,function(_,g){m&&(g=_,_=t[g]),_re(o,g,Ug(_,e,n,g,t,s))}),o}var uie=Ug,die=uie,hie=1,fie=4;function gie(t){return die(t,hie|fie)}var pie=gie,mie="__lodash_hash_undefined__";function yie(t){return this.__data__.set(t,mie),this}var _ie=yie;function vie(t){return this.__data__.has(t)}var wie=vie,xie=eS,Eie=_ie,Sie=wie;function fm(t){var e=-1,n=t==null?0:t.length;for(this.__data__=new xie;++e<n;)this.add(t[e])}fm.prototype.add=fm.prototype.push=Eie;fm.prototype.has=Sie;var Gy=fm;function bie(t,e){for(var n=-1,r=t==null?0:t.length;++n<r;)if(e(t[n],n,t))return!0;return!1}var Cie=bie;function Tie(t,e){return t.has(e)}var By=Tie,Pie=Gy,Rie=Cie,Iie=By,Aie=1,Fie=2;function Oie(t,e,n,r,i,s){var o=n&Aie,a=t.length,l=e.length;if(a!=l&&!(o&&l>a))return!1;var c=s.get(t),u=s.get(e);if(c&&u)return c==e&&u==t;var d=-1,h=!0,f=n&Fie?new Pie:void 0;for(s.set(t,e),s.set(e,t);++d<a;){var p=t[d],m=e[d];if(r)var _=o?r(m,p,d,e,t,s):r(p,m,d,t,e,s);if(_!==void 0){if(_)continue;h=!1;break}if(f){if(!Rie(e,function(g,y){if(!Iie(f,y)&&(p===g||i(p,g,n,r,s)))return f.push(y)})){h=!1;break}}else if(!(p===m||i(p,m,n,r,s))){h=!1;break}}return s.delete(t),s.delete(e),h}var Zk=Oie;function $ie(t){var e=-1,n=Array(t.size);return t.forEach(function(r,i){n[++e]=[i,r]}),n}var Lie=$ie;function kie(t){var e=-1,n=Array(t.size);return t.forEach(function(r){n[++e]=r}),n}var hS=kie,U2=yu,G2=Vk,Mie=pu,Die=Zk,Nie=Lie,jie=hS,zie=1,Uie=2,Gie="[object Boolean]",Bie="[object Date]",Vie="[object Error]",Wie="[object Map]",Hie="[object Number]",Kie="[object RegExp]",Yie="[object Set]",Xie="[object String]",Zie="[object Symbol]",qie="[object ArrayBuffer]",Jie="[object DataView]",B2=U2?U2.prototype:void 0,M0=B2?B2.valueOf:void 0;function Qie(t,e,n,r,i,s,o){switch(n){case Jie:if(t.byteLength!=e.byteLength||t.byteOffset!=e.byteOffset)return!1;t=t.buffer,e=e.buffer;case qie:return!(t.byteLength!=e.byteLength||!s(new G2(t),new G2(e)));case Gie:case Bie:case Hie:return Mie(+t,+e);case Vie:return t.name==e.name&&t.message==e.message;case Kie:case Xie:return t==e+"";case Wie:var a=Nie;case Yie:var l=r&zie;if(a||(a=jie),t.size!=e.size&&!l)return!1;var c=o.get(t);if(c)return c==e;r|=Uie,o.set(t,e);var u=Die(a(t),a(e),r,i,s,o);return o.delete(t),u;case Zie:if(M0)return M0.call(t)==M0.call(e)}return!1}var ese=Qie,V2=Uk,tse=1,nse=Object.prototype,rse=nse.hasOwnProperty;function ise(t,e,n,r,i,s){var o=n&tse,a=V2(t),l=a.length,c=V2(e),u=c.length;if(l!=u&&!o)return!1;for(var d=l;d--;){var h=a[d];if(!(o?h in e:rse.call(e,h)))return!1}var f=s.get(t),p=s.get(e);if(f&&p)return f==e&&p==t;var m=!0;s.set(t,e),s.set(e,t);for(var _=o;++d<l;){h=a[d];var g=t[h],y=e[h];if(r)var v=o?r(y,g,h,e,t,s):r(g,y,h,t,e,s);if(!(v===void 0?g===y||i(g,y,n,r,s):v)){m=!1;break}_||(_=h=="constructor")}if(m&&!_){var w=t.constructor,x=e.constructor;w!=x&&"constructor"in t&&"constructor"in e&&!(typeof w=="function"&&w instanceof w&&typeof x=="function"&&x instanceof x)&&(m=!1)}return s.delete(t),s.delete(e),m}var sse=ise,D0=Ny,ose=Zk,ase=ese,lse=sse,W2=Uy,H2=Rr,K2=zy,cse=sS,use=1,Y2="[object Arguments]",X2="[object Array]",ig="[object Object]",dse=Object.prototype,Z2=dse.hasOwnProperty;function hse(t,e,n,r,i,s){var o=H2(t),a=H2(e),l=o?X2:W2(t),c=a?X2:W2(e);l=l==Y2?ig:l,c=c==Y2?ig:c;var u=l==ig,d=c==ig,h=l==c;if(h&&K2(t)){if(!K2(e))return!1;o=!0,u=!1}if(h&&!u)return s||(s=new D0),o||cse(t)?ose(t,e,n,r,i,s):ase(t,e,l,n,r,i,s);if(!(n&use)){var f=u&&Z2.call(t,"__wrapped__"),p=d&&Z2.call(e,"__wrapped__");if(f||p){var m=f?t.value():t,_=p?e.value():e;return s||(s=new D0),i(m,_,n,r,s)}}return h?(s||(s=new D0),lse(t,e,n,r,i,s)):!1}var fse=hse,gse=fse,q2=is;function qk(t,e,n,r,i){return t===e?!0:t==null||e==null||!q2(t)&&!q2(e)?t!==t&&e!==e:gse(t,e,n,r,qk,i)}var fS=qk,pse=fS;function mse(t,e){return pse(t,e)}var Jk=mse,J2=yu,yse=jy,_se=Rr,Q2=J2?J2.isConcatSpreadable:void 0;function vse(t){return _se(t)||yse(t)||!!(Q2&&t&&t[Q2])}var wse=vse,xse=cS,Ese=wse;function Qk(t,e,n,r,i){var s=-1,o=t.length;for(n||(n=Ese),i||(i=[]);++s<o;){var a=t[s];e>0&&n(a)?e>1?Qk(a,e-1,n,r,i):xse(i,a):r||(i[i.length]=a)}return i}var gS=Qk;function Sse(t,e){for(var n=-1,r=t==null?0:t.length,i=Array(r);++n<r;)i[n]=e(t[n],n,t);return i}var gl=Sse,bse=dl,Cse=is,Tse="[object Symbol]";function Pse(t){return typeof t=="symbol"||Cse(t)&&bse(t)==Tse}var Vy=Pse,Rse=Rr,Ise=Vy,Ase=/\.|\[(?:[^[\]]*|(["'])(?:(?!\1)[^\\]|\\.)*?\1)\]/,Fse=/^\w*$/;function Ose(t,e){if(Rse(t))return!1;var n=typeof t;return n=="number"||n=="symbol"||n=="boolean"||t==null||Ise(t)?!0:Fse.test(t)||!Ase.test(t)||e!=null&&t in Object(e)}var pS=Ose,eM=eS,$se="Expected a function";function mS(t,e){if(typeof t!="function"||e!=null&&typeof e!="function")throw new TypeError($se);var n=function(){var r=arguments,i=e?e.apply(this,r):r[0],s=n.cache;if(s.has(i))return s.get(i);var o=t.apply(this,r);return n.cache=s.set(i,o)||s,o};return n.cache=new(mS.Cache||eM),n}mS.Cache=eM;var Lse=mS,kse=Lse,Mse=500;function Dse(t){var e=kse(t,function(r){return n.size===Mse&&n.clear(),r}),n=e.cache;return e}var Nse=Dse,jse=Nse,zse=/[^.[\]]+|\[(?:(-?\d+(?:\.\d+)?)|(["'])((?:(?!\2)[^\\]|\\.)*?)\2)\]|(?=(?:\.|\[\])(?:\.|\[\]|$))/g,Use=/\\(\\)?/g,Gse=jse(function(t){var e=[];return t.charCodeAt(0)===46&&e.push(""),t.replace(zse,function(n,r,i,s){e.push(i?s.replace(Use,"$1"):r||n)}),e}),Bse=Gse,eR=yu,Vse=gl,Wse=Rr,Hse=Vy,tR=eR?eR.prototype:void 0,nR=tR?tR.toString:void 0;function tM(t){if(typeof t=="string")return t;if(Wse(t))return Vse(t,tM)+"";if(Hse(t))return nR?nR.call(t):"";var e=t+"";return e=="0"&&1/t==-1/0?"-0":e}var Kse=tM,Yse=Kse;function Xse(t){return t==null?"":Yse(t)}var Zse=Xse,qse=Rr,Jse=pS,Qse=Bse,eoe=Zse;function toe(t,e){return qse(t)?t:Jse(t,e)?[t]:Qse(eoe(t))}var nM=toe,noe=Vy;function roe(t){if(typeof t=="string"||noe(t))return t;var e=t+"";return e=="0"&&1/t==-1/0?"-0":e}var Wy=roe,ioe=nM,soe=Wy;function ooe(t,e){e=ioe(e,t);for(var n=0,r=e.length;t!=null&&n<r;)t=t[soe(e[n++])];return n&&n==r?t:void 0}var yS=ooe,aoe=Ny,loe=fS,coe=1,uoe=2;function doe(t,e,n,r){var i=n.length,s=i,o=!r;if(t==null)return!s;for(t=Object(t);i--;){var a=n[i];if(o&&a[2]?a[1]!==t[a[0]]:!(a[0]in t))return!1}for(;++i<s;){a=n[i];var l=a[0],c=t[l],u=a[1];if(o&&a[2]){if(c===void 0&&!(l in t))return!1}else{var d=new aoe;if(r)var h=r(c,u,l,t,e,d);if(!(h===void 0?loe(u,c,coe|uoe,r,d):h))return!1}}return!0}var hoe=doe,foe=rs;function goe(t){return t===t&&!foe(t)}var rM=goe,poe=rM,moe=Jh;function yoe(t){for(var e=moe(t),n=e.length;n--;){var r=e[n],i=t[r];e[n]=[r,i,poe(i)]}return e}var _oe=yoe;function voe(t,e){return function(n){return n==null?!1:n[t]===e&&(e!==void 0||t in Object(n))}}var iM=voe,woe=hoe,xoe=_oe,Eoe=iM;function Soe(t){var e=xoe(t);return e.length==1&&e[0][2]?Eoe(e[0][0],e[0][1]):function(n){return n===t||woe(n,t,e)}}var boe=Soe,Coe=yS;function Toe(t,e,n){var r=t==null?void 0:Coe(t,e);return r===void 0?n:r}var Poe=Toe;function Roe(t,e){return t!=null&&e in Object(t)}var Ioe=Roe,Aoe=nM,Foe=jy,Ooe=Rr,$oe=nS,Loe=rS,koe=Wy;function Moe(t,e,n){e=Aoe(e,t);for(var r=-1,i=e.length,s=!1;++r<i;){var o=koe(e[r]);if(!(s=t!=null&&n(t,o)))break;t=t[o]}return s||++r!=i?s:(i=t==null?0:t.length,!!i&&Loe(i)&&$oe(o,i)&&(Ooe(t)||Foe(t)))}var Doe=Moe,Noe=Ioe,joe=Doe;function zoe(t,e){return t!=null&&joe(t,e,Noe)}var Uoe=zoe,Goe=fS,Boe=Poe,Voe=Uoe,Woe=pS,Hoe=rM,Koe=iM,Yoe=Wy,Xoe=1,Zoe=2;function qoe(t,e){return Woe(t)&&Hoe(e)?Koe(Yoe(t),e):function(n){var r=Boe(n,t);return r===void 0&&r===e?Voe(n,t):Goe(e,r,Xoe|Zoe)}}var Joe=qoe;function Qoe(t){return t}var Qh=Qoe;function eae(t){return function(e){return e==null?void 0:e[t]}}var tae=eae,nae=yS;function rae(t){return function(e){return nae(e,t)}}var iae=rae,sae=tae,oae=iae,aae=pS,lae=Wy;function cae(t){return aae(t)?sae(lae(t)):oae(t)}var uae=cae,dae=boe,hae=Joe,fae=Qh,gae=Rr,pae=uae;function mae(t){return typeof t=="function"?t:t==null?fae:typeof t=="object"?gae(t)?hae(t[0],t[1]):dae(t):pae(t)}var yae=mae;function _ae(t){return function(e,n,r){for(var i=-1,s=Object(e),o=r(e),a=o.length;a--;){var l=o[t?a:++i];if(n(s[l],l,s)===!1)break}return e}}var vae=_ae,wae=vae,xae=wae(),sM=xae,Eae=sM,Sae=Jh;function bae(t,e){return t&&Eae(t,e,Sae)}var Cae=bae,Tae=xu;function Pae(t,e){return function(n,r){if(n==null)return n;if(!Tae(n))return t(n,r);for(var i=n.length,s=e?i:-1,o=Object(n);(e?s--:++s<i)&&r(o[s],s,o)!==!1;);return n}}var Rae=Pae,Iae=Cae,Aae=Rae,Fae=Aae(Iae),oM=Fae,Oae=oM,$ae=xu;function Lae(t,e){var n=-1,r=$ae(t)?Array(t.length):[];return Oae(t,function(i,s,o){r[++n]=e(i,s,o)}),r}var kae=Lae;function Mae(t,e){var n=t.length;for(t.sort(e);n--;)t[n]=t[n].value;return t}var Dae=Mae,rR=Vy;function Nae(t,e){if(t!==e){var n=t!==void 0,r=t===null,i=t===t,s=rR(t),o=e!==void 0,a=e===null,l=e===e,c=rR(e);if(!a&&!c&&!s&&t>e||s&&o&&l&&!a&&!c||r&&o&&l||!n&&l||!i)return 1;if(!r&&!s&&!c&&t<e||c&&n&&i&&!r&&!s||a&&n&&i||!o&&i||!l)return-1}return 0}var jae=Nae,zae=jae;function Uae(t,e,n){for(var r=-1,i=t.criteria,s=e.criteria,o=i.length,a=n.length;++r<o;){var l=zae(i[r],s[r]);if(l){if(r>=a)return l;var c=n[r];return l*(c=="desc"?-1:1)}}return t.index-e.index}var Gae=Uae,N0=gl,Bae=yS,Vae=yae,Wae=kae,Hae=Dae,Kae=fl,Yae=Gae,Xae=Qh,Zae=Rr;function qae(t,e,n){e.length?e=N0(e,function(s){return Zae(s)?function(o){return Bae(o,s.length===1?s[0]:s)}:s}):e=[Xae];var r=-1;e=N0(e,Kae(Vae));var i=Wae(t,function(s,o,a){var l=N0(e,function(c){return c(s)});return{criteria:l,index:++r,value:s}});return Hae(i,function(s,o){return Yae(s,o,n)})}var Jae=qae;function Qae(t,e,n){switch(n.length){case 0:return t.call(e);case 1:return t.call(e,n[0]);case 2:return t.call(e,n[0],n[1]);case 3:return t.call(e,n[0],n[1],n[2])}return t.apply(e,n)}var aM=Qae,ele=aM,iR=Math.max;function tle(t,e,n){return e=iR(e===void 0?t.length-1:e,0),function(){for(var r=arguments,i=-1,s=iR(r.length-e,0),o=Array(s);++i<s;)o[i]=r[e+i];i=-1;for(var a=Array(e+1);++i<e;)a[i]=r[i];return a[e]=n(o),ele(t,this,a)}}var nle=tle;function rle(t){return function(){return t}}var ile=rle,sle=ile,sR=Ok,ole=Qh,ale=sR?function(t,e){return sR(t,"toString",{configurable:!0,enumerable:!1,value:sle(e),writable:!0})}:ole,lle=ale,cle=800,ule=16,dle=Date.now;function hle(t){var e=0,n=0;return function(){var r=dle(),i=ule-(r-n);if(n=r,i>0){if(++e>=cle)return arguments[0]}else e=0;return t.apply(void 0,arguments)}}var fle=hle,gle=lle,ple=fle,mle=ple(gle),yle=mle,_le=Qh,vle=nle,wle=yle;function xle(t,e){return wle(vle(t,e,_le),t+"")}var pl=xle,Ele=pu,Sle=xu,ble=nS,Cle=rs;function Tle(t,e,n){if(!Cle(n))return!1;var r=typeof e;return(r=="number"?Sle(n)&&ble(e,n.length):r=="string"&&e in n)?Ele(n[e],t):!1}var _S=Tle,Ple=gS,Rle=Jae,Ile=pl,oR=_S,Ale=Ile(function(t,e){if(t==null)return[];var n=e.length;return n>1&&oR(t,e[0],e[1])?e=[]:n>2&&oR(e[0],e[1],e[2])&&(e=[e[0]]),Rle(t,Ple(e,1),[])}),lM=Ale;function Fle(t,e,n,r){for(var i=t.length,s=n+(r?1:-1);r?s--:++s<i;)if(e(t[s],s,t))return s;return-1}var Ole=Fle;function $le(t){return t!==t}var Lle=$le;function kle(t,e,n){for(var r=n-1,i=t.length;++r<i;)if(t[r]===e)return r;return-1}var Mle=kle,Dle=Ole,Nle=Lle,jle=Mle;function zle(t,e,n){return e===e?jle(t,e,n):Dle(t,Nle,n)}var cM=zle,Ule=cM;function Gle(t,e){var n=t==null?0:t.length;return!!n&&Ule(t,e,0)>-1}var vS=Gle;function Ble(t,e,n){for(var r=-1,i=t==null?0:t.length;++r<i;)if(n(e,t[r]))return!0;return!1}var wS=Ble;function Vle(){}var Wle=Vle,j0=Gk,Hle=Wle,Kle=hS,Yle=1/0,Xle=j0&&1/Kle(new j0([,-0]))[1]==Yle?function(t){return new j0(t)}:Hle,Zle=Xle,qle=Gy,Jle=vS,Qle=wS,ece=By,tce=Zle,nce=hS,rce=200;function ice(t,e,n){var r=-1,i=Jle,s=t.length,o=!0,a=[],l=a;if(n)o=!1,i=Qle;else if(s>=rce){var c=e?null:tce(t);if(c)return nce(c);o=!1,i=ece,l=new qle}else l=e?[]:a;e:for(;++r<s;){var u=t[r],d=e?e(u):u;if(u=n||u!==0?u:0,o&&d===d){for(var h=l.length;h--;)if(l[h]===d)continue e;e&&l.push(d),a.push(u)}else i(l,d,n)||(l!==a&&l.push(d),a.push(u))}return a}var uM=ice,sce=uM;function oce(t){return t&&t.length?sce(t):[]}var xS=oce,ace=uM;function lce(t,e){return e=typeof e=="function"?e:void 0,t&&t.length?ace(t,void 0,e):[]}var ES=lce,cce=pl,uce=pu,dce=_S,hce=Eu,dM=Object.prototype,fce=dM.hasOwnProperty,gce=cce(function(t,e){t=Object(t);var n=-1,r=e.length,i=r>2?e[2]:void 0;for(i&&dce(e[0],e[1],i)&&(r=1);++n<r;)for(var s=e[n],o=hce(s),a=-1,l=o.length;++a<l;){var c=o[a],u=t[c];(u===void 0||uce(u,dM[c])&&!fce.call(t,c))&&(t[c]=s[c])}return t}),pce=gce,mce=Gy,yce=vS,_ce=wS,vce=gl,wce=fl,aR=By,xce=Math.min;function Ece(t,e,n){for(var r=n?_ce:yce,i=t[0].length,s=t.length,o=s,a=Array(s),l=1/0,c=[];o--;){var u=t[o];o&&e&&(u=vce(u,wce(e))),l=xce(u.length,l),a[o]=!n&&(e||i>=120&&u.length>=120)?new mce(o&&u):void 0}u=t[0];var d=-1,h=a[0];e:for(;++d<i&&c.length<l;){var f=u[d],p=e?e(f):f;if(f=n||f!==0?f:0,!(h?aR(h,p):r(c,p,n))){for(o=s;--o;){var m=a[o];if(!(m?aR(m,p):r(t[o],p,n)))continue e}h&&h.push(p),c.push(f)}}return c}var hM=Ece,Sce=xu,bce=is;function Cce(t){return bce(t)&&Sce(t)}var SS=Cce,Tce=SS;function Pce(t){return Tce(t)?t:[]}var fM=Pce;function Rce(t){var e=t==null?0:t.length;return e?t[e-1]:void 0}var Ice=Rce,Ace=gl,Fce=hM,Oce=pl,$ce=fM,Lce=Ice,kce=Oce(function(t){var e=Lce(t),n=Ace(t,$ce);return e=typeof e=="function"?e:void 0,e&&n.pop(),n.length&&n[0]===t[0]?Fce(n,void 0,e):[]}),gM=kce,Mce=dl,Dce=uS,Nce=is,jce="[object Object]",zce=Function.prototype,Uce=Object.prototype,pM=zce.toString,Gce=Uce.hasOwnProperty,Bce=pM.call(Object);function Vce(t){if(!Nce(t)||Mce(t)!=jce)return!1;var e=Dce(t);if(e===null)return!0;var n=Gce.call(e,"constructor")&&e.constructor;return typeof n=="function"&&n instanceof n&&pM.call(n)==Bce}var Hy=Vce,Wce=dl,Hce=is,Kce="[object Boolean]";function Yce(t){return t===!0||t===!1||Hce(t)&&Wce(t)==Kce}var Xce=Yce,Si=Jk,Zce=lM,bS=xS,lR=ES,qce=pce,Jce=gM,gm=Hy,z0=Xce,cR=t=>Array.isArray(t)?t:[t],Gr=t=>t===void 0,sg=t=>gm(t)||Array.isArray(t)?Object.keys(t):[],sc=(t,e)=>t.hasOwnProperty(e),Wc=t=>Zce(bS(t)),uR=t=>Gr(t)||Array.isArray(t)&&t.length===0,Qce=(t,e,n,r)=>e&&sc(e,n)&&t&&sc(t,n)&&r(t[n],e[n]),U0=(t,e)=>Gr(t)&&e===0||Gr(e)&&t===0||Si(t,e),eue=(t,e)=>Gr(t)&&e===!1||Gr(e)&&t===!1||Si(t,e),dR=t=>Gr(t)||Si(t,{})||t===!0,og=t=>Gr(t)||Si(t,{}),hR=t=>Gr(t)||gm(t)||t===!0||t===!1;function fR(t,e){return uR(t)&&uR(e)?!0:Si(Wc(t),Wc(e))}function tue(t,e){return t=cR(t),e=cR(e),Si(Wc(t),Wc(e))}function Gg(t,e,n,r){var i=bS(sg(t).concat(sg(e)));return og(t)&&og(e)?!0:og(t)&&sg(e).length||og(e)&&sg(t).length?!1:i.every(function(s){var o=t[s],a=e[s];return Array.isArray(o)&&Array.isArray(a)?Si(Wc(t),Wc(e)):Array.isArray(o)&&!Array.isArray(a)||Array.isArray(a)&&!Array.isArray(o)?!1:Qce(t,e,s,r)})}function nue(t,e,n,r){return gm(t)&&gm(e)?r(t,e):Array.isArray(t)&&Array.isArray(e)?Gg(t,e,n,r):Si(t,e)}function G0(t,e,n,r){var i=lR(t,r),s=lR(e,r),o=Jce(i,s,r);return o.length===Math.max(i.length,s.length)}var rue={title:Si,uniqueItems:eue,minLength:U0,minItems:U0,minProperties:U0,required:fR,enum:fR,type:tue,items:nue,anyOf:G0,allOf:G0,oneOf:G0,properties:Gg,patternProperties:Gg,dependencies:Gg},iue=["properties","patternProperties","dependencies","uniqueItems","minLength","minItems","minProperties","required"],sue=["additionalProperties","additionalItems","contains","propertyNames","not"];function qw(t,e,n){if(n=qce(n,{ignore:[]}),dR(t)&&dR(e))return!0;if(!hR(t)||!hR(e))throw new Error("Either of the values are not a JSON schema.");if(t===e)return!0;if(z0(t)&&z0(e))return t===e;if(t===void 0&&e===!1||e===void 0&&t===!1||Gr(t)&&!Gr(e)||!Gr(t)&&Gr(e))return!1;var r=bS(Object.keys(t).concat(Object.keys(e)));if(n.ignore.length&&(r=r.filter(s=>n.ignore.indexOf(s)===-1)),!r.length)return!0;function i(s,o){return qw(s,o,n)}return r.every(function(s){var o=t[s],a=e[s];if(sue.indexOf(s)!==-1)return qw(o,a,n);var l=rue[s];if(l||(l=Si),Si(o,a))return!0;if(iue.indexOf(s)===-1&&(!sc(t,s)&&sc(e,s)||sc(t,s)&&!sc(e,s)))return o===a;var c=l(o,a,s,i);if(!z0(c))throw new Error("Comparer must return true or false");return c})}var CS=qw;function oue(t){return Object.prototype.toString.call(t)==="[object Array]"}var TS=Array.isArray||oue;function aue(t){return(typeof t=="number"||Object.prototype.toString.call(t)==="[object Number]")&&t.valueOf()===t.valueOf()}var lue=aue,cue=lue;function uue(t){return cue(t)&&t%1===0}var due=uue,hue=TS,fue=due;function gue(t){var e;if(!hue(t)||(e=t.length,!e))return!1;for(var n=0;n<e;n++)if(!fue(t[n]))return!1;return!0}var mM=gue;function pue(t){return typeof t=="function"}var yM=pue,mue=TS,gR=mM,yue=yM,ag=Math.pow(2,31)-1;function pR(t,e){var n=1,r;if(t===0)return e;if(e===0)return t;for(;t%2===0&&e%2===0;)t=t/2,e=e/2,n=n*2;for(;t%2===0;)t=t/2;for(;e;){for(;e%2===0;)e=e/2;t>e&&(r=e,e=t,t=r),e=e-t}return n*t}function mR(t,e){var n=0,r;if(t===0)return e;if(e===0)return t;for(;!(t&1)&&!(e&1);)t>>>=1,e>>>=1,n++;for(;!(t&1);)t>>>=1;for(;e;){for(;!(e&1);)e>>>=1;t>e&&(r=e,e=t,t=r),e=e-t}return t<<n}function _ue(){var t=arguments.length,e,n,r,i,s,o,a;for(e=new Array(t),a=0;a<t;a++)e[a]=arguments[a];if(gR(e)){if(t===2)return s=e[0],o=e[1],s<0&&(s=-s),o<0&&(o=-o),s<=ag&&o<=ag?mR(s,o):pR(s,o);r=e}else if(mue(e[0]))if(t>1){if(r=e[0],n=e[1],!yue(n))throw new TypeError("gcd()::invalid input argument. Accessor must be a function. Value: `"+n+"`.")}else r=e[0];else throw new TypeError("gcd()::invalid input argument. Must provide an array of integers. Value: `"+e[0]+"`.");if(i=r.length,i<2)return null;if(n){for(s=new Array(i),a=0;a<i;a++)s[a]=n(r[a],a);r=s}if(t<3&&!gR(r))throw new TypeError("gcd()::invalid input argument. Accessed array values must be integers. Value: `"+r+"`.");for(a=0;a<i;a++)s=r[a],s<0&&(r[a]=-s);for(s=r[0],a=1;a<i;a++)o=r[a],o<=ag&&s<=ag?s=mR(s,o):s=pR(s,o);return s}var vue=_ue,yR=vue,wue=TS,_R=mM,xue=yM;function Eue(){var t=arguments.length,e,n,r,i,s,o,a;for(e=new Array(t),a=0;a<t;a++)e[a]=arguments[a];if(_R(e)){if(t===2)return s=e[0],o=e[1],s<0&&(s=-s),o<0&&(o=-o),s===0||o===0?0:s/yR(s,o)*o;r=e}else if(wue(e[0]))if(t>1){if(r=e[0],n=e[1],!xue(n))throw new TypeError("lcm()::invalid input argument. Accessor must be a function. Value: `"+n+"`.")}else r=e[0];else throw new TypeError("lcm()::invalid input argument. Must provide an array of integers. Value: `"+e[0]+"`.");if(i=r.length,i<2)return null;if(n){for(s=new Array(i),a=0;a<i;a++)s[a]=n(r[a],a);r=s}if(t<3&&!_R(r))throw new TypeError("lcm()::invalid input argument. Accessed array values must be integers. Value: `"+r+"`.");for(a=0;a<i;a++)s=r[a],s<0&&(r[a]=-s);for(s=r[0],a=1;a<i;a++){if(o=r[a],s===0||o===0)return 0;s=s/yR(s,o)*o}return s}var Sue=Eue,bue=tS,Cue=pu;function Tue(t,e,n){(n!==void 0&&!Cue(t[e],n)||n===void 0&&!(e in t))&&bue(t,e,n)}var _M=Tue;function Pue(t,e){if(!(e==="constructor"&&typeof t[e]=="function")&&e!="__proto__")return t[e]}var vM=Pue,Rue=qh,Iue=Eu;function Aue(t){return Rue(t,Iue(t))}var Fue=Aue,vR=_M,Oue=Dk,$ue=Wk,Lue=aS,kue=Hk,wR=jy,xR=Rr,Mue=SS,Due=zy,Nue=JE,jue=rs,zue=Hy,Uue=sS,ER=vM,Gue=Fue;function Bue(t,e,n,r,i,s,o){var a=ER(t,n),l=ER(e,n),c=o.get(l);if(c){vR(t,n,c);return}var u=s?s(a,l,n+"",t,e,o):void 0,d=u===void 0;if(d){var h=xR(l),f=!h&&Due(l),p=!h&&!f&&Uue(l);u=l,h||f||p?xR(a)?u=a:Mue(a)?u=Lue(a):f?(d=!1,u=Oue(l,!0)):p?(d=!1,u=$ue(l,!0)):u=[]:zue(l)||wR(l)?(u=a,wR(a)?u=Gue(a):(!jue(a)||Nue(a))&&(u=kue(l))):d=!1}d&&(o.set(l,u),i(u,l,r,s,o),o.delete(l)),vR(t,n,u)}var Vue=Bue,Wue=Ny,Hue=_M,Kue=sM,Yue=Vue,Xue=rs,Zue=Eu,que=vM;function wM(t,e,n,r,i){t!==e&&Kue(e,function(s,o){if(i||(i=new Wue),Xue(s))Yue(t,e,o,n,wM,r,i);else{var a=r?r(que(t,o),s,o+"",t,e,i):void 0;a===void 0&&(a=s),Hue(t,o,a)}},Zue)}var xM=wM,Jue=xM,SR=rs;function EM(t,e,n,r,i,s){return SR(t)&&SR(e)&&(s.set(e,t),Jue(t,e,void 0,EM,s),s.delete(e)),t}var Que=EM,ede=pl,tde=_S;function nde(t){return ede(function(e,n){var r=-1,i=n.length,s=i>1?n[i-1]:void 0,o=i>2?n[2]:void 0;for(s=t.length>3&&typeof s=="function"?(i--,s):void 0,o&&tde(n[0],n[1],o)&&(s=i<3?void 0:s,i=1),e=Object(e);++r<i;){var a=n[r];a&&t(e,a,r,s)}return e})}var rde=nde,ide=xM,sde=rde,ode=sde(function(t,e,n,r){ide(t,e,n,r)}),ade=ode,lde=aM,cde=pl,ude=Que,dde=ade,hde=cde(function(t){return t.push(void 0,ude),lde(dde,void 0,t)}),fde=hde,gde=gS;function pde(t){var e=t==null?0:t.length;return e?gde(t,1):[]}var SM=pde,mde=gS,yde=1/0;function _de(t){var e=t==null?0:t.length;return e?mde(t,yde):[]}var bM=_de,vde=gl,wde=hM,xde=pl,Ede=fM,Sde=xde(function(t){var e=vde(t,Ede);return e.length&&e[0]===t[0]?wde(e):[]}),bde=Sde;function Cde(t,e,n,r){for(var i=n-1,s=t.length;++i<s;)if(r(t[i],e))return i;return-1}var Tde=Cde,Pde=gl,Rde=cM,Ide=Tde,Ade=fl,Fde=aS,Ode=Array.prototype,bR=Ode.splice;function $de(t,e,n,r){var i=r?Ide:Rde,s=-1,o=e.length,a=t;for(t===e&&(e=Fde(e)),n&&(a=Pde(t,Ade(n)));++s<o;)for(var l=0,c=e[s],u=n?n(c):c;(l=i(a,u,l,r))>-1;)a!==t&&bR.call(a,l,1),bR.call(t,l,1);return t}var Lde=$de,kde=Lde;function Mde(t,e){return t&&t.length&&e&&e.length?kde(t,e):t}var Dde=Mde,Nde=Qh;function jde(t){return typeof t=="function"?t:Nde}var zde=jde,Ude=Fk,Gde=oM,Bde=zde,Vde=Rr;function Wde(t,e){var n=Vde(t)?Ude:Gde;return n(t,Bde(e))}var CM=Wde,Hde=Gy,Kde=vS,Yde=wS,Xde=gl,Zde=fl,qde=By,Jde=200;function Qde(t,e,n,r){var i=-1,s=Kde,o=!0,a=t.length,l=[],c=e.length;if(!a)return l;n&&(e=Xde(e,Zde(n))),r?(s=Yde,o=!1):e.length>=Jde&&(s=qde,o=!1,e=new Hde(e));e:for(;++i<a;){var u=t[i],d=n==null?u:n(u);if(u=r||u!==0?u:0,o&&d===d){for(var h=c;h--;)if(e[h]===d)continue e;l.push(u)}else s(e,d,r)||l.push(u)}return l}var ehe=Qde,the=ehe,nhe=pl,rhe=SS,ihe=nhe(function(t,e){return rhe(t)?the(t,e):[]}),she=ihe;const ohe=SM,ahe=bM,TM=Hy,lhe=xS,che=ES,uhe=she;function dhe(t){for(const e in t)PM(t,e)&&mhe(t[e])&&delete t[e];return t}const hhe=t=>lhe(ahe(t.map(PS))),fhe=(t,e)=>t.map(n=>n&&n[e]),PM=(t,e)=>Object.prototype.hasOwnProperty.call(t,e),PS=t=>TM(t)||Array.isArray(t)?Object.keys(t):[],ghe=t=>t!==void 0,phe=t=>TM(t)||t===!0||t===!1,mhe=t=>!PS(t).length&&t!==!1&&t!==!0,yhe=(t,...e)=>uhe.apply(null,[t].concat(ohe(e)));var RM={allUniqueKeys:hhe,deleteUndefinedProps:dhe,getValues:fhe,has:PM,isSchema:phe,keys:PS,notUndefined:ghe,uniqWith:che,withoutArr:yhe};const _he=CS,vhe=CM,{allUniqueKeys:whe,deleteUndefinedProps:xhe,getValues:Ehe,keys:qu,notUndefined:She,uniqWith:bhe,withoutArr:CR}=RM;function Che(t){vhe(t,function(e,n){e===!1&&delete t[n]})}function TR(t,e){return whe(t).reduce(function(r,i){const s=Ehe(t,i),o=bhe(s.filter(She),_he);return r[i]=e(o,i),r},{})}var The={keywords:["properties","patternProperties","additionalProperties"],resolver(t,e,n,r){r.ignoreAdditionalProperties||(t.forEach(function(s){const o=t.filter(u=>u!==s),a=qu(s.properties),c=qu(s.patternProperties).map(u=>new RegExp(u));o.forEach(function(u){const d=qu(u.properties),h=d.filter(p=>c.some(m=>m.test(p)));CR(d,a,h).forEach(function(p){u.properties[p]=n.properties([u.properties[p],s.additionalProperties],p)})})}),t.forEach(function(s){const o=t.filter(l=>l!==s),a=qu(s.patternProperties);s.additionalProperties===!1&&o.forEach(function(l){const c=qu(l.patternProperties);CR(c,a).forEach(d=>delete l.patternProperties[d])})}));const i={additionalProperties:n.additionalProperties(t.map(s=>s.additionalProperties)),patternProperties:TR(t.map(s=>s.patternProperties),n.patternProperties),properties:TR(t.map(s=>s.properties),n.properties)};return i.additionalProperties===!1&&Che(i.properties),xhe(i)}};const Phe=CS,Rhe=CM,{allUniqueKeys:Ihe,deleteUndefinedProps:Ahe,has:Fhe,isSchema:IM,notUndefined:AM,uniqWith:Ohe}=RM;function $he(t){Rhe(t,function(e,n){e===!1&&t.splice(n,1)})}function Lhe(t,e){return t.map(function(n){if(n)if(Array.isArray(n.items)){const r=n.items[e];if(IM(r))return r;if(Fhe(n,"additionalItems"))return n.additionalItems}else return n.items})}function khe(t){return t.map(function(e){if(e)return Array.isArray(e.items)?e.additionalItems:e.items})}function Mhe(t,e,n){return Ihe(n).reduce(function(i,s){const o=Lhe(t,s),a=Ohe(o.filter(AM),Phe);return i[s]=e(a,s),i},[])}var Dhe={keywords:["items","additionalItems"],resolver(t,e,n){const r=t.map(a=>a.items),i=r.filter(AM),s={};i.every(IM)?s.items=n.items(r):s.items=Mhe(t,n.items,r);let o;return i.every(Array.isArray)?o=t.map(a=>a.additionalItems):i.some(Array.isArray)&&(o=khe(t)),o&&(s.additionalItems=n.additionalItems(o)),s.additionalItems===!1&&Array.isArray(s.items)&&$he(s.items),Ahe(s)}};const FM=pie,pm=CS,Nhe=Sue,jhe=fde,OM=SM,RS=bM,zhe=bde,Uhe=gM,Jw=Jk,Hc=Hy,Ghe=Dde,$M=lM,IS=xS,Sc=ES,LM=The,kM=Dhe,lg=(t,e)=>t.indexOf(e)!==-1,Bhe=t=>Hc(t)||t===!0||t===!1,Vhe=t=>t===!1,MM=t=>t===!0,Ky=(t,e,n)=>n(t),DM=t=>$M(IS(RS(t))),mm=t=>t!==void 0,NM=t=>IS(RS(t.map(Zhe))),bu=t=>t[0],Whe=t=>DM(t),ef=t=>Math.max.apply(Math,t),tf=t=>Math.min.apply(Math,t),Hhe=t=>t.some(MM),Khe=t=>Sc(OM(t),Jw);function Yhe(t){return function(e,n){return pm({[t]:e},{[t]:n})}}function jM(t){let{allOf:e=[],...n}=t;return n=Hc(t)?n:t,[n,...e.map(jM)]}function zM(t,e){return t.map(n=>n&&n[e])}function Xhe(t,e){return t.map(function(n,r){try{return e(n,r)}catch{return}}).filter(mm)}function Zhe(t){return Hc(t)||Array.isArray(t)?Object.keys(t):[]}function Qw(t,e){if(e=e||[],!t.length)return e;const n=t.slice(0).shift(),r=t.slice(1);return e.length?Qw(r,OM(e.map(i=>n.map(s=>[s].concat(i))))):Qw(r,n.map(i=>i))}function UM(t,e){let n;try{n=t.map(function(r){return JSON.stringify(r,null,2)}).join(`
`)}catch{n=t.join(", ")}throw new Error('Could not resolve values for path:"'+e.join(".")+`". They are probably incompatible. Values: 
`+n)}function qhe(t,e,n,r,i,s){if(t.length){const o=i.complexResolvers[e];if(!o||!o.resolver)throw new Error("No resolver found for "+e);const a=n.map(d=>t.reduce((h,f)=>(d[f]!==void 0&&(h[f]=d[f]),h),{})),l=Sc(a,pm),c=o.keywords.reduce((d,h)=>({...d,[h]:(f,p=[])=>r(f,null,s.concat(h,p))}),{}),u=o.resolver(l,s.concat(e),c,i);return Hc(u)||UM(l,s.concat(e)),u}}function Jhe(t){return{required:t}}const Qhe=["properties","patternProperties","definitions","dependencies"],efe=["anyOf","oneOf"],tfe=["additionalProperties","additionalItems","contains","propertyNames","not","items"],tt={type(t){if(t.some(Array.isArray)){const e=t.map(function(r){return Array.isArray(r)?r:[r]}),n=zhe.apply(null,e);if(n.length===1)return n[0];if(n.length>1)return IS(n)}},dependencies(t,e,n){return NM(t).reduce(function(i,s){const o=zM(t,s);let a=Sc(o.filter(mm),Jw);const l=a.filter(Array.isArray);if(l.length){if(l.length===a.length)i[s]=DM(a);else{const c=a.filter(Bhe),u=l.map(Jhe);i[s]=n(c.concat(u),s)}return i}return a=Sc(a,pm),i[s]=n(a,s),i},{})},oneOf(t,e,n){const r=Qw(FM(t)),i=Xhe(r,n),s=Sc(i,pm);if(s.length)return s},not(t){return{anyOf:t}},pattern(t){return t.map(e=>"(?="+e+")").join("")},multipleOf(t){let e=t.slice(0),n=1;for(;e.some(r=>!Number.isInteger(r));)e=e.map(r=>r*10),n=n*10;return Nhe(e)/n},enum(t){const e=Uhe.apply(null,t.concat(Jw));if(e.length)return $M(e)}};tt.$id=bu;tt.$ref=bu;tt.$schema=bu;tt.additionalItems=Ky;tt.additionalProperties=Ky;tt.anyOf=tt.oneOf;tt.contains=Ky;tt.default=bu;tt.definitions=tt.dependencies;tt.description=bu;tt.examples=Khe;tt.exclusiveMaximum=tf;tt.exclusiveMinimum=ef;tt.items=kM;tt.maximum=tf;tt.maxItems=tf;tt.maxLength=tf;tt.maxProperties=tf;tt.minimum=ef;tt.minItems=ef;tt.minLength=ef;tt.minProperties=ef;tt.properties=LM;tt.propertyNames=Ky;tt.required=Whe;tt.title=bu;tt.uniqueItems=Hhe;const nfe={properties:LM,items:kM};function AS(t,e,n){e=jhe(e,{ignoreAdditionalProperties:!1,resolvers:tt,complexResolvers:nfe,deep:!0});const r=Object.entries(e.complexResolvers);function i(a,l,c){a=FM(a.filter(mm)),c=c||[];const u=Hc(l)?l:{};if(!a.length)return;if(a.some(Vhe))return!1;if(a.every(MM))return!0;a=a.filter(Hc);const d=NM(a);if(e.deep&&lg(d,"allOf"))return AS({allOf:a},e);const h=r.map(([f,p])=>d.filter(m=>p.keywords.includes(m)));return h.forEach(f=>Ghe(d,f)),d.forEach(function(f){const p=zM(a,f),m=Sc(p.filter(mm),Yhe(f));if(m.length===1&&lg(efe,f))u[f]=m[0].map(_=>i([_],_));else if(m.length===1&&!lg(Qhe,f)&&!lg(tfe,f))u[f]=m[0];else{const _=e.resolvers[f]||e.resolvers.defaultResolver;if(!_)throw new Error("No resolver found for key "+f+". You can provide a resolver for this keyword in the options, or provide a default resolver.");const g=(y,v=[])=>i(y,null,c.concat(f,v));u[f]=_(m,c.concat(f),g,e),u[f]===void 0?UM(m,c.concat(f)):u[f]===void 0&&delete u[f]}}),r.reduce((f,[p,m],_)=>({...f,...qhe(h[_],p,a,i,e,c)}),u)}const s=RS(jM(t));return i(s)}AS.options={resolvers:tt};var rfe=AS;const ife=Za(rfe);function Kc(t){let e;const n=we(t,"discriminator.propertyName",void 0);return $y(n)?e=n:n!==void 0&&console.warn(`Expecting discriminator to be a string, got "${typeof n}" instead`),e}function vh(t){return Array.isArray(t)?"array":typeof t=="string"?"string":t==null?"null":typeof t=="boolean"?"boolean":isNaN(t)?typeof t=="object"?"object":"string":"number"}var sfe=qE(function(t){return Pk(Zh(t,1,cm,!0))});function js(t){let{type:e}=t;return!e&&t.const?vh(t.const):!e&&t.enum?"string":!e&&(t.properties||t.additionalProperties)?"object":(Array.isArray(e)&&(e.length===2&&e.includes("null")?e=e.find(n=>n!=="null"):e=e[0]),e)}function zs(t,e){const n=Object.assign({},t);return Object.keys(e).reduce((r,i)=>{const s=t?t[i]:{},o=e[i];return t&&i in t&&Ye(o)?r[i]=zs(s,o):t&&e&&(js(t)==="object"||js(e)==="object")&&i===bH&&Array.isArray(s)&&Array.isArray(o)?r[i]=sfe(s,o):r[i]=o,r},n)}function _r(t,e,n={},r,i){return Ui(t,e,n,r,void 0,void 0,i)[0]}function ofe(t,e,n,r,i,s,o){const{if:a,then:l,else:c,...u}=e,d=t.isValid(a,s||{},n);let h=[u],f=[];if(r)l&&typeof l!="boolean"&&(f=f.concat(Ui(t,l,n,s,r,i,o))),c&&typeof c!="boolean"&&(f=f.concat(Ui(t,c,n,s,r,i,o)));else{const p=d?l:c;p&&typeof p!="boolean"&&(f=f.concat(Ui(t,p,n,s,r,i,o)))}return f.length&&(h=f.map(p=>zs(u,p))),h.flatMap(p=>Ui(t,p,n,s,r,i,o))}function GM(t){return t.reduce((n,r)=>r.length>1?r.flatMap(i=>Ek(n.length,s=>[...n[s]].concat(i))):(n.forEach(i=>i.push(r[0])),n),[[]])}function afe(t,e,n,r,i,s,o){const a=BM(t,e,n,r,i,s);if(a.length>1||a[0]!==e)return a;if(xy in e)return VM(t,e,n,r,i,s).flatMap(c=>Ui(t,c,n,s,r,i,o));if(du in e&&Array.isArray(e.allOf)){const l=e.allOf.map(u=>Ui(t,u,n,s,r,i,o));return GM(l).map(u=>({...e,allOf:u}))}return[e]}function BM(t,e,n,r,i,s,o){const a=wh(e,n,i);return a!==e?Ui(t,a,n,s,r,i,o):[e]}function wh(t,e,n){if(!Ye(t))return t;let r=t;if(nn in r){const{$ref:i,...s}=r;if(n.includes(i))return r;n.push(i),r={...hk(i,e),...s}}if(jt in r){const i=[],s=D7(r[jt],(o,a,l)=>{const c=[...n];o[l]=wh(a,e,c),i.push(c)},{});G7(n,Q7(V7(i))),r={...r,[jt]:s}}return Lo in r&&!Array.isArray(r.items)&&typeof r.items!="boolean"&&(r={...r,items:wh(r.items,e,n)}),St(t,r)?t:r}function lfe(t,e,n,r,i){const s={...e,properties:{...e.properties}},o=r&&Ye(r)?r:{};return Object.keys(o).forEach(a=>{if(a in s.properties)return;let l={};typeof s.additionalProperties!="boolean"?nn in s.additionalProperties?l=_r(t,{$ref:we(s.additionalProperties,[nn])},n,o,i):"type"in s.additionalProperties?l={...s.additionalProperties}:pi in s.additionalProperties||yr in s.additionalProperties?l={type:"object",...s.additionalProperties}:l={type:vh(we(o,[a]))}:l={type:vh(we(o,[a]))},s.properties[a]=l,vn(s.properties,[a,Wh],!0)}),s}function Ui(t,e,n,r,i=!1,s=[],o){return Ye(e)?afe(t,e,n,i,s,r,o).flatMap(l=>{var c;let u=l;if(EH in u)return ofe(t,u,n,i,s,r,o);if(du in u){if(i){const{allOf:h,...f}=u;return[...h,f]}try{const h=[],f=[];(c=u.allOf)===null||c===void 0||c.forEach(p=>{typeof p=="object"&&p.contains?h.push(p):f.push(p)}),h.length&&(u={...u,allOf:f}),u=o?o(u):ife(u,{deep:!1}),h.length&&(u.allOf=h)}catch(h){console.warn(`could not merge subschemas in allOf:
`,h);const{allOf:f,...p}=u;return p}}return jw in u&&u.additionalProperties!==!1?lfe(t,u,n,r,o):u}):[{}]}function cfe(t,e,n,r,i){let s;const{oneOf:o,anyOf:a,...l}=e;if(Array.isArray(o)?s=o:Array.isArray(a)&&(s=a),s){const c=i===void 0&&r?{}:i,u=Kc(e);s=s.map(h=>wh(h,n,[]));const d=XE(t,c,s,n,u);if(r)return s.map(h=>zs(l,h));e=zs(l,s[d])}return[e]}function VM(t,e,n,r,i,s,o){const{dependencies:a,...l}=e;return cfe(t,l,n,r,s).flatMap(u=>WM(t,a,u,n,r,i,s,o))}function WM(t,e,n,r,i,s,o,a){let l=[n];for(const c in e){if(!i&&we(o,[c])===void 0||n.properties&&!(c in n.properties))continue;const[u,d]=KE(c,e);return Array.isArray(d)?l[0]=ufe(n,d):Ye(d)&&(l=dfe(t,n,r,c,d,i,s,o,a)),l.flatMap(h=>WM(t,u,h,r,i,s,o,a))}return l}function ufe(t,e){if(!e)return t;const n=Array.isArray(t.required)?Array.from(new Set([...t.required,...e])):e;return{...t,required:n}}function dfe(t,e,n,r,i,s,o,a,l){return Ui(t,i,n,a,s,o,l).flatMap(u=>{const{oneOf:d,...h}=u;if(e=zs(e,h),d===void 0)return e;const f=d.map(m=>typeof m=="boolean"||!(nn in m)?[m]:BM(t,m,n,s,o,a));return GM(f).flatMap(m=>hfe(t,e,n,r,m,s,o,a,l))})}function hfe(t,e,n,r,i,s,o,a,l){const c=i.filter(u=>{if(typeof u=="boolean"||!u||!u.properties)return!1;const{[r]:d}=u.properties;if(d){const h={type:"object",properties:{[r]:d}};return t.isValid(h,a,n)||s}return!1});return!s&&c.length!==1?(console.warn("ignoring oneOf in dependencies because there isn't exactly one subschema that is valid"),[e]):c.flatMap(u=>{const d=u,[h]=KE(r,d.properties),f={...d,properties:h};return Ui(t,f,n,a,s,o,l).map(m=>zs(e,m))})}const ffe={type:"object",$id:SH,properties:{__not_really_there__:{type:"number"}}};function ex(t,e,n,r,i){let s=0;return n&&(mt(n.properties)?s+=E7(n.properties,(o,a,l)=>{const c=we(r,l);if(typeof a=="boolean")return o;if(Un(a,nn)){const u=_r(t,a,e,c,i);return o+ex(t,e,u,c||{},i)}if((Un(a,yr)||Un(a,pi))&&c){const u=Un(a,yr)?yr:pi,d=Kc(a);return o+xh(t,e,c,we(a,u),-1,d,i)}if(a.type==="object")return mt(c)&&(o+=1),o+ex(t,e,a,c,i);if(a.type===vh(c)){let u=o+1;return a.default?u+=c===a.default?1:-1:a.const&&(u+=c===a.const?1:-1),u}return o},0):$y(n.type)&&n.type===vh(r)&&(s+=1)),s}function xh(t,e,n,r,i=-1,s,o){const a=r.map(h=>wh(h,e,[])),l=Sk(n,r,s);if(gk(l))return l;const c=a.reduce((h,f,p)=>(XE(t,n,[ffe,f],e,s)===1&&h.push(p),h),[]);if(c.length===1)return c[0];c.length||Ek(a.length,h=>c.push(h));const u=new Set,{bestIndex:d}=c.reduce((h,f)=>{const{bestScore:p}=h,m=a[f],_=ex(t,e,m,n,o);return u.add(_),_>p?{bestIndex:f,bestScore:_}:h},{bestIndex:i,bestScore:0});return u.size===1&&i>=0?i:d}function tx(t){return Array.isArray(t.items)&&t.items.length>0&&t.items.every(e=>Ye(e))}function Od(t){return t==null}function Eh(t,e,n=!1,r=!1,i=!1){if(Array.isArray(e)){const s=Array.isArray(t)?t:[],o=i?s:e,a=i?e:s,l=o.map((c,u)=>a[u]!==void 0?Eh(s[u],e[u],n,r,i):c);return(n||i)&&l.length<a.length&&l.push(...a.slice(l.length)),l}if(Ye(e)){const s=Object.assign({},t);return Object.keys(e).reduce((o,a)=>{const l=we(e,a),c=Ye(t)&&a in t,u=a in e;return o[a]=Eh(t?we(t,a):{},l,n,r,i&&(c||!u)),o},s)}return r&&(!Od(t)&&Od(e)||typeof e=="number"&&isNaN(e))||i&&!Od(e)?t:e}function bs(t,e,n=!1){return Object.keys(e).reduce((r,i)=>{const s=t?t[i]:{},o=e[i];if(t&&i in t&&Ye(o))r[i]=bs(s,o,n);else if(n&&Array.isArray(s)&&Array.isArray(o)){let a=o;n==="preventDuplicates"&&(a=o.reduce((l,c)=>(s.includes(c)||l.push(c),l),[])),r[i]=s.concat(a)}else r[i]=o;return r},Object.assign({},t))}function HM(t){return Array.isArray(t.enum)&&t.enum.length===1||Ns in t}function FS(t,e,n={},r){const i=_r(t,e,n,void 0,r),s=i.oneOf||i.anyOf;return Array.isArray(i.enum)?!0:Array.isArray(s)?s.every(o=>typeof o!="boolean"&&HM(o)):!1}function OS(t,e,n,r){return!e.uniqueItems||!e.items||typeof e.items=="boolean"?!1:FS(t,e.items,n,r)}function KM(t){const e=t[Ns],n=js(t);return Ye(e)&&$y(e==null?void 0:e.$data)&&n!=="object"&&n!=="array"}function gfe(t){if(xH in t&&Array.isArray(t.enum)&&t.enum.length===1)return t.enum[0];if(Ns in t)return t.const;throw new Error("schema cannot be inferred as a constant")}function Sh(t,e){const n=t;if(t.enum){let s;if(e){const{enumNames:o}=Ke(e);s=o}return!s&&n.enumNames&&(s=n.enumNames),t.enum.map((o,a)=>({label:(s==null?void 0:s[a])||String(o),value:o}))}let r,i;return t.anyOf?(r=t.anyOf,i=e==null?void 0:e.anyOf):t.oneOf&&(r=t.oneOf,i=e==null?void 0:e.oneOf),r&&r.map((s,o)=>{const{title:a}=Ke(i==null?void 0:i[o]),l=s,c=gfe(l),u=a||l.title||String(c);return{schema:l,label:u,value:c}})}const pfe=["string","number","integer","boolean","null"];var Yc;(function(t){t[t.Ignore=0]="Ignore",t[t.Invert=1]="Invert",t[t.Fallback=2]="Fallback"})(Yc||(Yc={}));function B0(t,e=Yc.Ignore,n=-1){if(n>=0){if(Array.isArray(t.items)&&n<t.items.length){const r=t.items[n];if(typeof r!="boolean")return r}}else if(t.items&&!Array.isArray(t.items)&&typeof t.items!="boolean")return t.items;return e!==Yc.Ignore&&Ye(t.additionalItems)?t.additionalItems:{}}function PR(t,e,n,r,i,s=[],o={},a=!1){const{emptyObjectFields:l="populateAllDefaults"}=o;if(r||a)t[e]=n;else if(l!=="skipDefaults"){const c=i===void 0?s.includes(e):i;Ye(n)?l==="skipEmptyDefaults"?Vc(n)||(t[e]=n):(!Vc(n)||s.includes(e))&&(c||l!=="populateRequiredDefaults")&&(t[e]=n):n!==void 0&&(l==="populateAllDefaults"||l==="skipEmptyDefaults"||c&&s.includes(e))&&(t[e]=n)}}function ko(t,e,n={}){const{parentDefaults:r,rawFormData:i,rootSchema:s={},includeUndefinedValues:o=!1,_recurseList:a=[],experimental_defaultFormStateBehavior:l=void 0,experimental_customMergeAllOf:c=void 0,required:u,shouldMergeDefaultsIntoFormData:d=!1}=n;let h=Ye(i)?i:{};const f=Ye(e)?e:{};let p=r,m=null,_=l,g=a;if(f[Ns]!==void 0&&(l==null?void 0:l.constAsDefaults)!=="never"&&!KM(f))p=f[Ns];else if(Ye(p)&&Ye(f.default))p=bs(p,f.default);else if(wH in f&&!f[pi]&&!f[yr])p=f.default;else if(nn in f){const w=f[nn];a.includes(w)||(g=a.concat(w),m=hk(w,s)),m&&!p&&(p=f.default),d&&m&&!Ye(i)&&(h=i)}else if(xy in f){const w={...RR(t,f,n,p),...h};m=VM(t,f,s,!1,[],w,c)[0]}else if(tx(f))p=f.items.map((w,x)=>ko(t,w,{rootSchema:s,includeUndefinedValues:o,_recurseList:a,experimental_defaultFormStateBehavior:l,experimental_customMergeAllOf:c,parentDefaults:Array.isArray(r)?r[x]:void 0,rawFormData:h,required:u,shouldMergeDefaultsIntoFormData:d}));else if(yr in f){const{oneOf:w,...x}=f;if(w.length===0)return;const S=Kc(f),{type:C="null"}=x;!Array.isArray(C)&&pfe.includes(C)&&(_==null?void 0:_.constAsDefaults)==="skipOneOf"&&(_={..._,constAsDefaults:"never"}),m=w[xh(t,s,i??f.default,w,0,S,c)],m=zs(x,m)}else if(pi in f){const{anyOf:w,...x}=f;if(w.length===0)return;const S=Kc(f);m=w[xh(t,s,i??f.default,w,0,S,c)],m=zs(x,m)}if(m)return ko(t,m,{rootSchema:s,includeUndefinedValues:o,_recurseList:g,experimental_defaultFormStateBehavior:_,experimental_customMergeAllOf:c,parentDefaults:p,rawFormData:i??h,required:u,shouldMergeDefaultsIntoFormData:d});p===void 0&&(p=f.default);const y=RR(t,f,n,p);let v=y??p;if(d){const{arrayMinItems:w={}}=l||{},{mergeExtraDefaults:x}=w,S=mfe(t,f,s,i,l,c);(!Ye(i)||du in f)&&(v=Eh(v,S,x,!0))}return v}function mfe(t,e,n,r,i,s){const o=!HM(e)&&FS(t,e,n,s);let a=r;if(o){const c=Sh(e);a=(c==null?void 0:c.some(d=>St(d.value,r)))?r:void 0}return e[Ns]&&(i==null?void 0:i.constAsDefaults)==="always"&&(a=e.const),a}function yfe(t,e,{rawFormData:n,rootSchema:r={},includeUndefinedValues:i=!1,_recurseList:s=[],experimental_defaultFormStateBehavior:o=void 0,experimental_customMergeAllOf:a=void 0,required:l,shouldMergeDefaultsIntoFormData:c}={},u){{const d=Ye(n)?n:{},h=e,f=(o==null?void 0:o.allOf)==="populateDefaults"&&du in h?_r(t,h,r,d,a):h,p=f[Ns],m=Object.keys(f.properties||{}).reduce((_,g)=>{var y;const v=we(f,[jt,g]),w=Ye(p)&&p[g]!==void 0,x=(Ye(v)&&Ns in v||w)&&(o==null?void 0:o.constAsDefaults)!=="never"&&!KM(v),S=ko(t,v,{rootSchema:r,_recurseList:s,experimental_defaultFormStateBehavior:o,experimental_customMergeAllOf:a,includeUndefinedValues:i===!0,parentDefaults:we(u,[g]),rawFormData:we(d,[g]),required:(y=f.required)===null||y===void 0?void 0:y.includes(g),shouldMergeDefaultsIntoFormData:c});return PR(_,g,S,i,l,f.required,o,x),_},{});if(f.additionalProperties){const _=Ye(f.additionalProperties)?f.additionalProperties:{},g=new Set;Ye(u)&&Object.keys(u).filter(v=>!f.properties||!f.properties[v]).forEach(v=>g.add(v));const y=[];Object.keys(d).filter(v=>!f.properties||!f.properties[v]).forEach(v=>{g.add(v),y.push(v)}),g.forEach(v=>{var w;const x=ko(t,_,{rootSchema:r,_recurseList:s,experimental_defaultFormStateBehavior:o,experimental_customMergeAllOf:a,includeUndefinedValues:i===!0,parentDefaults:we(u,[v]),rawFormData:we(d,[v]),required:(w=f.required)===null||w===void 0?void 0:w.includes(v),shouldMergeDefaultsIntoFormData:c});PR(m,v,x,i,l,y)})}return m}}function _fe(t,e,{rawFormData:n,rootSchema:r={},_recurseList:i=[],experimental_defaultFormStateBehavior:s=void 0,experimental_customMergeAllOf:o=void 0,required:a,shouldMergeDefaultsIntoFormData:l}={},c){var u,d;const h=e,f=(u=s==null?void 0:s.arrayMinItems)!==null&&u!==void 0?u:{},{populate:p,mergeExtraDefaults:m}=f,_=p==="never",g=p==="requiredOnly",y=p==="all"||!_&&!g,v=(d=f==null?void 0:f.computeSkipPopulate)!==null&&d!==void 0?d:()=>!1,x=(s==null?void 0:s.emptyObjectFields)==="skipEmptyDefaults"?void 0:[];if(Array.isArray(c)&&(c=c.map((A,M)=>{const b=B0(h,Yc.Fallback,M);return ko(t,b,{rootSchema:r,_recurseList:i,experimental_defaultFormStateBehavior:s,experimental_customMergeAllOf:o,parentDefaults:A,required:a,shouldMergeDefaultsIntoFormData:l})})),Array.isArray(n)){const A=B0(h);if(_)c=n;else{const M=n.map((j,V)=>ko(t,A,{rootSchema:r,_recurseList:i,experimental_defaultFormStateBehavior:s,experimental_customMergeAllOf:o,rawFormData:j,parentDefaults:we(c,[V]),required:a,shouldMergeDefaultsIntoFormData:l}));c=Eh(c,M,(g&&a||y)&&m)}}if((Ye(h)&&Ns in h&&(s==null?void 0:s.constAsDefaults)!=="never")===!1){if(_)return c??x;if(g&&!a)return c||void 0}const C=Array.isArray(c)?c.length:0;if(!h.minItems||OS(t,h,r,o)||v(t,h,r)||h.minItems<=C)return c||x;const T=c||[],P=B0(h,Yc.Invert),F=P.default,k=new Array(h.minItems-C).fill(ko(t,P,{parentDefaults:F,rootSchema:r,_recurseList:i,experimental_defaultFormStateBehavior:s,experimental_customMergeAllOf:o,required:a,shouldMergeDefaultsIntoFormData:l}));return T.concat(k)}function RR(t,e,n={},r){switch(js(e)){case"object":return yfe(t,e,n,r);case"array":return _fe(t,e,n,r)}}function YM(t,e,n,r,i=!1,s,o){if(!Ye(e))throw new Error("Invalid schema: "+e);const a=_r(t,e,r,n,o),l=ko(t,a,{rootSchema:r,includeUndefinedValues:i,experimental_defaultFormStateBehavior:s,experimental_customMergeAllOf:o,rawFormData:n,shouldMergeDefaultsIntoFormData:!0});if(Ye(n)||Array.isArray(n)){const{mergeDefaultsIntoFormData:c}=s||{};return Eh(l,n,!0,c==="useDefaultIfFormDataUndefined",!0)}return l}function XM(t={}){return"widget"in Ke(t)&&Ke(t).widget!=="hidden"}function ZM(t,e,n={},r,i){if(n[AE]==="files")return!0;if(e.items){const s=_r(t,e.items,r,void 0,i);return s.type==="string"&&s.format==="data-url"}return!1}function vfe(t,e,n={},r,i,s){const o=Ke(n,i),{label:a=!0}=o;let l=!!a;const c=js(e);return c==="array"&&(l=OS(t,e,r,s)||ZM(t,e,n,r,s)||XM(n)),c==="object"&&(l=!1),c==="boolean"&&!n[AE]&&(l=!1),n[CH]&&(l=!1),l}function wfe(t,e,n){if(!n)return e;const{errors:r,errorSchema:i}=e;let s=t.toErrorList(n),o=n;return Vc(i)||(o=bs(i,n,!0),s=[...r].concat(s)),{errorSchema:o,errors:s}}const Rl=Symbol("no Value");function nx(t,e,n,r,i={},s){let o;if(Un(n,jt)){const a={};if(Un(r,jt)){const u=we(r,jt,{});Object.keys(u).forEach(d=>{Un(i,d)&&(a[d]=void 0)})}const l=Object.keys(we(n,jt,{})),c={};l.forEach(u=>{const d=we(i,u);let h=we(r,[jt,u],{}),f=we(n,[jt,u],{});Un(h,nn)&&(h=_r(t,h,e,d,s)),Un(f,nn)&&(f=_r(t,f,e,d,s));const p=we(h,"type"),m=we(f,"type");if(!p||p===m)if(Un(a,u)&&delete a[u],m==="object"||m==="array"&&Array.isArray(d)){const _=nx(t,e,f,h,d,s);(_!==void 0||m==="array")&&(c[u]=_)}else{const _=we(f,"default",Rl),g=we(h,"default",Rl);_!==Rl&&_!==d&&(g===d?a[u]=_:we(f,"readOnly")===!0&&(a[u]=void 0));const y=we(f,"const",Rl),v=we(h,"const",Rl);y!==Rl&&y!==d&&(a[u]=v===d?y:void 0)}}),o={...typeof i=="string"||Array.isArray(i)?void 0:i,...a,...c}}else if(we(r,"type")==="array"&&we(n,"type")==="array"&&Array.isArray(i)){let a=we(r,"items"),l=we(n,"items");if(typeof a=="object"&&typeof l=="object"&&!Array.isArray(a)&&!Array.isArray(l)){Un(a,nn)&&(a=_r(t,a,e,i,s)),Un(l,nn)&&(l=_r(t,l,e,i,s));const c=we(a,"type"),u=we(l,"type");if(!c||c===u){const d=we(n,"maxItems",-1);u==="object"?o=i.reduce((h,f)=>{const p=nx(t,e,l,a,f,s);return p!==void 0&&(d<0||h.length<d)&&h.push(p),h},[]):o=d>0&&i.length>d?i.slice(0,d):i}}else typeof a=="boolean"&&typeof l=="boolean"&&a===l&&(o=i)}return o}function Bg(t,e,n,r,i,s,o,a=[],l){if(nn in e||xy in e||du in e){const d=_r(t,e,s,o,l);if(a.findIndex(f=>St(f,d))===-1)return Bg(t,d,n,r,i,s,o,a.concat(d),l)}if(Lo in e&&!we(e,[Lo,nn]))return Bg(t,we(e,Lo),n,r,i,s,o,a,l);const u={$id:i||n};if(js(e)==="object"&&jt in e)for(const d in e.properties){const h=we(e,[jt,d]),f=u[bo]+r+d;u[d]=Bg(t,Ye(h)?h:{},n,r,f,s,we(o,[d]),a,l)}return u}function xfe(t,e,n,r,i,s="root",o="_",a){return Bg(t,e,s,o,n,r,i,void 0,a)}function ga(t,e,n,r,i,s=[],o){if(nn in e||xy in e||du in e){const l=_r(t,e,r,i,o);if(s.findIndex(u=>St(u,l))===-1)return ga(t,l,n,r,i,s.concat(l),o)}let a={[zg]:n.replace(/^\./,"")};if(yr in e||pi in e){const l=yr in e?e.oneOf:e.anyOf,c=Kc(e),u=xh(t,r,i,l,0,c,o),d=l[u];a={...a,...ga(t,d,n,r,i,s,o)}}if(jw in e&&e[jw]!==!1&&vn(a,IE,!0),Lo in e&&Array.isArray(i)){const{items:l,additionalItems:c}=e;Array.isArray(l)?i.forEach((u,d)=>{l[d]?a[d]=ga(t,l[d],`${n}.${d}`,r,u,s,o):c?a[d]=ga(t,c,`${n}.${d}`,r,u,s,o):console.warn(`Unable to generate path schema for "${n}.${d}". No schema defined for it`)}):i.forEach((u,d)=>{a[d]=ga(t,l,`${n}.${d}`,r,u,s,o)})}else if(jt in e)for(const l in e.properties){const c=we(e,[jt,l]);a[l]=ga(t,c,`${n}.${l}`,r,we(i,[l]),s,o)}return a}function Efe(t,e,n="",r,i,s){return ga(t,e,n,r,i,void 0,s)}class Sfe{constructor(e,n,r,i){this.rootSchema=n,this.validator=e,this.experimental_defaultFormStateBehavior=r,this.experimental_customMergeAllOf=i}getValidator(){return this.validator}doesSchemaUtilsDiffer(e,n,r={},i){return!e||!n?!1:this.validator!==e||!St(this.rootSchema,n)||!St(this.experimental_defaultFormStateBehavior,r)||this.experimental_customMergeAllOf!==i}getDefaultFormState(e,n,r=!1){return YM(this.validator,e,n,this.rootSchema,r,this.experimental_defaultFormStateBehavior,this.experimental_customMergeAllOf)}getDisplayLabel(e,n,r){return vfe(this.validator,e,n,this.rootSchema,r,this.experimental_customMergeAllOf)}getClosestMatchingOption(e,n,r,i){return xh(this.validator,this.rootSchema,e,n,r,i,this.experimental_customMergeAllOf)}getFirstMatchingOption(e,n,r){return XE(this.validator,e,n,this.rootSchema,r)}getMatchingOption(e,n,r){return bk(this.validator,e,n,this.rootSchema,r)}isFilesArray(e,n){return ZM(this.validator,e,n,this.rootSchema,this.experimental_customMergeAllOf)}isMultiSelect(e){return OS(this.validator,e,this.rootSchema,this.experimental_customMergeAllOf)}isSelect(e){return FS(this.validator,e,this.rootSchema,this.experimental_customMergeAllOf)}mergeValidationData(e,n){return wfe(this.validator,e,n)}retrieveSchema(e,n){return _r(this.validator,e,this.rootSchema,n,this.experimental_customMergeAllOf)}sanitizeDataForNewSchema(e,n,r){return nx(this.validator,this.rootSchema,e,n,r,this.experimental_customMergeAllOf)}toIdSchema(e,n,r,i="root",s="_"){return xfe(this.validator,e,n,this.rootSchema,r,i,s,this.experimental_customMergeAllOf)}toPathSchema(e,n,r){return Efe(this.validator,e,n,this.rootSchema,r,this.experimental_customMergeAllOf)}}function bfe(t,e,n={},r){return new Sfe(t,e,n,r)}function Cfe(t){var e;if(t.indexOf("data:")===-1)throw new Error("File is invalid: URI must be a dataURI");const r=t.slice(5).split(";base64,");if(r.length!==2)throw new Error("File is invalid: dataURI must be base64");const[i,s]=r,[o,...a]=i.split(";"),l=o||"",c=decodeURI(((e=a.map(u=>u.split("=")).find(([u])=>u==="name"))===null||e===void 0?void 0:e[1])||"unknown");try{const u=atob(s),d=new Array(u.length);for(let f=0;f<u.length;f++)d[f]=u.charCodeAt(f);return{blob:new window.Blob([new Uint8Array(d)],{type:l}),name:c}}catch(u){throw new Error("File is invalid: "+u.message)}}function lo(t,e){let n=String(t);for(;n.length<e;)n="0"+n;return n}function qM(t,e){if(t<=0&&e<=0)t=new Date().getFullYear()+t,e=new Date().getFullYear()+e;else if(t<0||e<0)throw new Error(`Both start (${t}) and stop (${e}) must both be <= 0 or > 0, got one of each`);if(t>e)return qM(e,t).reverse();const n=[];for(let r=t;r<=e;r++)n.push({value:r,label:lo(r,2)});return n}function Tfe(t,e){let n=t;if(Array.isArray(e)){const r=n.split(/(%\d)/);e.forEach((i,s)=>{const o=r.findIndex(a=>a===`%${s+1}`);o>=0&&(r[o]=i)}),n=r.join("")}return n}function Pfe(t,e){return Tfe(t,e)}function Yi(t,e=[],n){if(Array.isArray(t))return t.map(s=>Yi(s,e)).filter(s=>s!==n);const r=t===""||t===null?-1:Number(t),i=e[r];return i?i.value:n}function Rfe(t,e,n=[]){const r=Yi(t,n);return Array.isArray(e)?e.filter(i=>!St(i,r)):St(r,e)?void 0:e}function $S(t,e){return Array.isArray(e)?e.some(n=>St(n,t)):St(e,t)}function Ife(t,e=[],n=!1){const r=e.map((i,s)=>$S(i.value,t)?String(s):void 0).filter(i=>typeof i<"u");return n?r:r[0]}function Afe(t,e,n=[]){const r=Yi(t,n);if(!Od(r)){const i=n.findIndex(a=>r===a.value),s=n.map(({value:a})=>a);return e.slice(0,i).concat(r,e.slice(i)).sort((a,l)=>+(s.indexOf(a)>s.indexOf(l)))}return e}var Ffe=1,Ofe=4;function JM(t){return Fd(t,Ffe|Ofe)}function $fe(t,e,n,r){return r=typeof r=="function"?r:void 0,t==null?t:ZE(t,e,n,r)}class Lfe{constructor(e){this.errorSchema={},this.resetAllErrors(e)}get ErrorSchema(){return this.errorSchema}getOrCreateErrorBlock(e){let r=Array.isArray(e)&&e.length>0||typeof e=="string"?we(this.errorSchema,e):this.errorSchema;return!r&&e&&(r={},$fe(this.errorSchema,e,r,Object)),r}resetAllErrors(e){return this.errorSchema=e?JM(e):{},this}addErrors(e,n){const r=this.getOrCreateErrorBlock(n);let i=we(r,gr);return Array.isArray(i)||(i=[],r[gr]=i),Array.isArray(e)?vn(r,gr,[...new Set([...i,...e])]):vn(r,gr,[...new Set([...i,e])]),this}setErrors(e,n){const r=this.getOrCreateErrorBlock(n),i=Array.isArray(e)?[...new Set([...e])]:[e];return vn(r,gr,i),this}clearErrors(e){const n=this.getOrCreateErrorBlock(e);return vn(n,gr,[]),this}}function kfe(t,e,n=[1900,new Date().getFullYear()+2],r="YMD"){const{day:i,month:s,year:o,hour:a,minute:l,second:c}=t,u={type:"day",range:[1,31],value:i},d={type:"month",range:[1,12],value:s},h={type:"year",range:n,value:o},f=[];switch(r){case"MDY":f.push(d,u,h);break;case"DMY":f.push(u,d,h);break;case"YMD":default:f.push(h,d,u)}return e&&f.push({type:"hour",range:[0,23],value:a},{type:"minute",range:[0,59],value:l},{type:"second",range:[0,59],value:c}),f}function Mfe(t){const e={};return t.multipleOf&&(e.step=t.multipleOf),(t.minimum||t.minimum===0)&&(e.min=t.minimum),(t.maximum||t.maximum===0)&&(e.max=t.maximum),e}function Dfe(t,e,n={},r=!0){const i={type:e||"text",...Mfe(t)};return n.inputType?i.type=n.inputType:e||(t.type==="number"?(i.type="number",r&&i.step===void 0&&(i.step="any")):t.type==="integer"&&(i.type="number",i.step===void 0&&(i.step=1))),n.autocomplete&&(i.autoComplete=n.autocomplete),n.accept&&(i.accept=n.accept),i}const IR={props:{disabled:!1},submitText:"Submit",norender:!1};function Nfe(t={}){const e=Ke(t);if(e&&e[im]){const n=e[im];return{...IR,...n}}return IR}function rt(t,e,n={}){const{templates:r}=e;return t==="ButtonTemplates"?r[t]:n[t]||r[t]}var QM={exports:{}},ot={};/**
 * @license React
 * react-is.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var LS=Symbol.for("react.element"),kS=Symbol.for("react.portal"),Yy=Symbol.for("react.fragment"),Xy=Symbol.for("react.strict_mode"),Zy=Symbol.for("react.profiler"),qy=Symbol.for("react.provider"),Jy=Symbol.for("react.context"),jfe=Symbol.for("react.server_context"),Qy=Symbol.for("react.forward_ref"),e_=Symbol.for("react.suspense"),t_=Symbol.for("react.suspense_list"),n_=Symbol.for("react.memo"),r_=Symbol.for("react.lazy"),zfe=Symbol.for("react.offscreen"),eD;eD=Symbol.for("react.module.reference");function ei(t){if(typeof t=="object"&&t!==null){var e=t.$$typeof;switch(e){case LS:switch(t=t.type,t){case Yy:case Zy:case Xy:case e_:case t_:return t;default:switch(t=t&&t.$$typeof,t){case jfe:case Jy:case Qy:case r_:case n_:case qy:return t;default:return e}}case kS:return e}}}ot.ContextConsumer=Jy;ot.ContextProvider=qy;ot.Element=LS;ot.ForwardRef=Qy;ot.Fragment=Yy;ot.Lazy=r_;ot.Memo=n_;ot.Portal=kS;ot.Profiler=Zy;ot.StrictMode=Xy;ot.Suspense=e_;ot.SuspenseList=t_;ot.isAsyncMode=function(){return!1};ot.isConcurrentMode=function(){return!1};ot.isContextConsumer=function(t){return ei(t)===Jy};ot.isContextProvider=function(t){return ei(t)===qy};ot.isElement=function(t){return typeof t=="object"&&t!==null&&t.$$typeof===LS};ot.isForwardRef=function(t){return ei(t)===Qy};ot.isFragment=function(t){return ei(t)===Yy};ot.isLazy=function(t){return ei(t)===r_};ot.isMemo=function(t){return ei(t)===n_};ot.isPortal=function(t){return ei(t)===kS};ot.isProfiler=function(t){return ei(t)===Zy};ot.isStrictMode=function(t){return ei(t)===Xy};ot.isSuspense=function(t){return ei(t)===e_};ot.isSuspenseList=function(t){return ei(t)===t_};ot.isValidElementType=function(t){return typeof t=="string"||typeof t=="function"||t===Yy||t===Zy||t===Xy||t===e_||t===t_||t===zfe||typeof t=="object"&&t!==null&&(t.$$typeof===r_||t.$$typeof===n_||t.$$typeof===qy||t.$$typeof===Jy||t.$$typeof===Qy||t.$$typeof===eD||t.getModuleId!==void 0)};ot.typeOf=ei;QM.exports=ot;var Ufe=QM.exports;const AR=Za(Ufe),V0={boolean:{checkbox:"CheckboxWidget",radio:"RadioWidget",select:"SelectWidget",hidden:"HiddenWidget"},string:{text:"TextWidget",password:"PasswordWidget",email:"EmailWidget",hostname:"TextWidget",ipv4:"TextWidget",ipv6:"TextWidget",uri:"URLWidget","data-url":"FileWidget",radio:"RadioWidget",select:"SelectWidget",textarea:"TextareaWidget",hidden:"HiddenWidget",date:"DateWidget",datetime:"DateTimeWidget","date-time":"DateTimeWidget","alt-date":"AltDateWidget","alt-datetime":"AltDateTimeWidget",time:"TimeWidget",color:"ColorWidget",file:"FileWidget"},number:{text:"TextWidget",select:"SelectWidget",updown:"UpDownWidget",range:"RangeWidget",radio:"RadioWidget",hidden:"HiddenWidget"},integer:{text:"TextWidget",select:"SelectWidget",updown:"UpDownWidget",range:"RangeWidget",radio:"RadioWidget",hidden:"HiddenWidget"},array:{select:"SelectWidget",checkboxes:"CheckboxesWidget",files:"FileWidget",hidden:"HiddenWidget"}};function Gfe(t){let e=we(t,"MergedWidget");if(!e){const n=t.defaultProps&&t.defaultProps.options||{};e=({options:r,...i})=>E.jsx(t,{options:{...n,...r},...i}),vn(t,"MergedWidget",e)}return e}function As(t,e,n={}){const r=js(t);if(typeof e=="function"||e&&AR.isForwardRef(K.createElement(e))||AR.isMemo(e))return Gfe(e);if(typeof e!="string")throw new Error(`Unsupported widget definition: ${typeof e}`);if(e in n){const i=n[e];return As(t,i,n)}if(typeof r=="string"){if(!(r in V0))throw new Error(`No widget for type '${r}'`);if(e in V0[r]){const i=n[V0[r][e]];return As(t,i,n)}}throw new Error(`No widget '${e}' for type '${r}'`)}function Bfe(t){let e=0;for(let n=0;n<t.length;n+=1){const r=t.charCodeAt(n);e=(e<<5)-e+r,e=e&e}return e.toString(16)}function Vfe(t){const e=new Set;return JSON.stringify(t,(n,r)=>(e.add(n),r)),Bfe(JSON.stringify(t,Array.from(e).sort()))}function Wfe(t,e,n={}){try{return As(t,e,n),!0}catch(r){const i=r;if(i.message&&(i.message.startsWith("No widget")||i.message.startsWith("Unsupported widget")))return!1;throw r}}function nf(t,e){return`${$y(t)?t:t[bo]}__${e}`}function rf(t){return nf(t,"description")}function tD(t){return nf(t,"error")}function rx(t){return nf(t,"examples")}function nD(t){return nf(t,"help")}function rD(t){return nf(t,"title")}function ml(t,e=!1){const n=e?` ${rx(t)}`:"";return`${tD(t)} ${rf(t)} ${nD(t)}${n}`}function iD(t,e){return`${t}-${e}`}function Hfe(t,e,n){return e?n:t}function Kfe(t){return t?new Date(t).toJSON():void 0}function Yfe(t,e){if(!Array.isArray(e))return t;const n=u=>u.reduce((d,h)=>(d[h]=!0,d),{}),r=u=>u.length>1?`properties '${u.join("', '")}'`:`property '${u[0]}'`,i=n(t),s=e.filter(u=>u==="*"||i[u]),o=n(s),a=t.filter(u=>!o[u]),l=s.indexOf("*");if(l===-1){if(a.length)throw new Error(`uiSchema order list does not contain ${r(a)}`);return s}if(l!==s.lastIndexOf("*"))throw new Error("uiSchema order list contains more than one wildcard item");const c=[...s];return c.splice(l,1,...a),c}function W0(t,e=!0){if(!t)return{year:-1,month:-1,day:-1,hour:e?-1:0,minute:e?-1:0,second:e?-1:0};const n=new Date(t);if(Number.isNaN(n.getTime()))throw new Error("Unable to parse date "+t);return{year:n.getUTCFullYear(),month:n.getUTCMonth()+1,day:n.getUTCDate(),hour:e?n.getUTCHours():0,minute:e?n.getUTCMinutes():0,second:e?n.getUTCSeconds():0}}function Vg(t){if(t.const||t.enum&&t.enum.length===1&&t.enum[0]===!0)return!0;if(t.anyOf&&t.anyOf.length===1)return Vg(t.anyOf[0]);if(t.oneOf&&t.oneOf.length===1)return Vg(t.oneOf[0]);if(t.allOf){const e=n=>Vg(n);return t.allOf.some(e)}return!1}function Xfe(t,e,n){const{props:r,state:i}=t;return!St(r,e)||!St(i,n)}function FR(t,e=!0){const{year:n,month:r,day:i,hour:s=0,minute:o=0,second:a=0}=t,l=Date.UTC(n,r-1,i,s,o,a),c=new Date(l).toJSON();return e?c:c.slice(0,10)}function bh(t,e=[]){if(!t)return[];let n=[];return gr in t&&(n=n.concat(t[gr].map(r=>{const i=`.${e.join(".")}`;return{property:i,message:r,stack:`${i} ${r}`}}))),Object.keys(t).reduce((r,i)=>{if(i!==gr){const s=t[i];Va(s)&&(r=r.concat(bh(s,[...e,i])))}return r},n)}function sD(t){return rn(t)?Iy(t,ul):Yh(t)?[t]:VE(KL(jE(t)))}function Zfe(t){const e=new Lfe;return t.length&&t.forEach(n=>{const{property:r,message:i}=n,s=r==="."?[]:sD(r);s.length>0&&s[0]===""&&s.splice(0,1),i&&e.addErrors(i,s)}),e.ErrorSchema}function MS(t){return Object.keys(t).reduce((e,n)=>{if(n==="addError")return e;{const r=t[n];return Va(r)?{...e,[n]:MS(r)}:{...e,[n]:r}}},{})}function qfe(t){if(!t)return"";const e=new Date(t),n=lo(e.getFullYear(),4),r=lo(e.getMonth()+1,2),i=lo(e.getDate(),2),s=lo(e.getHours(),2),o=lo(e.getMinutes(),2),a=lo(e.getSeconds(),2),l=lo(e.getMilliseconds(),3);return`${n}-${r}-${i}T${s}:${o}:${a}.${l}`}function Wg(t,e){if(!e)return t;const{errors:n,errorSchema:r}=t;let i=bh(e),s=e;return Vc(r)||(s=bs(r,e,!0),i=[...n].concat(i)),{errorSchema:s,errors:i}}function Jfe(t){for(const e in t){const n=t,r=n[e];e===nn&&typeof r=="string"&&r.startsWith("#")?n[e]=$L+r:n[e]=DS(r)}return t}function Qfe(t){for(let e=0;e<t.length;e++)t[e]=DS(t[e]);return t}function DS(t){return Array.isArray(t)?Qfe([...t]):mt(t)?Jfe({...t}):t}function oD(t,e,n){for(var r=-1,i=e.length,s={};++r<i;){var o=e[r],a=Ay(t,o);n(a,o)&&ZE(s,fu(o,t),a)}return s}function ege(t,e){if(t==null)return{};var n=Iy(WE(t),function(r){return[r]});return e=YE(e),oD(t,n,function(r,i){return e(r,i[0])})}var tge=200;function nge(t,e,n,r){var i=-1,s=Tk,o=!0,a=t.length,l=[],c=e.length;if(!a)return l;e.length>=tge&&(s=FE,o=!1,e=new Uc(e));e:for(;++i<a;){var u=t[i],d=u;if(u=u!==0?u:0,o&&d===d){for(var h=c;h--;)if(e[h]===d)continue e;l.push(u)}else s(e,d,r)||l.push(u)}return l}var rge=qE(function(t,e){return cm(t)?nge(t,Zh(e,1,cm,!0)):[]});function ige(t,e){const n=Va(t),r=Va(e);if(t===e||!n&&!r)return[];if(n&&!r)return Mi(t);if(!n&&r)return Mi(e);{const i=Mi(ege(t,(o,a)=>!St(o,we(e,a)))),s=rge(Mi(e),Mi(t));return[...i,...s]}}var lt;(function(t){t.ArrayItemTitle="Item",t.MissingItems="Missing items definition",t.YesLabel="Yes",t.NoLabel="No",t.CloseLabel="Close",t.ErrorsLabel="Errors",t.NewStringDefault="New Value",t.AddButton="Add",t.AddItemButton="Add Item",t.CopyButton="Copy",t.MoveDownButton="Move down",t.MoveUpButton="Move up",t.RemoveButton="Remove",t.NowLabel="Now",t.ClearLabel="Clear",t.AriaDateLabel="Select a date",t.PreviewLabel="Preview",t.DecrementAriaLabel="Decrease value by 1",t.IncrementAriaLabel="Increase value by 1",t.UnknownFieldType="Unknown field type %1",t.OptionPrefix="Option %1",t.TitleOptionPrefix="%1 option %2",t.KeyLabel="%1 Key",t.InvalidObjectField='Invalid "%1" object field configuration: _%2_.',t.UnsupportedField="Unsupported field schema.",t.UnsupportedFieldWithId="Unsupported field schema for field `%1`.",t.UnsupportedFieldWithReason="Unsupported field schema: _%1_.",t.UnsupportedFieldWithIdAndReason="Unsupported field schema for field `%1`: _%2_.",t.FilesInfo="**%1** (%2, %3 bytes)"})(lt||(lt={}));function sge(t,e){var n=rn(t)?UE:yk;return n(t,xk(e))}function oge(t,e){return oD(t,e,function(n,r){return wk(t,r)})}var OR=uk(function(t,e){return t==null?{}:oge(t,e)}),age=0;function lge(t){var e=++age;return jE(t)+e}function ix(){return lge("rjsf-array-item-")}function $R(t){return Array.isArray(t)?t.map(e=>({key:ix(),item:e})):[]}function Ju(t){return Array.isArray(t)?t.map(e=>e.item):[]}class cge extends K.Component{constructor(n){super(n);q(this,"_getNewFormDataRow",()=>{const{schema:n,registry:r}=this.props,{schemaUtils:i}=r;let s=n.items;return tx(n)&&vH(n)&&(s=n.additionalItems),i.getDefaultFormState(s)});q(this,"onAddClick",n=>{this._handleAddClick(n)});q(this,"onAddIndexClick",n=>r=>{this._handleAddClick(r,n)});q(this,"onCopyIndexClick",n=>r=>{r&&r.preventDefault();const{onChange:i,errorSchema:s}=this.props,{keyedFormData:o}=this.state;let a;if(s){a={};for(const u in s){const d=parseInt(u);d<=n?vn(a,[d],s[u]):d>n&&vn(a,[d+1],s[u])}}const l={key:ix(),item:JM(o[n].item)},c=[...o];n!==void 0?c.splice(n+1,0,l):c.push(l),this.setState({keyedFormData:c,updatedKeyedFormData:!0},()=>i(Ju(c),a))});q(this,"onDropIndexClick",n=>r=>{r&&r.preventDefault();const{onChange:i,errorSchema:s}=this.props,{keyedFormData:o}=this.state;let a;if(s){a={};for(const c in s){const u=parseInt(c);u<n?vn(a,[u],s[c]):u>n&&vn(a,[u-1],s[c])}}const l=o.filter((c,u)=>u!==n);this.setState({keyedFormData:l,updatedKeyedFormData:!0},()=>i(Ju(l),a))});q(this,"onReorderClick",(n,r)=>i=>{i&&(i.preventDefault(),i.currentTarget.blur());const{onChange:s,errorSchema:o}=this.props;let a;if(o){a={};for(const d in o){const h=parseInt(d);h==n?vn(a,[r],o[n]):h==r?vn(a,[n],o[r]):vn(a,[d],o[h])}}const{keyedFormData:l}=this.state;function c(){const d=l.slice();return d.splice(n,1),d.splice(r,0,l[n]),d}const u=c();this.setState({keyedFormData:u},()=>s(Ju(u),a))});q(this,"onChangeForIndex",n=>(r,i,s)=>{const{formData:o,onChange:a,errorSchema:l}=this.props,u=(Array.isArray(o)?o:[]).map((d,h)=>n===h?typeof r>"u"?null:r:d);a(u,l&&l&&{...l,[n]:i},s)});q(this,"onSelectChange",n=>{const{onChange:r,idSchema:i}=this.props;r(n,void 0,i&&i.$id)});const{formData:r=[]}=n,i=$R(r);this.state={keyedFormData:i,updatedKeyedFormData:!1}}static getDerivedStateFromProps(n,r){if(r.updatedKeyedFormData)return{updatedKeyedFormData:!1};const i=Array.isArray(n.formData)?n.formData:[],s=r.keyedFormData||[];return{keyedFormData:i.length===s.length?s.map((a,l)=>({key:a.key,item:i[l]})):$R(i)}}get itemTitle(){const{schema:n,registry:r}=this.props,{translateString:i}=r;return we(n,[Lo,"title"],we(n,[Lo,"description"],i(lt.ArrayItemTitle)))}isItemRequired(n){return Array.isArray(n.type)?!n.type.includes("null"):n.type!=="null"}canAddItem(n){const{schema:r,uiSchema:i,registry:s}=this.props;let{addable:o}=Ke(i,s.globalUiOptions);return o!==!1&&(r.maxItems!==void 0?o=n.length<r.maxItems:o=!0),o}_handleAddClick(n,r){n&&n.preventDefault();const{onChange:i,errorSchema:s}=this.props,{keyedFormData:o}=this.state;let a;if(s){a={};for(const u in s){const d=parseInt(u);r===void 0||d<r?vn(a,[d],s[u]):d>=r&&vn(a,[d+1],s[u])}}const l={key:ix(),item:this._getNewFormDataRow()},c=[...o];r!==void 0?c.splice(r,0,l):c.push(l),this.setState({keyedFormData:c,updatedKeyedFormData:!0},()=>i(Ju(c),a))}render(){const{schema:n,uiSchema:r,idSchema:i,registry:s}=this.props,{schemaUtils:o,translateString:a}=s;if(!(Lo in n)){const l=Ke(r),c=rt("UnsupportedFieldTemplate",s,l);return E.jsx(c,{schema:n,idSchema:i,reason:a(lt.MissingItems),registry:s})}return o.isMultiSelect(n)?this.renderMultiSelect():XM(r)?this.renderCustomWidget():tx(n)?this.renderFixedArray():o.isFilesArray(n,r)?this.renderFiles():this.renderNormalArray()}renderNormalArray(){const{schema:n,uiSchema:r={},errorSchema:i,idSchema:s,name:o,title:a,disabled:l=!1,readonly:c=!1,autofocus:u=!1,required:d=!1,registry:h,onBlur:f,onFocus:p,idPrefix:m,idSeparator:_="_",rawErrors:g}=this.props,{keyedFormData:y}=this.state,v=n.title||a||o,{schemaUtils:w,formContext:x}=h,S=Ke(r),C=mt(n.items)?n.items:{},T=w.retrieveSchema(C),P=Ju(this.state.keyedFormData),F=this.canAddItem(P),k={canAdd:F,items:y.map((M,b)=>{const{key:j,item:V}=M,H=V,U=w.retrieveSchema(C,H),B=i?i[b]:void 0,N=s.$id+_+b,O=w.toIdSchema(U,N,H,m,_);return this.renderArrayFieldItem({key:j,index:b,name:o&&`${o}-${b}`,title:v?`${v}-${b+1}`:void 0,canAdd:F,canMoveUp:b>0,canMoveDown:b<P.length-1,itemSchema:U,itemIdSchema:O,itemErrorSchema:B,itemData:H,itemUiSchema:r.items,autofocus:u&&b===0,onBlur:f,onFocus:p,rawErrors:g,totalItems:y.length})}),className:`field field-array field-array-of-${T.type}`,disabled:l,idSchema:s,uiSchema:r,onAddClick:this.onAddClick,readonly:c,required:d,schema:n,title:v,formContext:x,formData:P,rawErrors:g,registry:h},A=rt("ArrayFieldTemplate",h,S);return E.jsx(A,{...k})}renderCustomWidget(){const{schema:n,idSchema:r,uiSchema:i,disabled:s=!1,readonly:o=!1,autofocus:a=!1,required:l=!1,hideError:c,placeholder:u,onBlur:d,onFocus:h,formData:f=[],registry:p,rawErrors:m,name:_}=this.props,{widgets:g,formContext:y,globalUiOptions:v,schemaUtils:w}=p,{widget:x,title:S,...C}=Ke(i,v),T=As(n,x,g),P=S??n.title??_,F=w.getDisplayLabel(n,i,v);return E.jsx(T,{id:r.$id,name:_,multiple:!0,onChange:this.onSelectChange,onBlur:d,onFocus:h,options:C,schema:n,uiSchema:i,registry:p,value:f,disabled:s,readonly:o,hideError:c,required:l,label:P,hideLabel:!F,placeholder:u,formContext:y,autofocus:a,rawErrors:m})}renderMultiSelect(){const{schema:n,idSchema:r,uiSchema:i,formData:s=[],disabled:o=!1,readonly:a=!1,autofocus:l=!1,required:c=!1,placeholder:u,onBlur:d,onFocus:h,registry:f,rawErrors:p,name:m}=this.props,{widgets:_,schemaUtils:g,formContext:y,globalUiOptions:v}=f,w=g.retrieveSchema(n.items,s),x=Sh(w,i),{widget:S="select",title:C,...T}=Ke(i,v),P=As(n,S,_),F=C??n.title??m,k=g.getDisplayLabel(n,i,v);return E.jsx(P,{id:r.$id,name:m,multiple:!0,onChange:this.onSelectChange,onBlur:d,onFocus:h,options:{...T,enumOptions:x},schema:n,uiSchema:i,registry:f,value:s,disabled:o,readonly:a,required:c,label:F,hideLabel:!k,placeholder:u,formContext:y,autofocus:l,rawErrors:p})}renderFiles(){const{schema:n,uiSchema:r,idSchema:i,name:s,disabled:o=!1,readonly:a=!1,autofocus:l=!1,required:c=!1,onBlur:u,onFocus:d,registry:h,formData:f=[],rawErrors:p}=this.props,{widgets:m,formContext:_,globalUiOptions:g,schemaUtils:y}=h,{widget:v="files",title:w,...x}=Ke(r,g),S=As(n,v,m),C=w??n.title??s,T=y.getDisplayLabel(n,r,g);return E.jsx(S,{options:x,id:i.$id,name:s,multiple:!0,onChange:this.onSelectChange,onBlur:u,onFocus:d,schema:n,uiSchema:r,value:f,disabled:o,readonly:a,required:c,registry:h,formContext:_,autofocus:l,rawErrors:p,label:C,hideLabel:!T})}renderFixedArray(){const{schema:n,uiSchema:r={},formData:i=[],errorSchema:s,idPrefix:o,idSeparator:a="_",idSchema:l,name:c,title:u,disabled:d=!1,readonly:h=!1,autofocus:f=!1,required:p=!1,registry:m,onBlur:_,onFocus:g,rawErrors:y}=this.props,{keyedFormData:v}=this.state;let{formData:w=[]}=this.props;const x=n.title||u||c,S=Ke(r),{schemaUtils:C,formContext:T}=m,F=(mt(n.items)?n.items:[]).map((j,V)=>C.retrieveSchema(j,i[V])),k=mt(n.additionalItems)?C.retrieveSchema(n.additionalItems,i):null;(!w||w.length<F.length)&&(w=w||[],w=w.concat(new Array(F.length-w.length)));const A=this.canAddItem(w)&&!!k,M={canAdd:A,className:"field field-array field-array-fixed-items",disabled:d,idSchema:l,formData:i,items:v.map((j,V)=>{const{key:H,item:U}=j,B=U,N=V>=F.length,O=(N&&mt(n.additionalItems)?C.retrieveSchema(n.additionalItems,B):F[V])||{},$=l.$id+a+V,G=C.toIdSchema(O,$,B,o,a),R=N?r.additionalItems||{}:Array.isArray(r.items)?r.items[V]:r.items||{},L=s?s[V]:void 0;return this.renderArrayFieldItem({key:H,index:V,name:c&&`${c}-${V}`,title:x?`${x}-${V+1}`:void 0,canAdd:A,canRemove:N,canMoveUp:V>=F.length+1,canMoveDown:N&&V<w.length-1,itemSchema:O,itemData:B,itemUiSchema:R,itemIdSchema:G,itemErrorSchema:L,autofocus:f&&V===0,onBlur:_,onFocus:g,rawErrors:y,totalItems:v.length})}),onAddClick:this.onAddClick,readonly:h,required:p,registry:m,schema:n,uiSchema:r,title:x,formContext:T,errorSchema:s,rawErrors:y},b=rt("ArrayFieldTemplate",m,S);return E.jsx(b,{...M})}renderArrayFieldItem(n){const{key:r,index:i,name:s,canAdd:o,canRemove:a=!0,canMoveUp:l,canMoveDown:c,itemSchema:u,itemData:d,itemUiSchema:h,itemIdSchema:f,itemErrorSchema:p,autofocus:m,onBlur:_,onFocus:g,rawErrors:y,totalItems:v,title:w}=n,{disabled:x,hideError:S,idPrefix:C,idSeparator:T,readonly:P,uiSchema:F,registry:k,formContext:A}=this.props,{fields:{ArraySchemaField:M,SchemaField:b},globalUiOptions:j}=k,V=M||b,{orderable:H=!0,removable:U=!0,copyable:B=!1}=Ke(F,j),N={moveUp:H&&l,moveDown:H&&c,copy:B&&o,remove:U&&a,toolbar:!1};return N.toolbar=Object.keys(N).some(O=>N[O]),{children:E.jsx(V,{name:s,title:w,index:i,schema:u,uiSchema:h,formData:d,formContext:A,errorSchema:p,idPrefix:C,idSeparator:T,idSchema:f,required:this.isItemRequired(u),onChange:this.onChangeForIndex(i),onBlur:_,onFocus:g,registry:k,disabled:x,readonly:P,hideError:S,autofocus:m,rawErrors:y}),className:"array-item",disabled:x,canAdd:o,hasCopy:N.copy,hasToolbar:N.toolbar,hasMoveUp:N.moveUp,hasMoveDown:N.moveDown,hasRemove:N.remove,index:i,totalItems:v,key:r,onAddIndexClick:this.onAddIndexClick,onCopyIndexClick:this.onCopyIndexClick,onDropIndexClick:this.onDropIndexClick,onReorderClick:this.onReorderClick,readonly:P,registry:k,schema:u,uiSchema:h}}}function uge(t){const{schema:e,name:n,uiSchema:r,idSchema:i,formData:s,registry:o,required:a,disabled:l,readonly:c,hideError:u,autofocus:d,title:h,onChange:f,onFocus:p,onBlur:m,rawErrors:_}=t,{title:g}=e,{widgets:y,formContext:v,translateString:w,globalUiOptions:x}=o,{widget:S="checkbox",title:C,label:T=!0,...P}=Ke(r,x),F=As(e,S,y),k=w(lt.YesLabel),A=w(lt.NoLabel);let M;const b=C??g??h??n;if(Array.isArray(e.oneOf))M=Sh({oneOf:e.oneOf.map(j=>{if(mt(j))return{...j,title:j.title||(j.const===!0?k:A)}}).filter(j=>j)},r);else{const j=e,V=e.enum??[!0,!1];!j.enumNames&&V.length===2&&V.every(H=>typeof H=="boolean")?M=[{value:V[0],label:V[0]?k:A},{value:V[1],label:V[1]?k:A}]:M=Sh({enum:V,enumNames:j.enumNames},r)}return E.jsx(F,{options:{...P,enumOptions:M},schema:e,uiSchema:r,id:i.$id,name:n,onChange:f,onFocus:p,onBlur:m,label:b,hideLabel:!T,value:s,required:a,disabled:l,readonly:c,hideError:u,registry:o,formContext:v,autofocus:d,rawErrors:_})}class LR extends K.Component{constructor(n){super(n);q(this,"onOptionChange",n=>{const{selectedOption:r,retrievedOptions:i}=this.state,{formData:s,onChange:o,registry:a}=this.props,{schemaUtils:l}=a,c=n!==void 0?parseInt(n,10):-1;if(c===r)return;const u=c>=0?i[c]:void 0,d=r>=0?i[r]:void 0;let h=l.sanitizeDataForNewSchema(u,d,s);u&&(h=l.getDefaultFormState(u,h,"excludeObjectChildren")),this.setState({selectedOption:c},()=>{o(h,void 0,this.getFieldId())})});const{formData:r,options:i,registry:{schemaUtils:s}}=this.props,o=i.map(a=>s.retrieveSchema(a,r));this.state={retrievedOptions:o,selectedOption:this.getMatchingOption(0,r,o)}}componentDidUpdate(n,r){const{formData:i,options:s,idSchema:o}=this.props,{selectedOption:a}=this.state;let l=this.state;if(!St(n.options,s)){const{registry:{schemaUtils:c}}=this.props,u=s.map(d=>c.retrieveSchema(d,i));l={selectedOption:a,retrievedOptions:u}}if(!St(i,n.formData)&&o.$id===n.idSchema.$id){const{retrievedOptions:c}=l,u=this.getMatchingOption(a,i,c);r&&u!==a&&(l={selectedOption:u,retrievedOptions:c})}l!==this.state&&this.setState(l)}getMatchingOption(n,r,i){const{schema:s,registry:{schemaUtils:o}}=this.props,a=Kc(s);return o.getClosestMatchingOption(r,i,n,a)}getFieldId(){const{idSchema:n,schema:r}=this.props;return`${n.$id}${r.oneOf?"__oneof_select":"__anyof_select"}`}render(){const{name:n,disabled:r=!1,errorSchema:i={},formContext:s,onBlur:o,onFocus:a,readonly:l,registry:c,schema:u,uiSchema:d}=this.props,{widgets:h,fields:f,translateString:p,globalUiOptions:m,schemaUtils:_}=c,{SchemaField:g}=f,{selectedOption:y,retrievedOptions:v}=this.state,{widget:w="select",placeholder:x,autofocus:S,autocomplete:C,title:T=u.title,...P}=Ke(d,m),F=As({type:"number"},w,h),k=we(i,gr,[]),A=lm(i,[gr]),M=_.getDisplayLabel(u,d,m),b=y>=0&&v[y]||null;let j;if(b){const{required:O}=u;j=O?zs({required:O},b):b}let V=[];yr in u&&d&&yr in d?Array.isArray(d[yr])?V=d[yr]:console.warn(`uiSchema.oneOf is not an array for "${T||n}"`):pi in u&&d&&pi in d&&(Array.isArray(d[pi])?V=d[pi]:console.warn(`uiSchema.anyOf is not an array for "${T||n}"`));let H=d;y>=0&&V.length>y&&(H=V[y]);const U=T?lt.TitleOptionPrefix:lt.OptionPrefix,B=T?[T]:[],N=v.map((O,$)=>{const{title:G=O.title}=Ke(V[$]);return{label:G||p(U,B.concat(String($+1))),value:$}});return E.jsxs("div",{className:"panel panel-default panel-body",children:[E.jsx("div",{className:"form-group",children:E.jsx(F,{id:this.getFieldId(),name:`${n}${u.oneOf?"__oneof_select":"__anyof_select"}`,schema:{type:"number",default:0},onChange:this.onOptionChange,onBlur:o,onFocus:a,disabled:r||Vc(N),multiple:!1,rawErrors:k,errorSchema:A,value:y>=0?y:void 0,options:{enumOptions:N,...P},registry:c,formContext:s,placeholder:x,autocomplete:C,autofocus:S,label:T??n,hideLabel:!M,readonly:l})}),j&&j.type!=="null"&&E.jsx(g,{...this.props,schema:j,uiSchema:H})]})}}const dge=/\.([0-9]*0)*$/,hge=/[0.]0*$/;function fge(t){const{registry:e,onChange:n,formData:r,value:i}=t,[s,o]=K.useState(i),{StringField:a}=e.fields;let l=r;const c=K.useCallback((u,d,h)=>{o(u),`${u}`.charAt(0)==="."&&(u=`0${u}`);const f=typeof u=="string"&&u.match(dge)?jP(u.replace(hge,"")):jP(u);n(f,d,h)},[n]);if(typeof s=="string"&&typeof l=="number"){const u=new RegExp(`^(${String(l).replace(".","\\.")})?\\.?0*$`);s.match(u)&&(l=s)}return E.jsx(a,{...t,formData:l,onChange:c})}function ma(){return ma=Object.assign?Object.assign.bind():function(t){for(var e=1;e<arguments.length;e++){var n=arguments[e];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(t[r]=n[r])}return t},ma.apply(this,arguments)}const gge=["children","options"],kR=["allowFullScreen","allowTransparency","autoComplete","autoFocus","autoPlay","cellPadding","cellSpacing","charSet","classId","colSpan","contentEditable","contextMenu","crossOrigin","encType","formAction","formEncType","formMethod","formNoValidate","formTarget","frameBorder","hrefLang","inputMode","keyParams","keyType","marginHeight","marginWidth","maxLength","mediaGroup","minLength","noValidate","radioGroup","readOnly","rowSpan","spellCheck","srcDoc","srcLang","srcSet","tabIndex","useMap"].reduce((t,e)=>(t[e.toLowerCase()]=e,t),{class:"className",for:"htmlFor"}),MR={amp:"&",apos:"'",gt:">",lt:"<",nbsp:"",quot:""},pge=["style","script","pre"],mge=["src","href","data","formAction","srcDoc","action"],yge=/([-A-Z0-9_:]+)(?:\s*=\s*(?:(?:"((?:\\.|[^"])*)")|(?:'((?:\\.|[^'])*)')|(?:\{((?:\\.|{[^}]*?}|[^}])*)\})))?/gi,_ge=/\n{2,}$/,DR=/^(\s*>[\s\S]*?)(?=\n\n|$)/,vge=/^ *> ?/gm,wge=/^(?:\[!([^\]]*)\]\n)?([\s\S]*)/,xge=/^ {2,}\n/,Ege=/^(?:([-*_])( *\1){2,}) *(?:\n *)+\n/,NR=/^(?: {1,3})?(`{3,}|~{3,}) *(\S+)? *([^\n]*?)?\n([\s\S]*?)(?:\1\n?|$)/,jR=/^(?: {4}[^\n]+\n*)+(?:\n *)+\n?/,Sge=/^(`+)((?:\\`|(?!\1)`|[^`])+)\1/,bge=/^(?:\n *)*\n/,Cge=/\r\n?/g,Tge=/^\[\^([^\]]+)](:(.*)((\n+ {4,}.*)|(\n(?!\[\^).+))*)/,Pge=/^\[\^([^\]]+)]/,Rge=/\f/g,Ige=/^---[ \t]*\n(.|\n)*\n---[ \t]*\n/,Age=/^\s*?\[(x|\s)\]/,zR=/^ *(#{1,6}) *([^\n]+?)(?: +#*)?(?:\n *)*(?:\n|$)/,UR=/^ *(#{1,6}) +([^\n]+?)(?: +#*)?(?:\n *)*(?:\n|$)/,GR=/^([^\n]+)\n *(=|-)\2{2,} *\n/,H0=/^ *(?!<[a-z][^ >/]* ?\/>)<([a-z][^ >/]*) ?((?:[^>]*[^/])?)>\n?(\s*(?:<\1[^>]*?>[\s\S]*?<\/\1>|(?!<\1\b)[\s\S])*?)<\/\1>(?!<\/\1>)\n*/i,Fge=/&([a-z0-9]+|#[0-9]{1,6}|#x[0-9a-fA-F]{1,6});/gi,BR=/^<!--[\s\S]*?(?:-->)/,Oge=/^(data|aria|x)-[a-z_][a-z\d_.-]*$/,K0=/^ *<([a-z][a-z0-9:]*)(?:\s+((?:<.*?>|[^>])*))?\/?>(?!<\/\1>)(\s*\n)?/i,$ge=/^\{.*\}$/,Lge=/^(https?:\/\/[^\s<]+[^<.,:;"')\]\s])/,kge=/^<([^ >]+[:@\/][^ >]+)>/,Mge=/-([a-z])?/gi,VR=/^(\|.*)\n(?: *(\|? *[-:]+ *\|[-| :]*)\n((?:.*\|.*\n)*))?\n?/,Dge=/^[^\n]+(?:  \n|\n{2,})/,Nge=/^\[([^\]]*)\]:\s+<?([^\s>]+)>?\s*("([^"]*)")?/,jge=/^!\[([^\]]*)\] ?\[([^\]]*)\]/,zge=/^\[([^\]]*)\] ?\[([^\]]*)\]/,Uge=/(\n|^[-*]\s|^#|^ {2,}|^-{2,}|^>\s)/,Gge=/\t/g,Bge=/(^ *\||\| *$)/g,Vge=/^ *:-+: *$/,Wge=/^ *:-+ *$/,Hge=/^ *-+: *$/,i_=t=>`(?=[\\s\\S]+?\\1${t?"\\1":""})`,s_="((?:\\[.*?\\][([].*?[)\\]]|<.*?>(?:.*?<.*?>)?|`.*?`|\\\\\\1|[\\s\\S])+?)",Kge=RegExp(`^([*_])\\1${i_(1)}${s_}\\1\\1(?!\\1)`),Yge=RegExp(`^([*_])${i_(0)}${s_}\\1(?!\\1)`),Xge=RegExp(`^(==)${i_(0)}${s_}\\1`),Zge=RegExp(`^(~~)${i_(0)}${s_}\\1`),qge=/^(:[a-zA-Z0-9-_]+:)/,Jge=/^\\([^0-9A-Za-z\s])/,Qge=/\\([^0-9A-Za-z\s])/g,epe=/^[\s\S](?:(?!  \n|[0-9]\.|http)[^=*_~\-\n:<`\\\[!])*/,tpe=/^\n+/,npe=/^([ \t]*)/,rpe=/(?:^|\n)( *)$/,NS="(?:\\d+\\.)",jS="(?:[*+-])";function aD(t){return"( *)("+(t===1?NS:jS)+") +"}const lD=aD(1),cD=aD(2);function uD(t){return RegExp("^"+(t===1?lD:cD))}const ipe=uD(1),spe=uD(2);function dD(t){return RegExp("^"+(t===1?lD:cD)+"[^\\n]*(?:\\n(?!\\1"+(t===1?NS:jS)+" )[^\\n]*)*(\\n|$)","gm")}const ope=dD(1),ape=dD(2);function hD(t){const e=t===1?NS:jS;return RegExp("^( *)("+e+") [\\s\\S]+?(?:\\n{2,}(?! )(?!\\1"+e+" (?!"+e+" ))\\n*|\\s*\\n*$)")}const fD=hD(1),gD=hD(2);function WR(t,e){const n=e===1,r=n?fD:gD,i=n?ope:ape,s=n?ipe:spe;return{t:o=>s.test(o),o:Xc(function(o,a){const l=rpe.exec(a.prevCapture);return l&&(a.list||!a.inline&&!a.simple)?r.exec(o=l[1]+o):null}),i:1,u(o,a,l){const c=n?+o[2]:void 0,u=o[0].replace(_ge,`
`).match(i);let d=!1;return{items:u.map(function(h,f){const p=s.exec(h)[0].length,m=RegExp("^ {1,"+p+"}","gm"),_=h.replace(m,"").replace(s,""),g=f===u.length-1,y=_.indexOf(`

`)!==-1||g&&d;d=y;const v=l.inline,w=l.list;let x;l.list=!0,y?(l.inline=!1,x=$d(_)+`

`):(l.inline=!0,x=$d(_));const S=a(x,l);return l.inline=v,l.list=w,S}),ordered:n,start:c}},l:(o,a,l)=>t(o.ordered?"ol":"ul",{key:l.key,start:o.type==="20"?o.start:void 0},o.items.map(function(c,u){return t("li",{key:u},a(c,l))}))}}const lpe=RegExp(`^\\[((?:\\[[^\\[\\]]*(?:\\[[^\\[\\]]*\\][^\\[\\]]*)*\\]|[^\\[\\]])*)\\]\\(\\s*<?((?:\\([^)]*\\)|[^\\s\\\\]|\\\\.)*?)>?(?:\\s+['"]([\\s\\S]*?)['"])?\\s*\\)`),cpe=/^!\[(.*?)\]\( *((?:\([^)]*\)|[^() ])*) *"?([^)"]*)?"?\)/;function HR(t){return typeof t=="string"}function $d(t){let e=t.length;for(;e>0&&t[e-1]<=" ";)e--;return t.slice(0,e)}function Hg(t,e){return t.startsWith(e)}function upe(t,e,n){if(Array.isArray(n)){for(let r=0;r<n.length;r++)if(Hg(t,n[r]))return!0;return!1}return n(t,e)}function Qu(t){return t.replace(/[]/g,"a").replace(/[]/g,"c").replace(/[]/g,"d").replace(/[]/g,"e").replace(/[]/g,"i").replace(/[]/g,"n").replace(/[]/g,"o").replace(/[]/g,"u").replace(/[]/g,"y").replace(/[^a-z0-9- ]/gi,"").replace(/ /gi,"-").toLowerCase()}function dpe(t){return Hge.test(t)?"right":Vge.test(t)?"center":Wge.test(t)?"left":null}function KR(t,e,n,r){const i=n.inTable;n.inTable=!0;let s=[[]],o="";function a(){if(!o)return;const l=s[s.length-1];l.push.apply(l,e(o,n)),o=""}return t.trim().split(/(`[^`]*`|\\\||\|)/).filter(Boolean).forEach((l,c,u)=>{l.trim()==="|"&&(a(),r)?c!==0&&c!==u.length-1&&s.push([]):o+=l}),a(),n.inTable=i,s}function hpe(t,e,n){n.inline=!0;const r=t[2]?t[2].replace(Bge,"").split("|").map(dpe):[],i=t[3]?function(o,a,l){return o.trim().split(`
`).map(function(c){return KR(c,a,l,!0)})}(t[3],e,n):[],s=KR(t[1],e,n,!!i.length);return n.inline=!1,i.length?{align:r,cells:i,header:s,type:"25"}:{children:s,type:"21"}}function YR(t,e){return t.align[e]==null?{}:{textAlign:t.align[e]}}function Xc(t){return t.inline=1,t}function la(t){return Xc(function(e,n){return n.inline?t.exec(e):null})}function io(t){return Xc(function(e,n){return n.inline||n.simple?t.exec(e):null})}function ds(t){return function(e,n){return n.inline||n.simple?null:t.exec(e)}}function cg(t){return Xc(function(e){return t.exec(e)})}const fpe=/(javascript|vbscript|data(?!:image)):/i;function gpe(t){try{const e=decodeURIComponent(t).replace(/[^A-Za-z0-9/:]/g,"");if(fpe.test(e))return null}catch{return null}return t}function Ai(t){return t&&t.replace(Qge,"$1")}function Kg(t,e,n){const r=n.inline||!1,i=n.simple||!1;n.inline=!0,n.simple=!0;const s=t(e,n);return n.inline=r,n.simple=i,s}function ppe(t,e,n){const r=n.inline||!1,i=n.simple||!1;n.inline=!1,n.simple=!0;const s=t(e,n);return n.inline=r,n.simple=i,s}function mpe(t,e,n){const r=n.inline||!1;n.inline=!1;const i=t(e,n);return n.inline=r,i}const Y0=(t,e,n)=>({children:Kg(e,t[2],n)});function X0(){return{}}function Z0(){return null}function ype(...t){return t.filter(Boolean).join(" ")}function q0(t,e,n){let r=t;const i=e.split(".");for(;i.length&&(r=r[i[0]],r!==void 0);)i.shift();return r||n}function _pe(t="",e={}){e.overrides=e.overrides||{},e.namedCodesToUnicode=e.namedCodesToUnicode?ma({},MR,e.namedCodesToUnicode):MR;const n=e.slugify||Qu,r=e.sanitizer||gpe,i=e.createElement||K.createElement,s=[DR,NR,jR,e.enforceAtxHeadings?UR:zR,GR,VR,fD,gD],o=[...s,Dge,H0,BR,K0];function a(g,y){for(let v=0;v<g.length;v++)if(g[v].test(y))return!0;return!1}function l(g,y,...v){const w=q0(e.overrides,g+".props",{});return i(function(x,S){const C=q0(S,x);return C?typeof C=="function"||typeof C=="object"&&"render"in C?C:q0(S,x+".component",x):x}(g,e.overrides),ma({},y,w,{className:ype(y==null?void 0:y.className,w.className)||void 0}),...v)}function c(g){g=g.replace(Ige,"");let y=!1;e.forceInline?y=!0:e.forceBlock||(y=Uge.test(g)===!1);const v=m(p(y?g:$d(g).replace(tpe,"")+`

`,{inline:y}));for(;HR(v[v.length-1])&&!v[v.length-1].trim();)v.pop();if(e.wrapper===null)return v;const w=e.wrapper||(y?"span":"div");let x;if(v.length>1||e.forceWrapper)x=v;else{if(v.length===1)return x=v[0],typeof x=="string"?l("span",{key:"outer"},x):x;x=null}return i(w,{key:"outer"},x)}function u(g,y){if(!y||!y.trim())return null;const v=y.match(yge);return v?v.reduce(function(w,x){const S=x.indexOf("=");if(S!==-1){const C=function(k){return k.indexOf("-")!==-1&&k.match(Oge)===null&&(k=k.replace(Mge,function(A,M){return M.toUpperCase()})),k}(x.slice(0,S)).trim(),T=function(k){const A=k[0];return(A==='"'||A==="'")&&k.length>=2&&k[k.length-1]===A?k.slice(1,-1):k}(x.slice(S+1).trim()),P=kR[C]||C;if(P==="ref")return w;const F=w[P]=function(k,A,M,b){return A==="style"?function(j){const V=[];let H="",U=!1,B=!1,N="";if(!j)return V;for(let $=0;$<j.length;$++){const G=j[$];if(G!=='"'&&G!=="'"||U||(B?G===N&&(B=!1,N=""):(B=!0,N=G)),G==="("&&H.endsWith("url")?U=!0:G===")"&&U&&(U=!1),G!==";"||B||U)H+=G;else{const R=H.trim();if(R){const L=R.indexOf(":");if(L>0){const W=R.slice(0,L).trim(),te=R.slice(L+1).trim();V.push([W,te])}}H=""}}const O=H.trim();if(O){const $=O.indexOf(":");if($>0){const G=O.slice(0,$).trim(),R=O.slice($+1).trim();V.push([G,R])}}return V}(M).reduce(function(j,[V,H]){return j[V.replace(/(-[a-z])/g,U=>U[1].toUpperCase())]=b(H,k,V),j},{}):mge.indexOf(A)!==-1?b(Ai(M),k,A):(M.match($ge)&&(M=Ai(M.slice(1,M.length-1))),M==="true"||M!=="false"&&M)}(g,C,T,r);typeof F=="string"&&(H0.test(F)||K0.test(F))&&(w[P]=c(F.trim()))}else x!=="style"&&(w[kR[x]||x]=!0);return w},{}):null}const d=[],h={},f={0:{t:[">"],o:ds(DR),i:1,u(g,y,v){const[,w,x]=g[0].replace(vge,"").match(wge);return{alert:w,children:y(x,v)}},l(g,y,v){const w={key:v.key};return g.alert&&(w.className="markdown-alert-"+n(g.alert.toLowerCase(),Qu),g.children.unshift({attrs:{},children:[{type:"27",text:g.alert}],noInnerParse:!0,type:"11",tag:"header"})),l("blockquote",w,y(g.children,v))}},1:{t:["  "],o:cg(xge),i:1,u:X0,l:(g,y,v)=>l("br",{key:v.key})},2:{t:["--","__","**","- ","* ","_ "],o:ds(Ege),i:1,u:X0,l:(g,y,v)=>l("hr",{key:v.key})},3:{t:["    "],o:ds(jR),i:0,u:g=>({lang:void 0,text:Ai($d(g[0].replace(/^ {4}/gm,"")))}),l:(g,y,v)=>l("pre",{key:v.key},l("code",ma({},g.attrs,{className:g.lang?"lang-"+g.lang:""}),g.text))},4:{t:["```","~~~"],o:ds(NR),i:0,u:g=>({attrs:u("code",g[3]||""),lang:g[2]||void 0,text:g[4],type:"3"})},5:{t:["`"],o:io(Sge),i:3,u:g=>({text:Ai(g[2])}),l:(g,y,v)=>l("code",{key:v.key},g.text)},6:{t:["[^"],o:ds(Tge),i:0,u:g=>(d.push({footnote:g[2],identifier:g[1]}),{}),l:Z0},7:{t:["[^"],o:la(Pge),i:1,u:g=>({target:"#"+n(g[1],Qu),text:g[1]}),l:(g,y,v)=>l("a",{key:v.key,href:r(g.target,"a","href")},l("sup",{key:v.key},g.text))},8:{t:["[ ]","[x]"],o:la(Age),i:1,u:g=>({completed:g[1].toLowerCase()==="x"}),l:(g,y,v)=>l("input",{checked:g.completed,key:v.key,readOnly:!0,type:"checkbox"})},9:{t:["#"],o:ds(e.enforceAtxHeadings?UR:zR),i:1,u:(g,y,v)=>({children:Kg(y,g[2],v),id:n(g[2],Qu),level:g[1].length}),l:(g,y,v)=>l("h"+g.level,{id:g.id,key:v.key},y(g.children,v))},10:{t:g=>{const y=g.indexOf(`
`);return y>0&&y<g.length-1&&(g[y+1]==="="||g[y+1]==="-")},o:ds(GR),i:1,u:(g,y,v)=>({children:Kg(y,g[1],v),level:g[2]==="="?1:2,type:"9"})},11:{t:["<"],o:cg(H0),i:1,u(g,y,v){const[,w]=g[3].match(npe),x=RegExp("^"+w,"gm"),S=g[3].replace(x,""),C=a(o,S)?mpe:Kg,T=g[1].toLowerCase(),P=pge.indexOf(T)!==-1,F=(P?T:g[1]).trim(),k={attrs:u(F,g[2]),noInnerParse:P,tag:F};if(v.inAnchor=v.inAnchor||T==="a",P)k.text=g[3];else{const A=v.inHTML;v.inHTML=!0,k.children=C(y,S,v),v.inHTML=A}return v.inAnchor=!1,k},l:(g,y,v)=>l(g.tag,ma({key:v.key},g.attrs),g.text||(g.children?y(g.children,v):""))},13:{t:["<"],o:cg(K0),i:1,u(g){const y=g[1].trim();return{attrs:u(y,g[2]||""),tag:y}},l:(g,y,v)=>l(g.tag,ma({},g.attrs,{key:v.key}))},12:{t:["<!--"],o:cg(BR),i:1,u:()=>({}),l:Z0},14:{t:["!["],o:io(cpe),i:1,u:g=>({alt:Ai(g[1]),target:Ai(g[2]),title:Ai(g[3])}),l:(g,y,v)=>l("img",{key:v.key,alt:g.alt||void 0,title:g.title||void 0,src:r(g.target,"img","src")})},15:{t:["["],o:la(lpe),i:3,u:(g,y,v)=>({children:ppe(y,g[1],v),target:Ai(g[2]),title:Ai(g[3])}),l:(g,y,v)=>l("a",{key:v.key,href:r(g.target,"a","href"),title:g.title},y(g.children,v))},16:{t:["<"],o:la(kge),i:0,u(g){let y=g[1],v=!1;return y.indexOf("@")!==-1&&y.indexOf("//")===-1&&(v=!0,y=y.replace("mailto:","")),{children:[{text:y,type:"27"}],target:v?"mailto:"+y:y,type:"15"}}},17:{t:(g,y)=>!y.inAnchor&&!e.disableAutoLink&&(Hg(g,"http://")||Hg(g,"https://")),o:la(Lge),i:0,u:g=>({children:[{text:g[1],type:"27"}],target:g[1],title:void 0,type:"15"})},20:WR(l,1),33:WR(l,2),19:{t:[`
`],o:ds(bge),i:3,u:X0,l:()=>`
`},21:{o:Xc(function(g,y){if(y.inline||y.simple||y.inHTML&&g.indexOf(`

`)===-1&&y.prevCapture.indexOf(`

`)===-1)return null;let v="",w=0;for(;;){const S=g.indexOf(`
`,w),C=g.slice(w,S===-1?void 0:S+1);if(a(s,C)||(v+=C,S===-1||!C.trim()))break;w=S+1}const x=$d(v);return x===""?null:[v,,x]}),i:3,u:Y0,l:(g,y,v)=>l("p",{key:v.key},y(g.children,v))},22:{t:["["],o:la(Nge),i:0,u:g=>(h[g[1]]={target:g[2],title:g[4]},{}),l:Z0},23:{t:["!["],o:io(jge),i:0,u:g=>({alt:g[1]?Ai(g[1]):void 0,ref:g[2]}),l:(g,y,v)=>h[g.ref]?l("img",{key:v.key,alt:g.alt,src:r(h[g.ref].target,"img","src"),title:h[g.ref].title}):null},24:{t:g=>g[0]==="["&&g.indexOf("](")===-1,o:la(zge),i:0,u:(g,y,v)=>({children:y(g[1],v),fallbackChildren:g[0],ref:g[2]}),l:(g,y,v)=>h[g.ref]?l("a",{key:v.key,href:r(h[g.ref].target,"a","href"),title:h[g.ref].title},y(g.children,v)):l("span",{key:v.key},g.fallbackChildren)},25:{t:["|"],o:ds(VR),i:1,u:hpe,l(g,y,v){const w=g;return l("table",{key:v.key},l("thead",null,l("tr",null,w.header.map(function(x,S){return l("th",{key:S,style:YR(w,S)},y(x,v))}))),l("tbody",null,w.cells.map(function(x,S){return l("tr",{key:S},x.map(function(C,T){return l("td",{key:T,style:YR(w,T)},y(C,v))}))})))}},27:{o:Xc(function(g,y){let v;return Hg(g,":")&&(v=qge.exec(g)),v||epe.exec(g)}),i:4,u(g){const y=g[0];return{text:y.indexOf("&")===-1?y:y.replace(Fge,(v,w)=>e.namedCodesToUnicode[w]||v)}},l:g=>g.text},28:{t:["**","__"],o:io(Kge),i:2,u:(g,y,v)=>({children:y(g[2],v)}),l:(g,y,v)=>l("strong",{key:v.key},y(g.children,v))},29:{t:g=>{const y=g[0];return(y==="*"||y==="_")&&g[1]!==y},o:io(Yge),i:3,u:(g,y,v)=>({children:y(g[2],v)}),l:(g,y,v)=>l("em",{key:v.key},y(g.children,v))},30:{t:["\\"],o:io(Jge),i:1,u:g=>({text:g[1],type:"27"})},31:{t:["=="],o:io(Xge),i:3,u:Y0,l:(g,y,v)=>l("mark",{key:v.key},y(g.children,v))},32:{t:["~~"],o:io(Zge),i:3,u:Y0,l:(g,y,v)=>l("del",{key:v.key},y(g.children,v))}};e.disableParsingRawHTML===!0&&(delete f[11],delete f[13]);const p=function(g){var y=Object.keys(g);function v(w,x){var S=[];if(x.prevCapture=x.prevCapture||"",w.trim())for(;w;)for(var C=0;C<y.length;){var T=y[C],P=g[T];if(!P.t||upe(w,x,P.t)){var F=P.o(w,x);if(F&&F[0]){w=w.substring(F[0].length);var k=P.u(F,v,x);x.prevCapture+=F[0],k.type||(k.type=T),S.push(k);break}C++}else C++}return x.prevCapture="",S}return y.sort(function(w,x){return g[w].i-g[x].i||(w<x?-1:1)}),function(w,x){return v(function(S){return S.replace(Cge,`
`).replace(Rge,"").replace(Gge,"    ")}(w),x)}}(f),m=function(g,y){return function v(w,x={}){if(Array.isArray(w)){const S=x.key,C=[];let T=!1;for(let P=0;P<w.length;P++){x.key=P;const F=v(w[P],x),k=HR(F);k&&T?C[C.length-1]+=F:F!==null&&C.push(F),T=k}return x.key=S,C}return function(S,C,T){const P=g[S.type].l;return y?y(()=>P(S,C,T),S,C,T):P(S,C,T)}(w,v,x)}}(f,e.renderRule),_=c(t);return d.length?l("div",null,_,l("footer",{key:"footer"},d.map(function(g){return l("div",{id:n(g.identifier,Qu),key:g.identifier},g.identifier,m(p(g.footnote,{inline:!0})))}))):_}const o_=t=>{let{children:e,options:n}=t,r=function(i,s){if(i==null)return{};var o,a,l={},c=Object.keys(i);for(a=0;a<c.length;a++)s.indexOf(o=c[a])>=0||(l[o]=i[o]);return l}(t,gge);return K.cloneElement(_pe(e??"",n),r)};function vpe(t,e){return t==null?!0:ak(t,e)}class wpe extends K.Component{constructor(){super(...arguments);q(this,"state",{wasPropertyKeyModified:!1,additionalProperties:{}});q(this,"onPropertyChange",(n,r=!1)=>(i,s,o)=>{const{formData:a,onChange:l,errorSchema:c}=this.props;i===void 0&&r&&(i="");const u={...a,[n]:i};l(u,c&&c&&{...c,[n]:s},o)});q(this,"onDropPropertyClick",n=>r=>{r.preventDefault();const{onChange:i,formData:s}=this.props,o={...s};vpe(o,n),i(o)});q(this,"getAvailableKey",(n,r)=>{const{uiSchema:i,registry:s}=this.props,{duplicateKeySuffixSeparator:o="-"}=Ke(i,s.globalUiOptions);let a=0,l=n;for(;Un(r,l);)l=`${n}${o}${++a}`;return l});q(this,"onKeyChange",n=>(r,i)=>{if(n===r)return;const{formData:s,onChange:o,errorSchema:a}=this.props;r=this.getAvailableKey(r,s);const l={...s},c={[n]:r},u=Object.keys(l).map(h=>({[c[h]||h]:l[h]})),d=Object.assign({},...u);this.setState({wasPropertyKeyModified:!0}),o(d,a&&a&&{...a,[r]:i})});q(this,"handleAddClick",n=>()=>{if(!n.additionalProperties)return;const{formData:r,onChange:i,registry:s}=this.props,o={...r};let a,l,c;if(mt(n.additionalProperties)){a=n.additionalProperties.type,l=n.additionalProperties.const,c=n.additionalProperties.default;let h=n.additionalProperties;if(nn in h){const{schemaUtils:f}=s;h=f.retrieveSchema({$ref:h[nn]},r),a=h.type,l=h.const,c=h.default}!a&&(pi in h||yr in h)&&(a="object")}const u=this.getAvailableKey("newKey",o),d=l??c??this.getDefaultValue(a);vn(o,u,d),i(o)})}isRequired(n){const{schema:r}=this.props;return Array.isArray(r.required)&&r.required.indexOf(n)!==-1}getDefaultValue(n){const{registry:{translateString:r}}=this.props;switch(n){case"array":return[];case"boolean":return!1;case"null":return null;case"number":return 0;case"object":return{};case"string":default:return r(lt.NewStringDefault)}}render(){const{schema:n,uiSchema:r={},formData:i,errorSchema:s,idSchema:o,name:a,required:l=!1,disabled:c,readonly:u,hideError:d,idPrefix:h,idSeparator:f,onBlur:p,onFocus:m,registry:_,title:g}=this.props,{fields:y,formContext:v,schemaUtils:w,translateString:x,globalUiOptions:S}=_,{SchemaField:C}=y,T=w.retrieveSchema(n,i),P=Ke(r,S),{properties:F={}}=T,k=P.title??T.title??g??a,A=P.description??T.description;let M;try{const V=Object.keys(F);M=Yfe(V,P.order)}catch(V){return E.jsxs("div",{children:[E.jsx("p",{className:"config-error",style:{color:"red"},children:E.jsx(o_,{options:{disableParsingRawHTML:!0},children:x(lt.InvalidObjectField,[a||"root",V.message])})}),E.jsx("pre",{children:JSON.stringify(T)})]})}const b=rt("ObjectFieldTemplate",_,P),j={title:P.label===!1?"":k,description:P.label===!1?void 0:A,properties:M.map(V=>{const H=Un(T,[jt,V,Wh]),U=H?r.additionalProperties:r[V],B=Ke(U).widget==="hidden",N=we(o,[V],{});return{content:E.jsx(C,{name:V,required:this.isRequired(V),schema:we(T,[jt,V],{}),uiSchema:U,errorSchema:we(s,V),idSchema:N,idPrefix:h,idSeparator:f,formData:we(i,V),formContext:v,wasPropertyKeyModified:this.state.wasPropertyKeyModified,onKeyChange:this.onKeyChange(V),onChange:this.onPropertyChange(V,H),onBlur:p,onFocus:m,registry:_,disabled:c,readonly:u,hideError:d,onDropPropertyClick:this.onDropPropertyClick},V),name:V,readonly:u,disabled:c,required:l,hidden:B}}),readonly:u,disabled:c,required:l,idSchema:o,uiSchema:r,errorSchema:s,schema:T,formData:i,formContext:v,registry:_};return E.jsx(b,{...j,onAddClick:this.handleAddClick})}}const xpe={array:"ArrayField",boolean:"BooleanField",integer:"NumberField",number:"NumberField",object:"ObjectField",string:"StringField",null:"NullField"};function Epe(t,e,n,r){const i=e.field,{fields:s,translateString:o}=r;if(typeof i=="function")return i;if(typeof i=="string"&&i in s)return s[i];const a=js(t),l=Array.isArray(a)?a[0]:a||"",c=t.$id;let u=xpe[l];return c&&c in s&&(u=c),!u&&(t.anyOf||t.oneOf)?()=>null:u in s?s[u]:()=>{const d=rt("UnsupportedFieldTemplate",r,e);return E.jsx(d,{schema:t,idSchema:n,reason:o(lt.UnknownFieldType,[String(t.type)]),registry:r})}}function Spe(t){const{schema:e,idSchema:n,uiSchema:r,formData:i,errorSchema:s,idPrefix:o,idSeparator:a,name:l,onChange:c,onKeyChange:u,onDropPropertyClick:d,required:h,registry:f,wasPropertyKeyModified:p=!1}=t,{formContext:m,schemaUtils:_,globalUiOptions:g}=f,y=Ke(r,g),v=rt("FieldTemplate",f,y),w=rt("DescriptionFieldTemplate",f,y),x=rt("FieldHelpTemplate",f,y),S=rt("FieldErrorTemplate",f,y),C=_.retrieveSchema(e,i),T=n[bo],P=bs(_.toIdSchema(C,T,i,o,a),n),F=K.useCallback((Q,J,z)=>c(Q,J,z||T),[T,c]),k=Epe(C,y,P,f),A=!!(y.disabled??t.disabled),M=!!(y.readonly??(t.readonly||t.schema.readOnly||C.readOnly)),b=y.hideError,j=b===void 0?t.hideError:!!b,V=!!(y.autofocus??t.autofocus);if(Object.keys(C).length===0)return null;const H=_.getDisplayLabel(C,r,g),{__errors:U,...B}=s||{},N=lm(r,["ui:classNames","classNames","ui:style"]);Id in N&&(N[Id]=lm(N[Id],["classNames","style"]));const O=E.jsx(k,{...t,onChange:F,idSchema:P,schema:C,uiSchema:N,disabled:A,readonly:M,hideError:j,autofocus:V,errorSchema:B,formContext:m,rawErrors:U}),$=P[bo];let G;p?G=l:G=Wh in C?l:y.title||t.schema.title||C.title||t.title||l;const R=y.description||t.schema.description||C.description||"",L=y.enableMarkdownInDescription?E.jsx(o_,{options:{disableParsingRawHTML:!0},children:R}):R,W=y.help,te=y.widget==="hidden",ee=["form-group","field",`field-${js(C)}`];!j&&U&&U.length>0&&ee.push("field-error has-error has-danger"),r!=null&&r.classNames&&ee.push(r.classNames),y.classNames&&ee.push(y.classNames);const ce=E.jsx(x,{help:W,idSchema:P,schema:C,uiSchema:r,hasErrors:!j&&U&&U.length>0,registry:f}),ge=j||(C.anyOf||C.oneOf)&&!_.isSelect(C)?void 0:E.jsx(S,{errors:U,errorSchema:s,idSchema:P,schema:C,uiSchema:r,registry:f}),Ce={description:E.jsx(w,{id:rf($),description:L,schema:C,uiSchema:r,registry:f}),rawDescription:R,help:ce,rawHelp:typeof W=="string"?W:void 0,errors:ge,rawErrors:j?void 0:U,id:$,label:G,hidden:te,onChange:c,onKeyChange:u,onDropPropertyClick:d,required:h,disabled:A,readonly:M,hideError:j,displayLabel:H,classNames:ee.join(" ").trim(),style:y.style,formContext:m,formData:i,schema:C,uiSchema:r,registry:f},_t=f.fields.AnyOfField,vt=f.fields.OneOfField,I=(r==null?void 0:r["ui:field"])&&(r==null?void 0:r["ui:fieldReplacesAnyOrOneOf"])===!0;return E.jsx(v,{...Ce,children:E.jsxs(E.Fragment,{children:[O,C.anyOf&&!I&&!_.isSelect(C)&&E.jsx(_t,{name:l,disabled:A,readonly:M,hideError:j,errorSchema:s,formData:i,formContext:m,idPrefix:o,idSchema:P,idSeparator:a,onBlur:t.onBlur,onChange:t.onChange,onFocus:t.onFocus,options:C.anyOf.map(Q=>_.retrieveSchema(mt(Q)?Q:{},i)),registry:f,required:h,schema:C,uiSchema:r}),C.oneOf&&!I&&!_.isSelect(C)&&E.jsx(vt,{name:l,disabled:A,readonly:M,hideError:j,errorSchema:s,formData:i,formContext:m,idPrefix:o,idSchema:P,idSeparator:a,onBlur:t.onBlur,onChange:t.onChange,onFocus:t.onFocus,options:C.oneOf.map(Q=>_.retrieveSchema(mt(Q)?Q:{},i)),registry:f,required:h,schema:C,uiSchema:r})]})})}class bpe extends K.Component{shouldComponentUpdate(e){return!St(this.props,e)}render(){return E.jsx(Spe,{...this.props})}}function Cpe(t){const{schema:e,name:n,uiSchema:r,idSchema:i,formData:s,required:o,disabled:a=!1,readonly:l=!1,autofocus:c=!1,onChange:u,onBlur:d,onFocus:h,registry:f,rawErrors:p,hideError:m}=t,{title:_,format:g}=e,{widgets:y,formContext:v,schemaUtils:w,globalUiOptions:x}=f,S=w.isSelect(e)?Sh(e,r):void 0;let C=S?"select":"text";g&&Wfe(e,g,y)&&(C=g);const{widget:T=C,placeholder:P="",title:F,...k}=Ke(r),A=w.getDisplayLabel(e,r,x),M=F??_??n,b=As(e,T,y);return E.jsx(b,{options:{...k,enumOptions:S},schema:e,uiSchema:r,id:i.$id,name:n,label:M,hideLabel:!A,hideError:m,value:s,onChange:u,onBlur:d,onFocus:h,required:o,disabled:a,readonly:l,formContext:v,autofocus:c,registry:f,placeholder:P,rawErrors:p})}function Tpe(t){const{formData:e,onChange:n}=t;return K.useEffect(()=>{e===void 0&&n(null)},[e,n]),null}function Ppe(){return{AnyOfField:LR,ArrayField:cge,BooleanField:uge,NumberField:fge,ObjectField:wpe,OneOfField:LR,SchemaField:bpe,StringField:Cpe,NullField:Tpe}}function Rpe(t){const{idSchema:e,description:n,registry:r,schema:i,uiSchema:s}=t,o=Ke(s,r.globalUiOptions),{label:a=!0}=o;if(!n||!a)return null;const l=rt("DescriptionFieldTemplate",r,o);return E.jsx(l,{id:rf(e),description:n,schema:i,uiSchema:s,registry:r})}function Ipe(t){const{children:e,className:n,disabled:r,hasToolbar:i,hasMoveDown:s,hasMoveUp:o,hasRemove:a,hasCopy:l,index:c,onCopyIndexClick:u,onDropIndexClick:d,onReorderClick:h,readonly:f,registry:p,uiSchema:m}=t,{CopyButton:_,MoveDownButton:g,MoveUpButton:y,RemoveButton:v}=p.templates.ButtonTemplates,w={flex:1,paddingLeft:6,paddingRight:6,fontWeight:"bold"};return E.jsxs("div",{className:n,children:[E.jsx("div",{className:i?"col-xs-9":"col-xs-12",children:e}),i&&E.jsx("div",{className:"col-xs-3 array-item-toolbox",children:E.jsxs("div",{className:"btn-group",style:{display:"flex",justifyContent:"space-around"},children:[(o||s)&&E.jsx(y,{style:w,disabled:r||f||!o,onClick:h(c,c-1),uiSchema:m,registry:p}),(o||s)&&E.jsx(g,{style:w,disabled:r||f||!s,onClick:h(c,c+1),uiSchema:m,registry:p}),l&&E.jsx(_,{style:w,disabled:r||f,onClick:u(c),uiSchema:m,registry:p}),a&&E.jsx(v,{style:w,disabled:r||f,onClick:d(c),uiSchema:m,registry:p})]})})]})}function Ape(t){const{canAdd:e,className:n,disabled:r,idSchema:i,uiSchema:s,items:o,onAddClick:a,readonly:l,registry:c,required:u,schema:d,title:h}=t,f=Ke(s),p=rt("ArrayFieldDescriptionTemplate",c,f),m=rt("ArrayFieldItemTemplate",c,f),_=rt("ArrayFieldTitleTemplate",c,f),{ButtonTemplates:{AddButton:g}}=c.templates;return E.jsxs("fieldset",{className:n,id:i.$id,children:[E.jsx(_,{idSchema:i,title:f.title||h,required:u,schema:d,uiSchema:s,registry:c}),E.jsx(p,{idSchema:i,description:f.description||d.description,schema:d,uiSchema:s,registry:c}),E.jsx("div",{className:"row array-item-list",children:o&&o.map(({key:y,...v})=>E.jsx(m,{...v},y))}),e&&E.jsx(g,{className:"array-item-add",onClick:a,disabled:r||l,uiSchema:s,registry:c})]})}function Fpe(t){const{idSchema:e,title:n,schema:r,uiSchema:i,required:s,registry:o}=t,a=Ke(i,o.globalUiOptions),{label:l=!0}=a;if(!n||!l)return null;const c=rt("TitleFieldTemplate",o,a);return E.jsx(c,{id:rD(e),title:n,required:s,schema:r,uiSchema:i,registry:o})}function Ope(t){const{id:e,name:n,value:r,readonly:i,disabled:s,autofocus:o,onBlur:a,onFocus:l,onChange:c,onChangeOverride:u,options:d,schema:h,uiSchema:f,formContext:p,registry:m,rawErrors:_,type:g,hideLabel:y,hideError:v,...w}=t;if(!e)throw console.log("No id for",t),new Error(`no id for props ${JSON.stringify(t)}`);const x={...w,...Dfe(h,g,d)};let S;x.type==="number"||x.type==="integer"?S=r||r===0?r:"":S=r??"";const C=K.useCallback(({target:{value:F}})=>c(F===""?d.emptyValue:F),[c,d]),T=K.useCallback(({target:F})=>a(e,F&&F.value),[a,e]),P=K.useCallback(({target:F})=>l(e,F&&F.value),[l,e]);return E.jsxs(E.Fragment,{children:[E.jsx("input",{id:e,name:e,className:"form-control",readOnly:i,disabled:s,autoFocus:o,value:S,...x,list:h.examples?rx(e):void 0,onChange:u||C,onBlur:T,onFocus:P,"aria-describedby":ml(e,!!h.examples)}),Array.isArray(h.examples)&&E.jsx("datalist",{id:rx(e),children:h.examples.concat(h.default&&!h.examples.includes(h.default)?[h.default]:[]).map(F=>E.jsx("option",{value:F},F))},`datalist_${e}`)]})}function $pe({uiSchema:t}){const{submitText:e,norender:n,props:r={}}=Nfe(t);return n?null:E.jsx("div",{children:E.jsx("button",{type:"submit",...r,className:`btn btn-info ${r.className||""}`,children:e})})}function sf(t){const{iconType:e="default",icon:n,className:r,uiSchema:i,registry:s,...o}=t;return E.jsx("button",{type:"button",className:`btn btn-${e} ${r}`,...o,children:E.jsx("i",{className:`glyphicon glyphicon-${n}`})})}function Lpe(t){const{registry:{translateString:e}}=t;return E.jsx(sf,{title:e(lt.CopyButton),className:"array-item-copy",...t,icon:"copy"})}function kpe(t){const{registry:{translateString:e}}=t;return E.jsx(sf,{title:e(lt.MoveDownButton),className:"array-item-move-down",...t,icon:"arrow-down"})}function Mpe(t){const{registry:{translateString:e}}=t;return E.jsx(sf,{title:e(lt.MoveUpButton),className:"array-item-move-up",...t,icon:"arrow-up"})}function Dpe(t){const{registry:{translateString:e}}=t;return E.jsx(sf,{title:e(lt.RemoveButton),className:"array-item-remove",...t,iconType:"danger",icon:"remove"})}function Npe({className:t,onClick:e,disabled:n,registry:r}){const{translateString:i}=r;return E.jsx("div",{className:"row",children:E.jsx("p",{className:`col-xs-3 col-xs-offset-9 text-right ${t}`,children:E.jsx(sf,{iconType:"info",icon:"plus",className:"btn-add col-xs-12",title:i(lt.AddButton),onClick:e,disabled:n,registry:r})})})}function jpe(){return{SubmitButton:$pe,AddButton:Npe,CopyButton:Lpe,MoveDownButton:kpe,MoveUpButton:Mpe,RemoveButton:Dpe}}function zpe(t){const{id:e,description:n}=t;return n?typeof n=="string"?E.jsx("p",{id:e,className:"field-description",children:n}):E.jsx("div",{id:e,className:"field-description",children:n}):null}function Upe({errors:t,registry:e}){const{translateString:n}=e;return E.jsxs("div",{className:"panel panel-danger errors",children:[E.jsx("div",{className:"panel-heading",children:E.jsx("h3",{className:"panel-title",children:n(lt.ErrorsLabel)})}),E.jsx("ul",{className:"list-group",children:t.map((r,i)=>E.jsx("li",{className:"list-group-item text-danger",children:r.stack},i))})]})}const Gpe="*";function pD(t){const{label:e,required:n,id:r}=t;return e?E.jsxs("label",{className:"control-label",htmlFor:r,children:[e,n&&E.jsx("span",{className:"required",children:Gpe})]}):null}function Bpe(t){const{id:e,label:n,children:r,errors:i,help:s,description:o,hidden:a,required:l,displayLabel:c,registry:u,uiSchema:d}=t,h=Ke(d),f=rt("WrapIfAdditionalTemplate",u,h);return a?E.jsx("div",{className:"hidden",children:r}):E.jsxs(f,{...t,children:[c&&E.jsx(pD,{label:n,required:l,id:e}),c&&o?o:null,r,i,s]})}function Vpe(t){const{errors:e=[],idSchema:n}=t;if(e.length===0)return null;const r=tD(n);return E.jsx("div",{children:E.jsx("ul",{id:r,className:"error-detail bs-callout bs-callout-info",children:e.filter(i=>!!i).map((i,s)=>E.jsx("li",{className:"text-danger",children:i},s))})})}function Wpe(t){const{idSchema:e,help:n}=t;if(!n)return null;const r=nD(e);return typeof n=="string"?E.jsx("p",{id:r,className:"help-block",children:n}):E.jsx("div",{id:r,className:"help-block",children:n})}function Hpe(t){const{description:e,disabled:n,formData:r,idSchema:i,onAddClick:s,properties:o,readonly:a,registry:l,required:c,schema:u,title:d,uiSchema:h}=t,f=Ke(h),p=rt("TitleFieldTemplate",l,f),m=rt("DescriptionFieldTemplate",l,f),{ButtonTemplates:{AddButton:_}}=l.templates;return E.jsxs("fieldset",{id:i.$id,children:[d&&E.jsx(p,{id:rD(i),title:d,required:c,schema:u,uiSchema:h,registry:l}),e&&E.jsx(m,{id:rf(i),description:e,schema:u,uiSchema:h,registry:l}),o.map(g=>g.content),PH(u,h,r)&&E.jsx(_,{className:"object-property-expand",onClick:s(u),disabled:n||a,uiSchema:h,registry:l})]})}const Kpe="*";function Ype(t){const{id:e,title:n,required:r}=t;return E.jsxs("legend",{id:e,children:[n,r&&E.jsx("span",{className:"required",children:Kpe})]})}function Xpe(t){const{schema:e,idSchema:n,reason:r,registry:i}=t,{translateString:s}=i;let o=lt.UnsupportedField;const a=[];return n&&n.$id&&(o=lt.UnsupportedFieldWithId,a.push(n.$id)),r&&(o=o===lt.UnsupportedField?lt.UnsupportedFieldWithReason:lt.UnsupportedFieldWithIdAndReason,a.push(r)),E.jsxs("div",{className:"unsupported-field",children:[E.jsx("p",{children:E.jsx(o_,{options:{disableParsingRawHTML:!0},children:s(o,a)})}),e&&E.jsx("pre",{children:JSON.stringify(e,null,2)})]})}function Zpe(t){const{id:e,classNames:n,style:r,disabled:i,label:s,onKeyChange:o,onDropPropertyClick:a,readonly:l,required:c,schema:u,children:d,uiSchema:h,registry:f}=t,{templates:p,translateString:m}=f,{RemoveButton:_}=p.ButtonTemplates,g=m(lt.KeyLabel,[s]);return Wh in u?E.jsx("div",{className:n,style:r,children:E.jsxs("div",{className:"row",children:[E.jsx("div",{className:"col-xs-5 form-additional",children:E.jsxs("div",{className:"form-group",children:[E.jsx(pD,{label:g,required:c,id:`${e}-key`}),E.jsx("input",{className:"form-control",type:"text",id:`${e}-key`,onBlur:({target:v})=>o(v&&v.value),defaultValue:s})]})}),E.jsx("div",{className:"form-additional form-group col-xs-5",children:d}),E.jsx("div",{className:"col-xs-2",children:E.jsx(_,{className:"array-item-remove btn-block",style:{border:"0"},disabled:i||l,onClick:a(s),uiSchema:h,registry:f})})]})}):E.jsx("div",{className:n,style:r,children:d})}function qpe(){return{ArrayFieldDescriptionTemplate:Rpe,ArrayFieldItemTemplate:Ipe,ArrayFieldTemplate:Ape,ArrayFieldTitleTemplate:Fpe,ButtonTemplates:jpe(),BaseInputTemplate:Ope,DescriptionFieldTemplate:zpe,ErrorListTemplate:Upe,FieldTemplate:Bpe,FieldErrorTemplate:Vpe,FieldHelpTemplate:Wpe,ObjectFieldTemplate:Hpe,TitleFieldTemplate:Ype,UnsupportedFieldTemplate:Xpe,WrapIfAdditionalTemplate:Zpe}}function Jpe(t){return Object.values(t).every(e=>e!==-1)}function Qpe({type:t,range:e,value:n,select:r,rootId:i,name:s,disabled:o,readonly:a,autofocus:l,registry:c,onBlur:u,onFocus:d}){const h=i+"_"+t,{SelectWidget:f}=c.widgets;return E.jsx(f,{schema:{type:"integer"},id:h,name:s,className:"form-control",options:{enumOptions:qM(e[0],e[1])},placeholder:t,value:n,disabled:o,readonly:a,autofocus:l,onChange:p=>r(t,p),onBlur:u,onFocus:d,registry:c,label:"","aria-describedby":ml(i)})}function eme({time:t=!1,disabled:e=!1,readonly:n=!1,autofocus:r=!1,options:i,id:s,name:o,registry:a,onBlur:l,onFocus:c,onChange:u,value:d}){const{translateString:h}=a,[f,p]=K.useState(d),[m,_]=K.useReducer((w,x)=>({...w,...x}),W0(d,t));K.useEffect(()=>{const w=FR(m,t);Jpe(m)&&w!==d?u(w):f!==d&&(p(d),_(W0(d,t)))},[t,d,u,m,f]);const g=K.useCallback((w,x)=>{_({[w]:x})},[]),y=K.useCallback(w=>{if(w.preventDefault(),e||n)return;const x=W0(new Date().toJSON(),t);u(FR(x,t))},[e,n,t]),v=K.useCallback(w=>{w.preventDefault(),!(e||n)&&u(void 0)},[e,n,u]);return E.jsxs("ul",{className:"list-inline",children:[kfe(m,t,i.yearsRange,i.format).map((w,x)=>E.jsx("li",{className:"list-inline-item",children:E.jsx(Qpe,{rootId:s,name:o,select:g,...w,disabled:e,readonly:n,registry:a,onBlur:l,onFocus:c,autofocus:r&&x===0})},x)),(i.hideNowButton!=="undefined"?!i.hideNowButton:!0)&&E.jsx("li",{className:"list-inline-item",children:E.jsx("a",{href:"#",className:"btn btn-info btn-now",onClick:y,children:h(lt.NowLabel)})}),(i.hideClearButton!=="undefined"?!i.hideClearButton:!0)&&E.jsx("li",{className:"list-inline-item",children:E.jsx("a",{href:"#",className:"btn btn-warning btn-clear",onClick:v,children:h(lt.ClearLabel)})})]})}function tme({time:t=!0,...e}){const{AltDateWidget:n}=e.registry.widgets;return E.jsx(n,{time:t,...e})}function nme({schema:t,uiSchema:e,options:n,id:r,value:i,disabled:s,readonly:o,label:a,hideLabel:l,autofocus:c=!1,onBlur:u,onFocus:d,onChange:h,registry:f}){const p=rt("DescriptionFieldTemplate",f,n),m=Vg(t),_=K.useCallback(w=>h(w.target.checked),[h]),g=K.useCallback(w=>u(r,w.target.checked),[u,r]),y=K.useCallback(w=>d(r,w.target.checked),[d,r]),v=n.description??t.description;return E.jsxs("div",{className:`checkbox ${s||o?"disabled":""}`,children:[!l&&!!v&&E.jsx(p,{id:rf(r),description:v,schema:t,uiSchema:e,registry:f}),E.jsxs("label",{children:[E.jsx("input",{type:"checkbox",id:r,name:r,checked:typeof i>"u"?!1:i,required:m,disabled:s||o,autoFocus:c,onChange:_,onBlur:g,onFocus:y,"aria-describedby":ml(r)}),Hfe(E.jsx("span",{children:a}),l)]})]})}function rme({id:t,disabled:e,options:{inline:n=!1,enumOptions:r,enumDisabled:i,emptyValue:s},value:o,autofocus:a=!1,readonly:l,onChange:c,onBlur:u,onFocus:d}){const h=Array.isArray(o)?o:[o],f=K.useCallback(({target:m})=>u(t,Yi(m&&m.value,r,s)),[u,t]),p=K.useCallback(({target:m})=>d(t,Yi(m&&m.value,r,s)),[d,t]);return E.jsx("div",{className:"checkboxes",id:t,children:Array.isArray(r)&&r.map((m,_)=>{const g=$S(m.value,h),y=Array.isArray(i)&&i.indexOf(m.value)!==-1,v=e||y||l?"disabled":"",w=S=>{S.target.checked?c(Afe(_,h,r)):c(Rfe(_,h,r))},x=E.jsxs("span",{children:[E.jsx("input",{type:"checkbox",id:iD(t,_),name:t,checked:g,value:String(_),disabled:e||y||l,autoFocus:a&&_===0,onChange:w,onBlur:f,onFocus:p,"aria-describedby":ml(t)}),E.jsx("span",{children:m.label})]});return n?E.jsx("label",{className:`checkbox-inline ${v}`,children:x},_):E.jsx("div",{className:`checkbox ${v}`,children:E.jsx("label",{children:x})},_)})})}function ime(t){const{disabled:e,readonly:n,options:r,registry:i}=t,s=rt("BaseInputTemplate",i,r);return E.jsx(s,{type:"color",...t,disabled:e||n})}function sme(t){const{onChange:e,options:n,registry:r}=t,i=rt("BaseInputTemplate",r,n),s=K.useCallback(o=>e(o||void 0),[e]);return E.jsx(i,{type:"date",...t,onChange:s})}function ome(t){const{onChange:e,value:n,options:r,registry:i}=t,s=rt("BaseInputTemplate",i,r);return E.jsx(s,{type:"datetime-local",...t,value:qfe(n),onChange:o=>e(Kfe(o))})}function ame(t){const{options:e,registry:n}=t,r=rt("BaseInputTemplate",n,e);return E.jsx(r,{type:"email",...t})}function lme(t,e){return t===null?null:t.replace(";base64",`;name=${encodeURIComponent(e)};base64`)}function cme(t){const{name:e,size:n,type:r}=t;return new Promise((i,s)=>{const o=new window.FileReader;o.onerror=s,o.onload=a=>{var l;typeof((l=a.target)==null?void 0:l.result)=="string"?i({dataURL:lme(a.target.result,e),name:e,size:n,type:r}):i({dataURL:null,name:e,size:n,type:r})},o.readAsDataURL(t)})}function ume(t){return Promise.all(Array.from(t).map(cme))}function dme({fileInfo:t,registry:e}){const{translateString:n}=e,{dataURL:r,type:i,name:s}=t;return r?["image/jpeg","image/png"].includes(i)?E.jsx("img",{src:r,style:{maxWidth:"100%"},className:"file-preview"}):E.jsxs(E.Fragment,{children:[" ",E.jsx("a",{download:`preview-${s}`,href:r,className:"file-download",children:n(lt.PreviewLabel)})]}):null}function hme({filesInfo:t,registry:e,preview:n,onRemove:r,options:i}){if(t.length===0)return null;const{translateString:s}=e,{RemoveButton:o}=rt("ButtonTemplates",e,i);return E.jsx("ul",{className:"file-info",children:t.map((a,l)=>{const{name:c,size:u,type:d}=a,h=()=>r(l);return E.jsxs("li",{children:[E.jsx(o_,{children:s(lt.FilesInfo,[c,d,String(u)])}),n&&E.jsx(dme,{fileInfo:a,registry:e}),E.jsx(o,{onClick:h,registry:e})]},l)})})}function fme(t){return t.reduce((e,n)=>{if(!n)return e;try{const{blob:r,name:i}=Cfe(n);return[...e,{dataURL:n,name:i,size:r.size,type:r.type}]}catch{return e}},[])}function gme(t){const{disabled:e,readonly:n,required:r,multiple:i,onChange:s,value:o,options:a,registry:l}=t,c=rt("BaseInputTemplate",l,a),u=K.useCallback(f=>{f.target.files&&ume(f.target.files).then(p=>{const m=p.map(_=>_.dataURL);s(i?o.concat(m):m[0])})},[i,o,s]),d=K.useMemo(()=>fme(Array.isArray(o)?o:[o]),[o]),h=K.useCallback(f=>{if(i){const p=o.filter((m,_)=>_!==f);s(p)}else s(void 0)},[i,o,s]);return E.jsxs("div",{children:[E.jsx(c,{...t,disabled:e||n,type:"file",required:o?!1:r,onChangeOverride:u,value:"",accept:a.accept?String(a.accept):void 0}),E.jsx(hme,{filesInfo:d,onRemove:h,registry:l,preview:a.filePreview,options:a})]})}function pme({id:t,value:e}){return E.jsx("input",{type:"hidden",id:t,name:t,value:typeof e>"u"?"":e})}function mme(t){const{options:e,registry:n}=t,r=rt("BaseInputTemplate",n,e);return E.jsx(r,{type:"password",...t})}function yme({options:t,value:e,required:n,disabled:r,readonly:i,autofocus:s=!1,onBlur:o,onFocus:a,onChange:l,id:c}){const{enumOptions:u,enumDisabled:d,inline:h,emptyValue:f}=t,p=K.useCallback(({target:_})=>o(c,Yi(_&&_.value,u,f)),[o,c]),m=K.useCallback(({target:_})=>a(c,Yi(_&&_.value,u,f)),[a,c]);return E.jsx("div",{className:"field-radio-group",id:c,children:Array.isArray(u)&&u.map((_,g)=>{const y=$S(_.value,e),v=Array.isArray(d)&&d.indexOf(_.value)!==-1,w=r||v||i?"disabled":"",x=()=>l(_.value),S=E.jsxs("span",{children:[E.jsx("input",{type:"radio",id:iD(c,g),checked:y,name:c,required:n,value:String(g),disabled:r||v||i,autoFocus:s&&g===0,onChange:x,onBlur:p,onFocus:m,"aria-describedby":ml(c)}),E.jsx("span",{children:_.label})]});return h?E.jsx("label",{className:`radio-inline ${w}`,children:S},g):E.jsx("div",{className:`radio ${w}`,children:E.jsx("label",{children:S})},g)})})}function _me(t){const{value:e,registry:{templates:{BaseInputTemplate:n}}}=t;return E.jsxs("div",{className:"field-range-wrapper",children:[E.jsx(n,{type:"range",...t}),E.jsx("span",{className:"range-view",children:e})]})}function J0(t,e){return e?Array.from(t.target.options).slice().filter(n=>n.selected).map(n=>n.value):t.target.value}function vme({schema:t,id:e,options:n,value:r,required:i,disabled:s,readonly:o,multiple:a=!1,autofocus:l=!1,onChange:c,onBlur:u,onFocus:d,placeholder:h}){const{enumOptions:f,enumDisabled:p,emptyValue:m}=n,_=a?[]:"",g=K.useCallback(S=>{const C=J0(S,a);return d(e,Yi(C,f,m))},[d,e,t,a,f,m]),y=K.useCallback(S=>{const C=J0(S,a);return u(e,Yi(C,f,m))},[u,e,t,a,f,m]),v=K.useCallback(S=>{const C=J0(S,a);return c(Yi(C,f,m))},[c,t,a,f,m]),w=Ife(r,f,a),x=!a&&t.default===void 0;return E.jsxs("select",{id:e,name:e,multiple:a,className:"form-control",value:typeof w>"u"?_:w,required:i,disabled:s||o,autoFocus:l,onBlur:y,onFocus:g,onChange:v,"aria-describedby":ml(e),children:[x&&E.jsx("option",{value:"",children:h}),Array.isArray(f)&&f.map(({value:S,label:C},T)=>{const P=p&&p.indexOf(S)!==-1;return E.jsx("option",{value:String(T),disabled:P,children:C},T)})]})}function mD({id:t,options:e={},placeholder:n,value:r,required:i,disabled:s,readonly:o,autofocus:a=!1,onChange:l,onBlur:c,onFocus:u}){const d=K.useCallback(({target:{value:p}})=>l(p===""?e.emptyValue:p),[l,e.emptyValue]),h=K.useCallback(({target:p})=>c(t,p&&p.value),[c,t]),f=K.useCallback(({target:p})=>u(t,p&&p.value),[t,u]);return E.jsx("textarea",{id:t,name:t,className:"form-control",value:r||"",placeholder:n,required:i,disabled:s,readOnly:o,autoFocus:a,rows:e.rows,onBlur:h,onFocus:f,onChange:d,"aria-describedby":ml(t)})}mD.defaultProps={autofocus:!1,options:{}};function wme(t){const{options:e,registry:n}=t,r=rt("BaseInputTemplate",n,e);return E.jsx(r,{...t})}function xme(t){const{onChange:e,options:n,registry:r}=t,i=rt("BaseInputTemplate",r,n),s=K.useCallback(o=>e(o?`${o}:00`:void 0),[e]);return E.jsx(i,{type:"time",...t,onChange:s})}function Eme(t){const{options:e,registry:n}=t,r=rt("BaseInputTemplate",n,e);return E.jsx(r,{type:"url",...t})}function Sme(t){const{options:e,registry:n}=t,r=rt("BaseInputTemplate",n,e);return E.jsx(r,{type:"number",...t})}function bme(){return{AltDateWidget:eme,AltDateTimeWidget:tme,CheckboxWidget:nme,CheckboxesWidget:rme,ColorWidget:ime,DateWidget:sme,DateTimeWidget:ome,EmailWidget:ame,FileWidget:gme,HiddenWidget:pme,PasswordWidget:mme,RadioWidget:yme,RangeWidget:_me,SelectWidget:vme,TextWidget:wme,TextareaWidget:mD,TimeWidget:xme,UpDownWidget:Sme,URLWidget:Eme}}function Cme(){return{fields:Ppe(),templates:qpe(),widgets:bme(),rootSchema:{},formContext:{},translateString:Pfe}}class Tme extends K.Component{constructor(n){super(n);q(this,"formElement");q(this,"getUsedFormData",(n,r)=>{if(r.length===0&&typeof n!="object")return n;const i=OR(n,r);return Array.isArray(n)?Object.keys(i).map(s=>i[s]):i});q(this,"getFieldNames",(n,r)=>{const i=(s,o=[],a=[[]])=>(Object.keys(s).forEach(l=>{if(typeof s[l]=="object"){const c=a.map(u=>[...u,l]);s[l][IE]&&s[l][zg]!==""?o.push(s[l][zg]):i(s[l],o,c)}else l===zg&&s[l]!==""&&a.forEach(c=>{const u=we(r,c);(typeof u!="object"||Vc(u)||Array.isArray(u)&&u.every(d=>typeof d!="object"))&&o.push(c)})}),o);return i(n)});q(this,"omitExtraData",n=>{const{schema:r,schemaUtils:i}=this.state,s=i.retrieveSchema(r,n),o=i.toPathSchema(s,"",n),a=this.getFieldNames(o,n);return this.getUsedFormData(n,a)});q(this,"onChange",(n,r,i)=>{const{extraErrors:s,omitExtraData:o,liveOmit:a,noValidate:l,liveValidate:c,onChange:u}=this.props,{schemaUtils:d,schema:h}=this.state;let f=this.state.retrievedSchema;if(Ye(n)||Array.isArray(n)){const g=this.getStateFromProps(this.props,n);n=g.formData,f=g.retrievedSchema}const p=!l&&c;let m={formData:n,schema:h},_=n;if(o===!0&&a===!0&&(_=this.omitExtraData(n),m={formData:_}),p){const g=this.validate(_,h,d,f);let y=g.errors,v=g.errorSchema;const w=y,x=v;if(s){const S=Wg(g,s);v=S.errorSchema,y=S.errors}if(r){const S=this.filterErrorsBasedOnSchema(r,f,_);v=bs(v,S,"preventDuplicates")}m={formData:_,errors:y,errorSchema:v,schemaValidationErrors:w,schemaValidationErrorSchema:x}}else if(!l&&r){const g=s?bs(r,s,"preventDuplicates"):r;m={formData:_,errorSchema:g,errors:bh(g)}}this.setState(m,()=>u&&u({...this.state,...m},i))});q(this,"reset",()=>{const{onChange:n}=this.props,s={formData:this.getStateFromProps(this.props,void 0).formData,errorSchema:{},errors:[],schemaValidationErrors:[],schemaValidationErrorSchema:{}};this.setState(s,()=>n&&n({...this.state,...s}))});q(this,"onBlur",(n,r)=>{const{onBlur:i}=this.props;i&&i(n,r)});q(this,"onFocus",(n,r)=>{const{onFocus:i}=this.props;i&&i(n,r)});q(this,"onSubmit",n=>{if(n.preventDefault(),n.target!==n.currentTarget)return;n.persist();const{omitExtraData:r,extraErrors:i,noValidate:s,onSubmit:o}=this.props;let{formData:a}=this.state;if(r===!0&&(a=this.omitExtraData(a)),s||this.validateFormWithFormData(a)){const l=i||{},c=i?bh(i):[];this.setState({formData:a,errors:c,errorSchema:l,schemaValidationErrors:[],schemaValidationErrorSchema:{}},()=>{o&&o({...this.state,formData:a,status:"submitted"},n)})}});q(this,"submit",()=>{if(this.formElement.current){const n=new CustomEvent("submit",{cancelable:!0});n.preventDefault(),this.formElement.current.dispatchEvent(n),this.formElement.current.requestSubmit()}});q(this,"validateFormWithFormData",n=>{const{extraErrors:r,extraErrorsBlockSubmit:i,focusOnFirstError:s,onError:o}=this.props,{errors:a}=this.state,l=this.validate(n);let c=l.errors,u=l.errorSchema;const d=c,h=u,f=c.length>0||r&&i;if(f){if(r){const p=Wg(l,r);u=p.errorSchema,c=p.errors}s&&(typeof s=="function"?s(c[0]):this.focusOnError(c[0])),this.setState({errors:c,errorSchema:u,schemaValidationErrors:d,schemaValidationErrorSchema:h},()=>{o?o(c):console.error("Form validation failed",c)})}else a.length>0&&this.setState({errors:[],errorSchema:{},schemaValidationErrors:[],schemaValidationErrorSchema:{}});return!f});if(!n.validator)throw new Error("A validator is required for Form functionality to work");this.state=this.getStateFromProps(n,n.formData),this.props.onChange&&!St(this.state.formData,this.props.formData)&&this.props.onChange(this.state),this.formElement=K.createRef()}getSnapshotBeforeUpdate(n,r){if(!St(this.props,n)){const i=ige(this.props.formData,n.formData),s=!St(n.schema,this.props.schema),o=i.length>0||!St(n.formData,this.props.formData),a=this.getStateFromProps(this.props,this.props.formData,s||o?void 0:this.state.retrievedSchema,s,i),l=!St(a,r);return{nextState:a,shouldUpdate:l}}return{shouldUpdate:!1}}componentDidUpdate(n,r,i){if(i.shouldUpdate){const{nextState:s}=i;!St(s.formData,this.props.formData)&&!St(s.formData,r.formData)&&this.props.onChange&&this.props.onChange(s),this.setState(s)}}getStateFromProps(n,r,i,s=!1,o=[]){var F;const a=this.state||{},l="schema"in n?n.schema:this.props.schema,c=("uiSchema"in n?n.uiSchema:this.props.uiSchema)||{},u=typeof r<"u",d="liveValidate"in n?n.liveValidate:this.props.liveValidate,h=u&&!n.noValidate&&d,f=l,p="experimental_defaultFormStateBehavior"in n?n.experimental_defaultFormStateBehavior:this.props.experimental_defaultFormStateBehavior,m="experimental_customMergeAllOf"in n?n.experimental_customMergeAllOf:this.props.experimental_customMergeAllOf;let _=a.schemaUtils;(!_||_.doesSchemaUtilsDiffer(n.validator,f,p,m))&&(_=bfe(n.validator,f,p,m));const g=_.getDefaultFormState(l,r),y=this.updateRetrievedSchema(i??_.retrieveSchema(l,g)),v=()=>n.noValidate||s?{errors:[],errorSchema:{}}:n.liveValidate?{errors:a.errors||[],errorSchema:a.errorSchema||{}}:{errors:a.schemaValidationErrors||[],errorSchema:a.schemaValidationErrorSchema||{}};let w,x,S=a.schemaValidationErrors,C=a.schemaValidationErrorSchema;if(h){const k=this.validate(g,l,_,y);w=k.errors,i===void 0?x=k.errorSchema:x=bs((F=this.state)==null?void 0:F.errorSchema,k.errorSchema,"preventDuplicates"),S=w,C=x}else{const k=v();if(w=k.errors,x=k.errorSchema,o.length>0){const A=o.reduce((M,b)=>(M[b]=void 0,M),{});x=C=bs(k.errorSchema,A,"preventDuplicates")}}if(n.extraErrors){const k=Wg({errorSchema:x,errors:w},n.extraErrors);x=k.errorSchema,w=k.errors}const T=_.toIdSchema(y,c["ui:rootFieldId"],g,n.idPrefix,n.idSeparator);return{schemaUtils:_,schema:l,uiSchema:c,idSchema:T,formData:g,edit:u,errors:w,errorSchema:x,schemaValidationErrors:S,schemaValidationErrorSchema:C,retrievedSchema:y}}shouldComponentUpdate(n,r){return Xfe(this,n,r)}getPreviousCustomValidateErrors(){const{customValidate:n,uiSchema:r}=this.props,i=this.state.formData;let s={};if(typeof n=="function"){const o=n(i,sm(i),r);s=MS(o)}return s}validate(n,r=this.props.schema,i,s){const o=i||this.state.schemaUtils,{customValidate:a,transformErrors:l,uiSchema:c}=this.props,u=s??o.retrieveSchema(r,n);return o.getValidator().validateFormData(n,u,a,l,c)}renderErrors(n){const{errors:r,errorSchema:i,schema:s,uiSchema:o}=this.state,{formContext:a}=this.props,l=Ke(o),c=rt("ErrorListTemplate",n,l);return r&&r.length?E.jsx(c,{errors:r,errorSchema:i||{},schema:s,uiSchema:o,formContext:a,registry:n}):null}filterErrorsBasedOnSchema(n,r,i){const{retrievedSchema:s,schemaUtils:o}=this.state,a=r??s,l=o.toPathSchema(a,"",i),c=this.getFieldNames(l,i),u=OR(n,c);(r==null?void 0:r.type)!=="object"&&(r==null?void 0:r.type)!=="array"&&(u.__errors=n.__errors);const d=this.getPreviousCustomValidateErrors(),h=(p=[],m)=>p.length===0?p:p.filter(_=>!m.includes(_)),f=(p,m={})=>(sge(p,(_,g)=>{const y=m[g];Od(_)||Array.isArray(_)&&_.length===0?delete p[g]:Ye(_)&&Ye(y)&&Array.isArray(y==null?void 0:y.__errors)?p[g]=h(_.__errors,y.__errors):typeof _=="object"&&!Array.isArray(_.__errors)&&f(_,m[g])}),p);return f(u,d)}updateRetrievedSchema(n){var i;return St(n,(i=this.state)==null?void 0:i.retrievedSchema)?this.state.retrievedSchema:n}getRegistry(){var u;const{translateString:n,uiSchema:r={}}=this.props,{schemaUtils:i}=this.state,{fields:s,templates:o,widgets:a,formContext:l,translateString:c}=Cme();return{fields:{...s,...this.props.fields},templates:{...o,...this.props.templates,ButtonTemplates:{...o.ButtonTemplates,...(u=this.props.templates)==null?void 0:u.ButtonTemplates}},widgets:{...a,...this.props.widgets},rootSchema:this.props.schema,formContext:this.props.formContext||l,schemaUtils:i,translateString:n||c,globalUiOptions:r[TH]}}focusOnError(n){const{idPrefix:r="root",idSeparator:i="_"}=this.props,{property:s}=n,o=sD(s);o[0]===""?o[0]=r:o.unshift(r);const a=o.join(i);let l=this.formElement.current.elements[a];l||(l=this.formElement.current.querySelector(`input[id^="${a}"`)),l&&l.length&&(l=l[0]),l&&l.focus()}validateForm(){const{omitExtraData:n}=this.props;let{formData:r}=this.state;return n===!0&&(r=this.omitExtraData(r)),this.validateFormWithFormData(r)}render(){const{children:n,id:r,idPrefix:i,idSeparator:s,className:o="",tagName:a,name:l,method:c,target:u,action:d,autoComplete:h,enctype:f,acceptcharset:p,acceptCharset:m,noHtml5Validate:_=!1,disabled:g,readonly:y,formContext:v,showErrorList:w="top",_internalFormWrapper:x}=this.props,{schema:S,uiSchema:C,formData:T,errorSchema:P,idSchema:F}=this.state,k=this.getRegistry(),{SchemaField:A}=k.fields,{SubmitButton:M}=k.templates.ButtonTemplates,b=x?a:void 0,j=x||a||"form";let{[im]:V={}}=Ke(C);g&&(V={...V,props:{...V.props,disabled:!0}});const H={[Id]:{[im]:V}};return E.jsxs(j,{className:o||"rjsf",id:r,name:l,method:c,target:u,action:d,autoComplete:h,encType:f,acceptCharset:m||p,noValidate:_,onSubmit:this.onSubmit,as:b,ref:this.formElement,children:[w==="top"&&this.renderErrors(k),E.jsx(A,{name:"",schema:S,uiSchema:C,errorSchema:P,idSchema:F,idPrefix:i,idSeparator:s,formContext:v,formData:T,onChange:this.onChange,onBlur:this.onBlur,onFocus:this.onFocus,registry:k,disabled:g,readonly:y}),n||E.jsx(M,{uiSchema:H,registry:k}),w==="bottom"&&this.renderErrors(k)]})}}var sx={exports:{}},yD={},wi={},Zc={},of={},Le={},Ch={};(function(t){Object.defineProperty(t,"__esModule",{value:!0}),t.regexpCode=t.getEsmExportName=t.getProperty=t.safeStringify=t.stringify=t.strConcat=t.addCodeArg=t.str=t._=t.nil=t._Code=t.Name=t.IDENTIFIER=t._CodeOrName=void 0;class e{}t._CodeOrName=e,t.IDENTIFIER=/^[a-z$_][a-z$_0-9]*$/i;class n extends e{constructor(y){if(super(),!t.IDENTIFIER.test(y))throw new Error("CodeGen: name must be a valid identifier");this.str=y}toString(){return this.str}emptyStr(){return!1}get names(){return{[this.str]:1}}}t.Name=n;class r extends e{constructor(y){super(),this._items=typeof y=="string"?[y]:y}toString(){return this.str}emptyStr(){if(this._items.length>1)return!1;const y=this._items[0];return y===""||y==='""'}get str(){var y;return(y=this._str)!==null&&y!==void 0?y:this._str=this._items.reduce((v,w)=>`${v}${w}`,"")}get names(){var y;return(y=this._names)!==null&&y!==void 0?y:this._names=this._items.reduce((v,w)=>(w instanceof n&&(v[w.str]=(v[w.str]||0)+1),v),{})}}t._Code=r,t.nil=new r("");function i(g,...y){const v=[g[0]];let w=0;for(;w<y.length;)a(v,y[w]),v.push(g[++w]);return new r(v)}t._=i;const s=new r("+");function o(g,...y){const v=[f(g[0])];let w=0;for(;w<y.length;)v.push(s),a(v,y[w]),v.push(s,f(g[++w]));return l(v),new r(v)}t.str=o;function a(g,y){y instanceof r?g.push(...y._items):y instanceof n?g.push(y):g.push(d(y))}t.addCodeArg=a;function l(g){let y=1;for(;y<g.length-1;){if(g[y]===s){const v=c(g[y-1],g[y+1]);if(v!==void 0){g.splice(y-1,3,v);continue}g[y++]="+"}y++}}function c(g,y){if(y==='""')return g;if(g==='""')return y;if(typeof g=="string")return y instanceof n||g[g.length-1]!=='"'?void 0:typeof y!="string"?`${g.slice(0,-1)}${y}"`:y[0]==='"'?g.slice(0,-1)+y.slice(1):void 0;if(typeof y=="string"&&y[0]==='"'&&!(g instanceof n))return`"${g}${y.slice(1)}`}function u(g,y){return y.emptyStr()?g:g.emptyStr()?y:o`${g}${y}`}t.strConcat=u;function d(g){return typeof g=="number"||typeof g=="boolean"||g===null?g:f(Array.isArray(g)?g.join(","):g)}function h(g){return new r(f(g))}t.stringify=h;function f(g){return JSON.stringify(g).replace(/\u2028/g,"\\u2028").replace(/\u2029/g,"\\u2029")}t.safeStringify=f;function p(g){return typeof g=="string"&&t.IDENTIFIER.test(g)?new r(`.${g}`):i`[${g}]`}t.getProperty=p;function m(g){if(typeof g=="string"&&t.IDENTIFIER.test(g))return new r(`${g}`);throw new Error(`CodeGen: invalid export name: ${g}, use explicit $id name mapping`)}t.getEsmExportName=m;function _(g){return new r(g.toString())}t.regexpCode=_})(Ch);var ox={};(function(t){Object.defineProperty(t,"__esModule",{value:!0}),t.ValueScope=t.ValueScopeName=t.Scope=t.varKinds=t.UsedValueState=void 0;const e=Ch;class n extends Error{constructor(c){super(`CodeGen: "code" for ${c} not defined`),this.value=c.value}}var r;(function(l){l[l.Started=0]="Started",l[l.Completed=1]="Completed"})(r||(t.UsedValueState=r={})),t.varKinds={const:new e.Name("const"),let:new e.Name("let"),var:new e.Name("var")};class i{constructor({prefixes:c,parent:u}={}){this._names={},this._prefixes=c,this._parent=u}toName(c){return c instanceof e.Name?c:this.name(c)}name(c){return new e.Name(this._newName(c))}_newName(c){const u=this._names[c]||this._nameGroup(c);return`${c}${u.index++}`}_nameGroup(c){var u,d;if(!((d=(u=this._parent)===null||u===void 0?void 0:u._prefixes)===null||d===void 0)&&d.has(c)||this._prefixes&&!this._prefixes.has(c))throw new Error(`CodeGen: prefix "${c}" is not allowed in this scope`);return this._names[c]={prefix:c,index:0}}}t.Scope=i;class s extends e.Name{constructor(c,u){super(u),this.prefix=c}setValue(c,{property:u,itemIndex:d}){this.value=c,this.scopePath=(0,e._)`.${new e.Name(u)}[${d}]`}}t.ValueScopeName=s;const o=(0,e._)`\n`;class a extends i{constructor(c){super(c),this._values={},this._scope=c.scope,this.opts={...c,_n:c.lines?o:e.nil}}get(){return this._scope}name(c){return new s(c,this._newName(c))}value(c,u){var d;if(u.ref===void 0)throw new Error("CodeGen: ref must be passed in value");const h=this.toName(c),{prefix:f}=h,p=(d=u.key)!==null&&d!==void 0?d:u.ref;let m=this._values[f];if(m){const y=m.get(p);if(y)return y}else m=this._values[f]=new Map;m.set(p,h);const _=this._scope[f]||(this._scope[f]=[]),g=_.length;return _[g]=u.ref,h.setValue(u,{property:f,itemIndex:g}),h}getValue(c,u){const d=this._values[c];if(d)return d.get(u)}scopeRefs(c,u=this._values){return this._reduceValues(u,d=>{if(d.scopePath===void 0)throw new Error(`CodeGen: name "${d}" has no value`);return(0,e._)`${c}${d.scopePath}`})}scopeCode(c=this._values,u,d){return this._reduceValues(c,h=>{if(h.value===void 0)throw new Error(`CodeGen: name "${h}" has no value`);return h.value.code},u,d)}_reduceValues(c,u,d={},h){let f=e.nil;for(const p in c){const m=c[p];if(!m)continue;const _=d[p]=d[p]||new Map;m.forEach(g=>{if(_.has(g))return;_.set(g,r.Started);let y=u(g);if(y){const v=this.opts.es5?t.varKinds.var:t.varKinds.const;f=(0,e._)`${f}${v} ${g} = ${y};${this.opts._n}`}else if(y=h==null?void 0:h(g))f=(0,e._)`${f}${y}${this.opts._n}`;else throw new n(g);_.set(g,r.Completed)})}return f}}t.ValueScope=a})(ox);(function(t){Object.defineProperty(t,"__esModule",{value:!0}),t.or=t.and=t.not=t.CodeGen=t.operators=t.varKinds=t.ValueScopeName=t.ValueScope=t.Scope=t.Name=t.regexpCode=t.stringify=t.getProperty=t.nil=t.strConcat=t.str=t._=void 0;const e=Ch,n=ox;var r=Ch;Object.defineProperty(t,"_",{enumerable:!0,get:function(){return r._}}),Object.defineProperty(t,"str",{enumerable:!0,get:function(){return r.str}}),Object.defineProperty(t,"strConcat",{enumerable:!0,get:function(){return r.strConcat}}),Object.defineProperty(t,"nil",{enumerable:!0,get:function(){return r.nil}}),Object.defineProperty(t,"getProperty",{enumerable:!0,get:function(){return r.getProperty}}),Object.defineProperty(t,"stringify",{enumerable:!0,get:function(){return r.stringify}}),Object.defineProperty(t,"regexpCode",{enumerable:!0,get:function(){return r.regexpCode}}),Object.defineProperty(t,"Name",{enumerable:!0,get:function(){return r.Name}});var i=ox;Object.defineProperty(t,"Scope",{enumerable:!0,get:function(){return i.Scope}}),Object.defineProperty(t,"ValueScope",{enumerable:!0,get:function(){return i.ValueScope}}),Object.defineProperty(t,"ValueScopeName",{enumerable:!0,get:function(){return i.ValueScopeName}}),Object.defineProperty(t,"varKinds",{enumerable:!0,get:function(){return i.varKinds}}),t.operators={GT:new e._Code(">"),GTE:new e._Code(">="),LT:new e._Code("<"),LTE:new e._Code("<="),EQ:new e._Code("==="),NEQ:new e._Code("!=="),NOT:new e._Code("!"),OR:new e._Code("||"),AND:new e._Code("&&"),ADD:new e._Code("+")};class s{optimizeNodes(){return this}optimizeNames(R,L){return this}}class o extends s{constructor(R,L,W){super(),this.varKind=R,this.name=L,this.rhs=W}render({es5:R,_n:L}){const W=R?n.varKinds.var:this.varKind,te=this.rhs===void 0?"":` = ${this.rhs}`;return`${W} ${this.name}${te};`+L}optimizeNames(R,L){if(R[this.name.str])return this.rhs&&(this.rhs=b(this.rhs,R,L)),this}get names(){return this.rhs instanceof e._CodeOrName?this.rhs.names:{}}}class a extends s{constructor(R,L,W){super(),this.lhs=R,this.rhs=L,this.sideEffects=W}render({_n:R}){return`${this.lhs} = ${this.rhs};`+R}optimizeNames(R,L){if(!(this.lhs instanceof e.Name&&!R[this.lhs.str]&&!this.sideEffects))return this.rhs=b(this.rhs,R,L),this}get names(){const R=this.lhs instanceof e.Name?{}:{...this.lhs.names};return M(R,this.rhs)}}class l extends a{constructor(R,L,W,te){super(R,W,te),this.op=L}render({_n:R}){return`${this.lhs} ${this.op}= ${this.rhs};`+R}}class c extends s{constructor(R){super(),this.label=R,this.names={}}render({_n:R}){return`${this.label}:`+R}}class u extends s{constructor(R){super(),this.label=R,this.names={}}render({_n:R}){return`break${this.label?` ${this.label}`:""};`+R}}class d extends s{constructor(R){super(),this.error=R}render({_n:R}){return`throw ${this.error};`+R}get names(){return this.error.names}}class h extends s{constructor(R){super(),this.code=R}render({_n:R}){return`${this.code};`+R}optimizeNodes(){return`${this.code}`?this:void 0}optimizeNames(R,L){return this.code=b(this.code,R,L),this}get names(){return this.code instanceof e._CodeOrName?this.code.names:{}}}class f extends s{constructor(R=[]){super(),this.nodes=R}render(R){return this.nodes.reduce((L,W)=>L+W.render(R),"")}optimizeNodes(){const{nodes:R}=this;let L=R.length;for(;L--;){const W=R[L].optimizeNodes();Array.isArray(W)?R.splice(L,1,...W):W?R[L]=W:R.splice(L,1)}return R.length>0?this:void 0}optimizeNames(R,L){const{nodes:W}=this;let te=W.length;for(;te--;){const ee=W[te];ee.optimizeNames(R,L)||(j(R,ee.names),W.splice(te,1))}return W.length>0?this:void 0}get names(){return this.nodes.reduce((R,L)=>A(R,L.names),{})}}class p extends f{render(R){return"{"+R._n+super.render(R)+"}"+R._n}}class m extends f{}class _ extends p{}_.kind="else";class g extends p{constructor(R,L){super(L),this.condition=R}render(R){let L=`if(${this.condition})`+super.render(R);return this.else&&(L+="else "+this.else.render(R)),L}optimizeNodes(){super.optimizeNodes();const R=this.condition;if(R===!0)return this.nodes;let L=this.else;if(L){const W=L.optimizeNodes();L=this.else=Array.isArray(W)?new _(W):W}if(L)return R===!1?L instanceof g?L:L.nodes:this.nodes.length?this:new g(V(R),L instanceof g?[L]:L.nodes);if(!(R===!1||!this.nodes.length))return this}optimizeNames(R,L){var W;if(this.else=(W=this.else)===null||W===void 0?void 0:W.optimizeNames(R,L),!!(super.optimizeNames(R,L)||this.else))return this.condition=b(this.condition,R,L),this}get names(){const R=super.names;return M(R,this.condition),this.else&&A(R,this.else.names),R}}g.kind="if";class y extends p{}y.kind="for";class v extends y{constructor(R){super(),this.iteration=R}render(R){return`for(${this.iteration})`+super.render(R)}optimizeNames(R,L){if(super.optimizeNames(R,L))return this.iteration=b(this.iteration,R,L),this}get names(){return A(super.names,this.iteration.names)}}class w extends y{constructor(R,L,W,te){super(),this.varKind=R,this.name=L,this.from=W,this.to=te}render(R){const L=R.es5?n.varKinds.var:this.varKind,{name:W,from:te,to:ee}=this;return`for(${L} ${W}=${te}; ${W}<${ee}; ${W}++)`+super.render(R)}get names(){const R=M(super.names,this.from);return M(R,this.to)}}class x extends y{constructor(R,L,W,te){super(),this.loop=R,this.varKind=L,this.name=W,this.iterable=te}render(R){return`for(${this.varKind} ${this.name} ${this.loop} ${this.iterable})`+super.render(R)}optimizeNames(R,L){if(super.optimizeNames(R,L))return this.iterable=b(this.iterable,R,L),this}get names(){return A(super.names,this.iterable.names)}}class S extends p{constructor(R,L,W){super(),this.name=R,this.args=L,this.async=W}render(R){return`${this.async?"async ":""}function ${this.name}(${this.args})`+super.render(R)}}S.kind="func";class C extends f{render(R){return"return "+super.render(R)}}C.kind="return";class T extends p{render(R){let L="try"+super.render(R);return this.catch&&(L+=this.catch.render(R)),this.finally&&(L+=this.finally.render(R)),L}optimizeNodes(){var R,L;return super.optimizeNodes(),(R=this.catch)===null||R===void 0||R.optimizeNodes(),(L=this.finally)===null||L===void 0||L.optimizeNodes(),this}optimizeNames(R,L){var W,te;return super.optimizeNames(R,L),(W=this.catch)===null||W===void 0||W.optimizeNames(R,L),(te=this.finally)===null||te===void 0||te.optimizeNames(R,L),this}get names(){const R=super.names;return this.catch&&A(R,this.catch.names),this.finally&&A(R,this.finally.names),R}}class P extends p{constructor(R){super(),this.error=R}render(R){return`catch(${this.error})`+super.render(R)}}P.kind="catch";class F extends p{render(R){return"finally"+super.render(R)}}F.kind="finally";class k{constructor(R,L={}){this._values={},this._blockStarts=[],this._constants={},this.opts={...L,_n:L.lines?`
`:""},this._extScope=R,this._scope=new n.Scope({parent:R}),this._nodes=[new m]}toString(){return this._root.render(this.opts)}name(R){return this._scope.name(R)}scopeName(R){return this._extScope.name(R)}scopeValue(R,L){const W=this._extScope.value(R,L);return(this._values[W.prefix]||(this._values[W.prefix]=new Set)).add(W),W}getScopeValue(R,L){return this._extScope.getValue(R,L)}scopeRefs(R){return this._extScope.scopeRefs(R,this._values)}scopeCode(){return this._extScope.scopeCode(this._values)}_def(R,L,W,te){const ee=this._scope.toName(L);return W!==void 0&&te&&(this._constants[ee.str]=W),this._leafNode(new o(R,ee,W)),ee}const(R,L,W){return this._def(n.varKinds.const,R,L,W)}let(R,L,W){return this._def(n.varKinds.let,R,L,W)}var(R,L,W){return this._def(n.varKinds.var,R,L,W)}assign(R,L,W){return this._leafNode(new a(R,L,W))}add(R,L){return this._leafNode(new l(R,t.operators.ADD,L))}code(R){return typeof R=="function"?R():R!==e.nil&&this._leafNode(new h(R)),this}object(...R){const L=["{"];for(const[W,te]of R)L.length>1&&L.push(","),L.push(W),(W!==te||this.opts.es5)&&(L.push(":"),(0,e.addCodeArg)(L,te));return L.push("}"),new e._Code(L)}if(R,L,W){if(this._blockNode(new g(R)),L&&W)this.code(L).else().code(W).endIf();else if(L)this.code(L).endIf();else if(W)throw new Error('CodeGen: "else" body without "then" body');return this}elseIf(R){return this._elseNode(new g(R))}else(){return this._elseNode(new _)}endIf(){return this._endBlockNode(g,_)}_for(R,L){return this._blockNode(R),L&&this.code(L).endFor(),this}for(R,L){return this._for(new v(R),L)}forRange(R,L,W,te,ee=this.opts.es5?n.varKinds.var:n.varKinds.let){const ce=this._scope.toName(R);return this._for(new w(ee,ce,L,W),()=>te(ce))}forOf(R,L,W,te=n.varKinds.const){const ee=this._scope.toName(R);if(this.opts.es5){const ce=L instanceof e.Name?L:this.var("_arr",L);return this.forRange("_i",0,(0,e._)`${ce}.length`,ge=>{this.var(ee,(0,e._)`${ce}[${ge}]`),W(ee)})}return this._for(new x("of",te,ee,L),()=>W(ee))}forIn(R,L,W,te=this.opts.es5?n.varKinds.var:n.varKinds.const){if(this.opts.ownProperties)return this.forOf(R,(0,e._)`Object.keys(${L})`,W);const ee=this._scope.toName(R);return this._for(new x("in",te,ee,L),()=>W(ee))}endFor(){return this._endBlockNode(y)}label(R){return this._leafNode(new c(R))}break(R){return this._leafNode(new u(R))}return(R){const L=new C;if(this._blockNode(L),this.code(R),L.nodes.length!==1)throw new Error('CodeGen: "return" should have one node');return this._endBlockNode(C)}try(R,L,W){if(!L&&!W)throw new Error('CodeGen: "try" without "catch" and "finally"');const te=new T;if(this._blockNode(te),this.code(R),L){const ee=this.name("e");this._currNode=te.catch=new P(ee),L(ee)}return W&&(this._currNode=te.finally=new F,this.code(W)),this._endBlockNode(P,F)}throw(R){return this._leafNode(new d(R))}block(R,L){return this._blockStarts.push(this._nodes.length),R&&this.code(R).endBlock(L),this}endBlock(R){const L=this._blockStarts.pop();if(L===void 0)throw new Error("CodeGen: not in self-balancing block");const W=this._nodes.length-L;if(W<0||R!==void 0&&W!==R)throw new Error(`CodeGen: wrong number of nodes: ${W} vs ${R} expected`);return this._nodes.length=L,this}func(R,L=e.nil,W,te){return this._blockNode(new S(R,L,W)),te&&this.code(te).endFunc(),this}endFunc(){return this._endBlockNode(S)}optimize(R=1){for(;R-- >0;)this._root.optimizeNodes(),this._root.optimizeNames(this._root.names,this._constants)}_leafNode(R){return this._currNode.nodes.push(R),this}_blockNode(R){this._currNode.nodes.push(R),this._nodes.push(R)}_endBlockNode(R,L){const W=this._currNode;if(W instanceof R||L&&W instanceof L)return this._nodes.pop(),this;throw new Error(`CodeGen: not in block "${L?`${R.kind}/${L.kind}`:R.kind}"`)}_elseNode(R){const L=this._currNode;if(!(L instanceof g))throw new Error('CodeGen: "else" without "if"');return this._currNode=L.else=R,this}get _root(){return this._nodes[0]}get _currNode(){const R=this._nodes;return R[R.length-1]}set _currNode(R){const L=this._nodes;L[L.length-1]=R}}t.CodeGen=k;function A(G,R){for(const L in R)G[L]=(G[L]||0)+(R[L]||0);return G}function M(G,R){return R instanceof e._CodeOrName?A(G,R.names):G}function b(G,R,L){if(G instanceof e.Name)return W(G);if(!te(G))return G;return new e._Code(G._items.reduce((ee,ce)=>(ce instanceof e.Name&&(ce=W(ce)),ce instanceof e._Code?ee.push(...ce._items):ee.push(ce),ee),[]));function W(ee){const ce=L[ee.str];return ce===void 0||R[ee.str]!==1?ee:(delete R[ee.str],ce)}function te(ee){return ee instanceof e._Code&&ee._items.some(ce=>ce instanceof e.Name&&R[ce.str]===1&&L[ce.str]!==void 0)}}function j(G,R){for(const L in R)G[L]=(G[L]||0)-(R[L]||0)}function V(G){return typeof G=="boolean"||typeof G=="number"||G===null?!G:(0,e._)`!${$(G)}`}t.not=V;const H=O(t.operators.AND);function U(...G){return G.reduce(H)}t.and=U;const B=O(t.operators.OR);function N(...G){return G.reduce(B)}t.or=N;function O(G){return(R,L)=>R===e.nil?L:L===e.nil?R:(0,e._)`${$(R)} ${G} ${$(L)}`}function $(G){return G instanceof e.Name?G:(0,e._)`(${G})`}})(Le);var pe={};Object.defineProperty(pe,"__esModule",{value:!0});pe.checkStrictMode=pe.getErrorPath=pe.Type=pe.useFunc=pe.setEvaluated=pe.evaluatedPropsToName=pe.mergeEvaluated=pe.eachItem=pe.unescapeJsonPointer=pe.escapeJsonPointer=pe.escapeFragment=pe.unescapeFragment=pe.schemaRefOrVal=pe.schemaHasRulesButRef=pe.schemaHasRules=pe.checkUnknownRules=pe.alwaysValidSchema=pe.toHash=void 0;const at=Le,Pme=Ch;function Rme(t){const e={};for(const n of t)e[n]=!0;return e}pe.toHash=Rme;function Ime(t,e){return typeof e=="boolean"?e:Object.keys(e).length===0?!0:(_D(t,e),!vD(e,t.self.RULES.all))}pe.alwaysValidSchema=Ime;function _D(t,e=t.schema){const{opts:n,self:r}=t;if(!n.strictSchema||typeof e=="boolean")return;const i=r.RULES.keywords;for(const s in e)i[s]||ED(t,`unknown keyword: "${s}"`)}pe.checkUnknownRules=_D;function vD(t,e){if(typeof t=="boolean")return!t;for(const n in t)if(e[n])return!0;return!1}pe.schemaHasRules=vD;function Ame(t,e){if(typeof t=="boolean")return!t;for(const n in t)if(n!=="$ref"&&e.all[n])return!0;return!1}pe.schemaHasRulesButRef=Ame;function Fme({topSchemaRef:t,schemaPath:e},n,r,i){if(!i){if(typeof n=="number"||typeof n=="boolean")return n;if(typeof n=="string")return(0,at._)`${n}`}return(0,at._)`${t}${e}${(0,at.getProperty)(r)}`}pe.schemaRefOrVal=Fme;function Ome(t){return wD(decodeURIComponent(t))}pe.unescapeFragment=Ome;function $me(t){return encodeURIComponent(zS(t))}pe.escapeFragment=$me;function zS(t){return typeof t=="number"?`${t}`:t.replace(/~/g,"~0").replace(/\//g,"~1")}pe.escapeJsonPointer=zS;function wD(t){return t.replace(/~1/g,"/").replace(/~0/g,"~")}pe.unescapeJsonPointer=wD;function Lme(t,e){if(Array.isArray(t))for(const n of t)e(n);else e(t)}pe.eachItem=Lme;function XR({mergeNames:t,mergeToName:e,mergeValues:n,resultToName:r}){return(i,s,o,a)=>{const l=o===void 0?s:o instanceof at.Name?(s instanceof at.Name?t(i,s,o):e(i,s,o),o):s instanceof at.Name?(e(i,o,s),s):n(s,o);return a===at.Name&&!(l instanceof at.Name)?r(i,l):l}}pe.mergeEvaluated={props:XR({mergeNames:(t,e,n)=>t.if((0,at._)`${n} !== true && ${e} !== undefined`,()=>{t.if((0,at._)`${e} === true`,()=>t.assign(n,!0),()=>t.assign(n,(0,at._)`${n} || {}`).code((0,at._)`Object.assign(${n}, ${e})`))}),mergeToName:(t,e,n)=>t.if((0,at._)`${n} !== true`,()=>{e===!0?t.assign(n,!0):(t.assign(n,(0,at._)`${n} || {}`),US(t,n,e))}),mergeValues:(t,e)=>t===!0?!0:{...t,...e},resultToName:xD}),items:XR({mergeNames:(t,e,n)=>t.if((0,at._)`${n} !== true && ${e} !== undefined`,()=>t.assign(n,(0,at._)`${e} === true ? true : ${n} > ${e} ? ${n} : ${e}`)),mergeToName:(t,e,n)=>t.if((0,at._)`${n} !== true`,()=>t.assign(n,e===!0?!0:(0,at._)`${n} > ${e} ? ${n} : ${e}`)),mergeValues:(t,e)=>t===!0?!0:Math.max(t,e),resultToName:(t,e)=>t.var("items",e)})};function xD(t,e){if(e===!0)return t.var("props",!0);const n=t.var("props",(0,at._)`{}`);return e!==void 0&&US(t,n,e),n}pe.evaluatedPropsToName=xD;function US(t,e,n){Object.keys(n).forEach(r=>t.assign((0,at._)`${e}${(0,at.getProperty)(r)}`,!0))}pe.setEvaluated=US;const ZR={};function kme(t,e){return t.scopeValue("func",{ref:e,code:ZR[e.code]||(ZR[e.code]=new Pme._Code(e.code))})}pe.useFunc=kme;var ax;(function(t){t[t.Num=0]="Num",t[t.Str=1]="Str"})(ax||(pe.Type=ax={}));function Mme(t,e,n){if(t instanceof at.Name){const r=e===ax.Num;return n?r?(0,at._)`"[" + ${t} + "]"`:(0,at._)`"['" + ${t} + "']"`:r?(0,at._)`"/" + ${t}`:(0,at._)`"/" + ${t}.replace(/~/g, "~0").replace(/\\//g, "~1")`}return n?(0,at.getProperty)(t).toString():"/"+zS(t)}pe.getErrorPath=Mme;function ED(t,e,n=t.opts.strictSchema){if(n){if(e=`strict mode: ${e}`,n===!0)throw new Error(e);t.self.logger.warn(e)}}pe.checkStrictMode=ED;var ss={};Object.defineProperty(ss,"__esModule",{value:!0});const An=Le,Dme={data:new An.Name("data"),valCxt:new An.Name("valCxt"),instancePath:new An.Name("instancePath"),parentData:new An.Name("parentData"),parentDataProperty:new An.Name("parentDataProperty"),rootData:new An.Name("rootData"),dynamicAnchors:new An.Name("dynamicAnchors"),vErrors:new An.Name("vErrors"),errors:new An.Name("errors"),this:new An.Name("this"),self:new An.Name("self"),scope:new An.Name("scope"),json:new An.Name("json"),jsonPos:new An.Name("jsonPos"),jsonLen:new An.Name("jsonLen"),jsonPart:new An.Name("jsonPart")};ss.default=Dme;(function(t){Object.defineProperty(t,"__esModule",{value:!0}),t.extendErrors=t.resetErrorsCount=t.reportExtraError=t.reportError=t.keyword$DataError=t.keywordError=void 0;const e=Le,n=pe,r=ss;t.keywordError={message:({keyword:_})=>(0,e.str)`must pass "${_}" keyword validation`},t.keyword$DataError={message:({keyword:_,schemaType:g})=>g?(0,e.str)`"${_}" keyword must be ${g} ($data)`:(0,e.str)`"${_}" keyword is invalid ($data)`};function i(_,g=t.keywordError,y,v){const{it:w}=_,{gen:x,compositeRule:S,allErrors:C}=w,T=d(_,g,y);v??(S||C)?l(x,T):c(w,(0,e._)`[${T}]`)}t.reportError=i;function s(_,g=t.keywordError,y){const{it:v}=_,{gen:w,compositeRule:x,allErrors:S}=v,C=d(_,g,y);l(w,C),x||S||c(v,r.default.vErrors)}t.reportExtraError=s;function o(_,g){_.assign(r.default.errors,g),_.if((0,e._)`${r.default.vErrors} !== null`,()=>_.if(g,()=>_.assign((0,e._)`${r.default.vErrors}.length`,g),()=>_.assign(r.default.vErrors,null)))}t.resetErrorsCount=o;function a({gen:_,keyword:g,schemaValue:y,data:v,errsCount:w,it:x}){if(w===void 0)throw new Error("ajv implementation error");const S=_.name("err");_.forRange("i",w,r.default.errors,C=>{_.const(S,(0,e._)`${r.default.vErrors}[${C}]`),_.if((0,e._)`${S}.instancePath === undefined`,()=>_.assign((0,e._)`${S}.instancePath`,(0,e.strConcat)(r.default.instancePath,x.errorPath))),_.assign((0,e._)`${S}.schemaPath`,(0,e.str)`${x.errSchemaPath}/${g}`),x.opts.verbose&&(_.assign((0,e._)`${S}.schema`,y),_.assign((0,e._)`${S}.data`,v))})}t.extendErrors=a;function l(_,g){const y=_.const("err",g);_.if((0,e._)`${r.default.vErrors} === null`,()=>_.assign(r.default.vErrors,(0,e._)`[${y}]`),(0,e._)`${r.default.vErrors}.push(${y})`),_.code((0,e._)`${r.default.errors}++`)}function c(_,g){const{gen:y,validateName:v,schemaEnv:w}=_;w.$async?y.throw((0,e._)`new ${_.ValidationError}(${g})`):(y.assign((0,e._)`${v}.errors`,g),y.return(!1))}const u={keyword:new e.Name("keyword"),schemaPath:new e.Name("schemaPath"),params:new e.Name("params"),propertyName:new e.Name("propertyName"),message:new e.Name("message"),schema:new e.Name("schema"),parentSchema:new e.Name("parentSchema")};function d(_,g,y){const{createErrors:v}=_.it;return v===!1?(0,e._)`{}`:h(_,g,y)}function h(_,g,y={}){const{gen:v,it:w}=_,x=[f(w,y),p(_,y)];return m(_,g,x),v.object(...x)}function f({errorPath:_},{instancePath:g}){const y=g?(0,e.str)`${_}${(0,n.getErrorPath)(g,n.Type.Str)}`:_;return[r.default.instancePath,(0,e.strConcat)(r.default.instancePath,y)]}function p({keyword:_,it:{errSchemaPath:g}},{schemaPath:y,parentSchema:v}){let w=v?g:(0,e.str)`${g}/${_}`;return y&&(w=(0,e.str)`${w}${(0,n.getErrorPath)(y,n.Type.Str)}`),[u.schemaPath,w]}function m(_,{params:g,message:y},v){const{keyword:w,data:x,schemaValue:S,it:C}=_,{opts:T,propertyName:P,topSchemaRef:F,schemaPath:k}=C;v.push([u.keyword,w],[u.params,typeof g=="function"?g(_):g||(0,e._)`{}`]),T.messages&&v.push([u.message,typeof y=="function"?y(_):y]),T.verbose&&v.push([u.schema,S],[u.parentSchema,(0,e._)`${F}${k}`],[r.default.data,x]),P&&v.push([u.propertyName,P])}})(of);Object.defineProperty(Zc,"__esModule",{value:!0});Zc.boolOrEmptySchema=Zc.topBoolOrEmptySchema=void 0;const Nme=of,jme=Le,zme=ss,Ume={message:"boolean schema is false"};function Gme(t){const{gen:e,schema:n,validateName:r}=t;n===!1?SD(t,!1):typeof n=="object"&&n.$async===!0?e.return(zme.default.data):(e.assign((0,jme._)`${r}.errors`,null),e.return(!0))}Zc.topBoolOrEmptySchema=Gme;function Bme(t,e){const{gen:n,schema:r}=t;r===!1?(n.var(e,!1),SD(t)):n.var(e,!0)}Zc.boolOrEmptySchema=Bme;function SD(t,e){const{gen:n,data:r}=t,i={gen:n,keyword:"false schema",data:r,schema:!1,schemaCode:!1,schemaValue:!1,params:{},it:t};(0,Nme.reportError)(i,Ume,void 0,e)}var qt={},Ka={};Object.defineProperty(Ka,"__esModule",{value:!0});Ka.getRules=Ka.isJSONType=void 0;const Vme=["string","number","integer","boolean","null","object","array"],Wme=new Set(Vme);function Hme(t){return typeof t=="string"&&Wme.has(t)}Ka.isJSONType=Hme;function Kme(){const t={number:{type:"number",rules:[]},string:{type:"string",rules:[]},array:{type:"array",rules:[]},object:{type:"object",rules:[]}};return{types:{...t,integer:!0,boolean:!0,null:!0},rules:[{rules:[]},t.number,t.string,t.array,t.object],post:{rules:[]},all:{},keywords:{}}}Ka.getRules=Kme;var Fs={};Object.defineProperty(Fs,"__esModule",{value:!0});Fs.shouldUseRule=Fs.shouldUseGroup=Fs.schemaHasRulesForType=void 0;function Yme({schema:t,self:e},n){const r=e.RULES.types[n];return r&&r!==!0&&bD(t,r)}Fs.schemaHasRulesForType=Yme;function bD(t,e){return e.rules.some(n=>CD(t,n))}Fs.shouldUseGroup=bD;function CD(t,e){var n;return t[e.keyword]!==void 0||((n=e.definition.implements)===null||n===void 0?void 0:n.some(r=>t[r]!==void 0))}Fs.shouldUseRule=CD;Object.defineProperty(qt,"__esModule",{value:!0});qt.reportTypeError=qt.checkDataTypes=qt.checkDataType=qt.coerceAndCheckDataType=qt.getJSONTypes=qt.getSchemaTypes=qt.DataType=void 0;const Xme=Ka,Zme=Fs,qme=of,Fe=Le,TD=pe;var bc;(function(t){t[t.Correct=0]="Correct",t[t.Wrong=1]="Wrong"})(bc||(qt.DataType=bc={}));function Jme(t){const e=PD(t.type);if(e.includes("null")){if(t.nullable===!1)throw new Error("type: null contradicts nullable: false")}else{if(!e.length&&t.nullable!==void 0)throw new Error('"nullable" cannot be used without "type"');t.nullable===!0&&e.push("null")}return e}qt.getSchemaTypes=Jme;function PD(t){const e=Array.isArray(t)?t:t?[t]:[];if(e.every(Xme.isJSONType))return e;throw new Error("type must be JSONType or JSONType[]: "+e.join(","))}qt.getJSONTypes=PD;function Qme(t,e){const{gen:n,data:r,opts:i}=t,s=eye(e,i.coerceTypes),o=e.length>0&&!(s.length===0&&e.length===1&&(0,Zme.schemaHasRulesForType)(t,e[0]));if(o){const a=GS(e,r,i.strictNumbers,bc.Wrong);n.if(a,()=>{s.length?tye(t,e,s):BS(t)})}return o}qt.coerceAndCheckDataType=Qme;const RD=new Set(["string","number","integer","boolean","null"]);function eye(t,e){return e?t.filter(n=>RD.has(n)||e==="array"&&n==="array"):[]}function tye(t,e,n){const{gen:r,data:i,opts:s}=t,o=r.let("dataType",(0,Fe._)`typeof ${i}`),a=r.let("coerced",(0,Fe._)`undefined`);s.coerceTypes==="array"&&r.if((0,Fe._)`${o} == 'object' && Array.isArray(${i}) && ${i}.length == 1`,()=>r.assign(i,(0,Fe._)`${i}[0]`).assign(o,(0,Fe._)`typeof ${i}`).if(GS(e,i,s.strictNumbers),()=>r.assign(a,i))),r.if((0,Fe._)`${a} !== undefined`);for(const c of n)(RD.has(c)||c==="array"&&s.coerceTypes==="array")&&l(c);r.else(),BS(t),r.endIf(),r.if((0,Fe._)`${a} !== undefined`,()=>{r.assign(i,a),nye(t,a)});function l(c){switch(c){case"string":r.elseIf((0,Fe._)`${o} == "number" || ${o} == "boolean"`).assign(a,(0,Fe._)`"" + ${i}`).elseIf((0,Fe._)`${i} === null`).assign(a,(0,Fe._)`""`);return;case"number":r.elseIf((0,Fe._)`${o} == "boolean" || ${i} === null
              || (${o} == "string" && ${i} && ${i} == +${i})`).assign(a,(0,Fe._)`+${i}`);return;case"integer":r.elseIf((0,Fe._)`${o} === "boolean" || ${i} === null
              || (${o} === "string" && ${i} && ${i} == +${i} && !(${i} % 1))`).assign(a,(0,Fe._)`+${i}`);return;case"boolean":r.elseIf((0,Fe._)`${i} === "false" || ${i} === 0 || ${i} === null`).assign(a,!1).elseIf((0,Fe._)`${i} === "true" || ${i} === 1`).assign(a,!0);return;case"null":r.elseIf((0,Fe._)`${i} === "" || ${i} === 0 || ${i} === false`),r.assign(a,null);return;case"array":r.elseIf((0,Fe._)`${o} === "string" || ${o} === "number"
              || ${o} === "boolean" || ${i} === null`).assign(a,(0,Fe._)`[${i}]`)}}}function nye({gen:t,parentData:e,parentDataProperty:n},r){t.if((0,Fe._)`${e} !== undefined`,()=>t.assign((0,Fe._)`${e}[${n}]`,r))}function lx(t,e,n,r=bc.Correct){const i=r===bc.Correct?Fe.operators.EQ:Fe.operators.NEQ;let s;switch(t){case"null":return(0,Fe._)`${e} ${i} null`;case"array":s=(0,Fe._)`Array.isArray(${e})`;break;case"object":s=(0,Fe._)`${e} && typeof ${e} == "object" && !Array.isArray(${e})`;break;case"integer":s=o((0,Fe._)`!(${e} % 1) && !isNaN(${e})`);break;case"number":s=o();break;default:return(0,Fe._)`typeof ${e} ${i} ${t}`}return r===bc.Correct?s:(0,Fe.not)(s);function o(a=Fe.nil){return(0,Fe.and)((0,Fe._)`typeof ${e} == "number"`,a,n?(0,Fe._)`isFinite(${e})`:Fe.nil)}}qt.checkDataType=lx;function GS(t,e,n,r){if(t.length===1)return lx(t[0],e,n,r);let i;const s=(0,TD.toHash)(t);if(s.array&&s.object){const o=(0,Fe._)`typeof ${e} != "object"`;i=s.null?o:(0,Fe._)`!${e} || ${o}`,delete s.null,delete s.array,delete s.object}else i=Fe.nil;s.number&&delete s.integer;for(const o in s)i=(0,Fe.and)(i,lx(o,e,n,r));return i}qt.checkDataTypes=GS;const rye={message:({schema:t})=>`must be ${t}`,params:({schema:t,schemaValue:e})=>typeof t=="string"?(0,Fe._)`{type: ${t}}`:(0,Fe._)`{type: ${e}}`};function BS(t){const e=iye(t);(0,qme.reportError)(e,rye)}qt.reportTypeError=BS;function iye(t){const{gen:e,data:n,schema:r}=t,i=(0,TD.schemaRefOrVal)(t,r,"type");return{gen:e,keyword:"type",data:n,schema:r.type,schemaCode:i,schemaValue:i,parentSchema:r,params:{},it:t}}var a_={};Object.defineProperty(a_,"__esModule",{value:!0});a_.assignDefaults=void 0;const Il=Le,sye=pe;function oye(t,e){const{properties:n,items:r}=t.schema;if(e==="object"&&n)for(const i in n)qR(t,i,n[i].default);else e==="array"&&Array.isArray(r)&&r.forEach((i,s)=>qR(t,s,i.default))}a_.assignDefaults=oye;function qR(t,e,n){const{gen:r,compositeRule:i,data:s,opts:o}=t;if(n===void 0)return;const a=(0,Il._)`${s}${(0,Il.getProperty)(e)}`;if(i){(0,sye.checkStrictMode)(t,`default is ignored for: ${a}`);return}let l=(0,Il._)`${a} === undefined`;o.useDefaults==="empty"&&(l=(0,Il._)`${l} || ${a} === null || ${a} === ""`),r.if(l,(0,Il._)`${a} = ${(0,Il.stringify)(n)}`)}var Gi={},De={};Object.defineProperty(De,"__esModule",{value:!0});De.validateUnion=De.validateArray=De.usePattern=De.callValidateCode=De.schemaProperties=De.allSchemaProperties=De.noPropertyInData=De.propertyInData=De.isOwnProperty=De.hasPropFunc=De.reportMissingProp=De.checkMissingProp=De.checkReportMissingProp=void 0;const bt=Le,VS=pe,so=ss,aye=pe;function lye(t,e){const{gen:n,data:r,it:i}=t;n.if(HS(n,r,e,i.opts.ownProperties),()=>{t.setParams({missingProperty:(0,bt._)`${e}`},!0),t.error()})}De.checkReportMissingProp=lye;function cye({gen:t,data:e,it:{opts:n}},r,i){return(0,bt.or)(...r.map(s=>(0,bt.and)(HS(t,e,s,n.ownProperties),(0,bt._)`${i} = ${s}`)))}De.checkMissingProp=cye;function uye(t,e){t.setParams({missingProperty:e},!0),t.error()}De.reportMissingProp=uye;function ID(t){return t.scopeValue("func",{ref:Object.prototype.hasOwnProperty,code:(0,bt._)`Object.prototype.hasOwnProperty`})}De.hasPropFunc=ID;function WS(t,e,n){return(0,bt._)`${ID(t)}.call(${e}, ${n})`}De.isOwnProperty=WS;function dye(t,e,n,r){const i=(0,bt._)`${e}${(0,bt.getProperty)(n)} !== undefined`;return r?(0,bt._)`${i} && ${WS(t,e,n)}`:i}De.propertyInData=dye;function HS(t,e,n,r){const i=(0,bt._)`${e}${(0,bt.getProperty)(n)} === undefined`;return r?(0,bt.or)(i,(0,bt.not)(WS(t,e,n))):i}De.noPropertyInData=HS;function AD(t){return t?Object.keys(t).filter(e=>e!=="__proto__"):[]}De.allSchemaProperties=AD;function hye(t,e){return AD(e).filter(n=>!(0,VS.alwaysValidSchema)(t,e[n]))}De.schemaProperties=hye;function fye({schemaCode:t,data:e,it:{gen:n,topSchemaRef:r,schemaPath:i,errorPath:s},it:o},a,l,c){const u=c?(0,bt._)`${t}, ${e}, ${r}${i}`:e,d=[[so.default.instancePath,(0,bt.strConcat)(so.default.instancePath,s)],[so.default.parentData,o.parentData],[so.default.parentDataProperty,o.parentDataProperty],[so.default.rootData,so.default.rootData]];o.opts.dynamicRef&&d.push([so.default.dynamicAnchors,so.default.dynamicAnchors]);const h=(0,bt._)`${u}, ${n.object(...d)}`;return l!==bt.nil?(0,bt._)`${a}.call(${l}, ${h})`:(0,bt._)`${a}(${h})`}De.callValidateCode=fye;const gye=(0,bt._)`new RegExp`;function pye({gen:t,it:{opts:e}},n){const r=e.unicodeRegExp?"u":"",{regExp:i}=e.code,s=i(n,r);return t.scopeValue("pattern",{key:s.toString(),ref:s,code:(0,bt._)`${i.code==="new RegExp"?gye:(0,aye.useFunc)(t,i)}(${n}, ${r})`})}De.usePattern=pye;function mye(t){const{gen:e,data:n,keyword:r,it:i}=t,s=e.name("valid");if(i.allErrors){const a=e.let("valid",!0);return o(()=>e.assign(a,!1)),a}return e.var(s,!0),o(()=>e.break()),s;function o(a){const l=e.const("len",(0,bt._)`${n}.length`);e.forRange("i",0,l,c=>{t.subschema({keyword:r,dataProp:c,dataPropType:VS.Type.Num},s),e.if((0,bt.not)(s),a)})}}De.validateArray=mye;function yye(t){const{gen:e,schema:n,keyword:r,it:i}=t;if(!Array.isArray(n))throw new Error("ajv implementation error");if(n.some(l=>(0,VS.alwaysValidSchema)(i,l))&&!i.opts.unevaluated)return;const o=e.let("valid",!1),a=e.name("_valid");e.block(()=>n.forEach((l,c)=>{const u=t.subschema({keyword:r,schemaProp:c,compositeRule:!0},a);e.assign(o,(0,bt._)`${o} || ${a}`),t.mergeValidEvaluated(u,a)||e.if((0,bt.not)(o))})),t.result(o,()=>t.reset(),()=>t.error(!0))}De.validateUnion=yye;Object.defineProperty(Gi,"__esModule",{value:!0});Gi.validateKeywordUsage=Gi.validSchemaType=Gi.funcKeywordCode=Gi.macroKeywordCode=void 0;const zn=Le,ya=ss,_ye=De,vye=of;function wye(t,e){const{gen:n,keyword:r,schema:i,parentSchema:s,it:o}=t,a=e.macro.call(o.self,i,s,o),l=FD(n,r,a);o.opts.validateSchema!==!1&&o.self.validateSchema(a,!0);const c=n.name("valid");t.subschema({schema:a,schemaPath:zn.nil,errSchemaPath:`${o.errSchemaPath}/${r}`,topSchemaRef:l,compositeRule:!0},c),t.pass(c,()=>t.error(!0))}Gi.macroKeywordCode=wye;function xye(t,e){var n;const{gen:r,keyword:i,schema:s,parentSchema:o,$data:a,it:l}=t;Sye(l,e);const c=!a&&e.compile?e.compile.call(l.self,s,o,l):e.validate,u=FD(r,i,c),d=r.let("valid");t.block$data(d,h),t.ok((n=e.valid)!==null&&n!==void 0?n:d);function h(){if(e.errors===!1)m(),e.modifying&&JR(t),_(()=>t.error());else{const g=e.async?f():p();e.modifying&&JR(t),_(()=>Eye(t,g))}}function f(){const g=r.let("ruleErrs",null);return r.try(()=>m((0,zn._)`await `),y=>r.assign(d,!1).if((0,zn._)`${y} instanceof ${l.ValidationError}`,()=>r.assign(g,(0,zn._)`${y}.errors`),()=>r.throw(y))),g}function p(){const g=(0,zn._)`${u}.errors`;return r.assign(g,null),m(zn.nil),g}function m(g=e.async?(0,zn._)`await `:zn.nil){const y=l.opts.passContext?ya.default.this:ya.default.self,v=!("compile"in e&&!a||e.schema===!1);r.assign(d,(0,zn._)`${g}${(0,_ye.callValidateCode)(t,u,y,v)}`,e.modifying)}function _(g){var y;r.if((0,zn.not)((y=e.valid)!==null&&y!==void 0?y:d),g)}}Gi.funcKeywordCode=xye;function JR(t){const{gen:e,data:n,it:r}=t;e.if(r.parentData,()=>e.assign(n,(0,zn._)`${r.parentData}[${r.parentDataProperty}]`))}function Eye(t,e){const{gen:n}=t;n.if((0,zn._)`Array.isArray(${e})`,()=>{n.assign(ya.default.vErrors,(0,zn._)`${ya.default.vErrors} === null ? ${e} : ${ya.default.vErrors}.concat(${e})`).assign(ya.default.errors,(0,zn._)`${ya.default.vErrors}.length`),(0,vye.extendErrors)(t)},()=>t.error())}function Sye({schemaEnv:t},e){if(e.async&&!t.$async)throw new Error("async keyword in sync schema")}function FD(t,e,n){if(n===void 0)throw new Error(`keyword "${e}" failed to compile`);return t.scopeValue("keyword",typeof n=="function"?{ref:n}:{ref:n,code:(0,zn.stringify)(n)})}function bye(t,e,n=!1){return!e.length||e.some(r=>r==="array"?Array.isArray(t):r==="object"?t&&typeof t=="object"&&!Array.isArray(t):typeof t==r||n&&typeof t>"u")}Gi.validSchemaType=bye;function Cye({schema:t,opts:e,self:n,errSchemaPath:r},i,s){if(Array.isArray(i.keyword)?!i.keyword.includes(s):i.keyword!==s)throw new Error("ajv implementation error");const o=i.dependencies;if(o!=null&&o.some(a=>!Object.prototype.hasOwnProperty.call(t,a)))throw new Error(`parent schema must have dependencies of ${s}: ${o.join(",")}`);if(i.validateSchema&&!i.validateSchema(t[s])){const l=`keyword "${s}" value is invalid at path "${r}": `+n.errorsText(i.validateSchema.errors);if(e.validateSchema==="log")n.logger.error(l);else throw new Error(l)}}Gi.validateKeywordUsage=Cye;var Mo={};Object.defineProperty(Mo,"__esModule",{value:!0});Mo.extendSubschemaMode=Mo.extendSubschemaData=Mo.getSubschema=void 0;const Di=Le,OD=pe;function Tye(t,{keyword:e,schemaProp:n,schema:r,schemaPath:i,errSchemaPath:s,topSchemaRef:o}){if(e!==void 0&&r!==void 0)throw new Error('both "keyword" and "schema" passed, only one allowed');if(e!==void 0){const a=t.schema[e];return n===void 0?{schema:a,schemaPath:(0,Di._)`${t.schemaPath}${(0,Di.getProperty)(e)}`,errSchemaPath:`${t.errSchemaPath}/${e}`}:{schema:a[n],schemaPath:(0,Di._)`${t.schemaPath}${(0,Di.getProperty)(e)}${(0,Di.getProperty)(n)}`,errSchemaPath:`${t.errSchemaPath}/${e}/${(0,OD.escapeFragment)(n)}`}}if(r!==void 0){if(i===void 0||s===void 0||o===void 0)throw new Error('"schemaPath", "errSchemaPath" and "topSchemaRef" are required with "schema"');return{schema:r,schemaPath:i,topSchemaRef:o,errSchemaPath:s}}throw new Error('either "keyword" or "schema" must be passed')}Mo.getSubschema=Tye;function Pye(t,e,{dataProp:n,dataPropType:r,data:i,dataTypes:s,propertyName:o}){if(i!==void 0&&n!==void 0)throw new Error('both "data" and "dataProp" passed, only one allowed');const{gen:a}=e;if(n!==void 0){const{errorPath:c,dataPathArr:u,opts:d}=e,h=a.let("data",(0,Di._)`${e.data}${(0,Di.getProperty)(n)}`,!0);l(h),t.errorPath=(0,Di.str)`${c}${(0,OD.getErrorPath)(n,r,d.jsPropertySyntax)}`,t.parentDataProperty=(0,Di._)`${n}`,t.dataPathArr=[...u,t.parentDataProperty]}if(i!==void 0){const c=i instanceof Di.Name?i:a.let("data",i,!0);l(c),o!==void 0&&(t.propertyName=o)}s&&(t.dataTypes=s);function l(c){t.data=c,t.dataLevel=e.dataLevel+1,t.dataTypes=[],e.definedProperties=new Set,t.parentData=e.data,t.dataNames=[...e.dataNames,c]}}Mo.extendSubschemaData=Pye;function Rye(t,{jtdDiscriminator:e,jtdMetadata:n,compositeRule:r,createErrors:i,allErrors:s}){r!==void 0&&(t.compositeRule=r),i!==void 0&&(t.createErrors=i),s!==void 0&&(t.allErrors=s),t.jtdDiscriminator=e,t.jtdMetadata=n}Mo.extendSubschemaMode=Rye;var xn={},$D=function t(e,n){if(e===n)return!0;if(e&&n&&typeof e=="object"&&typeof n=="object"){if(e.constructor!==n.constructor)return!1;var r,i,s;if(Array.isArray(e)){if(r=e.length,r!=n.length)return!1;for(i=r;i--!==0;)if(!t(e[i],n[i]))return!1;return!0}if(e.constructor===RegExp)return e.source===n.source&&e.flags===n.flags;if(e.valueOf!==Object.prototype.valueOf)return e.valueOf()===n.valueOf();if(e.toString!==Object.prototype.toString)return e.toString()===n.toString();if(s=Object.keys(e),r=s.length,r!==Object.keys(n).length)return!1;for(i=r;i--!==0;)if(!Object.prototype.hasOwnProperty.call(n,s[i]))return!1;for(i=r;i--!==0;){var o=s[i];if(!t(e[o],n[o]))return!1}return!0}return e!==e&&n!==n},LD={exports:{}},Co=LD.exports=function(t,e,n){typeof e=="function"&&(n=e,e={}),n=e.cb||n;var r=typeof n=="function"?n:n.pre||function(){},i=n.post||function(){};Yg(e,r,i,t,"",t)};Co.keywords={additionalItems:!0,items:!0,contains:!0,additionalProperties:!0,propertyNames:!0,not:!0,if:!0,then:!0,else:!0};Co.arrayKeywords={items:!0,allOf:!0,anyOf:!0,oneOf:!0};Co.propsKeywords={$defs:!0,definitions:!0,properties:!0,patternProperties:!0,dependencies:!0};Co.skipKeywords={default:!0,enum:!0,const:!0,required:!0,maximum:!0,minimum:!0,exclusiveMaximum:!0,exclusiveMinimum:!0,multipleOf:!0,maxLength:!0,minLength:!0,pattern:!0,format:!0,maxItems:!0,minItems:!0,uniqueItems:!0,maxProperties:!0,minProperties:!0};function Yg(t,e,n,r,i,s,o,a,l,c){if(r&&typeof r=="object"&&!Array.isArray(r)){e(r,i,s,o,a,l,c);for(var u in r){var d=r[u];if(Array.isArray(d)){if(u in Co.arrayKeywords)for(var h=0;h<d.length;h++)Yg(t,e,n,d[h],i+"/"+u+"/"+h,s,i,u,r,h)}else if(u in Co.propsKeywords){if(d&&typeof d=="object")for(var f in d)Yg(t,e,n,d[f],i+"/"+u+"/"+Iye(f),s,i,u,r,f)}else(u in Co.keywords||t.allKeys&&!(u in Co.skipKeywords))&&Yg(t,e,n,d,i+"/"+u,s,i,u,r)}n(r,i,s,o,a,l,c)}}function Iye(t){return t.replace(/~/g,"~0").replace(/\//g,"~1")}var Aye=LD.exports;Object.defineProperty(xn,"__esModule",{value:!0});xn.getSchemaRefs=xn.resolveUrl=xn.normalizeId=xn._getFullPath=xn.getFullPath=xn.inlineRef=void 0;const Fye=pe,Oye=$D,$ye=Aye,Lye=new Set(["type","format","pattern","maxLength","minLength","maxProperties","minProperties","maxItems","minItems","maximum","minimum","uniqueItems","multipleOf","required","enum","const"]);function kye(t,e=!0){return typeof t=="boolean"?!0:e===!0?!cx(t):e?kD(t)<=e:!1}xn.inlineRef=kye;const Mye=new Set(["$ref","$recursiveRef","$recursiveAnchor","$dynamicRef","$dynamicAnchor"]);function cx(t){for(const e in t){if(Mye.has(e))return!0;const n=t[e];if(Array.isArray(n)&&n.some(cx)||typeof n=="object"&&cx(n))return!0}return!1}function kD(t){let e=0;for(const n in t){if(n==="$ref")return 1/0;if(e++,!Lye.has(n)&&(typeof t[n]=="object"&&(0,Fye.eachItem)(t[n],r=>e+=kD(r)),e===1/0))return 1/0}return e}function MD(t,e="",n){n!==!1&&(e=Cc(e));const r=t.parse(e);return DD(t,r)}xn.getFullPath=MD;function DD(t,e){return t.serialize(e).split("#")[0]+"#"}xn._getFullPath=DD;const Dye=/#\/?$/;function Cc(t){return t?t.replace(Dye,""):""}xn.normalizeId=Cc;function Nye(t,e,n){return n=Cc(n),t.resolve(e,n)}xn.resolveUrl=Nye;const jye=/^[a-z_][-a-z0-9._]*$/i;function zye(t,e){if(typeof t=="boolean")return{};const{schemaId:n,uriResolver:r}=this.opts,i=Cc(t[n]||e),s={"":i},o=MD(r,i,!1),a={},l=new Set;return $ye(t,{allKeys:!0},(d,h,f,p)=>{if(p===void 0)return;const m=o+h;let _=s[p];typeof d[n]=="string"&&(_=g.call(this,d[n])),y.call(this,d.$anchor),y.call(this,d.$dynamicAnchor),s[h]=_;function g(v){const w=this.opts.uriResolver.resolve;if(v=Cc(_?w(_,v):v),l.has(v))throw u(v);l.add(v);let x=this.refs[v];return typeof x=="string"&&(x=this.refs[x]),typeof x=="object"?c(d,x.schema,v):v!==Cc(m)&&(v[0]==="#"?(c(d,a[v],v),a[v]=d):this.refs[v]=m),v}function y(v){if(typeof v=="string"){if(!jye.test(v))throw new Error(`invalid anchor "${v}"`);g.call(this,`#${v}`)}}}),a;function c(d,h,f){if(h!==void 0&&!Oye(d,h))throw u(f)}function u(d){return new Error(`reference "${d}" resolves to more than one schema`)}}xn.getSchemaRefs=zye;Object.defineProperty(wi,"__esModule",{value:!0});wi.getData=wi.KeywordCxt=wi.validateFunctionCode=void 0;const ND=Zc,QR=qt,KS=Fs,ym=qt,Uye=a_,Ld=Gi,Q0=Mo,Ee=Le,Ie=ss,Gye=xn,Os=pe,ed=of;function Bye(t){if(UD(t)&&(GD(t),zD(t))){Hye(t);return}jD(t,()=>(0,ND.topBoolOrEmptySchema)(t))}wi.validateFunctionCode=Bye;function jD({gen:t,validateName:e,schema:n,schemaEnv:r,opts:i},s){i.code.es5?t.func(e,(0,Ee._)`${Ie.default.data}, ${Ie.default.valCxt}`,r.$async,()=>{t.code((0,Ee._)`"use strict"; ${eI(n,i)}`),Wye(t,i),t.code(s)}):t.func(e,(0,Ee._)`${Ie.default.data}, ${Vye(i)}`,r.$async,()=>t.code(eI(n,i)).code(s))}function Vye(t){return(0,Ee._)`{${Ie.default.instancePath}="", ${Ie.default.parentData}, ${Ie.default.parentDataProperty}, ${Ie.default.rootData}=${Ie.default.data}${t.dynamicRef?(0,Ee._)`, ${Ie.default.dynamicAnchors}={}`:Ee.nil}}={}`}function Wye(t,e){t.if(Ie.default.valCxt,()=>{t.var(Ie.default.instancePath,(0,Ee._)`${Ie.default.valCxt}.${Ie.default.instancePath}`),t.var(Ie.default.parentData,(0,Ee._)`${Ie.default.valCxt}.${Ie.default.parentData}`),t.var(Ie.default.parentDataProperty,(0,Ee._)`${Ie.default.valCxt}.${Ie.default.parentDataProperty}`),t.var(Ie.default.rootData,(0,Ee._)`${Ie.default.valCxt}.${Ie.default.rootData}`),e.dynamicRef&&t.var(Ie.default.dynamicAnchors,(0,Ee._)`${Ie.default.valCxt}.${Ie.default.dynamicAnchors}`)},()=>{t.var(Ie.default.instancePath,(0,Ee._)`""`),t.var(Ie.default.parentData,(0,Ee._)`undefined`),t.var(Ie.default.parentDataProperty,(0,Ee._)`undefined`),t.var(Ie.default.rootData,Ie.default.data),e.dynamicRef&&t.var(Ie.default.dynamicAnchors,(0,Ee._)`{}`)})}function Hye(t){const{schema:e,opts:n,gen:r}=t;jD(t,()=>{n.$comment&&e.$comment&&VD(t),qye(t),r.let(Ie.default.vErrors,null),r.let(Ie.default.errors,0),n.unevaluated&&Kye(t),BD(t),e_e(t)})}function Kye(t){const{gen:e,validateName:n}=t;t.evaluated=e.const("evaluated",(0,Ee._)`${n}.evaluated`),e.if((0,Ee._)`${t.evaluated}.dynamicProps`,()=>e.assign((0,Ee._)`${t.evaluated}.props`,(0,Ee._)`undefined`)),e.if((0,Ee._)`${t.evaluated}.dynamicItems`,()=>e.assign((0,Ee._)`${t.evaluated}.items`,(0,Ee._)`undefined`))}function eI(t,e){const n=typeof t=="object"&&t[e.schemaId];return n&&(e.code.source||e.code.process)?(0,Ee._)`/*# sourceURL=${n} */`:Ee.nil}function Yye(t,e){if(UD(t)&&(GD(t),zD(t))){Xye(t,e);return}(0,ND.boolOrEmptySchema)(t,e)}function zD({schema:t,self:e}){if(typeof t=="boolean")return!t;for(const n in t)if(e.RULES.all[n])return!0;return!1}function UD(t){return typeof t.schema!="boolean"}function Xye(t,e){const{schema:n,gen:r,opts:i}=t;i.$comment&&n.$comment&&VD(t),Jye(t),Qye(t);const s=r.const("_errs",Ie.default.errors);BD(t,s),r.var(e,(0,Ee._)`${s} === ${Ie.default.errors}`)}function GD(t){(0,Os.checkUnknownRules)(t),Zye(t)}function BD(t,e){if(t.opts.jtd)return tI(t,[],!1,e);const n=(0,QR.getSchemaTypes)(t.schema),r=(0,QR.coerceAndCheckDataType)(t,n);tI(t,n,!r,e)}function Zye(t){const{schema:e,errSchemaPath:n,opts:r,self:i}=t;e.$ref&&r.ignoreKeywordsWithRef&&(0,Os.schemaHasRulesButRef)(e,i.RULES)&&i.logger.warn(`$ref: keywords ignored in schema at path "${n}"`)}function qye(t){const{schema:e,opts:n}=t;e.default!==void 0&&n.useDefaults&&n.strictSchema&&(0,Os.checkStrictMode)(t,"default is ignored in the schema root")}function Jye(t){const e=t.schema[t.opts.schemaId];e&&(t.baseId=(0,Gye.resolveUrl)(t.opts.uriResolver,t.baseId,e))}function Qye(t){if(t.schema.$async&&!t.schemaEnv.$async)throw new Error("async schema in sync schema")}function VD({gen:t,schemaEnv:e,schema:n,errSchemaPath:r,opts:i}){const s=n.$comment;if(i.$comment===!0)t.code((0,Ee._)`${Ie.default.self}.logger.log(${s})`);else if(typeof i.$comment=="function"){const o=(0,Ee.str)`${r}/$comment`,a=t.scopeValue("root",{ref:e.root});t.code((0,Ee._)`${Ie.default.self}.opts.$comment(${s}, ${o}, ${a}.schema)`)}}function e_e(t){const{gen:e,schemaEnv:n,validateName:r,ValidationError:i,opts:s}=t;n.$async?e.if((0,Ee._)`${Ie.default.errors} === 0`,()=>e.return(Ie.default.data),()=>e.throw((0,Ee._)`new ${i}(${Ie.default.vErrors})`)):(e.assign((0,Ee._)`${r}.errors`,Ie.default.vErrors),s.unevaluated&&t_e(t),e.return((0,Ee._)`${Ie.default.errors} === 0`))}function t_e({gen:t,evaluated:e,props:n,items:r}){n instanceof Ee.Name&&t.assign((0,Ee._)`${e}.props`,n),r instanceof Ee.Name&&t.assign((0,Ee._)`${e}.items`,r)}function tI(t,e,n,r){const{gen:i,schema:s,data:o,allErrors:a,opts:l,self:c}=t,{RULES:u}=c;if(s.$ref&&(l.ignoreKeywordsWithRef||!(0,Os.schemaHasRulesButRef)(s,u))){i.block(()=>KD(t,"$ref",u.all.$ref.definition));return}l.jtd||n_e(t,e),i.block(()=>{for(const h of u.rules)d(h);d(u.post)});function d(h){(0,KS.shouldUseGroup)(s,h)&&(h.type?(i.if((0,ym.checkDataType)(h.type,o,l.strictNumbers)),nI(t,h),e.length===1&&e[0]===h.type&&n&&(i.else(),(0,ym.reportTypeError)(t)),i.endIf()):nI(t,h),a||i.if((0,Ee._)`${Ie.default.errors} === ${r||0}`))}}function nI(t,e){const{gen:n,schema:r,opts:{useDefaults:i}}=t;i&&(0,Uye.assignDefaults)(t,e.type),n.block(()=>{for(const s of e.rules)(0,KS.shouldUseRule)(r,s)&&KD(t,s.keyword,s.definition,e.type)})}function n_e(t,e){t.schemaEnv.meta||!t.opts.strictTypes||(r_e(t,e),t.opts.allowUnionTypes||i_e(t,e),s_e(t,t.dataTypes))}function r_e(t,e){if(e.length){if(!t.dataTypes.length){t.dataTypes=e;return}e.forEach(n=>{WD(t.dataTypes,n)||YS(t,`type "${n}" not allowed by context "${t.dataTypes.join(",")}"`)}),a_e(t,e)}}function i_e(t,e){e.length>1&&!(e.length===2&&e.includes("null"))&&YS(t,"use allowUnionTypes to allow union type keyword")}function s_e(t,e){const n=t.self.RULES.all;for(const r in n){const i=n[r];if(typeof i=="object"&&(0,KS.shouldUseRule)(t.schema,i)){const{type:s}=i.definition;s.length&&!s.some(o=>o_e(e,o))&&YS(t,`missing type "${s.join(",")}" for keyword "${r}"`)}}}function o_e(t,e){return t.includes(e)||e==="number"&&t.includes("integer")}function WD(t,e){return t.includes(e)||e==="integer"&&t.includes("number")}function a_e(t,e){const n=[];for(const r of t.dataTypes)WD(e,r)?n.push(r):e.includes("integer")&&r==="number"&&n.push("integer");t.dataTypes=n}function YS(t,e){const n=t.schemaEnv.baseId+t.errSchemaPath;e+=` at "${n}" (strictTypes)`,(0,Os.checkStrictMode)(t,e,t.opts.strictTypes)}class HD{constructor(e,n,r){if((0,Ld.validateKeywordUsage)(e,n,r),this.gen=e.gen,this.allErrors=e.allErrors,this.keyword=r,this.data=e.data,this.schema=e.schema[r],this.$data=n.$data&&e.opts.$data&&this.schema&&this.schema.$data,this.schemaValue=(0,Os.schemaRefOrVal)(e,this.schema,r,this.$data),this.schemaType=n.schemaType,this.parentSchema=e.schema,this.params={},this.it=e,this.def=n,this.$data)this.schemaCode=e.gen.const("vSchema",YD(this.$data,e));else if(this.schemaCode=this.schemaValue,!(0,Ld.validSchemaType)(this.schema,n.schemaType,n.allowUndefined))throw new Error(`${r} value must be ${JSON.stringify(n.schemaType)}`);("code"in n?n.trackErrors:n.errors!==!1)&&(this.errsCount=e.gen.const("_errs",Ie.default.errors))}result(e,n,r){this.failResult((0,Ee.not)(e),n,r)}failResult(e,n,r){this.gen.if(e),r?r():this.error(),n?(this.gen.else(),n(),this.allErrors&&this.gen.endIf()):this.allErrors?this.gen.endIf():this.gen.else()}pass(e,n){this.failResult((0,Ee.not)(e),void 0,n)}fail(e){if(e===void 0){this.error(),this.allErrors||this.gen.if(!1);return}this.gen.if(e),this.error(),this.allErrors?this.gen.endIf():this.gen.else()}fail$data(e){if(!this.$data)return this.fail(e);const{schemaCode:n}=this;this.fail((0,Ee._)`${n} !== undefined && (${(0,Ee.or)(this.invalid$data(),e)})`)}error(e,n,r){if(n){this.setParams(n),this._error(e,r),this.setParams({});return}this._error(e,r)}_error(e,n){(e?ed.reportExtraError:ed.reportError)(this,this.def.error,n)}$dataError(){(0,ed.reportError)(this,this.def.$dataError||ed.keyword$DataError)}reset(){if(this.errsCount===void 0)throw new Error('add "trackErrors" to keyword definition');(0,ed.resetErrorsCount)(this.gen,this.errsCount)}ok(e){this.allErrors||this.gen.if(e)}setParams(e,n){n?Object.assign(this.params,e):this.params=e}block$data(e,n,r=Ee.nil){this.gen.block(()=>{this.check$data(e,r),n()})}check$data(e=Ee.nil,n=Ee.nil){if(!this.$data)return;const{gen:r,schemaCode:i,schemaType:s,def:o}=this;r.if((0,Ee.or)((0,Ee._)`${i} === undefined`,n)),e!==Ee.nil&&r.assign(e,!0),(s.length||o.validateSchema)&&(r.elseIf(this.invalid$data()),this.$dataError(),e!==Ee.nil&&r.assign(e,!1)),r.else()}invalid$data(){const{gen:e,schemaCode:n,schemaType:r,def:i,it:s}=this;return(0,Ee.or)(o(),a());function o(){if(r.length){if(!(n instanceof Ee.Name))throw new Error("ajv implementation error");const l=Array.isArray(r)?r:[r];return(0,Ee._)`${(0,ym.checkDataTypes)(l,n,s.opts.strictNumbers,ym.DataType.Wrong)}`}return Ee.nil}function a(){if(i.validateSchema){const l=e.scopeValue("validate$data",{ref:i.validateSchema});return(0,Ee._)`!${l}(${n})`}return Ee.nil}}subschema(e,n){const r=(0,Q0.getSubschema)(this.it,e);(0,Q0.extendSubschemaData)(r,this.it,e),(0,Q0.extendSubschemaMode)(r,e);const i={...this.it,...r,items:void 0,props:void 0};return Yye(i,n),i}mergeEvaluated(e,n){const{it:r,gen:i}=this;r.opts.unevaluated&&(r.props!==!0&&e.props!==void 0&&(r.props=Os.mergeEvaluated.props(i,e.props,r.props,n)),r.items!==!0&&e.items!==void 0&&(r.items=Os.mergeEvaluated.items(i,e.items,r.items,n)))}mergeValidEvaluated(e,n){const{it:r,gen:i}=this;if(r.opts.unevaluated&&(r.props!==!0||r.items!==!0))return i.if(n,()=>this.mergeEvaluated(e,Ee.Name)),!0}}wi.KeywordCxt=HD;function KD(t,e,n,r){const i=new HD(t,n,e);"code"in n?n.code(i,r):i.$data&&n.validate?(0,Ld.funcKeywordCode)(i,n):"macro"in n?(0,Ld.macroKeywordCode)(i,n):(n.compile||n.validate)&&(0,Ld.funcKeywordCode)(i,n)}const l_e=/^\/(?:[^~]|~0|~1)*$/,c_e=/^([0-9]+)(#|\/(?:[^~]|~0|~1)*)?$/;function YD(t,{dataLevel:e,dataNames:n,dataPathArr:r}){let i,s;if(t==="")return Ie.default.rootData;if(t[0]==="/"){if(!l_e.test(t))throw new Error(`Invalid JSON-pointer: ${t}`);i=t,s=Ie.default.rootData}else{const c=c_e.exec(t);if(!c)throw new Error(`Invalid JSON-pointer: ${t}`);const u=+c[1];if(i=c[2],i==="#"){if(u>=e)throw new Error(l("property/index",u));return r[e-u]}if(u>e)throw new Error(l("data",u));if(s=n[e-u],!i)return s}let o=s;const a=i.split("/");for(const c of a)c&&(s=(0,Ee._)`${s}${(0,Ee.getProperty)((0,Os.unescapeJsonPointer)(c))}`,o=(0,Ee._)`${o} && ${s}`);return o;function l(c,u){return`Cannot access ${c} ${u} levels up, current level is ${e}`}}wi.getData=YD;var af={};Object.defineProperty(af,"__esModule",{value:!0});class u_e extends Error{constructor(e){super("validation failed"),this.errors=e,this.ajv=this.validation=!0}}af.default=u_e;var Cu={};Object.defineProperty(Cu,"__esModule",{value:!0});const ev=xn;class d_e extends Error{constructor(e,n,r,i){super(i||`can't resolve reference ${r} from id ${n}`),this.missingRef=(0,ev.resolveUrl)(e,n,r),this.missingSchema=(0,ev.normalizeId)((0,ev.getFullPath)(e,this.missingRef))}}Cu.default=d_e;var tr={};Object.defineProperty(tr,"__esModule",{value:!0});tr.resolveSchema=tr.getCompilingSchema=tr.resolveRef=tr.compileSchema=tr.SchemaEnv=void 0;const ii=Le,h_e=af,ca=ss,hi=xn,rI=pe,f_e=wi;class l_{constructor(e){var n;this.refs={},this.dynamicAnchors={};let r;typeof e.schema=="object"&&(r=e.schema),this.schema=e.schema,this.schemaId=e.schemaId,this.root=e.root||this,this.baseId=(n=e.baseId)!==null&&n!==void 0?n:(0,hi.normalizeId)(r==null?void 0:r[e.schemaId||"$id"]),this.schemaPath=e.schemaPath,this.localRefs=e.localRefs,this.meta=e.meta,this.$async=r==null?void 0:r.$async,this.refs={}}}tr.SchemaEnv=l_;function XS(t){const e=XD.call(this,t);if(e)return e;const n=(0,hi.getFullPath)(this.opts.uriResolver,t.root.baseId),{es5:r,lines:i}=this.opts.code,{ownProperties:s}=this.opts,o=new ii.CodeGen(this.scope,{es5:r,lines:i,ownProperties:s});let a;t.$async&&(a=o.scopeValue("Error",{ref:h_e.default,code:(0,ii._)`require("ajv/dist/runtime/validation_error").default`}));const l=o.scopeName("validate");t.validateName=l;const c={gen:o,allErrors:this.opts.allErrors,data:ca.default.data,parentData:ca.default.parentData,parentDataProperty:ca.default.parentDataProperty,dataNames:[ca.default.data],dataPathArr:[ii.nil],dataLevel:0,dataTypes:[],definedProperties:new Set,topSchemaRef:o.scopeValue("schema",this.opts.code.source===!0?{ref:t.schema,code:(0,ii.stringify)(t.schema)}:{ref:t.schema}),validateName:l,ValidationError:a,schema:t.schema,schemaEnv:t,rootId:n,baseId:t.baseId||n,schemaPath:ii.nil,errSchemaPath:t.schemaPath||(this.opts.jtd?"":"#"),errorPath:(0,ii._)`""`,opts:this.opts,self:this};let u;try{this._compilations.add(t),(0,f_e.validateFunctionCode)(c),o.optimize(this.opts.code.optimize);const d=o.toString();u=`${o.scopeRefs(ca.default.scope)}return ${d}`,this.opts.code.process&&(u=this.opts.code.process(u,t));const f=new Function(`${ca.default.self}`,`${ca.default.scope}`,u)(this,this.scope.get());if(this.scope.value(l,{ref:f}),f.errors=null,f.schema=t.schema,f.schemaEnv=t,t.$async&&(f.$async=!0),this.opts.code.source===!0&&(f.source={validateName:l,validateCode:d,scopeValues:o._values}),this.opts.unevaluated){const{props:p,items:m}=c;f.evaluated={props:p instanceof ii.Name?void 0:p,items:m instanceof ii.Name?void 0:m,dynamicProps:p instanceof ii.Name,dynamicItems:m instanceof ii.Name},f.source&&(f.source.evaluated=(0,ii.stringify)(f.evaluated))}return t.validate=f,t}catch(d){throw delete t.validate,delete t.validateName,u&&this.logger.error("Error compiling schema, function code:",u),d}finally{this._compilations.delete(t)}}tr.compileSchema=XS;function g_e(t,e,n){var r;n=(0,hi.resolveUrl)(this.opts.uriResolver,e,n);const i=t.refs[n];if(i)return i;let s=y_e.call(this,t,n);if(s===void 0){const o=(r=t.localRefs)===null||r===void 0?void 0:r[n],{schemaId:a}=this.opts;o&&(s=new l_({schema:o,schemaId:a,root:t,baseId:e}))}if(s!==void 0)return t.refs[n]=p_e.call(this,s)}tr.resolveRef=g_e;function p_e(t){return(0,hi.inlineRef)(t.schema,this.opts.inlineRefs)?t.schema:t.validate?t:XS.call(this,t)}function XD(t){for(const e of this._compilations)if(m_e(e,t))return e}tr.getCompilingSchema=XD;function m_e(t,e){return t.schema===e.schema&&t.root===e.root&&t.baseId===e.baseId}function y_e(t,e){let n;for(;typeof(n=this.refs[e])=="string";)e=n;return n||this.schemas[e]||c_.call(this,t,e)}function c_(t,e){const n=this.opts.uriResolver.parse(e),r=(0,hi._getFullPath)(this.opts.uriResolver,n);let i=(0,hi.getFullPath)(this.opts.uriResolver,t.baseId,void 0);if(Object.keys(t.schema).length>0&&r===i)return tv.call(this,n,t);const s=(0,hi.normalizeId)(r),o=this.refs[s]||this.schemas[s];if(typeof o=="string"){const a=c_.call(this,t,o);return typeof(a==null?void 0:a.schema)!="object"?void 0:tv.call(this,n,a)}if(typeof(o==null?void 0:o.schema)=="object"){if(o.validate||XS.call(this,o),s===(0,hi.normalizeId)(e)){const{schema:a}=o,{schemaId:l}=this.opts,c=a[l];return c&&(i=(0,hi.resolveUrl)(this.opts.uriResolver,i,c)),new l_({schema:a,schemaId:l,root:t,baseId:i})}return tv.call(this,n,o)}}tr.resolveSchema=c_;const __e=new Set(["properties","patternProperties","enum","dependencies","definitions"]);function tv(t,{baseId:e,schema:n,root:r}){var i;if(((i=t.fragment)===null||i===void 0?void 0:i[0])!=="/")return;for(const a of t.fragment.slice(1).split("/")){if(typeof n=="boolean")return;const l=n[(0,rI.unescapeFragment)(a)];if(l===void 0)return;n=l;const c=typeof n=="object"&&n[this.opts.schemaId];!__e.has(a)&&c&&(e=(0,hi.resolveUrl)(this.opts.uriResolver,e,c))}let s;if(typeof n!="boolean"&&n.$ref&&!(0,rI.schemaHasRulesButRef)(n,this.RULES)){const a=(0,hi.resolveUrl)(this.opts.uriResolver,e,n.$ref);s=c_.call(this,r,a)}const{schemaId:o}=this.opts;if(s=s||new l_({schema:n,schemaId:o,root:r,baseId:e}),s.schema!==s.root.schema)return s}const v_e="https://raw.githubusercontent.com/ajv-validator/ajv/master/lib/refs/data.json#",w_e="Meta-schema for $data reference (JSON AnySchema extension proposal)",x_e="object",E_e=["$data"],S_e={$data:{type:"string",anyOf:[{format:"relative-json-pointer"},{format:"json-pointer"}]}},b_e=!1,C_e={$id:v_e,description:w_e,type:x_e,required:E_e,properties:S_e,additionalProperties:b_e};var ZS={},u_={exports:{}};const T_e=RegExp.prototype.test.bind(/^[\da-f]{8}-[\da-f]{4}-[\da-f]{4}-[\da-f]{4}-[\da-f]{12}$/iu),ZD=RegExp.prototype.test.bind(/^(?:(?:25[0-5]|2[0-4]\d|1\d{2}|[1-9]\d|\d)\.){3}(?:25[0-5]|2[0-4]\d|1\d{2}|[1-9]\d|\d)$/u);function qD(t){let e="",n=0,r=0;for(r=0;r<t.length;r++)if(n=t[r].charCodeAt(0),n!==48){if(!(n>=48&&n<=57||n>=65&&n<=70||n>=97&&n<=102))return"";e+=t[r];break}for(r+=1;r<t.length;r++){if(n=t[r].charCodeAt(0),!(n>=48&&n<=57||n>=65&&n<=70||n>=97&&n<=102))return"";e+=t[r]}return e}const P_e=RegExp.prototype.test.bind(/[^!"$&'()*+,\-.;=_`a-z{}~]/u);function iI(t){return t.length=0,!0}function R_e(t,e,n){if(t.length){const r=qD(t);if(r!=="")e.push(r);else return n.error=!0,!1;t.length=0}return!0}function I_e(t){let e=0;const n={error:!1,address:"",zone:""},r=[],i=[];let s=!1,o=!1,a=R_e;for(let l=0;l<t.length;l++){const c=t[l];if(!(c==="["||c==="]"))if(c===":"){if(s===!0&&(o=!0),!a(i,r,n))break;if(++e>7){n.error=!0;break}l>0&&t[l-1]===":"&&(s=!0),r.push(":");continue}else if(c==="%"){if(!a(i,r,n))break;a=iI}else{i.push(c);continue}}return i.length&&(a===iI?n.zone=i.join(""):o?r.push(i.join("")):r.push(qD(i))),n.address=r.join(""),n}function JD(t){if(A_e(t,":")<2)return{host:t,isIPV6:!1};const e=I_e(t);if(e.error)return{host:t,isIPV6:!1};{let n=e.address,r=e.address;return e.zone&&(n+="%"+e.zone,r+="%25"+e.zone),{host:n,isIPV6:!0,escapedHost:r}}}function A_e(t,e){let n=0;for(let r=0;r<t.length;r++)t[r]===e&&n++;return n}function F_e(t){let e=t;const n=[];let r=-1,i=0;for(;i=e.length;){if(i===1){if(e===".")break;if(e==="/"){n.push("/");break}else{n.push(e);break}}else if(i===2){if(e[0]==="."){if(e[1]===".")break;if(e[1]==="/"){e=e.slice(2);continue}}else if(e[0]==="/"&&(e[1]==="."||e[1]==="/")){n.push("/");break}}else if(i===3&&e==="/.."){n.length!==0&&n.pop(),n.push("/");break}if(e[0]==="."){if(e[1]==="."){if(e[2]==="/"){e=e.slice(3);continue}}else if(e[1]==="/"){e=e.slice(2);continue}}else if(e[0]==="/"&&e[1]==="."){if(e[2]==="/"){e=e.slice(2);continue}else if(e[2]==="."&&e[3]==="/"){e=e.slice(3),n.length!==0&&n.pop();continue}}if((r=e.indexOf("/",1))===-1){n.push(e);break}else n.push(e.slice(0,r)),e=e.slice(r)}return n.join("")}function O_e(t,e){const n=e!==!0?escape:unescape;return t.scheme!==void 0&&(t.scheme=n(t.scheme)),t.userinfo!==void 0&&(t.userinfo=n(t.userinfo)),t.host!==void 0&&(t.host=n(t.host)),t.path!==void 0&&(t.path=n(t.path)),t.query!==void 0&&(t.query=n(t.query)),t.fragment!==void 0&&(t.fragment=n(t.fragment)),t}function $_e(t){const e=[];if(t.userinfo!==void 0&&(e.push(t.userinfo),e.push("@")),t.host!==void 0){let n=unescape(t.host);if(!ZD(n)){const r=JD(n);r.isIPV6===!0?n=`[${r.escapedHost}]`:n=t.host}e.push(n)}return(typeof t.port=="number"||typeof t.port=="string")&&(e.push(":"),e.push(String(t.port))),e.length?e.join(""):void 0}var QD={nonSimpleDomain:P_e,recomposeAuthority:$_e,normalizeComponentEncoding:O_e,removeDotSegments:F_e,isIPv4:ZD,isUUID:T_e,normalizeIPv6:JD};const{isUUID:L_e}=QD,k_e=/([\da-z][\d\-a-z]{0,31}):((?:[\w!$'()*+,\-.:;=@]|%[\da-f]{2})+)/iu;function eN(t){return t.secure===!0?!0:t.secure===!1?!1:t.scheme?t.scheme.length===3&&(t.scheme[0]==="w"||t.scheme[0]==="W")&&(t.scheme[1]==="s"||t.scheme[1]==="S")&&(t.scheme[2]==="s"||t.scheme[2]==="S"):!1}function tN(t){return t.host||(t.error=t.error||"HTTP URIs must have a host."),t}function nN(t){const e=String(t.scheme).toLowerCase()==="https";return(t.port===(e?443:80)||t.port==="")&&(t.port=void 0),t.path||(t.path="/"),t}function M_e(t){return t.secure=eN(t),t.resourceName=(t.path||"/")+(t.query?"?"+t.query:""),t.path=void 0,t.query=void 0,t}function D_e(t){if((t.port===(eN(t)?443:80)||t.port==="")&&(t.port=void 0),typeof t.secure=="boolean"&&(t.scheme=t.secure?"wss":"ws",t.secure=void 0),t.resourceName){const[e,n]=t.resourceName.split("?");t.path=e&&e!=="/"?e:void 0,t.query=n,t.resourceName=void 0}return t.fragment=void 0,t}function N_e(t,e){if(!t.path)return t.error="URN can not be parsed",t;const n=t.path.match(k_e);if(n){const r=e.scheme||t.scheme||"urn";t.nid=n[1].toLowerCase(),t.nss=n[2];const i=`${r}:${e.nid||t.nid}`,s=qS(i);t.path=void 0,s&&(t=s.parse(t,e))}else t.error=t.error||"URN can not be parsed.";return t}function j_e(t,e){if(t.nid===void 0)throw new Error("URN without nid cannot be serialized");const n=e.scheme||t.scheme||"urn",r=t.nid.toLowerCase(),i=`${n}:${e.nid||r}`,s=qS(i);s&&(t=s.serialize(t,e));const o=t,a=t.nss;return o.path=`${r||e.nid}:${a}`,e.skipEscape=!0,o}function z_e(t,e){const n=t;return n.uuid=n.nss,n.nss=void 0,!e.tolerant&&(!n.uuid||!L_e(n.uuid))&&(n.error=n.error||"UUID is not valid."),n}function U_e(t){const e=t;return e.nss=(t.uuid||"").toLowerCase(),e}const rN={scheme:"http",domainHost:!0,parse:tN,serialize:nN},G_e={scheme:"https",domainHost:rN.domainHost,parse:tN,serialize:nN},Xg={scheme:"ws",domainHost:!0,parse:M_e,serialize:D_e},B_e={scheme:"wss",domainHost:Xg.domainHost,parse:Xg.parse,serialize:Xg.serialize},V_e={scheme:"urn",parse:N_e,serialize:j_e,skipNormalize:!0},W_e={scheme:"urn:uuid",parse:z_e,serialize:U_e,skipNormalize:!0},_m={http:rN,https:G_e,ws:Xg,wss:B_e,urn:V_e,"urn:uuid":W_e};Object.setPrototypeOf(_m,null);function qS(t){return t&&(_m[t]||_m[t.toLowerCase()])||void 0}var H_e={SCHEMES:_m,getSchemeHandler:qS};const{normalizeIPv6:K_e,removeDotSegments:ud,recomposeAuthority:Y_e,normalizeComponentEncoding:ug,isIPv4:X_e,nonSimpleDomain:Z_e}=QD,{SCHEMES:q_e,getSchemeHandler:iN}=H_e;function J_e(t,e){return typeof t=="string"?t=Bi(Us(t,e),e):typeof t=="object"&&(t=Us(Bi(t,e),e)),t}function Q_e(t,e,n){const r=n?Object.assign({scheme:"null"},n):{scheme:"null"},i=sN(Us(t,r),Us(e,r),r,!0);return r.skipEscape=!0,Bi(i,r)}function sN(t,e,n,r){const i={};return r||(t=Us(Bi(t,n),n),e=Us(Bi(e,n),n)),n=n||{},!n.tolerant&&e.scheme?(i.scheme=e.scheme,i.userinfo=e.userinfo,i.host=e.host,i.port=e.port,i.path=ud(e.path||""),i.query=e.query):(e.userinfo!==void 0||e.host!==void 0||e.port!==void 0?(i.userinfo=e.userinfo,i.host=e.host,i.port=e.port,i.path=ud(e.path||""),i.query=e.query):(e.path?(e.path[0]==="/"?i.path=ud(e.path):((t.userinfo!==void 0||t.host!==void 0||t.port!==void 0)&&!t.path?i.path="/"+e.path:t.path?i.path=t.path.slice(0,t.path.lastIndexOf("/")+1)+e.path:i.path=e.path,i.path=ud(i.path)),i.query=e.query):(i.path=t.path,e.query!==void 0?i.query=e.query:i.query=t.query),i.userinfo=t.userinfo,i.host=t.host,i.port=t.port),i.scheme=t.scheme),i.fragment=e.fragment,i}function e0e(t,e,n){return typeof t=="string"?(t=unescape(t),t=Bi(ug(Us(t,n),!0),{...n,skipEscape:!0})):typeof t=="object"&&(t=Bi(ug(t,!0),{...n,skipEscape:!0})),typeof e=="string"?(e=unescape(e),e=Bi(ug(Us(e,n),!0),{...n,skipEscape:!0})):typeof e=="object"&&(e=Bi(ug(e,!0),{...n,skipEscape:!0})),t.toLowerCase()===e.toLowerCase()}function Bi(t,e){const n={host:t.host,scheme:t.scheme,userinfo:t.userinfo,port:t.port,path:t.path,query:t.query,nid:t.nid,nss:t.nss,uuid:t.uuid,fragment:t.fragment,reference:t.reference,resourceName:t.resourceName,secure:t.secure,error:""},r=Object.assign({},e),i=[],s=iN(r.scheme||n.scheme);s&&s.serialize&&s.serialize(n,r),n.path!==void 0&&(r.skipEscape?n.path=unescape(n.path):(n.path=escape(n.path),n.scheme!==void 0&&(n.path=n.path.split("%3A").join(":")))),r.reference!=="suffix"&&n.scheme&&i.push(n.scheme,":");const o=Y_e(n);if(o!==void 0&&(r.reference!=="suffix"&&i.push("//"),i.push(o),n.path&&n.path[0]!=="/"&&i.push("/")),n.path!==void 0){let a=n.path;!r.absolutePath&&(!s||!s.absolutePath)&&(a=ud(a)),o===void 0&&a[0]==="/"&&a[1]==="/"&&(a="/%2F"+a.slice(2)),i.push(a)}return n.query!==void 0&&i.push("?",n.query),n.fragment!==void 0&&i.push("#",n.fragment),i.join("")}const t0e=/^(?:([^#/:?]+):)?(?:\/\/((?:([^#/?@]*)@)?(\[[^#/?\]]+\]|[^#/:?]*)(?::(\d*))?))?([^#?]*)(?:\?([^#]*))?(?:#((?:.|[\n\r])*))?/u;function Us(t,e){const n=Object.assign({},e),r={scheme:void 0,userinfo:void 0,host:"",port:void 0,path:"",query:void 0,fragment:void 0};let i=!1;n.reference==="suffix"&&(n.scheme?t=n.scheme+":"+t:t="//"+t);const s=t.match(t0e);if(s){if(r.scheme=s[1],r.userinfo=s[3],r.host=s[4],r.port=parseInt(s[5],10),r.path=s[6]||"",r.query=s[7],r.fragment=s[8],isNaN(r.port)&&(r.port=s[5]),r.host)if(X_e(r.host)===!1){const l=K_e(r.host);r.host=l.host.toLowerCase(),i=l.isIPV6}else i=!0;r.scheme===void 0&&r.userinfo===void 0&&r.host===void 0&&r.port===void 0&&r.query===void 0&&!r.path?r.reference="same-document":r.scheme===void 0?r.reference="relative":r.fragment===void 0?r.reference="absolute":r.reference="uri",n.reference&&n.reference!=="suffix"&&n.reference!==r.reference&&(r.error=r.error||"URI is not a "+n.reference+" reference.");const o=iN(n.scheme||r.scheme);if(!n.unicodeSupport&&(!o||!o.unicodeSupport)&&r.host&&(n.domainHost||o&&o.domainHost)&&i===!1&&Z_e(r.host))try{r.host=URL.domainToASCII(r.host.toLowerCase())}catch(a){r.error=r.error||"Host's domain name can not be converted to ASCII: "+a}(!o||o&&!o.skipNormalize)&&(t.indexOf("%")!==-1&&(r.scheme!==void 0&&(r.scheme=unescape(r.scheme)),r.host!==void 0&&(r.host=unescape(r.host))),r.path&&(r.path=escape(unescape(r.path))),r.fragment&&(r.fragment=encodeURI(decodeURIComponent(r.fragment)))),o&&o.parse&&o.parse(r,n)}else r.error=r.error||"URI can not be parsed.";return r}const JS={SCHEMES:q_e,normalize:J_e,resolve:Q_e,resolveComponent:sN,equal:e0e,serialize:Bi,parse:Us};u_.exports=JS;u_.exports.default=JS;u_.exports.fastUri=JS;var n0e=u_.exports;Object.defineProperty(ZS,"__esModule",{value:!0});const oN=n0e;oN.code='require("ajv/dist/runtime/uri").default';ZS.default=oN;(function(t){Object.defineProperty(t,"__esModule",{value:!0}),t.CodeGen=t.Name=t.nil=t.stringify=t.str=t._=t.KeywordCxt=void 0;var e=wi;Object.defineProperty(t,"KeywordCxt",{enumerable:!0,get:function(){return e.KeywordCxt}});var n=Le;Object.defineProperty(t,"_",{enumerable:!0,get:function(){return n._}}),Object.defineProperty(t,"str",{enumerable:!0,get:function(){return n.str}}),Object.defineProperty(t,"stringify",{enumerable:!0,get:function(){return n.stringify}}),Object.defineProperty(t,"nil",{enumerable:!0,get:function(){return n.nil}}),Object.defineProperty(t,"Name",{enumerable:!0,get:function(){return n.Name}}),Object.defineProperty(t,"CodeGen",{enumerable:!0,get:function(){return n.CodeGen}});const r=af,i=Cu,s=Ka,o=tr,a=Le,l=xn,c=qt,u=pe,d=C_e,h=ZS,f=(N,O)=>new RegExp(N,O);f.code="new RegExp";const p=["removeAdditional","useDefaults","coerceTypes"],m=new Set(["validate","serialize","parse","wrapper","root","schema","keyword","pattern","formats","validate$data","func","obj","Error"]),_={errorDataPath:"",format:"`validateFormats: false` can be used instead.",nullable:'"nullable" keyword is supported by default.',jsonPointers:"Deprecated jsPropertySyntax can be used instead.",extendRefs:"Deprecated ignoreKeywordsWithRef can be used instead.",missingRefs:"Pass empty schema with $id that should be ignored to ajv.addSchema.",processCode:"Use option `code: {process: (code, schemaEnv: object) => string}`",sourceCode:"Use option `code: {source: true}`",strictDefaults:"It is default now, see option `strict`.",strictKeywords:"It is default now, see option `strict`.",uniqueItems:'"uniqueItems" keyword is always validated.',unknownFormats:"Disable strict mode or pass `true` to `ajv.addFormat` (or `formats` option).",cache:"Map is used as cache, schema object as key.",serialize:"Map is used as cache, schema object as key.",ajvErrors:"It is default now."},g={ignoreKeywordsWithRef:"",jsPropertySyntax:"",unicode:'"minLength"/"maxLength" account for unicode characters by default.'},y=200;function v(N){var O,$,G,R,L,W,te,ee,ce,ge,Ce,_t,vt,I,Q,J,z,D,Y,ne,re,X,ie,he,le;const ve=N.strict,Ge=(O=N.code)===null||O===void 0?void 0:O.optimize,ke=Ge===!0||Ge===void 0?1:Ge||0,sn=(G=($=N.code)===null||$===void 0?void 0:$.regExp)!==null&&G!==void 0?G:f,Pi=(R=N.uriResolver)!==null&&R!==void 0?R:h.default;return{strictSchema:(W=(L=N.strictSchema)!==null&&L!==void 0?L:ve)!==null&&W!==void 0?W:!0,strictNumbers:(ee=(te=N.strictNumbers)!==null&&te!==void 0?te:ve)!==null&&ee!==void 0?ee:!0,strictTypes:(ge=(ce=N.strictTypes)!==null&&ce!==void 0?ce:ve)!==null&&ge!==void 0?ge:"log",strictTuples:(_t=(Ce=N.strictTuples)!==null&&Ce!==void 0?Ce:ve)!==null&&_t!==void 0?_t:"log",strictRequired:(I=(vt=N.strictRequired)!==null&&vt!==void 0?vt:ve)!==null&&I!==void 0?I:!1,code:N.code?{...N.code,optimize:ke,regExp:sn}:{optimize:ke,regExp:sn},loopRequired:(Q=N.loopRequired)!==null&&Q!==void 0?Q:y,loopEnum:(J=N.loopEnum)!==null&&J!==void 0?J:y,meta:(z=N.meta)!==null&&z!==void 0?z:!0,messages:(D=N.messages)!==null&&D!==void 0?D:!0,inlineRefs:(Y=N.inlineRefs)!==null&&Y!==void 0?Y:!0,schemaId:(ne=N.schemaId)!==null&&ne!==void 0?ne:"$id",addUsedSchema:(re=N.addUsedSchema)!==null&&re!==void 0?re:!0,validateSchema:(X=N.validateSchema)!==null&&X!==void 0?X:!0,validateFormats:(ie=N.validateFormats)!==null&&ie!==void 0?ie:!0,unicodeRegExp:(he=N.unicodeRegExp)!==null&&he!==void 0?he:!0,int32range:(le=N.int32range)!==null&&le!==void 0?le:!0,uriResolver:Pi}}class w{constructor(O={}){this.schemas={},this.refs={},this.formats={},this._compilations=new Set,this._loading={},this._cache=new Map,O=this.opts={...O,...v(O)};const{es5:$,lines:G}=this.opts.code;this.scope=new a.ValueScope({scope:{},prefixes:m,es5:$,lines:G}),this.logger=A(O.logger);const R=O.validateFormats;O.validateFormats=!1,this.RULES=(0,s.getRules)(),x.call(this,_,O,"NOT SUPPORTED"),x.call(this,g,O,"DEPRECATED","warn"),this._metaOpts=F.call(this),O.formats&&T.call(this),this._addVocabularies(),this._addDefaultMetaSchema(),O.keywords&&P.call(this,O.keywords),typeof O.meta=="object"&&this.addMetaSchema(O.meta),C.call(this),O.validateFormats=R}_addVocabularies(){this.addKeyword("$async")}_addDefaultMetaSchema(){const{$data:O,meta:$,schemaId:G}=this.opts;let R=d;G==="id"&&(R={...d},R.id=R.$id,delete R.$id),$&&O&&this.addMetaSchema(R,R[G],!1)}defaultMeta(){const{meta:O,schemaId:$}=this.opts;return this.opts.defaultMeta=typeof O=="object"?O[$]||O:void 0}validate(O,$){let G;if(typeof O=="string"){if(G=this.getSchema(O),!G)throw new Error(`no schema with key or ref "${O}"`)}else G=this.compile(O);const R=G($);return"$async"in G||(this.errors=G.errors),R}compile(O,$){const G=this._addSchema(O,$);return G.validate||this._compileSchemaEnv(G)}compileAsync(O,$){if(typeof this.opts.loadSchema!="function")throw new Error("options.loadSchema should be a function");const{loadSchema:G}=this.opts;return R.call(this,O,$);async function R(ge,Ce){await L.call(this,ge.$schema);const _t=this._addSchema(ge,Ce);return _t.validate||W.call(this,_t)}async function L(ge){ge&&!this.getSchema(ge)&&await R.call(this,{$ref:ge},!0)}async function W(ge){try{return this._compileSchemaEnv(ge)}catch(Ce){if(!(Ce instanceof i.default))throw Ce;return te.call(this,Ce),await ee.call(this,Ce.missingSchema),W.call(this,ge)}}function te({missingSchema:ge,missingRef:Ce}){if(this.refs[ge])throw new Error(`AnySchema ${ge} is loaded but ${Ce} cannot be resolved`)}async function ee(ge){const Ce=await ce.call(this,ge);this.refs[ge]||await L.call(this,Ce.$schema),this.refs[ge]||this.addSchema(Ce,ge,$)}async function ce(ge){const Ce=this._loading[ge];if(Ce)return Ce;try{return await(this._loading[ge]=G(ge))}finally{delete this._loading[ge]}}}addSchema(O,$,G,R=this.opts.validateSchema){if(Array.isArray(O)){for(const W of O)this.addSchema(W,void 0,G,R);return this}let L;if(typeof O=="object"){const{schemaId:W}=this.opts;if(L=O[W],L!==void 0&&typeof L!="string")throw new Error(`schema ${W} must be string`)}return $=(0,l.normalizeId)($||L),this._checkUnique($),this.schemas[$]=this._addSchema(O,G,$,R,!0),this}addMetaSchema(O,$,G=this.opts.validateSchema){return this.addSchema(O,$,!0,G),this}validateSchema(O,$){if(typeof O=="boolean")return!0;let G;if(G=O.$schema,G!==void 0&&typeof G!="string")throw new Error("$schema must be a string");if(G=G||this.opts.defaultMeta||this.defaultMeta(),!G)return this.logger.warn("meta-schema not available"),this.errors=null,!0;const R=this.validate(G,O);if(!R&&$){const L="schema is invalid: "+this.errorsText();if(this.opts.validateSchema==="log")this.logger.error(L);else throw new Error(L)}return R}getSchema(O){let $;for(;typeof($=S.call(this,O))=="string";)O=$;if($===void 0){const{schemaId:G}=this.opts,R=new o.SchemaEnv({schema:{},schemaId:G});if($=o.resolveSchema.call(this,R,O),!$)return;this.refs[O]=$}return $.validate||this._compileSchemaEnv($)}removeSchema(O){if(O instanceof RegExp)return this._removeAllSchemas(this.schemas,O),this._removeAllSchemas(this.refs,O),this;switch(typeof O){case"undefined":return this._removeAllSchemas(this.schemas),this._removeAllSchemas(this.refs),this._cache.clear(),this;case"string":{const $=S.call(this,O);return typeof $=="object"&&this._cache.delete($.schema),delete this.schemas[O],delete this.refs[O],this}case"object":{const $=O;this._cache.delete($);let G=O[this.opts.schemaId];return G&&(G=(0,l.normalizeId)(G),delete this.schemas[G],delete this.refs[G]),this}default:throw new Error("ajv.removeSchema: invalid parameter")}}addVocabulary(O){for(const $ of O)this.addKeyword($);return this}addKeyword(O,$){let G;if(typeof O=="string")G=O,typeof $=="object"&&(this.logger.warn("these parameters are deprecated, see docs for addKeyword"),$.keyword=G);else if(typeof O=="object"&&$===void 0){if($=O,G=$.keyword,Array.isArray(G)&&!G.length)throw new Error("addKeywords: keyword must be string or non-empty array")}else throw new Error("invalid addKeywords parameters");if(b.call(this,G,$),!$)return(0,u.eachItem)(G,L=>j.call(this,L)),this;H.call(this,$);const R={...$,type:(0,c.getJSONTypes)($.type),schemaType:(0,c.getJSONTypes)($.schemaType)};return(0,u.eachItem)(G,R.type.length===0?L=>j.call(this,L,R):L=>R.type.forEach(W=>j.call(this,L,R,W))),this}getKeyword(O){const $=this.RULES.all[O];return typeof $=="object"?$.definition:!!$}removeKeyword(O){const{RULES:$}=this;delete $.keywords[O],delete $.all[O];for(const G of $.rules){const R=G.rules.findIndex(L=>L.keyword===O);R>=0&&G.rules.splice(R,1)}return this}addFormat(O,$){return typeof $=="string"&&($=new RegExp($)),this.formats[O]=$,this}errorsText(O=this.errors,{separator:$=", ",dataVar:G="data"}={}){return!O||O.length===0?"No errors":O.map(R=>`${G}${R.instancePath} ${R.message}`).reduce((R,L)=>R+$+L)}$dataMetaSchema(O,$){const G=this.RULES.all;O=JSON.parse(JSON.stringify(O));for(const R of $){const L=R.split("/").slice(1);let W=O;for(const te of L)W=W[te];for(const te in G){const ee=G[te];if(typeof ee!="object")continue;const{$data:ce}=ee.definition,ge=W[te];ce&&ge&&(W[te]=B(ge))}}return O}_removeAllSchemas(O,$){for(const G in O){const R=O[G];(!$||$.test(G))&&(typeof R=="string"?delete O[G]:R&&!R.meta&&(this._cache.delete(R.schema),delete O[G]))}}_addSchema(O,$,G,R=this.opts.validateSchema,L=this.opts.addUsedSchema){let W;const{schemaId:te}=this.opts;if(typeof O=="object")W=O[te];else{if(this.opts.jtd)throw new Error("schema must be object");if(typeof O!="boolean")throw new Error("schema must be object or boolean")}let ee=this._cache.get(O);if(ee!==void 0)return ee;G=(0,l.normalizeId)(W||G);const ce=l.getSchemaRefs.call(this,O,G);return ee=new o.SchemaEnv({schema:O,schemaId:te,meta:$,baseId:G,localRefs:ce}),this._cache.set(ee.schema,ee),L&&!G.startsWith("#")&&(G&&this._checkUnique(G),this.refs[G]=ee),R&&this.validateSchema(O,!0),ee}_checkUnique(O){if(this.schemas[O]||this.refs[O])throw new Error(`schema with key or id "${O}" already exists`)}_compileSchemaEnv(O){if(O.meta?this._compileMetaSchema(O):o.compileSchema.call(this,O),!O.validate)throw new Error("ajv implementation error");return O.validate}_compileMetaSchema(O){const $=this.opts;this.opts=this._metaOpts;try{o.compileSchema.call(this,O)}finally{this.opts=$}}}w.ValidationError=r.default,w.MissingRefError=i.default,t.default=w;function x(N,O,$,G="error"){for(const R in N){const L=R;L in O&&this.logger[G](`${$}: option ${R}. ${N[L]}`)}}function S(N){return N=(0,l.normalizeId)(N),this.schemas[N]||this.refs[N]}function C(){const N=this.opts.schemas;if(N)if(Array.isArray(N))this.addSchema(N);else for(const O in N)this.addSchema(N[O],O)}function T(){for(const N in this.opts.formats){const O=this.opts.formats[N];O&&this.addFormat(N,O)}}function P(N){if(Array.isArray(N)){this.addVocabulary(N);return}this.logger.warn("keywords option as map is deprecated, pass array");for(const O in N){const $=N[O];$.keyword||($.keyword=O),this.addKeyword($)}}function F(){const N={...this.opts};for(const O of p)delete N[O];return N}const k={log(){},warn(){},error(){}};function A(N){if(N===!1)return k;if(N===void 0)return console;if(N.log&&N.warn&&N.error)return N;throw new Error("logger must implement log, warn and error methods")}const M=/^[a-z_$][a-z0-9_$:-]*$/i;function b(N,O){const{RULES:$}=this;if((0,u.eachItem)(N,G=>{if($.keywords[G])throw new Error(`Keyword ${G} is already defined`);if(!M.test(G))throw new Error(`Keyword ${G} has invalid name`)}),!!O&&O.$data&&!("code"in O||"validate"in O))throw new Error('$data keyword must have "code" or "validate" function')}function j(N,O,$){var G;const R=O==null?void 0:O.post;if($&&R)throw new Error('keyword with "post" flag cannot have "type"');const{RULES:L}=this;let W=R?L.post:L.rules.find(({type:ee})=>ee===$);if(W||(W={type:$,rules:[]},L.rules.push(W)),L.keywords[N]=!0,!O)return;const te={keyword:N,definition:{...O,type:(0,c.getJSONTypes)(O.type),schemaType:(0,c.getJSONTypes)(O.schemaType)}};O.before?V.call(this,W,te,O.before):W.rules.push(te),L.all[N]=te,(G=O.implements)===null||G===void 0||G.forEach(ee=>this.addKeyword(ee))}function V(N,O,$){const G=N.rules.findIndex(R=>R.keyword===$);G>=0?N.rules.splice(G,0,O):(N.rules.push(O),this.logger.warn(`rule ${$} is not defined`))}function H(N){let{metaSchema:O}=N;O!==void 0&&(N.$data&&this.opts.$data&&(O=B(O)),N.validateSchema=this.compile(O,!0))}const U={$ref:"https://raw.githubusercontent.com/ajv-validator/ajv/master/lib/refs/data.json#"};function B(N){return{anyOf:[N,U]}}})(yD);var QS={},eb={},tb={};Object.defineProperty(tb,"__esModule",{value:!0});const r0e={keyword:"id",code(){throw new Error('NOT SUPPORTED: keyword "id", use "$id" for schema ID')}};tb.default=r0e;var Ya={};Object.defineProperty(Ya,"__esModule",{value:!0});Ya.callRef=Ya.getValidate=void 0;const i0e=Cu,sI=De,Zn=Le,Al=ss,oI=tr,dg=pe,s0e={keyword:"$ref",schemaType:"string",code(t){const{gen:e,schema:n,it:r}=t,{baseId:i,schemaEnv:s,validateName:o,opts:a,self:l}=r,{root:c}=s;if((n==="#"||n==="#/")&&i===c.baseId)return d();const u=oI.resolveRef.call(l,c,i,n);if(u===void 0)throw new i0e.default(r.opts.uriResolver,i,n);if(u instanceof oI.SchemaEnv)return h(u);return f(u);function d(){if(s===c)return Zg(t,o,s,s.$async);const p=e.scopeValue("root",{ref:c});return Zg(t,(0,Zn._)`${p}.validate`,c,c.$async)}function h(p){const m=aN(t,p);Zg(t,m,p,p.$async)}function f(p){const m=e.scopeValue("schema",a.code.source===!0?{ref:p,code:(0,Zn.stringify)(p)}:{ref:p}),_=e.name("valid"),g=t.subschema({schema:p,dataTypes:[],schemaPath:Zn.nil,topSchemaRef:m,errSchemaPath:n},_);t.mergeEvaluated(g),t.ok(_)}}};function aN(t,e){const{gen:n}=t;return e.validate?n.scopeValue("validate",{ref:e.validate}):(0,Zn._)`${n.scopeValue("wrapper",{ref:e})}.validate`}Ya.getValidate=aN;function Zg(t,e,n,r){const{gen:i,it:s}=t,{allErrors:o,schemaEnv:a,opts:l}=s,c=l.passContext?Al.default.this:Zn.nil;r?u():d();function u(){if(!a.$async)throw new Error("async schema referenced by sync schema");const p=i.let("valid");i.try(()=>{i.code((0,Zn._)`await ${(0,sI.callValidateCode)(t,e,c)}`),f(e),o||i.assign(p,!0)},m=>{i.if((0,Zn._)`!(${m} instanceof ${s.ValidationError})`,()=>i.throw(m)),h(m),o||i.assign(p,!1)}),t.ok(p)}function d(){t.result((0,sI.callValidateCode)(t,e,c),()=>f(e),()=>h(e))}function h(p){const m=(0,Zn._)`${p}.errors`;i.assign(Al.default.vErrors,(0,Zn._)`${Al.default.vErrors} === null ? ${m} : ${Al.default.vErrors}.concat(${m})`),i.assign(Al.default.errors,(0,Zn._)`${Al.default.vErrors}.length`)}function f(p){var m;if(!s.opts.unevaluated)return;const _=(m=n==null?void 0:n.validate)===null||m===void 0?void 0:m.evaluated;if(s.props!==!0)if(_&&!_.dynamicProps)_.props!==void 0&&(s.props=dg.mergeEvaluated.props(i,_.props,s.props));else{const g=i.var("props",(0,Zn._)`${p}.evaluated.props`);s.props=dg.mergeEvaluated.props(i,g,s.props,Zn.Name)}if(s.items!==!0)if(_&&!_.dynamicItems)_.items!==void 0&&(s.items=dg.mergeEvaluated.items(i,_.items,s.items));else{const g=i.var("items",(0,Zn._)`${p}.evaluated.items`);s.items=dg.mergeEvaluated.items(i,g,s.items,Zn.Name)}}}Ya.callRef=Zg;Ya.default=s0e;Object.defineProperty(eb,"__esModule",{value:!0});const o0e=tb,a0e=Ya,l0e=["$schema","$id","$defs","$vocabulary",{keyword:"$comment"},"definitions",o0e.default,a0e.default];eb.default=l0e;var nb={},rb={};Object.defineProperty(rb,"__esModule",{value:!0});const vm=Le,oo=vm.operators,wm={maximum:{okStr:"<=",ok:oo.LTE,fail:oo.GT},minimum:{okStr:">=",ok:oo.GTE,fail:oo.LT},exclusiveMaximum:{okStr:"<",ok:oo.LT,fail:oo.GTE},exclusiveMinimum:{okStr:">",ok:oo.GT,fail:oo.LTE}},c0e={message:({keyword:t,schemaCode:e})=>(0,vm.str)`must be ${wm[t].okStr} ${e}`,params:({keyword:t,schemaCode:e})=>(0,vm._)`{comparison: ${wm[t].okStr}, limit: ${e}}`},u0e={keyword:Object.keys(wm),type:"number",schemaType:"number",$data:!0,error:c0e,code(t){const{keyword:e,data:n,schemaCode:r}=t;t.fail$data((0,vm._)`${n} ${wm[e].fail} ${r} || isNaN(${n})`)}};rb.default=u0e;var ib={};Object.defineProperty(ib,"__esModule",{value:!0});const kd=Le,d0e={message:({schemaCode:t})=>(0,kd.str)`must be multiple of ${t}`,params:({schemaCode:t})=>(0,kd._)`{multipleOf: ${t}}`},h0e={keyword:"multipleOf",type:"number",schemaType:"number",$data:!0,error:d0e,code(t){const{gen:e,data:n,schemaCode:r,it:i}=t,s=i.opts.multipleOfPrecision,o=e.let("res"),a=s?(0,kd._)`Math.abs(Math.round(${o}) - ${o}) > 1e-${s}`:(0,kd._)`${o} !== parseInt(${o})`;t.fail$data((0,kd._)`(${r} === 0 || (${o} = ${n}/${r}, ${a}))`)}};ib.default=h0e;var sb={},ob={};Object.defineProperty(ob,"__esModule",{value:!0});function lN(t){const e=t.length;let n=0,r=0,i;for(;r<e;)n++,i=t.charCodeAt(r++),i>=55296&&i<=56319&&r<e&&(i=t.charCodeAt(r),(i&64512)===56320&&r++);return n}ob.default=lN;lN.code='require("ajv/dist/runtime/ucs2length").default';Object.defineProperty(sb,"__esModule",{value:!0});const _a=Le,f0e=pe,g0e=ob,p0e={message({keyword:t,schemaCode:e}){const n=t==="maxLength"?"more":"fewer";return(0,_a.str)`must NOT have ${n} than ${e} characters`},params:({schemaCode:t})=>(0,_a._)`{limit: ${t}}`},m0e={keyword:["maxLength","minLength"],type:"string",schemaType:"number",$data:!0,error:p0e,code(t){const{keyword:e,data:n,schemaCode:r,it:i}=t,s=e==="maxLength"?_a.operators.GT:_a.operators.LT,o=i.opts.unicode===!1?(0,_a._)`${n}.length`:(0,_a._)`${(0,f0e.useFunc)(t.gen,g0e.default)}(${n})`;t.fail$data((0,_a._)`${o} ${s} ${r}`)}};sb.default=m0e;var ab={};Object.defineProperty(ab,"__esModule",{value:!0});const y0e=De,xm=Le,_0e={message:({schemaCode:t})=>(0,xm.str)`must match pattern "${t}"`,params:({schemaCode:t})=>(0,xm._)`{pattern: ${t}}`},v0e={keyword:"pattern",type:"string",schemaType:"string",$data:!0,error:_0e,code(t){const{data:e,$data:n,schema:r,schemaCode:i,it:s}=t,o=s.opts.unicodeRegExp?"u":"",a=n?(0,xm._)`(new RegExp(${i}, ${o}))`:(0,y0e.usePattern)(t,r);t.fail$data((0,xm._)`!${a}.test(${e})`)}};ab.default=v0e;var lb={};Object.defineProperty(lb,"__esModule",{value:!0});const Md=Le,w0e={message({keyword:t,schemaCode:e}){const n=t==="maxProperties"?"more":"fewer";return(0,Md.str)`must NOT have ${n} than ${e} properties`},params:({schemaCode:t})=>(0,Md._)`{limit: ${t}}`},x0e={keyword:["maxProperties","minProperties"],type:"object",schemaType:"number",$data:!0,error:w0e,code(t){const{keyword:e,data:n,schemaCode:r}=t,i=e==="maxProperties"?Md.operators.GT:Md.operators.LT;t.fail$data((0,Md._)`Object.keys(${n}).length ${i} ${r}`)}};lb.default=x0e;var cb={};Object.defineProperty(cb,"__esModule",{value:!0});const td=De,Dd=Le,E0e=pe,S0e={message:({params:{missingProperty:t}})=>(0,Dd.str)`must have required property '${t}'`,params:({params:{missingProperty:t}})=>(0,Dd._)`{missingProperty: ${t}}`},b0e={keyword:"required",type:"object",schemaType:"array",$data:!0,error:S0e,code(t){const{gen:e,schema:n,schemaCode:r,data:i,$data:s,it:o}=t,{opts:a}=o;if(!s&&n.length===0)return;const l=n.length>=a.loopRequired;if(o.allErrors?c():u(),a.strictRequired){const f=t.parentSchema.properties,{definedProperties:p}=t.it;for(const m of n)if((f==null?void 0:f[m])===void 0&&!p.has(m)){const _=o.schemaEnv.baseId+o.errSchemaPath,g=`required property "${m}" is not defined at "${_}" (strictRequired)`;(0,E0e.checkStrictMode)(o,g,o.opts.strictRequired)}}function c(){if(l||s)t.block$data(Dd.nil,d);else for(const f of n)(0,td.checkReportMissingProp)(t,f)}function u(){const f=e.let("missing");if(l||s){const p=e.let("valid",!0);t.block$data(p,()=>h(f,p)),t.ok(p)}else e.if((0,td.checkMissingProp)(t,n,f)),(0,td.reportMissingProp)(t,f),e.else()}function d(){e.forOf("prop",r,f=>{t.setParams({missingProperty:f}),e.if((0,td.noPropertyInData)(e,i,f,a.ownProperties),()=>t.error())})}function h(f,p){t.setParams({missingProperty:f}),e.forOf(f,r,()=>{e.assign(p,(0,td.propertyInData)(e,i,f,a.ownProperties)),e.if((0,Dd.not)(p),()=>{t.error(),e.break()})},Dd.nil)}}};cb.default=b0e;var ub={};Object.defineProperty(ub,"__esModule",{value:!0});const Nd=Le,C0e={message({keyword:t,schemaCode:e}){const n=t==="maxItems"?"more":"fewer";return(0,Nd.str)`must NOT have ${n} than ${e} items`},params:({schemaCode:t})=>(0,Nd._)`{limit: ${t}}`},T0e={keyword:["maxItems","minItems"],type:"array",schemaType:"number",$data:!0,error:C0e,code(t){const{keyword:e,data:n,schemaCode:r}=t,i=e==="maxItems"?Nd.operators.GT:Nd.operators.LT;t.fail$data((0,Nd._)`${n}.length ${i} ${r}`)}};ub.default=T0e;var db={},lf={};Object.defineProperty(lf,"__esModule",{value:!0});const cN=$D;cN.code='require("ajv/dist/runtime/equal").default';lf.default=cN;Object.defineProperty(db,"__esModule",{value:!0});const nv=qt,pn=Le,P0e=pe,R0e=lf,I0e={message:({params:{i:t,j:e}})=>(0,pn.str)`must NOT have duplicate items (items ## ${e} and ${t} are identical)`,params:({params:{i:t,j:e}})=>(0,pn._)`{i: ${t}, j: ${e}}`},A0e={keyword:"uniqueItems",type:"array",schemaType:"boolean",$data:!0,error:I0e,code(t){const{gen:e,data:n,$data:r,schema:i,parentSchema:s,schemaCode:o,it:a}=t;if(!r&&!i)return;const l=e.let("valid"),c=s.items?(0,nv.getSchemaTypes)(s.items):[];t.block$data(l,u,(0,pn._)`${o} === false`),t.ok(l);function u(){const p=e.let("i",(0,pn._)`${n}.length`),m=e.let("j");t.setParams({i:p,j:m}),e.assign(l,!0),e.if((0,pn._)`${p} > 1`,()=>(d()?h:f)(p,m))}function d(){return c.length>0&&!c.some(p=>p==="object"||p==="array")}function h(p,m){const _=e.name("item"),g=(0,nv.checkDataTypes)(c,_,a.opts.strictNumbers,nv.DataType.Wrong),y=e.const("indices",(0,pn._)`{}`);e.for((0,pn._)`;${p}--;`,()=>{e.let(_,(0,pn._)`${n}[${p}]`),e.if(g,(0,pn._)`continue`),c.length>1&&e.if((0,pn._)`typeof ${_} == "string"`,(0,pn._)`${_} += "_"`),e.if((0,pn._)`typeof ${y}[${_}] == "number"`,()=>{e.assign(m,(0,pn._)`${y}[${_}]`),t.error(),e.assign(l,!1).break()}).code((0,pn._)`${y}[${_}] = ${p}`)})}function f(p,m){const _=(0,P0e.useFunc)(e,R0e.default),g=e.name("outer");e.label(g).for((0,pn._)`;${p}--;`,()=>e.for((0,pn._)`${m} = ${p}; ${m}--;`,()=>e.if((0,pn._)`${_}(${n}[${p}], ${n}[${m}])`,()=>{t.error(),e.assign(l,!1).break(g)})))}}};db.default=A0e;var hb={};Object.defineProperty(hb,"__esModule",{value:!0});const ux=Le,F0e=pe,O0e=lf,$0e={message:"must be equal to constant",params:({schemaCode:t})=>(0,ux._)`{allowedValue: ${t}}`},L0e={keyword:"const",$data:!0,error:$0e,code(t){const{gen:e,data:n,$data:r,schemaCode:i,schema:s}=t;r||s&&typeof s=="object"?t.fail$data((0,ux._)`!${(0,F0e.useFunc)(e,O0e.default)}(${n}, ${i})`):t.fail((0,ux._)`${s} !== ${n}`)}};hb.default=L0e;var fb={};Object.defineProperty(fb,"__esModule",{value:!0});const dd=Le,k0e=pe,M0e=lf,D0e={message:"must be equal to one of the allowed values",params:({schemaCode:t})=>(0,dd._)`{allowedValues: ${t}}`},N0e={keyword:"enum",schemaType:"array",$data:!0,error:D0e,code(t){const{gen:e,data:n,$data:r,schema:i,schemaCode:s,it:o}=t;if(!r&&i.length===0)throw new Error("enum must have non-empty array");const a=i.length>=o.opts.loopEnum;let l;const c=()=>l??(l=(0,k0e.useFunc)(e,M0e.default));let u;if(a||r)u=e.let("valid"),t.block$data(u,d);else{if(!Array.isArray(i))throw new Error("ajv implementation error");const f=e.const("vSchema",s);u=(0,dd.or)(...i.map((p,m)=>h(f,m)))}t.pass(u);function d(){e.assign(u,!1),e.forOf("v",s,f=>e.if((0,dd._)`${c()}(${n}, ${f})`,()=>e.assign(u,!0).break()))}function h(f,p){const m=i[p];return typeof m=="object"&&m!==null?(0,dd._)`${c()}(${n}, ${f}[${p}])`:(0,dd._)`${n} === ${m}`}}};fb.default=N0e;Object.defineProperty(nb,"__esModule",{value:!0});const j0e=rb,z0e=ib,U0e=sb,G0e=ab,B0e=lb,V0e=cb,W0e=ub,H0e=db,K0e=hb,Y0e=fb,X0e=[j0e.default,z0e.default,U0e.default,G0e.default,B0e.default,V0e.default,W0e.default,H0e.default,{keyword:"type",schemaType:["string","array"]},{keyword:"nullable",schemaType:"boolean"},K0e.default,Y0e.default];nb.default=X0e;var gb={},Tu={};Object.defineProperty(Tu,"__esModule",{value:!0});Tu.validateAdditionalItems=void 0;const va=Le,dx=pe,Z0e={message:({params:{len:t}})=>(0,va.str)`must NOT have more than ${t} items`,params:({params:{len:t}})=>(0,va._)`{limit: ${t}}`},q0e={keyword:"additionalItems",type:"array",schemaType:["boolean","object"],before:"uniqueItems",error:Z0e,code(t){const{parentSchema:e,it:n}=t,{items:r}=e;if(!Array.isArray(r)){(0,dx.checkStrictMode)(n,'"additionalItems" is ignored when "items" is not an array of schemas');return}uN(t,r)}};function uN(t,e){const{gen:n,schema:r,data:i,keyword:s,it:o}=t;o.items=!0;const a=n.const("len",(0,va._)`${i}.length`);if(r===!1)t.setParams({len:e.length}),t.pass((0,va._)`${a} <= ${e.length}`);else if(typeof r=="object"&&!(0,dx.alwaysValidSchema)(o,r)){const c=n.var("valid",(0,va._)`${a} <= ${e.length}`);n.if((0,va.not)(c),()=>l(c)),t.ok(c)}function l(c){n.forRange("i",e.length,a,u=>{t.subschema({keyword:s,dataProp:u,dataPropType:dx.Type.Num},c),o.allErrors||n.if((0,va.not)(c),()=>n.break())})}}Tu.validateAdditionalItems=uN;Tu.default=q0e;var pb={},Pu={};Object.defineProperty(Pu,"__esModule",{value:!0});Pu.validateTuple=void 0;const aI=Le,qg=pe,J0e=De,Q0e={keyword:"items",type:"array",schemaType:["object","array","boolean"],before:"uniqueItems",code(t){const{schema:e,it:n}=t;if(Array.isArray(e))return dN(t,"additionalItems",e);n.items=!0,!(0,qg.alwaysValidSchema)(n,e)&&t.ok((0,J0e.validateArray)(t))}};function dN(t,e,n=t.schema){const{gen:r,parentSchema:i,data:s,keyword:o,it:a}=t;u(i),a.opts.unevaluated&&n.length&&a.items!==!0&&(a.items=qg.mergeEvaluated.items(r,n.length,a.items));const l=r.name("valid"),c=r.const("len",(0,aI._)`${s}.length`);n.forEach((d,h)=>{(0,qg.alwaysValidSchema)(a,d)||(r.if((0,aI._)`${c} > ${h}`,()=>t.subschema({keyword:o,schemaProp:h,dataProp:h},l)),t.ok(l))});function u(d){const{opts:h,errSchemaPath:f}=a,p=n.length,m=p===d.minItems&&(p===d.maxItems||d[e]===!1);if(h.strictTuples&&!m){const _=`"${o}" is ${p}-tuple, but minItems or maxItems/${e} are not specified or different at path "${f}"`;(0,qg.checkStrictMode)(a,_,h.strictTuples)}}}Pu.validateTuple=dN;Pu.default=Q0e;Object.defineProperty(pb,"__esModule",{value:!0});const eve=Pu,tve={keyword:"prefixItems",type:"array",schemaType:["array"],before:"uniqueItems",code:t=>(0,eve.validateTuple)(t,"items")};pb.default=tve;var mb={};Object.defineProperty(mb,"__esModule",{value:!0});const lI=Le,nve=pe,rve=De,ive=Tu,sve={message:({params:{len:t}})=>(0,lI.str)`must NOT have more than ${t} items`,params:({params:{len:t}})=>(0,lI._)`{limit: ${t}}`},ove={keyword:"items",type:"array",schemaType:["object","boolean"],before:"uniqueItems",error:sve,code(t){const{schema:e,parentSchema:n,it:r}=t,{prefixItems:i}=n;r.items=!0,!(0,nve.alwaysValidSchema)(r,e)&&(i?(0,ive.validateAdditionalItems)(t,i):t.ok((0,rve.validateArray)(t)))}};mb.default=ove;var yb={};Object.defineProperty(yb,"__esModule",{value:!0});const Lr=Le,hg=pe,ave={message:({params:{min:t,max:e}})=>e===void 0?(0,Lr.str)`must contain at least ${t} valid item(s)`:(0,Lr.str)`must contain at least ${t} and no more than ${e} valid item(s)`,params:({params:{min:t,max:e}})=>e===void 0?(0,Lr._)`{minContains: ${t}}`:(0,Lr._)`{minContains: ${t}, maxContains: ${e}}`},lve={keyword:"contains",type:"array",schemaType:["object","boolean"],before:"uniqueItems",trackErrors:!0,error:ave,code(t){const{gen:e,schema:n,parentSchema:r,data:i,it:s}=t;let o,a;const{minContains:l,maxContains:c}=r;s.opts.next?(o=l===void 0?1:l,a=c):o=1;const u=e.const("len",(0,Lr._)`${i}.length`);if(t.setParams({min:o,max:a}),a===void 0&&o===0){(0,hg.checkStrictMode)(s,'"minContains" == 0 without "maxContains": "contains" keyword ignored');return}if(a!==void 0&&o>a){(0,hg.checkStrictMode)(s,'"minContains" > "maxContains" is always invalid'),t.fail();return}if((0,hg.alwaysValidSchema)(s,n)){let m=(0,Lr._)`${u} >= ${o}`;a!==void 0&&(m=(0,Lr._)`${m} && ${u} <= ${a}`),t.pass(m);return}s.items=!0;const d=e.name("valid");a===void 0&&o===1?f(d,()=>e.if(d,()=>e.break())):o===0?(e.let(d,!0),a!==void 0&&e.if((0,Lr._)`${i}.length > 0`,h)):(e.let(d,!1),h()),t.result(d,()=>t.reset());function h(){const m=e.name("_valid"),_=e.let("count",0);f(m,()=>e.if(m,()=>p(_)))}function f(m,_){e.forRange("i",0,u,g=>{t.subschema({keyword:"contains",dataProp:g,dataPropType:hg.Type.Num,compositeRule:!0},m),_()})}function p(m){e.code((0,Lr._)`${m}++`),a===void 0?e.if((0,Lr._)`${m} >= ${o}`,()=>e.assign(d,!0).break()):(e.if((0,Lr._)`${m} > ${a}`,()=>e.assign(d,!1).break()),o===1?e.assign(d,!0):e.if((0,Lr._)`${m} >= ${o}`,()=>e.assign(d,!0)))}}};yb.default=lve;var hN={};(function(t){Object.defineProperty(t,"__esModule",{value:!0}),t.validateSchemaDeps=t.validatePropertyDeps=t.error=void 0;const e=Le,n=pe,r=De;t.error={message:({params:{property:l,depsCount:c,deps:u}})=>{const d=c===1?"property":"properties";return(0,e.str)`must have ${d} ${u} when property ${l} is present`},params:({params:{property:l,depsCount:c,deps:u,missingProperty:d}})=>(0,e._)`{property: ${l},
    missingProperty: ${d},
    depsCount: ${c},
    deps: ${u}}`};const i={keyword:"dependencies",type:"object",schemaType:"object",error:t.error,code(l){const[c,u]=s(l);o(l,c),a(l,u)}};function s({schema:l}){const c={},u={};for(const d in l){if(d==="__proto__")continue;const h=Array.isArray(l[d])?c:u;h[d]=l[d]}return[c,u]}function o(l,c=l.schema){const{gen:u,data:d,it:h}=l;if(Object.keys(c).length===0)return;const f=u.let("missing");for(const p in c){const m=c[p];if(m.length===0)continue;const _=(0,r.propertyInData)(u,d,p,h.opts.ownProperties);l.setParams({property:p,depsCount:m.length,deps:m.join(", ")}),h.allErrors?u.if(_,()=>{for(const g of m)(0,r.checkReportMissingProp)(l,g)}):(u.if((0,e._)`${_} && (${(0,r.checkMissingProp)(l,m,f)})`),(0,r.reportMissingProp)(l,f),u.else())}}t.validatePropertyDeps=o;function a(l,c=l.schema){const{gen:u,data:d,keyword:h,it:f}=l,p=u.name("valid");for(const m in c)(0,n.alwaysValidSchema)(f,c[m])||(u.if((0,r.propertyInData)(u,d,m,f.opts.ownProperties),()=>{const _=l.subschema({keyword:h,schemaProp:m},p);l.mergeValidEvaluated(_,p)},()=>u.var(p,!0)),l.ok(p))}t.validateSchemaDeps=a,t.default=i})(hN);var _b={};Object.defineProperty(_b,"__esModule",{value:!0});const fN=Le,cve=pe,uve={message:"property name must be valid",params:({params:t})=>(0,fN._)`{propertyName: ${t.propertyName}}`},dve={keyword:"propertyNames",type:"object",schemaType:["object","boolean"],error:uve,code(t){const{gen:e,schema:n,data:r,it:i}=t;if((0,cve.alwaysValidSchema)(i,n))return;const s=e.name("valid");e.forIn("key",r,o=>{t.setParams({propertyName:o}),t.subschema({keyword:"propertyNames",data:o,dataTypes:["string"],propertyName:o,compositeRule:!0},s),e.if((0,fN.not)(s),()=>{t.error(!0),i.allErrors||e.break()})}),t.ok(s)}};_b.default=dve;var d_={};Object.defineProperty(d_,"__esModule",{value:!0});const fg=De,si=Le,hve=ss,gg=pe,fve={message:"must NOT have additional properties",params:({params:t})=>(0,si._)`{additionalProperty: ${t.additionalProperty}}`},gve={keyword:"additionalProperties",type:["object"],schemaType:["boolean","object"],allowUndefined:!0,trackErrors:!0,error:fve,code(t){const{gen:e,schema:n,parentSchema:r,data:i,errsCount:s,it:o}=t;if(!s)throw new Error("ajv implementation error");const{allErrors:a,opts:l}=o;if(o.props=!0,l.removeAdditional!=="all"&&(0,gg.alwaysValidSchema)(o,n))return;const c=(0,fg.allSchemaProperties)(r.properties),u=(0,fg.allSchemaProperties)(r.patternProperties);d(),t.ok((0,si._)`${s} === ${hve.default.errors}`);function d(){e.forIn("key",i,_=>{!c.length&&!u.length?p(_):e.if(h(_),()=>p(_))})}function h(_){let g;if(c.length>8){const y=(0,gg.schemaRefOrVal)(o,r.properties,"properties");g=(0,fg.isOwnProperty)(e,y,_)}else c.length?g=(0,si.or)(...c.map(y=>(0,si._)`${_} === ${y}`)):g=si.nil;return u.length&&(g=(0,si.or)(g,...u.map(y=>(0,si._)`${(0,fg.usePattern)(t,y)}.test(${_})`))),(0,si.not)(g)}function f(_){e.code((0,si._)`delete ${i}[${_}]`)}function p(_){if(l.removeAdditional==="all"||l.removeAdditional&&n===!1){f(_);return}if(n===!1){t.setParams({additionalProperty:_}),t.error(),a||e.break();return}if(typeof n=="object"&&!(0,gg.alwaysValidSchema)(o,n)){const g=e.name("valid");l.removeAdditional==="failing"?(m(_,g,!1),e.if((0,si.not)(g),()=>{t.reset(),f(_)})):(m(_,g),a||e.if((0,si.not)(g),()=>e.break()))}}function m(_,g,y){const v={keyword:"additionalProperties",dataProp:_,dataPropType:gg.Type.Str};y===!1&&Object.assign(v,{compositeRule:!0,createErrors:!1,allErrors:!1}),t.subschema(v,g)}}};d_.default=gve;var vb={};Object.defineProperty(vb,"__esModule",{value:!0});const pve=wi,cI=De,rv=pe,uI=d_,mve={keyword:"properties",type:"object",schemaType:"object",code(t){const{gen:e,schema:n,parentSchema:r,data:i,it:s}=t;s.opts.removeAdditional==="all"&&r.additionalProperties===void 0&&uI.default.code(new pve.KeywordCxt(s,uI.default,"additionalProperties"));const o=(0,cI.allSchemaProperties)(n);for(const d of o)s.definedProperties.add(d);s.opts.unevaluated&&o.length&&s.props!==!0&&(s.props=rv.mergeEvaluated.props(e,(0,rv.toHash)(o),s.props));const a=o.filter(d=>!(0,rv.alwaysValidSchema)(s,n[d]));if(a.length===0)return;const l=e.name("valid");for(const d of a)c(d)?u(d):(e.if((0,cI.propertyInData)(e,i,d,s.opts.ownProperties)),u(d),s.allErrors||e.else().var(l,!0),e.endIf()),t.it.definedProperties.add(d),t.ok(l);function c(d){return s.opts.useDefaults&&!s.compositeRule&&n[d].default!==void 0}function u(d){t.subschema({keyword:"properties",schemaProp:d,dataProp:d},l)}}};vb.default=mve;var wb={};Object.defineProperty(wb,"__esModule",{value:!0});const dI=De,pg=Le,hI=pe,fI=pe,yve={keyword:"patternProperties",type:"object",schemaType:"object",code(t){const{gen:e,schema:n,data:r,parentSchema:i,it:s}=t,{opts:o}=s,a=(0,dI.allSchemaProperties)(n),l=a.filter(m=>(0,hI.alwaysValidSchema)(s,n[m]));if(a.length===0||l.length===a.length&&(!s.opts.unevaluated||s.props===!0))return;const c=o.strictSchema&&!o.allowMatchingProperties&&i.properties,u=e.name("valid");s.props!==!0&&!(s.props instanceof pg.Name)&&(s.props=(0,fI.evaluatedPropsToName)(e,s.props));const{props:d}=s;h();function h(){for(const m of a)c&&f(m),s.allErrors?p(m):(e.var(u,!0),p(m),e.if(u))}function f(m){for(const _ in c)new RegExp(m).test(_)&&(0,hI.checkStrictMode)(s,`property ${_} matches pattern ${m} (use allowMatchingProperties)`)}function p(m){e.forIn("key",r,_=>{e.if((0,pg._)`${(0,dI.usePattern)(t,m)}.test(${_})`,()=>{const g=l.includes(m);g||t.subschema({keyword:"patternProperties",schemaProp:m,dataProp:_,dataPropType:fI.Type.Str},u),s.opts.unevaluated&&d!==!0?e.assign((0,pg._)`${d}[${_}]`,!0):!g&&!s.allErrors&&e.if((0,pg.not)(u),()=>e.break())})})}}};wb.default=yve;var xb={};Object.defineProperty(xb,"__esModule",{value:!0});const _ve=pe,vve={keyword:"not",schemaType:["object","boolean"],trackErrors:!0,code(t){const{gen:e,schema:n,it:r}=t;if((0,_ve.alwaysValidSchema)(r,n)){t.fail();return}const i=e.name("valid");t.subschema({keyword:"not",compositeRule:!0,createErrors:!1,allErrors:!1},i),t.failResult(i,()=>t.reset(),()=>t.error())},error:{message:"must NOT be valid"}};xb.default=vve;var Eb={};Object.defineProperty(Eb,"__esModule",{value:!0});const wve=De,xve={keyword:"anyOf",schemaType:"array",trackErrors:!0,code:wve.validateUnion,error:{message:"must match a schema in anyOf"}};Eb.default=xve;var Sb={};Object.defineProperty(Sb,"__esModule",{value:!0});const Jg=Le,Eve=pe,Sve={message:"must match exactly one schema in oneOf",params:({params:t})=>(0,Jg._)`{passingSchemas: ${t.passing}}`},bve={keyword:"oneOf",schemaType:"array",trackErrors:!0,error:Sve,code(t){const{gen:e,schema:n,parentSchema:r,it:i}=t;if(!Array.isArray(n))throw new Error("ajv implementation error");if(i.opts.discriminator&&r.discriminator)return;const s=n,o=e.let("valid",!1),a=e.let("passing",null),l=e.name("_valid");t.setParams({passing:a}),e.block(c),t.result(o,()=>t.reset(),()=>t.error(!0));function c(){s.forEach((u,d)=>{let h;(0,Eve.alwaysValidSchema)(i,u)?e.var(l,!0):h=t.subschema({keyword:"oneOf",schemaProp:d,compositeRule:!0},l),d>0&&e.if((0,Jg._)`${l} && ${o}`).assign(o,!1).assign(a,(0,Jg._)`[${a}, ${d}]`).else(),e.if(l,()=>{e.assign(o,!0),e.assign(a,d),h&&t.mergeEvaluated(h,Jg.Name)})})}}};Sb.default=bve;var bb={};Object.defineProperty(bb,"__esModule",{value:!0});const Cve=pe,Tve={keyword:"allOf",schemaType:"array",code(t){const{gen:e,schema:n,it:r}=t;if(!Array.isArray(n))throw new Error("ajv implementation error");const i=e.name("valid");n.forEach((s,o)=>{if((0,Cve.alwaysValidSchema)(r,s))return;const a=t.subschema({keyword:"allOf",schemaProp:o},i);t.ok(i),t.mergeEvaluated(a)})}};bb.default=Tve;var Cb={};Object.defineProperty(Cb,"__esModule",{value:!0});const Em=Le,gN=pe,Pve={message:({params:t})=>(0,Em.str)`must match "${t.ifClause}" schema`,params:({params:t})=>(0,Em._)`{failingKeyword: ${t.ifClause}}`},Rve={keyword:"if",schemaType:["object","boolean"],trackErrors:!0,error:Pve,code(t){const{gen:e,parentSchema:n,it:r}=t;n.then===void 0&&n.else===void 0&&(0,gN.checkStrictMode)(r,'"if" without "then" and "else" is ignored');const i=gI(r,"then"),s=gI(r,"else");if(!i&&!s)return;const o=e.let("valid",!0),a=e.name("_valid");if(l(),t.reset(),i&&s){const u=e.let("ifClause");t.setParams({ifClause:u}),e.if(a,c("then",u),c("else",u))}else i?e.if(a,c("then")):e.if((0,Em.not)(a),c("else"));t.pass(o,()=>t.error(!0));function l(){const u=t.subschema({keyword:"if",compositeRule:!0,createErrors:!1,allErrors:!1},a);t.mergeEvaluated(u)}function c(u,d){return()=>{const h=t.subschema({keyword:u},a);e.assign(o,a),t.mergeValidEvaluated(h,o),d?e.assign(d,(0,Em._)`${u}`):t.setParams({ifClause:u})}}}};function gI(t,e){const n=t.schema[e];return n!==void 0&&!(0,gN.alwaysValidSchema)(t,n)}Cb.default=Rve;var Tb={};Object.defineProperty(Tb,"__esModule",{value:!0});const Ive=pe,Ave={keyword:["then","else"],schemaType:["object","boolean"],code({keyword:t,parentSchema:e,it:n}){e.if===void 0&&(0,Ive.checkStrictMode)(n,`"${t}" without "if" is ignored`)}};Tb.default=Ave;Object.defineProperty(gb,"__esModule",{value:!0});const Fve=Tu,Ove=pb,$ve=Pu,Lve=mb,kve=yb,Mve=hN,Dve=_b,Nve=d_,jve=vb,zve=wb,Uve=xb,Gve=Eb,Bve=Sb,Vve=bb,Wve=Cb,Hve=Tb;function Kve(t=!1){const e=[Uve.default,Gve.default,Bve.default,Vve.default,Wve.default,Hve.default,Dve.default,Nve.default,Mve.default,jve.default,zve.default];return t?e.push(Ove.default,Lve.default):e.push(Fve.default,$ve.default),e.push(kve.default),e}gb.default=Kve;var Pb={},Rb={};Object.defineProperty(Rb,"__esModule",{value:!0});const zt=Le,Yve={message:({schemaCode:t})=>(0,zt.str)`must match format "${t}"`,params:({schemaCode:t})=>(0,zt._)`{format: ${t}}`},Xve={keyword:"format",type:["number","string"],schemaType:"string",$data:!0,error:Yve,code(t,e){const{gen:n,data:r,$data:i,schema:s,schemaCode:o,it:a}=t,{opts:l,errSchemaPath:c,schemaEnv:u,self:d}=a;if(!l.validateFormats)return;i?h():f();function h(){const p=n.scopeValue("formats",{ref:d.formats,code:l.code.formats}),m=n.const("fDef",(0,zt._)`${p}[${o}]`),_=n.let("fType"),g=n.let("format");n.if((0,zt._)`typeof ${m} == "object" && !(${m} instanceof RegExp)`,()=>n.assign(_,(0,zt._)`${m}.type || "string"`).assign(g,(0,zt._)`${m}.validate`),()=>n.assign(_,(0,zt._)`"string"`).assign(g,m)),t.fail$data((0,zt.or)(y(),v()));function y(){return l.strictSchema===!1?zt.nil:(0,zt._)`${o} && !${g}`}function v(){const w=u.$async?(0,zt._)`(${m}.async ? await ${g}(${r}) : ${g}(${r}))`:(0,zt._)`${g}(${r})`,x=(0,zt._)`(typeof ${g} == "function" ? ${w} : ${g}.test(${r}))`;return(0,zt._)`${g} && ${g} !== true && ${_} === ${e} && !${x}`}}function f(){const p=d.formats[s];if(!p){y();return}if(p===!0)return;const[m,_,g]=v(p);m===e&&t.pass(w());function y(){if(l.strictSchema===!1){d.logger.warn(x());return}throw new Error(x());function x(){return`unknown format "${s}" ignored in schema at path "${c}"`}}function v(x){const S=x instanceof RegExp?(0,zt.regexpCode)(x):l.code.formats?(0,zt._)`${l.code.formats}${(0,zt.getProperty)(s)}`:void 0,C=n.scopeValue("formats",{key:s,ref:x,code:S});return typeof x=="object"&&!(x instanceof RegExp)?[x.type||"string",x.validate,(0,zt._)`${C}.validate`]:["string",x,C]}function w(){if(typeof p=="object"&&!(p instanceof RegExp)&&p.async){if(!u.$async)throw new Error("async format in sync schema");return(0,zt._)`await ${g}(${r})`}return typeof _=="function"?(0,zt._)`${g}(${r})`:(0,zt._)`${g}.test(${r})`}}}};Rb.default=Xve;Object.defineProperty(Pb,"__esModule",{value:!0});const Zve=Rb,qve=[Zve.default];Pb.default=qve;var qc={};Object.defineProperty(qc,"__esModule",{value:!0});qc.contentVocabulary=qc.metadataVocabulary=void 0;qc.metadataVocabulary=["title","description","default","deprecated","readOnly","writeOnly","examples"];qc.contentVocabulary=["contentMediaType","contentEncoding","contentSchema"];Object.defineProperty(QS,"__esModule",{value:!0});const Jve=eb,Qve=nb,ewe=gb,twe=Pb,pI=qc,nwe=[Jve.default,Qve.default,(0,ewe.default)(),twe.default,pI.metadataVocabulary,pI.contentVocabulary];QS.default=nwe;var Ib={},h_={};Object.defineProperty(h_,"__esModule",{value:!0});h_.DiscrError=void 0;var mI;(function(t){t.Tag="tag",t.Mapping="mapping"})(mI||(h_.DiscrError=mI={}));Object.defineProperty(Ib,"__esModule",{value:!0});const zl=Le,hx=h_,yI=tr,rwe=Cu,iwe=pe,swe={message:({params:{discrError:t,tagName:e}})=>t===hx.DiscrError.Tag?`tag "${e}" must be string`:`value of tag "${e}" must be in oneOf`,params:({params:{discrError:t,tag:e,tagName:n}})=>(0,zl._)`{error: ${t}, tag: ${n}, tagValue: ${e}}`},owe={keyword:"discriminator",type:"object",schemaType:"object",error:swe,code(t){const{gen:e,data:n,schema:r,parentSchema:i,it:s}=t,{oneOf:o}=i;if(!s.opts.discriminator)throw new Error("discriminator: requires discriminator option");const a=r.propertyName;if(typeof a!="string")throw new Error("discriminator: requires propertyName");if(r.mapping)throw new Error("discriminator: mapping is not supported");if(!o)throw new Error("discriminator: requires oneOf keyword");const l=e.let("valid",!1),c=e.const("tag",(0,zl._)`${n}${(0,zl.getProperty)(a)}`);e.if((0,zl._)`typeof ${c} == "string"`,()=>u(),()=>t.error(!1,{discrError:hx.DiscrError.Tag,tag:c,tagName:a})),t.ok(l);function u(){const f=h();e.if(!1);for(const p in f)e.elseIf((0,zl._)`${c} === ${p}`),e.assign(l,d(f[p]));e.else(),t.error(!1,{discrError:hx.DiscrError.Mapping,tag:c,tagName:a}),e.endIf()}function d(f){const p=e.name("valid"),m=t.subschema({keyword:"oneOf",schemaProp:f},p);return t.mergeEvaluated(m,zl.Name),p}function h(){var f;const p={},m=g(i);let _=!0;for(let w=0;w<o.length;w++){let x=o[w];if(x!=null&&x.$ref&&!(0,iwe.schemaHasRulesButRef)(x,s.self.RULES)){const C=x.$ref;if(x=yI.resolveRef.call(s.self,s.schemaEnv.root,s.baseId,C),x instanceof yI.SchemaEnv&&(x=x.schema),x===void 0)throw new rwe.default(s.opts.uriResolver,s.baseId,C)}const S=(f=x==null?void 0:x.properties)===null||f===void 0?void 0:f[a];if(typeof S!="object")throw new Error(`discriminator: oneOf subschemas (or referenced schemas) must have "properties/${a}"`);_=_&&(m||g(x)),y(S,w)}if(!_)throw new Error(`discriminator: "${a}" must be required`);return p;function g({required:w}){return Array.isArray(w)&&w.includes(a)}function y(w,x){if(w.const)v(w.const,x);else if(w.enum)for(const S of w.enum)v(S,x);else throw new Error(`discriminator: "properties/${a}" must have "const" or "enum"`)}function v(w,x){if(typeof w!="string"||w in p)throw new Error(`discriminator: "${a}" values must be unique strings`);p[w]=x}}}};Ib.default=owe;const awe="http://json-schema.org/draft-07/schema#",lwe="http://json-schema.org/draft-07/schema#",cwe="Core schema meta-schema",uwe={schemaArray:{type:"array",minItems:1,items:{$ref:"#"}},nonNegativeInteger:{type:"integer",minimum:0},nonNegativeIntegerDefault0:{allOf:[{$ref:"#/definitions/nonNegativeInteger"},{default:0}]},simpleTypes:{enum:["array","boolean","integer","null","number","object","string"]},stringArray:{type:"array",items:{type:"string"},uniqueItems:!0,default:[]}},dwe=["object","boolean"],hwe={$id:{type:"string",format:"uri-reference"},$schema:{type:"string",format:"uri"},$ref:{type:"string",format:"uri-reference"},$comment:{type:"string"},title:{type:"string"},description:{type:"string"},default:!0,readOnly:{type:"boolean",default:!1},examples:{type:"array",items:!0},multipleOf:{type:"number",exclusiveMinimum:0},maximum:{type:"number"},exclusiveMaximum:{type:"number"},minimum:{type:"number"},exclusiveMinimum:{type:"number"},maxLength:{$ref:"#/definitions/nonNegativeInteger"},minLength:{$ref:"#/definitions/nonNegativeIntegerDefault0"},pattern:{type:"string",format:"regex"},additionalItems:{$ref:"#"},items:{anyOf:[{$ref:"#"},{$ref:"#/definitions/schemaArray"}],default:!0},maxItems:{$ref:"#/definitions/nonNegativeInteger"},minItems:{$ref:"#/definitions/nonNegativeIntegerDefault0"},uniqueItems:{type:"boolean",default:!1},contains:{$ref:"#"},maxProperties:{$ref:"#/definitions/nonNegativeInteger"},minProperties:{$ref:"#/definitions/nonNegativeIntegerDefault0"},required:{$ref:"#/definitions/stringArray"},additionalProperties:{$ref:"#"},definitions:{type:"object",additionalProperties:{$ref:"#"},default:{}},properties:{type:"object",additionalProperties:{$ref:"#"},default:{}},patternProperties:{type:"object",additionalProperties:{$ref:"#"},propertyNames:{format:"regex"},default:{}},dependencies:{type:"object",additionalProperties:{anyOf:[{$ref:"#"},{$ref:"#/definitions/stringArray"}]}},propertyNames:{$ref:"#"},const:!0,enum:{type:"array",items:!0,minItems:1,uniqueItems:!0},type:{anyOf:[{$ref:"#/definitions/simpleTypes"},{type:"array",items:{$ref:"#/definitions/simpleTypes"},minItems:1,uniqueItems:!0}]},format:{type:"string"},contentMediaType:{type:"string"},contentEncoding:{type:"string"},if:{$ref:"#"},then:{$ref:"#"},else:{$ref:"#"},allOf:{$ref:"#/definitions/schemaArray"},anyOf:{$ref:"#/definitions/schemaArray"},oneOf:{$ref:"#/definitions/schemaArray"},not:{$ref:"#"}},fwe={$schema:awe,$id:lwe,title:cwe,definitions:uwe,type:dwe,properties:hwe,default:!0};(function(t,e){Object.defineProperty(e,"__esModule",{value:!0}),e.MissingRefError=e.ValidationError=e.CodeGen=e.Name=e.nil=e.stringify=e.str=e._=e.KeywordCxt=e.Ajv=void 0;const n=yD,r=QS,i=Ib,s=fwe,o=["/properties"],a="http://json-schema.org/draft-07/schema";class l extends n.default{_addVocabularies(){super._addVocabularies(),r.default.forEach(p=>this.addVocabulary(p)),this.opts.discriminator&&this.addKeyword(i.default)}_addDefaultMetaSchema(){if(super._addDefaultMetaSchema(),!this.opts.meta)return;const p=this.opts.$data?this.$dataMetaSchema(s,o):s;this.addMetaSchema(p,a,!1),this.refs["http://json-schema.org/schema"]=a}defaultMeta(){return this.opts.defaultMeta=super.defaultMeta()||(this.getSchema(a)?a:void 0)}}e.Ajv=l,t.exports=e=l,t.exports.Ajv=l,Object.defineProperty(e,"__esModule",{value:!0}),e.default=l;var c=wi;Object.defineProperty(e,"KeywordCxt",{enumerable:!0,get:function(){return c.KeywordCxt}});var u=Le;Object.defineProperty(e,"_",{enumerable:!0,get:function(){return u._}}),Object.defineProperty(e,"str",{enumerable:!0,get:function(){return u.str}}),Object.defineProperty(e,"stringify",{enumerable:!0,get:function(){return u.stringify}}),Object.defineProperty(e,"nil",{enumerable:!0,get:function(){return u.nil}}),Object.defineProperty(e,"Name",{enumerable:!0,get:function(){return u.Name}}),Object.defineProperty(e,"CodeGen",{enumerable:!0,get:function(){return u.CodeGen}});var d=af;Object.defineProperty(e,"ValidationError",{enumerable:!0,get:function(){return d.default}});var h=Cu;Object.defineProperty(e,"MissingRefError",{enumerable:!0,get:function(){return h.default}})})(sx,sx.exports);var pN=sx.exports;const gwe=Za(pN);var fx={exports:{}},mN={};(function(t){Object.defineProperty(t,"__esModule",{value:!0}),t.formatNames=t.fastFormats=t.fullFormats=void 0;function e(P,F){return{validate:P,compare:F}}t.fullFormats={date:e(s,o),time:e(l,c),"date-time":e(d,h),duration:/^P(?!$)((\d+Y)?(\d+M)?(\d+D)?(T(?=\d)(\d+H)?(\d+M)?(\d+S)?)?|(\d+W)?)$/,uri:m,"uri-reference":/^(?:[a-z][a-z0-9+\-.]*:)?(?:\/?\/(?:(?:[a-z0-9\-._~!$&'()*+,;=:]|%[0-9a-f]{2})*@)?(?:\[(?:(?:(?:(?:[0-9a-f]{1,4}:){6}|::(?:[0-9a-f]{1,4}:){5}|(?:[0-9a-f]{1,4})?::(?:[0-9a-f]{1,4}:){4}|(?:(?:[0-9a-f]{1,4}:){0,1}[0-9a-f]{1,4})?::(?:[0-9a-f]{1,4}:){3}|(?:(?:[0-9a-f]{1,4}:){0,2}[0-9a-f]{1,4})?::(?:[0-9a-f]{1,4}:){2}|(?:(?:[0-9a-f]{1,4}:){0,3}[0-9a-f]{1,4})?::[0-9a-f]{1,4}:|(?:(?:[0-9a-f]{1,4}:){0,4}[0-9a-f]{1,4})?::)(?:[0-9a-f]{1,4}:[0-9a-f]{1,4}|(?:(?:25[0-5]|2[0-4]\d|[01]?\d\d?)\.){3}(?:25[0-5]|2[0-4]\d|[01]?\d\d?))|(?:(?:[0-9a-f]{1,4}:){0,5}[0-9a-f]{1,4})?::[0-9a-f]{1,4}|(?:(?:[0-9a-f]{1,4}:){0,6}[0-9a-f]{1,4})?::)|[Vv][0-9a-f]+\.[a-z0-9\-._~!$&'()*+,;=:]+)\]|(?:(?:25[0-5]|2[0-4]\d|[01]?\d\d?)\.){3}(?:25[0-5]|2[0-4]\d|[01]?\d\d?)|(?:[a-z0-9\-._~!$&'"()*+,;=]|%[0-9a-f]{2})*)(?::\d*)?(?:\/(?:[a-z0-9\-._~!$&'"()*+,;=:@]|%[0-9a-f]{2})*)*|\/(?:(?:[a-z0-9\-._~!$&'"()*+,;=:@]|%[0-9a-f]{2})+(?:\/(?:[a-z0-9\-._~!$&'"()*+,;=:@]|%[0-9a-f]{2})*)*)?|(?:[a-z0-9\-._~!$&'"()*+,;=:@]|%[0-9a-f]{2})+(?:\/(?:[a-z0-9\-._~!$&'"()*+,;=:@]|%[0-9a-f]{2})*)*)?(?:\?(?:[a-z0-9\-._~!$&'"()*+,;=:@/?]|%[0-9a-f]{2})*)?(?:#(?:[a-z0-9\-._~!$&'"()*+,;=:@/?]|%[0-9a-f]{2})*)?$/i,"uri-template":/^(?:(?:[^\x00-\x20"'<>%\\^`{|}]|%[0-9a-f]{2})|\{[+#./;?&=,!@|]?(?:[a-z0-9_]|%[0-9a-f]{2})+(?::[1-9][0-9]{0,3}|\*)?(?:,(?:[a-z0-9_]|%[0-9a-f]{2})+(?::[1-9][0-9]{0,3}|\*)?)*\})*$/i,url:/^(?:https?|ftp):\/\/(?:\S+(?::\S*)?@)?(?:(?!(?:10|127)(?:\.\d{1,3}){3})(?!(?:169\.254|192\.168)(?:\.\d{1,3}){2})(?!172\.(?:1[6-9]|2\d|3[0-1])(?:\.\d{1,3}){2})(?:[1-9]\d?|1\d\d|2[01]\d|22[0-3])(?:\.(?:1?\d{1,2}|2[0-4]\d|25[0-5])){2}(?:\.(?:[1-9]\d?|1\d\d|2[0-4]\d|25[0-4]))|(?:(?:[a-z0-9\u{00a1}-\u{ffff}]+-)*[a-z0-9\u{00a1}-\u{ffff}]+)(?:\.(?:[a-z0-9\u{00a1}-\u{ffff}]+-)*[a-z0-9\u{00a1}-\u{ffff}]+)*(?:\.(?:[a-z\u{00a1}-\u{ffff}]{2,})))(?::\d{2,5})?(?:\/[^\s]*)?$/iu,email:/^[a-z0-9!#$%&'*+/=?^_`{|}~-]+(?:\.[a-z0-9!#$%&'*+/=?^_`{|}~-]+)*@(?:[a-z0-9](?:[a-z0-9-]*[a-z0-9])?\.)+[a-z0-9](?:[a-z0-9-]*[a-z0-9])?$/i,hostname:/^(?=.{1,253}\.?$)[a-z0-9](?:[a-z0-9-]{0,61}[a-z0-9])?(?:\.[a-z0-9](?:[-0-9a-z]{0,61}[0-9a-z])?)*\.?$/i,ipv4:/^(?:(?:25[0-5]|2[0-4]\d|[01]?\d\d?)\.){3}(?:25[0-5]|2[0-4]\d|[01]?\d\d?)$/,ipv6:/^((([0-9a-f]{1,4}:){7}([0-9a-f]{1,4}|:))|(([0-9a-f]{1,4}:){6}(:[0-9a-f]{1,4}|((25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)(\.(25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)){3})|:))|(([0-9a-f]{1,4}:){5}(((:[0-9a-f]{1,4}){1,2})|:((25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)(\.(25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)){3})|:))|(([0-9a-f]{1,4}:){4}(((:[0-9a-f]{1,4}){1,3})|((:[0-9a-f]{1,4})?:((25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)(\.(25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)){3}))|:))|(([0-9a-f]{1,4}:){3}(((:[0-9a-f]{1,4}){1,4})|((:[0-9a-f]{1,4}){0,2}:((25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)(\.(25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)){3}))|:))|(([0-9a-f]{1,4}:){2}(((:[0-9a-f]{1,4}){1,5})|((:[0-9a-f]{1,4}){0,3}:((25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)(\.(25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)){3}))|:))|(([0-9a-f]{1,4}:){1}(((:[0-9a-f]{1,4}){1,6})|((:[0-9a-f]{1,4}){0,4}:((25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)(\.(25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)){3}))|:))|(:(((:[0-9a-f]{1,4}){1,7})|((:[0-9a-f]{1,4}){0,5}:((25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)(\.(25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)){3}))|:)))$/i,regex:T,uuid:/^(?:urn:uuid:)?[0-9a-f]{8}-(?:[0-9a-f]{4}-){3}[0-9a-f]{12}$/i,"json-pointer":/^(?:\/(?:[^~/]|~0|~1)*)*$/,"json-pointer-uri-fragment":/^#(?:\/(?:[a-z0-9_\-.!$&'()*+,;:=@]|%[0-9a-f]{2}|~0|~1)*)*$/i,"relative-json-pointer":/^(?:0|[1-9][0-9]*)(?:#|(?:\/(?:[^~/]|~0|~1)*)*)$/,byte:g,int32:{type:"number",validate:w},int64:{type:"number",validate:x},float:{type:"number",validate:S},double:{type:"number",validate:S},password:!0,binary:!0},t.fastFormats={...t.fullFormats,date:e(/^\d\d\d\d-[0-1]\d-[0-3]\d$/,o),time:e(/^(?:[0-2]\d:[0-5]\d:[0-5]\d|23:59:60)(?:\.\d+)?(?:z|[+-]\d\d(?::?\d\d)?)?$/i,c),"date-time":e(/^\d\d\d\d-[0-1]\d-[0-3]\d[t\s](?:[0-2]\d:[0-5]\d:[0-5]\d|23:59:60)(?:\.\d+)?(?:z|[+-]\d\d(?::?\d\d)?)$/i,h),uri:/^(?:[a-z][a-z0-9+\-.]*:)(?:\/?\/)?[^\s]*$/i,"uri-reference":/^(?:(?:[a-z][a-z0-9+\-.]*:)?\/?\/)?(?:[^\\\s#][^\s#]*)?(?:#[^\\\s]*)?$/i,email:/^[a-z0-9.!#$%&'*+/=?^_`{|}~-]+@[a-z0-9](?:[a-z0-9-]{0,61}[a-z0-9])?(?:\.[a-z0-9](?:[a-z0-9-]{0,61}[a-z0-9])?)*$/i},t.formatNames=Object.keys(t.fullFormats);function n(P){return P%4===0&&(P%100!==0||P%400===0)}const r=/^(\d\d\d\d)-(\d\d)-(\d\d)$/,i=[0,31,28,31,30,31,30,31,31,30,31,30,31];function s(P){const F=r.exec(P);if(!F)return!1;const k=+F[1],A=+F[2],M=+F[3];return A>=1&&A<=12&&M>=1&&M<=(A===2&&n(k)?29:i[A])}function o(P,F){if(P&&F)return P>F?1:P<F?-1:0}const a=/^(\d\d):(\d\d):(\d\d)(\.\d+)?(z|[+-]\d\d(?::?\d\d)?)?$/i;function l(P,F){const k=a.exec(P);if(!k)return!1;const A=+k[1],M=+k[2],b=+k[3],j=k[5];return(A<=23&&M<=59&&b<=59||A===23&&M===59&&b===60)&&(!F||j!=="")}function c(P,F){if(!(P&&F))return;const k=a.exec(P),A=a.exec(F);if(k&&A)return P=k[1]+k[2]+k[3]+(k[4]||""),F=A[1]+A[2]+A[3]+(A[4]||""),P>F?1:P<F?-1:0}const u=/t|\s/i;function d(P){const F=P.split(u);return F.length===2&&s(F[0])&&l(F[1],!0)}function h(P,F){if(!(P&&F))return;const[k,A]=P.split(u),[M,b]=F.split(u),j=o(k,M);if(j!==void 0)return j||c(A,b)}const f=/\/|:/,p=/^(?:[a-z][a-z0-9+\-.]*:)(?:\/?\/(?:(?:[a-z0-9\-._~!$&'()*+,;=:]|%[0-9a-f]{2})*@)?(?:\[(?:(?:(?:(?:[0-9a-f]{1,4}:){6}|::(?:[0-9a-f]{1,4}:){5}|(?:[0-9a-f]{1,4})?::(?:[0-9a-f]{1,4}:){4}|(?:(?:[0-9a-f]{1,4}:){0,1}[0-9a-f]{1,4})?::(?:[0-9a-f]{1,4}:){3}|(?:(?:[0-9a-f]{1,4}:){0,2}[0-9a-f]{1,4})?::(?:[0-9a-f]{1,4}:){2}|(?:(?:[0-9a-f]{1,4}:){0,3}[0-9a-f]{1,4})?::[0-9a-f]{1,4}:|(?:(?:[0-9a-f]{1,4}:){0,4}[0-9a-f]{1,4})?::)(?:[0-9a-f]{1,4}:[0-9a-f]{1,4}|(?:(?:25[0-5]|2[0-4]\d|[01]?\d\d?)\.){3}(?:25[0-5]|2[0-4]\d|[01]?\d\d?))|(?:(?:[0-9a-f]{1,4}:){0,5}[0-9a-f]{1,4})?::[0-9a-f]{1,4}|(?:(?:[0-9a-f]{1,4}:){0,6}[0-9a-f]{1,4})?::)|[Vv][0-9a-f]+\.[a-z0-9\-._~!$&'()*+,;=:]+)\]|(?:(?:25[0-5]|2[0-4]\d|[01]?\d\d?)\.){3}(?:25[0-5]|2[0-4]\d|[01]?\d\d?)|(?:[a-z0-9\-._~!$&'()*+,;=]|%[0-9a-f]{2})*)(?::\d*)?(?:\/(?:[a-z0-9\-._~!$&'()*+,;=:@]|%[0-9a-f]{2})*)*|\/(?:(?:[a-z0-9\-._~!$&'()*+,;=:@]|%[0-9a-f]{2})+(?:\/(?:[a-z0-9\-._~!$&'()*+,;=:@]|%[0-9a-f]{2})*)*)?|(?:[a-z0-9\-._~!$&'()*+,;=:@]|%[0-9a-f]{2})+(?:\/(?:[a-z0-9\-._~!$&'()*+,;=:@]|%[0-9a-f]{2})*)*)(?:\?(?:[a-z0-9\-._~!$&'()*+,;=:@/?]|%[0-9a-f]{2})*)?(?:#(?:[a-z0-9\-._~!$&'()*+,;=:@/?]|%[0-9a-f]{2})*)?$/i;function m(P){return f.test(P)&&p.test(P)}const _=/^(?:[A-Za-z0-9+/]{4})*(?:[A-Za-z0-9+/]{2}==|[A-Za-z0-9+/]{3}=)?$/gm;function g(P){return _.lastIndex=0,_.test(P)}const y=-2147483648,v=2**31-1;function w(P){return Number.isInteger(P)&&P<=v&&P>=y}function x(P){return Number.isInteger(P)}function S(){return!0}const C=/[^\\]\\Z/;function T(P){if(C.test(P))return!1;try{return new RegExp(P),!0}catch{return!1}}})(mN);var yN={};(function(t){Object.defineProperty(t,"__esModule",{value:!0}),t.formatLimitDefinition=void 0;const e=pN,n=Le,r=n.operators,i={formatMaximum:{okStr:"<=",ok:r.LTE,fail:r.GT},formatMinimum:{okStr:">=",ok:r.GTE,fail:r.LT},formatExclusiveMaximum:{okStr:"<",ok:r.LT,fail:r.GTE},formatExclusiveMinimum:{okStr:">",ok:r.GT,fail:r.LTE}},s={message:({keyword:a,schemaCode:l})=>n.str`should be ${i[a].okStr} ${l}`,params:({keyword:a,schemaCode:l})=>n._`{comparison: ${i[a].okStr}, limit: ${l}}`};t.formatLimitDefinition={keyword:Object.keys(i),type:"string",schemaType:"string",$data:!0,error:s,code(a){const{gen:l,data:c,schemaCode:u,keyword:d,it:h}=a,{opts:f,self:p}=h;if(!f.validateFormats)return;const m=new e.KeywordCxt(h,p.RULES.all.format.definition,"format");m.$data?_():g();function _(){const v=l.scopeValue("formats",{ref:p.formats,code:f.code.formats}),w=l.const("fmt",n._`${v}[${m.schemaCode}]`);a.fail$data(n.or(n._`typeof ${w} != "object"`,n._`${w} instanceof RegExp`,n._`typeof ${w}.compare != "function"`,y(w)))}function g(){const v=m.schema,w=p.formats[v];if(!w||w===!0)return;if(typeof w!="object"||w instanceof RegExp||typeof w.compare!="function")throw new Error(`"${d}": format "${v}" does not define "compare" function`);const x=l.scopeValue("formats",{key:v,ref:w,code:f.code.formats?n._`${f.code.formats}${n.getProperty(v)}`:void 0});a.fail$data(y(x))}function y(v){return n._`${v}.compare(${c}, ${u}) ${i[d].fail} 0`}},dependencies:["format"]};const o=a=>(a.addKeyword(t.formatLimitDefinition),a);t.default=o})(yN);(function(t,e){Object.defineProperty(e,"__esModule",{value:!0});const n=mN,r=yN,i=Le,s=new i.Name("fullFormats"),o=new i.Name("fastFormats"),a=(c,u={keywords:!0})=>{if(Array.isArray(u))return l(c,u,n.fullFormats,s),c;const[d,h]=u.mode==="fast"?[n.fastFormats,o]:[n.fullFormats,s],f=u.formats||n.formatNames;return l(c,f,d,h),u.keywords&&r.default(c),c};a.get=(c,u="full")=>{const h=(u==="fast"?n.fastFormats:n.fullFormats)[c];if(!h)throw new Error(`Unknown format "${c}"`);return h};function l(c,u,d,h){var f,p;(f=(p=c.opts.code).formats)!==null&&f!==void 0||(p.formats=i._`require("ajv-formats/dist/formats").${h}`);for(const m of u)c.addFormat(m,d[m])}t.exports=e=a,Object.defineProperty(e,"__esModule",{value:!0}),e.default=a})(fx,fx.exports);var pwe=fx.exports;const _I=Za(pwe),mwe={allErrors:!0,multipleOfPrecision:8,strict:!1,verbose:!0,discriminator:!1},ywe=/^(#?([0-9A-Fa-f]{3}){1,2}\b|aqua|black|blue|fuchsia|gray|green|lime|maroon|navy|olive|orange|purple|red|silver|teal|white|yellow|(rgb\(\s*\b([0-9]|[1-9][0-9]|1[0-9][0-9]|2[0-4][0-9]|25[0-5])\b\s*,\s*\b([0-9]|[1-9][0-9]|1[0-9][0-9]|2[0-4][0-9]|25[0-5])\b\s*,\s*\b([0-9]|[1-9][0-9]|1[0-9][0-9]|2[0-4][0-9]|25[0-5])\b\s*\))|(rgb\(\s*(\d?\d%|100%)+\s*,\s*(\d?\d%|100%)+\s*,\s*(\d?\d%|100%)+\s*\)))$/,_we=/^data:([a-z]+\/[a-z0-9-+.]+)?;(?:name=(.*);)?base64,(.*)$/;function vwe(t,e,n={},r,i=gwe){const s=new i({...mwe,...n});return r?_I(s,r):r!==!1&&_I(s),s.addFormat("data-url",_we),s.addFormat("color",ywe),s.addKeyword(Wh),s.addKeyword(IE),Array.isArray(t)&&s.addMetaSchema(t),mt(e)&&Object.keys(e).forEach(o=>{s.addFormat(o,e[o])}),s}function wwe(t=[],e){return t.map(n=>{var r;const{instancePath:i,keyword:s,params:o,schemaPath:a,parentSchema:l,...c}=n;let{message:u=""}=c,d=i.replace(/\//g,"."),h=`${d} ${u}`.trim();const f=[...((r=o.deps)===null||r===void 0?void 0:r.split(", "))||[],o.missingProperty,o.property].filter(p=>p);if(f.length>0)f.forEach(p=>{const m=d?`${d}.${p}`:p;let _=Ke(we(e,`${m.replace(/^\./,"")}`)).title;if(_===void 0){const g=a.replace(/\/properties\//g,"/").split("/").slice(1,-1).concat([p]);_=Ke(we(e,g)).title}if(_)u=u.replace(`'${p}'`,`'${_}'`);else{const g=we(l,[jt,p,"title"]);g&&(u=u.replace(`'${p}'`,`'${g}'`))}}),h=u;else{const p=Ke(we(e,`${d.replace(/^\./,"")}`)).title;if(p)h=`'${p}' ${u}`.trim();else{const m=l==null?void 0:l.title;m&&(h=`'${m}' ${u}`.trim())}}return"missingProperty"in o&&(d=d?`${d}.${o.missingProperty}`:o.missingProperty),{name:s,property:d,message:u,params:o,stack:h,schemaPath:a}})}function xwe(t,e,n,r,i,s,o){const{validationError:a}=e;let l=wwe(e.errors,o);a&&(l=[...l,{stack:a.message}]),typeof s=="function"&&(l=s(l,o));let c=Zfe(l);if(a&&(c={...c,$schema:{__errors:[a.message]}}),typeof i!="function")return{errors:l,errorSchema:c};const u=YM(t,r,n,r,!0),d=i(u,sm(u),o),h=MS(d);return Wg({errors:l,errorSchema:c},h)}class Ewe{constructor(e,n){const{additionalMetaSchemas:r,customFormats:i,ajvOptionsOverrides:s,ajvFormatOptions:o,AjvClass:a}=e;this.ajv=vwe(r,i,s,o,a),this.localizer=n}reset(){this.ajv.removeSchema()}toErrorList(e,n=[]){return bh(e,n)}rawValidation(e,n){var r,i;let s,o;e[bo]&&(o=this.ajv.getSchema(e[bo]));try{o===void 0&&(o=this.ajv.compile(e)),o(n)}catch(l){s=l}let a;return o&&(typeof this.localizer=="function"&&(((r=o.errors)!==null&&r!==void 0?r:[]).forEach(l=>{var c;["missingProperty","property"].forEach(u=>{var d;!((d=l.params)===null||d===void 0)&&d[u]&&(l.params[u]=`'${l.params[u]}'`)}),!((c=l.params)===null||c===void 0)&&c.deps&&(l.params.deps=l.params.deps.split(", ").map(u=>`'${u}'`).join(", "))}),this.localizer(o.errors),((i=o.errors)!==null&&i!==void 0?i:[]).forEach(l=>{var c;["missingProperty","property"].forEach(u=>{var d;!((d=l.params)===null||d===void 0)&&d[u]&&(l.params[u]=l.params[u].slice(1,-1))}),!((c=l.params)===null||c===void 0)&&c.deps&&(l.params.deps=l.params.deps.split(", ").map(u=>u.slice(1,-1)).join(", "))})),a=o.errors||void 0,o.errors=null),{errors:a,validationError:s}}validateFormData(e,n,r,i,s){const o=this.rawValidation(n,e);return xwe(this,o,e,n,r,i,s)}handleSchemaUpdate(e){var n,r;const i=(n=e[bo])!==null&&n!==void 0?n:$L;this.ajv.getSchema(i)===void 0?this.ajv.addSchema(e,i):St(e,(r=this.ajv.getSchema(i))===null||r===void 0?void 0:r.schema)||(this.ajv.removeSchema(i),this.ajv.addSchema(e,i))}isValid(e,n,r){var i;try{this.handleSchemaUpdate(r);const s=DS(e),o=(i=s[bo])!==null&&i!==void 0?i:Vfe(s);let a;return a=this.ajv.getSchema(o),a===void 0&&(a=this.ajv.addSchema(s,o).getSchema(o)||this.ajv.compile(s)),a(n)}catch(s){return console.warn("Error encountered compiling schema:",s),!1}}}function Swe(t={},e){return new Ewe(t,e)}const bwe=Swe(),mg=["whitetail","turkey","bear","coyote","bobcat","fisher","fox","raccoon","porcupine","beaver","other"],Cwe=["scat","tracks","bed","rub","scrape","feathers","kill_site","hair","other"],Twe=["dawn","day","dusk","night"],Pwe=["ridge","bench","creek","crossing","saddle","logging_road","food","bed","other"],Rwe=["upwind","crosswind","downwind","unknown"],Iwe=["1.5","2.5","3.5","4.5+"],Awe=["none","light","moderate","heavy"],ao={type:"string",pattern:"^\\d{4}-\\d{2}-\\d{2}$",title:"Date (YYYY-MM-DD)"},yg={type:"string",pattern:"^\\d{2}:\\d{2}$",title:"Time (HH:MM)"},Fwe={property_boundary:{type:"object",properties:{name:{type:"string",title:"Area Name"},acres:{type:"number",title:"Acres",readOnly:!0},notes:{type:"string",title:"Notes"}},required:["name","acres"]},trees_points:{type:"object",properties:{species_group:{type:"string",enum:["oak","maple","pine","hemlock","spruce","birch","cherry","beech","ash","aspen","cedar","shrub","other"],title:"Group"},species_name:{type:"string",title:"Species"},species_other:{type:"string",title:"Other Species"},acorn_density_0_5:{type:"integer",minimum:0,maximum:5,title:"Acorn Density (0-5)"},mast_presence:{type:"string",enum:[...Awe],title:"Mast Presence"},photos:{type:"array",title:"Photos",items:{type:"string"}},notes:{type:"string",title:"Notes"}},required:["species_group","species_name"],allOf:[{if:{properties:{species_group:{const:"oak"}}},then:{properties:{species_name:{type:"string",enum:["red_oak","white_oak","chestnut_oak","black_oak","scarlet_oak"]}}}},{if:{properties:{species_group:{const:"maple"}}},then:{properties:{species_name:{type:"string",enum:["sugar_maple","red_maple","maple"]}}}},{if:{properties:{species_group:{const:"pine"}}},then:{properties:{species_name:{type:"string",enum:["white_pine","red_pine"]}}}},{if:{properties:{species_group:{const:"hemlock"}}},then:{properties:{species_name:{type:"string",enum:["hemlock"]}}}},{if:{properties:{species_group:{const:"spruce"}}},then:{properties:{species_name:{type:"string",enum:["spruce"]}}}},{if:{properties:{species_group:{const:"birch"}}},then:{properties:{species_name:{type:"string",enum:["birch","yellow_birch"]}}}},{if:{properties:{species_group:{const:"cherry"}}},then:{properties:{species_name:{type:"string",enum:["cherry"]}}}},{if:{properties:{species_group:{const:"beech"}}},then:{properties:{species_name:{type:"string",enum:["beech"]}}}},{if:{properties:{species_group:{const:"ash"}}},then:{properties:{species_name:{type:"string",enum:["ash"]}}}},{if:{properties:{species_group:{const:"aspen"}}},then:{properties:{species_name:{type:"string",enum:["aspen"]}}}},{if:{properties:{species_group:{const:"cedar"}}},then:{properties:{species_name:{type:"string",enum:["cedar"]}}}},{if:{properties:{species_group:{const:"shrub"}}},then:{properties:{species_name:{type:"string",enum:["mountain_laurel","huckleberry","blueberry"]}}}},{if:{properties:{species_group:{const:"other"}}},then:{properties:{species_name:{type:"string",enum:["other"]}}}}]},tree_stands:{type:"object",properties:{dominant_species:{type:"string",enum:["red_oak","white_oak","chestnut_oak","hemlock","white_pine","spruce","maple","birch","mixed"],title:"Dominant Species"},oak_density_0_5:{type:"integer",minimum:0,maximum:5,title:"Oak Density (0-5)"},canopy_density_0_5:{type:"integer",minimum:0,maximum:5,title:"Canopy Density (0-5)"},photos:{type:"array",title:"Photos",items:{type:"string"}},notes:{type:"string",title:"Notes"},area_acres:{type:"number",title:"Area (acres)",readOnly:!0}},required:[]},bedding_areas:{type:"object",properties:{cover_type:{type:"string",enum:["pines","hemlocks","laurel","mountain_laurel","huckleberry","blueberry","brush","tall_grass","mixed"],title:"Cover Type"},size_acres:{type:"number",title:"Approximate Size (acres)",readOnly:!0},freshness:{type:"string",enum:["fresh","recent","old"],title:"Freshness"},photos:{type:"array",title:"Photos",items:{type:"string"}},notes:{type:"string",title:"Notes"}}},beds_points:{type:"object",properties:{freshness:{type:"string",enum:["fresh","recent","old"],title:"Freshness"},hair_present:{type:"boolean",title:"Hair Present"},date:ao,photos:{type:"array",title:"Photos",items:{type:"string"}},notes:{type:"string",title:"Notes"}}},open_woods:{type:"object",properties:{openness_1_5:{type:"integer",minimum:1,maximum:5,title:"Openness (1=Thick, 5=Wide Open)"},understory_1_5:{type:"integer",minimum:1,maximum:5,title:"Understory (1=Sparse, 5=Dense)"},notes:{type:"string",title:"Notes"},area_acres:{type:"number",title:"Area (acres)",readOnly:!0}}},acorn_flats:{type:"object",properties:{oak_density_0_5:{type:"integer",minimum:0,maximum:5,title:"Oak Density (0-5)"},acorn_density_0_5:{type:"integer",minimum:0,maximum:5,title:"Acorn Density (0-5)"},sign_level:{type:"string",enum:["low","med","high"],title:"Deer Sign Level"},photos:{type:"array",title:"Photos",items:{type:"string"}},notes:{type:"string",title:"Notes"},area_acres:{type:"number",title:"Area (acres)",readOnly:!0}}},mast_check_points:{type:"object",properties:{oak_species:{type:"string",enum:["red","white","chestnut","mixed","unknown"],title:"Oak Species"},acorn_density_0_5:{type:"integer",minimum:0,maximum:5,title:"Acorn Density (0-5)"},date:ao,photos:{type:"array",title:"Photos",items:{type:"string"}},notes:{type:"string",title:"Notes"}},required:["date"]},big_rocks:{type:"object",properties:{rock_type:{type:"string",enum:["boulder","outcrop","talus","other"]},size_m:{type:"number",title:"Approximate Size (m)"},provides_cover:{type:"boolean",title:"Provides Cover"},vantage:{type:"boolean",title:"Good Vantage Point"},photos:{type:"array",title:"Photos",items:{type:"string"}},notes:{type:"string",title:"Notes"}}},cliffs:{type:"object",properties:{height_est_ft:{type:"integer",title:"Height (ft)"},hazard:{type:"boolean",title:"Hazardous"},photos:{type:"array",title:"Photos",items:{type:"string"}},notes:{type:"string",title:"Notes"}}},ravines:{type:"object",properties:{depth_est_ft:{type:"integer",title:"Depth (ft)"},passable:{type:"boolean",title:"Passable on Foot"},photos:{type:"array",title:"Photos",items:{type:"string"}},notes:{type:"string",title:"Notes"}}},streams:{type:"object",properties:{flow_type:{type:"string",enum:["perennial","intermittent","ephemeral"],title:"Flow Type"},crossing_easy:{type:"boolean",title:"Easy Crossing"},water_depth_cm:{type:"integer",title:"Depth (cm)"},photos:{type:"array",title:"Photos",items:{type:"string"}},notes:{type:"string",title:"Notes"}}},trails:{type:"object",properties:{name:{type:"string",title:"Trail Name"},trail_type:{type:"string",enum:["deer","foot","atv","logging_road"],enumNames:["Deer Trail","Foot Path","ATV/Access","Logging Road"],title:"Trail Type"},prominence:{type:"string",enum:["main","faint"],enumNames:["Main Route","Light/Faint"],title:"Traffic Level"},condition:{type:"string",enum:["recent","old","rough"],enumNames:["Recent","Old","Rough"],title:"Condition"},driveable:{type:"boolean",title:"Driveable"},notes:{type:"string",title:"Notes"}},required:["name","trail_type"]},scrapes:{type:"object",properties:{freshness:{type:"string",enum:["fresh","recent","old"],title:"Freshness"},size_class:{type:"string",enum:["small","medium","large"],title:"Size"},licking_branch:{type:"boolean",title:"Has Licking Branch"},date:ao,photos:{type:"array",title:"Photos",items:{type:"string"}},notes:{type:"string",title:"Notes"}},required:["date"]},rubs:{type:"object",properties:{diameter_in:{type:"number",title:"Trunk Diameter (in)"},height_in:{type:"number",title:"Rub Height (in)"},direction_bearing:{type:"integer",minimum:0,maximum:359,title:"Travel Bearing ()"},date:ao,photos:{type:"array",title:"Photos",items:{type:"string"}},notes:{type:"string",title:"Notes"}},required:["date"]},stands:{type:"object",properties:{name:{type:"string",title:"Stand Name"},stand_type:{type:"string",enum:["climber","double","blind","shanty","saddle","ground"],title:"Stand Type"},good_winds:{type:"array",items:{type:"string",enum:["N","NNE","NE","ENE","E","ESE","SE","SSE","S","SSW","SW","WSW","W","WNW","NW","NNW"]},uniqueItems:!0,title:"Good Winds"},access_notes:{type:"string",title:"Access Notes"},photos:{type:"array",title:"Photos",items:{type:"string"}},notes:{type:"string",title:"Notes"}}},hunts:{type:"object",properties:{hunt_id:{type:"string"},user_name:{type:"string"},date:ao,start_time:yg,end_time:yg,wind_dir_deg:{type:"integer",minimum:0,maximum:359},wind_speed_mph:{type:"number"},temp_f:{type:"number"},pressure_inhg:{type:"number"},stand_or_blind:{type:"string"},notes:{type:"string",title:"Notes"}},required:["hunt_id","date","start_time"]},animal_sightings:{type:"object",properties:{sighting_id:{type:"string"},hunt_id:{type:"string"},species:{type:"string",enum:[...mg]},sex:{type:"string",enum:["unknown","doe","buck","hen","tom","boar","sow"]},age_class:{type:"string",enum:["fawn","yearling","2.5+","unknown"]},count:{type:"integer",minimum:1},behavior:{type:"string",enum:["feeding","moving","bedding","alerted","vocalizing"]},time_of_day:{type:"string",enum:[...Twe],title:"Time of Day"},terrain_use:{type:"string",enum:[...Pwe],title:"Terrain Use"},direction_bearing:{type:"integer",minimum:0,maximum:359,title:"Direction ()"},wind_relation:{type:"string",enum:[...Rwe],title:"Wind Relation"},distance_yards:{type:"integer"},photos:{type:"array",title:"Photos",items:{type:"string"}},notes:{type:"string",title:"Notes"}},required:["sighting_id","species","count"]},animal_paths:{type:"object",properties:{name:{type:"string",title:"Path Name"},path_id:{type:"string"},hunt_id:{type:"string",title:"Linked Hunt ID"},species:{type:"string",enum:[...mg],title:"Species"},confidence:{type:"string",enum:["observed","likely","guess"],enumNames:["Observed","Likely","Assumed"],title:"Confidence"},start_time:yg,end_time:yg,notes:{type:"string",title:"Notes"}},required:["name","path_id","species","confidence"]},animal_sign:{type:"object",properties:{sign_id:{type:"string"},species:{type:"string",enum:[...mg],title:"Species"},sign_type:{type:"string",enum:[...Cwe],title:"Sign Type"},freshness:{type:"string",enum:["fresh","recent","old"],title:"Freshness"},track_size_class:{type:"string",enum:["small","medium","large"],title:"Track Size (if tracks)"},direction_bearing:{type:"integer",minimum:0,maximum:359,title:"Direction ()"},scat_size_class:{type:"string",enum:["pellet","small","large"],title:"Scat Size (if scat)"},scat_composition:{type:"string",title:"Scat Composition"},date:ao,photos:{type:"array",title:"Photos",items:{type:"string"}},notes:{type:"string",title:"Notes"},created_by:{type:"string",title:"Created By"}},required:["sign_id","species","sign_type"]},harvests:{type:"object",properties:{harvest_id:{type:"string"},hunt_id:{type:"string",title:"Linked Hunt ID"},species:{type:"string",enum:[...mg],title:"Species"},sex:{type:"string",enum:["unknown","doe","buck","hen","tom","boar","sow"]},weight_lbs:{type:"number",title:"Weight (lbs)"},weapon:{type:"string",enum:["bow","rifle","muzzleloader","shotgun","other"],title:"Weapon"},age_estimate:{type:"string",enum:[...Iwe],title:"Age (estimate)"},points:{type:"integer",minimum:0,title:"Points (deer)"},beard_length_in:{type:"number",title:"Beard Length (in, turkey)"},spur_length_in:{type:"number",title:"Spur Length (in, turkey)"},shot_distance_yards:{type:"integer",title:"Shot Distance (yd)"},date:ao,photos:{type:"array",title:"Photos",items:{type:"string"}},notes:{type:"string",title:"Notes"},created_by:{type:"string",title:"Created By"}},required:["harvest_id","species"]},cover_points:{type:"object",properties:{cover_type:{type:"string",enum:["pines","hemlocks","laurel","mountain_laurel","huckleberry","blueberry","brush","tall_grass","mixed"],title:"Cover Type"},date:ao,photos:{type:"array",title:"Photos",items:{type:"string"}},notes:{type:"string",title:"Notes"}}}};function Owe(t){return Fwe[t]||{type:"object",properties:{}}}const $we={trees_points:{species_group:{"ui:widget":"select"},species_name:{"ui:widget":"select","ui:placeholder":"Choose species"},notes:{"ui:widget":"textarea","ui:options":{rows:3}},"ui:order":["species_group","species_name","species_other","acorn_density_0_5","mast_presence","photos","notes"]},trails:{trail_type:{"ui:widget":"radio"},prominence:{"ui:widget":"radio"},notes:{"ui:widget":"textarea","ui:options":{rows:3},"ui:placeholder":"Surface conditions, access notes, landmarks"}},animal_paths:{confidence:{"ui:widget":"radio"},notes:{"ui:widget":"textarea","ui:options":{rows:3},"ui:placeholder":"Observed behavior, timing, direction"}},stands:{good_winds:{"ui:widget":"checkboxes"},notes:{"ui:widget":"textarea","ui:options":{rows:3},"ui:placeholder":"Entry/exit strategy, shooting lanes, nearby cover"},photos:{"ui:options":{orderable:!1}}}};function Lwe(t){return $we[t]}const kwe={display:"flex",flexDirection:"column",gap:8},Mwe={display:"flex",flexWrap:"wrap",gap:8},Dwe={position:"relative",width:96,height:72,borderRadius:6,overflow:"hidden",border:"1px solid rgba(0,0,0,0.1)",background:"#f3f3f3"},Nwe={position:"absolute",top:4,right:4,border:"none",borderRadius:"50%",width:18,height:18,background:"rgba(0,0,0,0.65)",color:"#fff",cursor:"pointer",fontSize:12,lineHeight:"18px",padding:0},jwe={fontSize:12,color:"rgba(0,0,0,0.45)"},zwe={alignSelf:"flex-start",padding:"6px 12px",borderRadius:6,border:"1px solid rgba(0,0,0,0.12)",background:"#f7f7f7",cursor:"pointer"},Uwe={fontSize:10,padding:6,display:"block",lineHeight:1.2},Gwe=t=>t?Array.isArray(t)?t.filter(e=>typeof e=="string"):typeof t=="string"?[t]:[]:[],Bwe=t=>{const e=t.replace(/\\/g,"/");return`file://${encodeURI(e)}`},Vwe=t=>{const{value:e,onChange:n,disabled:r,readonly:i}=t,{projectPath:s}=He(),o=K.useMemo(()=>Gwe(e),[e]),[a,l]=K.useState({});K.useEffect(()=>{let f=!1;return!s||o.length===0?(l({}),()=>{f=!0}):((async()=>{const m={};for(const _ of o)try{const g=await window.api.resolveMediaPath(s,_);m[_]=Bwe(g)}catch{m[_]=""}f||l(m)})(),()=>{f=!0})},[o,s]);const c=K.useCallback(async()=>{if(!s)return;const f=await window.api.chooseFiles([{name:"Images",extensions:["jpg","jpeg","png","webp","gif","heic"]}]);if(!f||f.length===0)return;const p=[];for(const m of f){const _=await window.api.copyToMedia(s,m);p.push(_)}n([...o,...p])},[o,n,s]),u=K.useCallback(f=>{n(o.filter(p=>p!==f))},[o,n]),d=K.useCallback(f=>{const p=a[f];p&&window.open(p,"_blank")},[a]),h=!r&&!i;return E.jsxs("div",{style:kwe,children:[E.jsxs("div",{style:Mwe,children:[o.map(f=>E.jsxs("div",{style:Dwe,children:[a[f]?E.jsx("img",{src:a[f],alt:f,style:{width:"100%",height:"100%",objectFit:"cover",cursor:"pointer"},onClick:()=>d(f)}):E.jsx("span",{style:Uwe,children:f.split("/").pop()}),h?E.jsx("button",{type:"button",onClick:()=>u(f),style:Nwe,children:""}):null]},f)),o.length===0?E.jsx("span",{style:jwe,children:"No photos yet."}):null]}),h?E.jsx("button",{type:"button",style:zwe,onClick:()=>void c(),disabled:!s,children:o.length?"Add More Photos":"Attach Photos"}):null]})};function ea({layerId:t,initialValues:e,onSubmit:n,onCancel:r}){const i=K.useMemo(()=>Owe(t),[t]),s=K.useMemo(()=>Lwe(t)??{},[t]),o=ja[t],a=K.useRef(null),l=K.useMemo(()=>{var h,f;const d={...s};return(h=i==null?void 0:i.properties)!=null&&h.photos&&!d.photos&&(d.photos={"ui:widget":"PhotoGallery"}),(f=i==null?void 0:i.properties)!=null&&f.notes&&!d.notes&&(d.notes={"ui:widget":"textarea","ui:options":{rows:3},"ui:autofocus":!0}),d},[s,i]),c=K.useMemo(()=>({PhotoGallery:Vwe}),[]),u=K.useCallback(d=>{var h;if((d.metaKey||d.ctrlKey)&&d.key==="Enter")try{const f=((h=a.current)==null?void 0:h.formElement)||null;f&&typeof f.requestSubmit=="function"&&(f.requestSubmit(),d.preventDefault())}catch{}},[]);return E.jsxs("div",{style:{minWidth:380,maxWidth:540,background:"rgba(255,255,255,0.96)",borderRadius:12,padding:18,boxShadow:"0 16px 40px rgba(15, 23, 42, 0.18)",border:"1px solid rgba(15, 23, 42, 0.08)"},onKeyDown:u,children:[E.jsxs("div",{style:{display:"flex",alignItems:"center",gap:10,marginBottom:14},children:[E.jsx("span",{style:{fontSize:20},children:o.icon??""}),E.jsxs("div",{children:[E.jsx("h3",{style:{margin:0,fontSize:16},children:o.label}),E.jsx("p",{style:{margin:0,fontSize:12,color:"rgba(0,0,0,0.55)"},children:"Add the details below and hit save when youre done."})]})]}),E.jsx(Tme,{ref:a,schema:i,formData:e,uiSchema:l,widgets:c,validator:bwe,onSubmit:d=>n(d.formData),children:E.jsxs("div",{style:{display:"flex",gap:10,justifyContent:"flex-end",marginTop:12},children:[r?E.jsx("button",{type:"button",onClick:r,style:{padding:"6px 14px",borderRadius:6,border:"1px solid rgba(0,0,0,0.12)",background:"#f7f7f7",cursor:"pointer"},children:"Cancel"}):null,E.jsx("button",{type:"submit",style:{padding:"6px 18px",borderRadius:6,border:"none",background:"#0a84ff",color:"#fff",fontWeight:600,cursor:"pointer"},children:"Save"})]})})]})}const Ve=Qi((t,e)=>({activeUser:null,users:[],loadUsers:async()=>{var n,r;try{const i=(r=(n=He.getState)==null?void 0:n.call(He))==null?void 0:r.projectPath;if(!i)return;const s=await window.api.readTextFile(i,"project.json"),o=JSON.parse(s||"{}"),a=Array.isArray(o.users)?o.users.filter(l=>typeof l=="string"):[];t({users:a})}catch{t({users:[]})}},setActiveUser:async n=>{var i,s;const r=(s=(i=He.getState)==null?void 0:i.call(He))==null?void 0:s.projectPath;if(!r){t({activeUser:n||null}),window.__ACTIVE_USER__=n||void 0;return}try{const o=await window.api.readTextFile(r,"project.json"),a=JSON.parse(o||"{}"),l=Array.isArray(a.users)?a.users:[];n&&!l.includes(n)&&l.push(n),a.users=l,await window.api.writeTextFile(r,"project.json",JSON.stringify(a,null,2))}catch{}t({activeUser:n||null}),window.__ACTIVE_USER__=n||void 0},addUser:async n=>{var r,i,s,o;(i=(r=Ve.getState)==null?void 0:r.call(Ve))==null||i.projectPath;try{const a=(o=(s=He.getState)==null?void 0:s.call(He))==null?void 0:o.projectPath;if(!a)return;const l=await window.api.readTextFile(a,"project.json"),c=JSON.parse(l||"{}"),u=Array.isArray(c.users)?c.users:[];u.includes(n)||u.push(n),c.users=u,await window.api.writeTextFile(a,"project.json",JSON.stringify(c,null,2)),e().loadUsers()}catch{}}})),Fn=Qi((t,e)=>({species:new Set,signTypes:new Set,onlyMine:!1,temporalView:"all",setSpecies:n=>t({species:new Set(n)}),toggleSpecies:n=>t(r=>{const i=new Set(r.species);return i.has(n)?i.delete(n):i.add(n),{species:i}}),setSignTypes:n=>t({signTypes:new Set(n)}),toggleSignType:n=>t(r=>{const i=new Set(r.signTypes);return i.has(n)?i.delete(n):i.add(n),{signTypes:i}}),setOnlyMine:n=>t({onlyMine:n}),setTemporalView:n=>t({temporalView:n}),clear:()=>t({species:new Set,signTypes:new Set,onlyMine:!1,temporalView:"all"})}));function yl(t,e){var h,f,p,m,_;const{species:n,signTypes:r,onlyMine:i,temporalView:s}=Fn.getState(),{timeWindow:o}=It.getState(),a=["property_boundary","streams","cliffs","ravines","big_rocks"];if(s==="permanentOnly")return a.includes(t);if(n.size>0){const g=(h=e==null?void 0:e.get)==null?void 0:h.call(e,"species");if(g&&!n.has(String(g)))return!1}if(r.size>0){const g=(f=e==null?void 0:e.get)==null?void 0:f.call(e,"sign_type");if(g&&!r.has(String(g))||t==="rubs"&&!r.has("rub")||t==="scrapes"&&!r.has("scrape"))return!1}if(i){const g=(p=e==null?void 0:e.get)==null?void 0:p.call(e,"created_by"),y=window.__ACTIVE_USER__;if(y&&g&&String(g)!==y)return!1}const l=o==="1y"?365:o==="5y"?365*5:s==="recentOnly"?365:null;if(l!==null){const g=(m=e==null?void 0:e.get)==null?void 0:m.call(e,"date");if(!g||typeof g!="string")return!1;const y=/^(\d{4})-(\d{2})-(\d{2})/.exec(g);if(!y)return!1;const v=new Date(`${y[1]}-${y[2]}-${y[3]}T00:00:00Z`);if(Number.isNaN(v.getTime()))return!1;const w=Date.now();if(Math.floor((w-v.getTime())/(1e3*60*60*24))>l)return!1}const c=Xm(),u=((_=c==null?void 0:c.getView())==null?void 0:_.getZoom())||10;return!(["scrapes","rubs","beds_points","animal_sign"].includes(t)&&u<14)}function cf(t,e){var h;const{temporalView:n}=Fn.getState(),{timeWindow:r}=It.getState();if(n==="permanentOnly")return 1;const i=r==="1y"?365:r==="5y"?365*5:null;if(!i)return 1;const s=(h=e==null?void 0:e.get)==null?void 0:h.call(e,"date");if(!s||typeof s!="string")return .6;const o=/^(\d{4})-(\d{2})-(\d{2})/.exec(s);if(!o)return .6;const a=new Date(`${o[1]}-${o[2]}-${o[3]}T00:00:00Z`);if(Number.isNaN(a.getTime()))return .6;const l=Date.now(),c=Math.max(0,Math.floor((l-a.getTime())/(1e3*60*60*24))),d=1-Math.min(1,c/i)*.65;return Math.max(.35,Math.min(1,d))}const Xi=Qi(t=>({selected:null,setSelected:e=>t({selected:e})})),Wwe=t=>{var h,f,p;const e=(h=t==null?void 0:t.get)==null?void 0:h.call(t,"trail_type"),n=(f=t==null?void 0:t.get)==null?void 0:f.call(t,"condition"),r=e==="logging_road"?"#8d6e63":e==="atv"?"#a35b20":"#c57b30",i=n==="rough"?[8,6]:void 0,s=n==="recent"?3.5:n==="old"?2.5:3,o=String(((p=t==null?void 0:t.get)==null?void 0:p.call(t,"name"))||""),a=e==="logging_road"?" (LR)":"",l=cf("trails",t),[c,u,d]=r==="#8d6e63"?[141,110,99]:r==="#a35b20"?[163,91,32]:[197,123,48];return new nt({stroke:new yt({color:`rgba(${c},${u},${d},${l})`,width:s,lineDash:i}),text:o?new Zo({text:o+a,font:"12px 'Inter', sans-serif",fill:new Wt({color:`rgba(255,255,255,${l})`}),stroke:new yt({color:`rgba(0,0,0,${.6*l})`,width:3}),placement:"line",overflow:!0}):void 0})};function Hwe(){const{projectPath:t}=He(),e=Tr(),n=K.useRef(new Cn),r=K.useRef(null),i=K.useRef(null),s=K.useRef(null),o=K.useRef(null),a=K.useRef(async()=>{}),[l,c]=K.useState(null);K.useEffect(()=>{if(!e||!t)return;const h=new Pr({source:n.current,style:F=>yl("trails",F)?Wwe(F):null});r.current=h,e.addLayer(h);const f=async()=>{if(!t)return;const F=new ut().writeFeaturesObject(n.current.getFeatures(),{dataProjection:"EPSG:4326",featureProjection:"EPSG:3857"});await window.api.writeTextFile(t,"data/trails.geojson",JSON.stringify(F,null,2))};a.current=f;const p=async()=>{try{const F=await window.api.readTextFile(t,"data/trails.geojson"),k=JSON.parse(F||'{"type":"FeatureCollection","features":[]}'),A=new ut().readFeatures(k,{dataProjection:"EPSG:4326",featureProjection:"EPSG:3857"});n.current.clear(),n.current.addFeatures(A);let M=!1;n.current.getFeatures().forEach((j,V)=>{j.get("name")||(j.set("name",`Trail ${V+1}`),M=!0)}),M&&await f()}catch{}};p();const m=()=>void p(),_=new Ks({layers:[h]});o.current=_,e.addInteraction(_),_.on("select",F=>{var A;const k=((A=F.selected)==null?void 0:A[0])||null;Xi.getState().setSelected(k?{layerId:"trails",feature:k}:null)});const g=()=>{if(!Ve.getState().activeUser){window.alert("Please select an Active User before editing geometry.");return}if(s.current)return;const k=new RL({source:n.current});s.current=k,e.addInteraction(k),k.on("modifyend",A=>{var b,j;const M=Ve.getState().activeUser;M&&((j=(b=A.features)==null?void 0:b.forEach)==null||j.call(b,V=>{V.set("updated_by",M),V.set("updated_at",new Date().toISOString())}),f())})},y=()=>{s.current&&(e.removeInteraction(s.current),s.current=null)},v=()=>g(),w=()=>y(),x=()=>void f();window.addEventListener("layer:enable-modify:trails",v),window.addEventListener("layer:disable-modify:trails",w),window.addEventListener("layer:persist:trails",x),_.on("select",()=>{});const S=()=>{if(!Ve.getState().activeUser){window.alert("Please select an Active User before adding features.");return}if(i.current)return;const k=new Qo({source:n.current,type:"LineString"});i.current=k,e.addInteraction(k),k.on("drawend",async A=>{var j;const M=A.feature;M.setId(((j=M.getId)==null?void 0:j.call(M))||Ba());const b=n.current.getFeatures().length;c({feature:M,initial:{name:`Trail ${b}`,trail_type:"deer",prominence:"main",notes:""}}),i.current&&(e.removeInteraction(i.current),i.current=null)})},C=async()=>{var k,A;const F=(A=(k=o.current)==null?void 0:k.getFeatures)==null?void 0:A.call(k);F&&(F.forEach(M=>n.current.removeFeature(M)),F.clear(),await f())},T=()=>S(),P=()=>void C();return window.addEventListener("start-trail-draw",T),window.addEventListener("delete-selected-trail",P),window.addEventListener("layers:reload",m),()=>{window.removeEventListener("layer:enable-modify:trails",v),window.removeEventListener("layer:disable-modify:trails",w),window.removeEventListener("layer:persist:trails",x),window.removeEventListener("start-trail-draw",T),window.removeEventListener("delete-selected-trail",P),window.removeEventListener("layers:reload",m),i.current&&e.removeInteraction(i.current),s.current&&e.removeInteraction(s.current),o.current&&e.removeInteraction(o.current),r.current&&e.removeLayer(r.current),i.current=null,s.current=null,o.current=null,r.current=null,a.current=async()=>{}}},[e,t]),K.useEffect(()=>{const h=r.current;if(!h)return;const f=()=>{const m=It.getState().isLayerVisible("trails");h.setVisible(m)};f();const p=It.subscribe(f);return()=>{p()}},[]);const u=async h=>{if(!l)return;const f=Ve.getState().activeUser;if(!f){window.alert("Please select an Active User before saving.");return}l.feature.setProperties(h),l.feature.get("created_by")||l.feature.set("created_by",f),l.feature.get("created_at")||l.feature.set("created_at",new Date().toISOString()),l.feature.set("updated_by",f),l.feature.set("updated_at",new Date().toISOString()),c(null),await a.current()},d=()=>{l&&(n.current.removeFeature(l.feature),c(null),a.current())};return l?E.jsxs("div",{style:{position:"fixed",left:0,right:0,bottom:0,padding:12,background:"rgba(255,255,255,0.95)",borderTop:"1px solid #ddd",zIndex:2e3},children:[E.jsx("h3",{style:{marginTop:0},children:"Add Trail"}),E.jsx(ea,{layerId:"trails",initialValues:l.initial,onSubmit:u,onCancel:d})]}):null}function Kwe(){const[t,e]=K.useState(!1),n=It(p=>p.preset),r=It(p=>p.setPreset),i=It(p=>p.timeWindow),s=It(p=>p.setTimeWindow),o=Fn(p=>p.temporalView),a=Fn(p=>p.setTemporalView),l=Fn(p=>p.onlyMine),c=Fn(p=>p.setOnlyMine),u=Fn(p=>p.setSpecies),d=It(p=>p.setLayerOverride),h={padding:"6px 12px",borderRadius:6,border:"1px solid rgba(15, 23, 42, 0.12)",background:"rgba(255, 255, 255, 0.92)",fontSize:12,cursor:"pointer",color:"rgba(15,23,42,0.75)",boxShadow:"0 4px 12px rgba(15,23,42,0.08)",width:"100%",textAlign:"left"};if(!t)return E.jsx("button",{onClick:()=>e(!0),style:h,children:"Layer Presets"});const f=p=>({display:"flex",alignItems:"center",justifyContent:"space-between",padding:"6px 10px",borderRadius:4,border:"1px solid rgba(15,23,42,0.12)",background:p?"rgba(10,132,255,0.12)":"#f7f9fc",fontSize:12,color:p?"#0a84ff":"rgba(15,23,42,0.75)",fontWeight:p?600:500});return E.jsxs("div",{style:{display:"flex",flexDirection:"column",gap:4,padding:"12px 14px",borderRadius:6,border:"1px solid rgba(15, 23, 42, 0.12)",background:"rgba(255, 255, 255, 0.94)",boxShadow:"0 12px 28px rgba(15, 23, 42, 0.12)",width:"100%"},children:[E.jsxs("div",{onClick:()=>e(!1),style:{display:"flex",justifyContent:"space-between",alignItems:"center",cursor:"pointer"},title:"Click to collapse",children:[E.jsx("div",{style:{fontSize:13,fontWeight:600,color:"rgba(15,23,42,0.75)"},children:"Layer Presets"}),E.jsx("button",{onClick:()=>e(!1),style:{border:"none",background:"transparent",fontSize:12,color:"rgba(15,23,42,0.55)",cursor:"pointer"},children:"Hide"})]}),E.jsxs("label",{style:f(n==="terrain"),children:[E.jsx("span",{children:"Terrain Only"}),E.jsx("input",{type:"checkbox",checked:n==="terrain",onChange:()=>r(n==="terrain"?"everything":"terrain")})]}),E.jsxs("label",{style:f(n==="sign"),children:[E.jsx("span",{children:"Sign Only"}),E.jsx("input",{type:"checkbox",checked:n==="sign",onChange:()=>r(n==="sign"?"everything":"sign")})]}),E.jsxs("label",{style:f(n==="hunts"),children:[E.jsx("span",{children:"Hunts Only"}),E.jsx("input",{type:"checkbox",checked:n==="hunts",onChange:()=>r(n==="hunts"?"everything":"hunts")})]}),E.jsxs("label",{style:f(n==="everything"),children:[E.jsx("span",{children:"Everything"}),E.jsx("input",{type:"checkbox",checked:n==="everything",onChange:()=>r("everything")})]}),E.jsx("hr",{style:{border:"none",borderTop:"1px solid rgba(15,23,42,0.12)",margin:"6px 0"}}),E.jsxs("label",{style:f(o==="permanentOnly"),children:[E.jsx("span",{children:"Historical (Permanent)"}),E.jsx("input",{type:"checkbox",checked:o==="permanentOnly",onChange:()=>{o==="permanentOnly"?(a("all"),r("everything")):(a("permanentOnly"),r("terrain"))}})]}),E.jsxs("label",{style:f(n==="hunts"&&l===!1),children:[E.jsx("span",{children:"Kills"}),E.jsx("input",{type:"checkbox",checked:n==="hunts"&&l===!1,onChange:()=>{r("hunts"),c(!1);const p="harvests",m=["hunts","animal_sightings","animal_paths","stands"];d(p,!0),m.forEach(_=>d(_,!1))}})]}),E.jsxs("label",{style:f(n==="hunts"&&l===!0),children:[E.jsx("span",{children:"My Kills"}),E.jsx("input",{type:"checkbox",checked:n==="hunts"&&l===!0,onChange:()=>{r("hunts"),c(!0);const p="harvests",m=["hunts","animal_sightings","animal_paths","stands"];d(p,!0),m.forEach(_=>d(_,!1))}})]}),E.jsxs("label",{style:f(n==="sign"),children:[E.jsx("span",{children:"Bear Sign"}),E.jsx("input",{type:"checkbox",checked:n==="sign",onChange:()=>{r("sign"),u(["bear"])}})]}),E.jsxs("label",{style:f(n==="sign"),children:[E.jsx("span",{children:"Turkey Sign"}),E.jsx("input",{type:"checkbox",checked:n==="sign",onChange:()=>{r("sign"),u(["turkey"])}})]}),E.jsx("hr",{style:{border:"none",borderTop:"1px solid rgba(15,23,42,0.12)",margin:"6px 0"}}),E.jsxs("label",{style:f(i==="1y"),children:[E.jsx("span",{children:"1 Year"}),E.jsx("input",{type:"checkbox",checked:i==="1y",onChange:()=>s(i==="1y"?"all":"1y")})]}),E.jsxs("label",{style:f(i==="5y"),children:[E.jsx("span",{children:"5 Years"}),E.jsx("input",{type:"checkbox",checked:i==="5y",onChange:()=>s(i==="5y"?"all":"5y")})]}),E.jsxs("label",{style:f(i==="all"),children:[E.jsx("span",{children:"All Time"}),E.jsx("input",{type:"checkbox",checked:i==="all",onChange:()=>s("all")})]})]})}const f_=Qi(t=>({selectedHuntId:null,setSelectedHuntId:e=>t({selectedHuntId:e})})),Ywe=t=>new nt({image:new Bs({radius:7,fill:new Wt({color:`rgba(14,165,233,${t})`}),stroke:new yt({color:`rgba(186,230,253,${t})`,width:2})})});function Xwe(){const{projectPath:t}=He(),e=Tr(),n=K.useRef(new Cn),r=K.useRef(null),i=K.useRef(null),s=K.useRef(null),o=K.useRef(null),a=f_(f=>f.setSelectedHuntId),l=K.useRef(async()=>{}),[c,u]=K.useState(null);K.useEffect(()=>{if(!e||!t)return;const f=new Pr({source:n.current,style:F=>{if(!yl("hunts",F))return null;const k=cf("hunts",F);return Ywe(k)}});r.current=f,e.addLayer(f);const p=async()=>{try{const F=await window.api.readTextFile(t,"data/hunts.geojson"),k=JSON.parse(F||'{"type":"FeatureCollection","features":[]}'),A=new ut().readFeatures(k,{dataProjection:"EPSG:4326",featureProjection:"EPSG:3857"});n.current.clear(),n.current.addFeatures(A)}catch{}};p();const m=()=>void p(),_=async()=>{if(!t)return;const F=new ut().writeFeaturesObject(n.current.getFeatures(),{dataProjection:"EPSG:4326",featureProjection:"EPSG:3857"});await window.api.writeTextFile(t,"data/hunts.geojson",JSON.stringify(F,null,2))};l.current=_;const g=()=>{if(!Ve.getState().activeUser){window.alert("Please select an Active User before adding features.");return}if(i.current)return;const k=new Qo({source:n.current,type:"Point"});i.current=k,e.addInteraction(k),k.on("drawend",async A=>{var O;const M=A.feature,b=new Date,j=b.getFullYear(),V=String(b.getMonth()+1).padStart(2,"0"),H=String(b.getDate()).padStart(2,"0"),U=String(b.getHours()).padStart(2,"0"),B=String(b.getMinutes()).padStart(2,"0"),N={hunt_id:Ba(),date:`${j}-${V}-${H}`,start_time:`${U}:${B}`};try{if(navigator.onLine){const $=(O=M.getGeometry())==null?void 0:O.getCoordinates();if($){const[G,R]=$1($),L=`https://api.open-meteo.com/v1/forecast?latitude=${R}&longitude=${G}&current=temperature_2m,wind_speed_10m,wind_direction_10m,pressure_msl&temperature_unit=fahrenheit&wind_speed_unit=mph&timezone=auto`,te=await(await fetch(L)).json(),ee=te==null?void 0:te.current;ee&&(typeof ee.temperature_2m=="number"&&(N.temp_f=ee.temperature_2m),typeof ee.wind_speed_10m=="number"&&(N.wind_speed_mph=ee.wind_speed_10m),typeof ee.wind_direction_10m=="number"&&(N.wind_dir_deg=ee.wind_direction_10m),typeof ee.pressure_msl=="number"&&(N.pressure_inhg=Number((ee.pressure_msl/33.8638866667).toFixed(2))))}}}catch{}u({feature:M,initial:N}),i.current&&(e.removeInteraction(i.current),i.current=null)})},y=()=>g();window.addEventListener("start-new-hunt",y);const v=new Ks({layers:[f]});s.current=v,e.addInteraction(v),v.on("select",F=>{const k=F.selected[0],A=(k==null?void 0:k.get("hunt_id"))||null;a(A),Xi.getState().setSelected(k?{layerId:"hunts",feature:k}:null)});const w=()=>{if(!Ve.getState().activeUser){window.alert("Please select an Active User before editing geometry.");return}if(o.current)return;const k=new(require("ol/interaction")).Modify({source:n.current});o.current=k,e.addInteraction(k),k.on("modifyend",A=>{var b,j;const M=Ve.getState().activeUser;M&&((j=(b=A.features)==null?void 0:b.forEach)==null||j.call(b,V=>{V.set("updated_by",M),V.set("updated_at",new Date().toISOString())}),_())})},x=()=>{o.current&&(e.removeInteraction(o.current),o.current=null)},S=()=>w(),C=()=>x(),T=()=>void _(),P=()=>{var k,A;const F=(A=(k=s.current)==null?void 0:k.getFeatures)==null?void 0:A.call(k);F&&(F.forEach(M=>n.current.removeFeature(M)),F.clear(),_())};return window.addEventListener("layer:enable-modify:hunts",S),window.addEventListener("layer:disable-modify:hunts",C),window.addEventListener("layer:persist:hunts",T),window.addEventListener("delete-feature-hunts",P),window.addEventListener("layers:reload",m),()=>{window.removeEventListener("start-new-hunt",y),window.removeEventListener("layer:enable-modify:hunts",S),window.removeEventListener("layer:disable-modify:hunts",C),window.removeEventListener("layer:persist:hunts",T),window.removeEventListener("delete-feature-hunts",P),window.removeEventListener("layers:reload",m),i.current&&e.removeInteraction(i.current),s.current&&e.removeInteraction(s.current),o.current&&e.removeInteraction(o.current),r.current&&e.removeLayer(r.current),i.current=null,s.current=null,o.current=null,r.current=null}},[e,t]);const d=async f=>{if(!t||!c)return;const{feature:p}=c,m=Ve.getState().activeUser;if(!m){window.alert("Please select an Active User before saving.");return}p.setProperties(f),p.get("created_by")||p.set("created_by",m),p.get("created_at")||p.set("created_at",new Date().toISOString()),p.set("updated_by",m),p.set("updated_at",new Date().toISOString());const _=new ut().writeFeaturesObject([p],{dataProjection:"EPSG:4326",featureProjection:"EPSG:3857"});try{const g=await window.api.readTextFile(t,"data/hunts.geojson"),y=JSON.parse(g||'{"type":"FeatureCollection","features":[]}');y.features.push(_.features[0]),await window.api.writeTextFile(t,"data/hunts.geojson",JSON.stringify(y,null,2))}catch{await window.api.writeTextFile(t,"data/hunts.geojson",JSON.stringify(_,null,2))}u(null)},h=()=>{c&&n.current.removeFeature(c.feature),u(null)};return c?E.jsxs("div",{style:{position:"fixed",left:0,right:0,bottom:0,padding:12,background:"rgba(255,255,255,0.95)",borderTop:"1px solid #ddd",zIndex:2e3},children:[E.jsx("h3",{style:{marginTop:0},children:"New Hunt"}),E.jsx(ea,{layerId:"hunts",initialValues:c.initial,onSubmit:d,onCancel:h})]}):null}const Zwe=t=>new nt({image:new Bs({radius:6,fill:new Wt({color:`rgba(236,72,153,${t})`}),stroke:new yt({color:`rgba(252,231,243,${t})`,width:1.6})})});function qwe(){const{projectPath:t}=He(),e=Tr(),n=K.useRef(new Cn),r=K.useRef(null),i=K.useRef(null),s=K.useRef(null),o=K.useRef(null),a=K.useRef(async()=>{}),l=f_(f=>f.selectedHuntId),[c,u]=K.useState(null);K.useEffect(()=>{if(!e||!t)return;const f=new Pr({source:n.current,style:F=>{if(!yl("animal_sightings",F))return null;const k=cf("animal_sightings",F);return Zwe(k)}});r.current=f,e.addLayer(f);const p=async()=>{try{const F=await window.api.readTextFile(t,"data/animal_sightings.geojson"),k=JSON.parse(F||'{"type":"FeatureCollection","features":[]}'),A=new ut().readFeatures(k,{dataProjection:"EPSG:4326",featureProjection:"EPSG:3857"});n.current.clear(),n.current.addFeatures(A)}catch{}};p();const m=()=>void p(),_=()=>{if(!Ve.getState().activeUser){window.alert("Please select an Active User before adding features.");return}if(i.current)return;const k=new Qo({source:n.current,type:"Point"});i.current=k,e.addInteraction(k),k.on("drawend",A=>{const M=A.feature,b={sighting_id:Ba(),hunt_id:l||""};u({feature:M,initial:b}),i.current&&(e.removeInteraction(i.current),i.current=null)})},g=async()=>{if(!t)return;const F=new ut().writeFeaturesObject(n.current.getFeatures(),{dataProjection:"EPSG:4326",featureProjection:"EPSG:3857"});await window.api.writeTextFile(t,"data/animal_sightings.geojson",JSON.stringify(F,null,2))};a.current=g;const y=()=>_(),v=new Ks({layers:[f]});s.current=v,e.addInteraction(v),v.on("select",F=>{var A;const k=((A=F.selected)==null?void 0:A[0])||null;Xi.getState().setSelected(k?{layerId:"animal_sightings",feature:k}:null)});const w=()=>{if(!Ve.getState().activeUser){window.alert("Please select an Active User before editing geometry.");return}if(o.current)return;const k=new(require("ol/interaction")).Modify({source:n.current});o.current=k,e.addInteraction(k),k.on("modifyend",A=>{var b,j;const M=Ve.getState().activeUser;M&&((j=(b=A.features)==null?void 0:b.forEach)==null||j.call(b,V=>{V.set("updated_by",M),V.set("updated_at",new Date().toISOString())}),g())})},x=()=>{o.current&&(e.removeInteraction(o.current),o.current=null)},S=()=>w(),C=()=>x();window.addEventListener("layer:enable-modify:animal_sightings",S),window.addEventListener("layer:disable-modify:animal_sightings",C);const T=()=>void g(),P=()=>{var k,A;const F=(A=(k=s.current)==null?void 0:k.getFeatures)==null?void 0:A.call(k);F&&(F.forEach(M=>n.current.removeFeature(M)),F.clear(),g())};return window.addEventListener("layer:persist:animal_sightings",T),window.addEventListener("delete-feature-animal_sightings",P),window.addEventListener("start-new-sighting",y),window.addEventListener("layers:reload",m),()=>{window.removeEventListener("start-new-sighting",y),window.removeEventListener("layer:enable-modify:animal_sightings",S),window.removeEventListener("layer:disable-modify:animal_sightings",C),window.removeEventListener("layer:enable-modify:animal_sightings",S),window.removeEventListener("layer:disable-modify:animal_sightings",C),window.removeEventListener("layer:persist:animal_sightings",T),window.removeEventListener("delete-feature-animal_sightings",P),window.removeEventListener("layers:reload",m),i.current&&e.removeInteraction(i.current),s.current&&e.removeInteraction(s.current),o.current&&e.removeInteraction(o.current),r.current&&e.removeLayer(r.current),i.current=null,s.current=null,o.current=null,r.current=null}},[e,t,l]);const d=async f=>{if(!t||!c)return;const{feature:p}=c,m=Ve.getState().activeUser;if(!m){window.alert("Please select an Active User before saving.");return}p.setProperties(f),p.get("created_by")||p.set("created_by",m),p.get("created_at")||p.set("created_at",new Date().toISOString()),p.set("updated_by",m),p.set("updated_at",new Date().toISOString());const _=new ut().writeFeaturesObject([p],{dataProjection:"EPSG:4326",featureProjection:"EPSG:3857"});try{const g=await window.api.readTextFile(t,"data/animal_sightings.geojson"),y=JSON.parse(g||'{"type":"FeatureCollection","features":[]}');y.features.push(_.features[0]),await window.api.writeTextFile(t,"data/animal_sightings.geojson",JSON.stringify(y,null,2))}catch{await window.api.writeTextFile(t,"data/animal_sightings.geojson",JSON.stringify(_,null,2))}u(null)},h=()=>{c&&n.current.removeFeature(c.feature),u(null)};return c?E.jsxs("div",{style:{position:"fixed",left:0,right:0,bottom:0,padding:12,background:"rgba(255,255,255,0.95)",borderTop:"1px solid #ddd",zIndex:2e3},children:[E.jsx("h3",{style:{marginTop:0},children:"Add Sighting"}),E.jsx(ea,{layerId:"animal_sightings",initialValues:c.initial,onSubmit:d,onCancel:h})]}):null}const Jwe=t=>{var e;return new nt({stroke:new yt({color:"#00695c",width:3}),text:(e=t==null?void 0:t.get)!=null&&e.call(t,"name")?new Zo({text:String(t.get("name")),font:"12px 'Inter', sans-serif",fill:new Wt({color:"#ffffff"}),stroke:new yt({color:"rgba(0,0,0,0.6)",width:3}),placement:"line",overflow:!0}):void 0})};function Qwe(){const{projectPath:t}=He(),e=Tr(),n=K.useRef(new Cn),r=K.useRef(null),i=K.useRef(null),s=K.useRef(null),o=K.useRef(null),a=f_(f=>f.selectedHuntId),l=K.useRef(async()=>{}),[c,u]=K.useState(null);K.useEffect(()=>{if(!e||!t)return;const f=new Pr({source:n.current,style:T=>yl("animal_paths",T)?Jwe(T):null});r.current=f,e.addLayer(f);const p=async()=>{try{const T=await window.api.readTextFile(t,"data/animal_paths.geojson"),P=JSON.parse(T||'{"type":"FeatureCollection","features":[]}'),F=new ut().readFeatures(P,{dataProjection:"EPSG:4326",featureProjection:"EPSG:3857"});n.current.clear(),n.current.addFeatures(F);let k=!1;n.current.getFeatures().forEach((M,b)=>{M.get("name")||(M.set("name",`Path ${b+1}`),k=!0),M.get("path_id")||(M.set("path_id",Ba()),k=!0)}),k&&await l.current()}catch{}};p();const m=()=>void p(),_=async()=>{if(!t)return;const T=new ut().writeFeaturesObject(n.current.getFeatures(),{dataProjection:"EPSG:4326",featureProjection:"EPSG:3857"});await window.api.writeTextFile(t,"data/animal_paths.geojson",JSON.stringify(T,null,2))};l.current=_;const g=()=>{if(i.current)return;const T=new Qo({source:n.current,type:"LineString"});i.current=T,e.addInteraction(T),T.on("drawend",P=>{const F=P.feature,k={path_id:Ba(),name:`Path ${n.current.getFeatures().length}`,hunt_id:a||"",species:"whitetail",confidence:"observed",notes:""};u({feature:F,initial:k}),i.current&&(e.removeInteraction(i.current),i.current=null)})},y=()=>g(),v=new Ks({layers:[f]});s.current=v,e.addInteraction(v),v.on("select",T=>{var F;const P=((F=T.selected)==null?void 0:F[0])||null;Xi.getState().setSelected(P?{layerId:"animal_paths",feature:P}:null)});const w=()=>{if(!Ve.getState().activeUser){window.alert("Please select an Active User before editing geometry.");return}if(o.current)return;const P=new(require("ol/interaction")).Modify({source:n.current});o.current=P,e.addInteraction(P),P.on("modifyend",F=>{var A,M;const k=Ve.getState().activeUser;k&&((M=(A=F.features)==null?void 0:A.forEach)==null||M.call(A,b=>{b.set("updated_by",k),b.set("updated_at",new Date().toISOString())}),l.current())})},x=()=>{o.current&&(e.removeInteraction(o.current),o.current=null)},S=()=>w(),C=()=>x();return window.addEventListener("layer:enable-modify:animal_paths",S),window.addEventListener("layer:disable-modify:animal_paths",C),window.addEventListener("start-new-animal-path",y),window.addEventListener("layers:reload",m),()=>{window.removeEventListener("start-new-animal-path",y),window.removeEventListener("layer:enable-modify:animal_paths",S),window.removeEventListener("layer:disable-modify:animal_paths",C),window.removeEventListener("layers:reload",m),i.current&&e.removeInteraction(i.current),s.current&&e.removeInteraction(s.current),o.current&&e.removeInteraction(o.current),r.current&&e.removeLayer(r.current),i.current=null,s.current=null,o.current=null,r.current=null}},[e,t,a]);const d=async f=>{if(!t||!c)return;const{feature:p}=c;p.setProperties(f);try{const m=Ve.getState().activeUser;m&&p.set("created_by",m)}catch{}await l.current(),u(null)},h=()=>{c&&(n.current.removeFeature(c.feature),l.current()),u(null)};return c?E.jsxs("div",{style:{position:"fixed",left:0,right:0,bottom:0,padding:12,background:"rgba(255,255,255,0.95)",borderTop:"1px solid #ddd",zIndex:2e3},children:[E.jsx("h3",{style:{marginTop:0},children:"Draw Animal Path"}),E.jsx(ea,{layerId:"animal_paths",initialValues:c.initial,onSubmit:d,onCancel:h})]}):null}const exe=t=>new nt({image:new Bs({radius:6,fill:new Wt({color:`rgba(147,51,234,${t})`}),stroke:new yt({color:`rgba(237,233,254,${t})`,width:1.5})})});function txe(){const{projectPath:t}=He(),e=Tr(),n=K.useRef(new Cn),r=K.useRef(null),i=K.useRef(null),s=K.useRef(null),o=K.useRef(null),a=K.useRef(async()=>{}),[l,c]=K.useState(null);K.useEffect(()=>{if(!e||!t)return;const h=new Pr({source:n.current,style:C=>{if(!yl("animal_sign",C))return null;const T=cf("animal_sign",C);return exe(T)}});r.current=h,e.addLayer(h),(async()=>{try{const C=await window.api.readTextFile(t,"data/animal_sign.geojson"),T=JSON.parse(C||'{"type":"FeatureCollection","features":[]}'),P=new ut().readFeatures(T,{dataProjection:"EPSG:4326",featureProjection:"EPSG:3857"});n.current.clear(),n.current.addFeatures(P)}catch{}})();const f=()=>{if(i.current)return;const C=new Qo({source:n.current,type:"Point"});i.current=C,e.addInteraction(C),C.on("drawend",T=>{const P=T.feature,F=new Date,k=F.getFullYear(),A=String(F.getMonth()+1).padStart(2,"0"),M=String(F.getDate()).padStart(2,"0"),b={sign_id:Ba(),date:`${k}-${A}-${M}`};c({feature:P,initial:b}),i.current&&(e.removeInteraction(i.current),i.current=null)})},p=async()=>{if(!t)return;const C=new ut().writeFeaturesObject(n.current.getFeatures(),{dataProjection:"EPSG:4326",featureProjection:"EPSG:3857"});await window.api.writeTextFile(t,"data/animal_sign.geojson",JSON.stringify(C,null,2))};a.current=p;const m=()=>f(),_=new Ks({layers:[h]});s.current=_,e.addInteraction(_),_.on("select",C=>{var P;const T=((P=C.selected)==null?void 0:P[0])||null;Xi.getState().setSelected(T?{layerId:"animal_sign",feature:T}:null)});const g=()=>{if(!Ve.getState().activeUser){window.alert("Please select an Active User before editing geometry.");return}if(o.current)return;const T=new(require("ol/interaction")).Modify({source:n.current});o.current=T,e.addInteraction(T),T.on("modifyend",P=>{var k,A;const F=Ve.getState().activeUser;F&&((A=(k=P.features)==null?void 0:k.forEach)==null||A.call(k,M=>{M.set("updated_by",F),M.set("updated_at",new Date().toISOString())}),p())})},y=()=>{o.current&&(e.removeInteraction(o.current),o.current=null)},v=()=>g(),w=()=>y();window.addEventListener("layer:enable-modify:animal_sign",v),window.addEventListener("layer:disable-modify:animal_sign",w);const x=()=>void p(),S=()=>{var T,P;const C=(P=(T=s.current)==null?void 0:T.getFeatures)==null?void 0:P.call(T);C&&(C.forEach(F=>n.current.removeFeature(F)),C.clear(),p())};return window.addEventListener("layer:persist:animal_sign",x),window.addEventListener("delete-feature-animal_sign",S),window.addEventListener("start-new-animal-sign",m),()=>{window.removeEventListener("start-new-animal-sign",m),window.removeEventListener("layer:enable-modify:animal_sign",v),window.removeEventListener("layer:disable-modify:animal_sign",w),window.removeEventListener("layer:enable-modify:animal_sign",v),window.removeEventListener("layer:disable-modify:animal_sign",w),window.removeEventListener("layer:persist:animal_sign",x),window.removeEventListener("delete-feature-animal_sign",S),i.current&&e.removeInteraction(i.current),s.current&&e.removeInteraction(s.current),o.current&&e.removeInteraction(o.current),r.current&&e.removeLayer(r.current),i.current=null,s.current=null,o.current=null,r.current=null}},[e,t]),K.useEffect(()=>{const h=r.current;if(!h)return;const f=()=>{const m=It.getState().isLayerVisible("animal_sign");h.setVisible(m)};f();const p=It.subscribe(f);return()=>{p()}},[]);const u=async h=>{if(!t||!l)return;const{feature:f}=l,p=Ve.getState().activeUser;if(!p){window.alert("Please select an Active User before saving.");return}f.setProperties(h),f.get("created_by")||f.set("created_by",p),f.get("created_at")||f.set("created_at",new Date().toISOString()),f.set("updated_by",p),f.set("updated_at",new Date().toISOString());const m=new ut().writeFeaturesObject([f],{dataProjection:"EPSG:4326",featureProjection:"EPSG:3857"});try{const _=await window.api.readTextFile(t,"data/animal_sign.geojson"),g=JSON.parse(_||'{"type":"FeatureCollection","features":[]}');g.features.push(m.features[0]),await window.api.writeTextFile(t,"data/animal_sign.geojson",JSON.stringify(g,null,2))}catch{await window.api.writeTextFile(t,"data/animal_sign.geojson",JSON.stringify(m,null,2))}c(null)},d=()=>{l&&n.current.removeFeature(l.feature),c(null)};return l?E.jsxs("div",{style:{position:"fixed",left:0,right:0,bottom:0,padding:12,background:"rgba(255,255,255,0.95)",borderTop:"1px solid #ddd",zIndex:2e3},children:[E.jsx("h3",{style:{marginTop:0},children:"Add Animal Sign"}),E.jsx(ea,{layerId:"animal_sign",initialValues:l.initial,onSubmit:u,onCancel:d})]}):null}const nxe=t=>new nt({image:new Bs({radius:6,fill:new Wt({color:`rgba(211,47,47,${t})`}),stroke:new yt({color:`rgba(255,255,255,${t})`,width:2})})});function rxe(){const{projectPath:t}=He(),e=Tr(),n=K.useRef(new Cn),r=K.useRef(null),i=K.useRef(null),s=K.useRef(null),o=K.useRef(null),a=K.useRef(async()=>{}),l=f_(f=>f.selectedHuntId),[c,u]=K.useState(null);K.useEffect(()=>{if(!e||!t)return;const f=new Pr({source:n.current,style:T=>{if(!yl("harvests",T))return null;const P=cf("harvests",T);return nxe(P)}});r.current=f,e.addLayer(f),(async()=>{try{const T=await window.api.readTextFile(t,"data/harvests.geojson"),P=JSON.parse(T||'{"type":"FeatureCollection","features":[]}'),F=new ut().readFeatures(P,{dataProjection:"EPSG:4326",featureProjection:"EPSG:3857"});n.current.clear(),n.current.addFeatures(F)}catch{}})();const p=()=>{if(i.current)return;const T=new Qo({source:n.current,type:"Point"});i.current=T,e.addInteraction(T),T.on("drawend",P=>{const F=P.feature,k=new Date,A=k.getFullYear(),M=String(k.getMonth()+1).padStart(2,"0"),b=String(k.getDate()).padStart(2,"0"),j={harvest_id:Ba(),hunt_id:l||"",date:`${A}-${M}-${b}`};u({feature:F,initial:j}),i.current&&(e.removeInteraction(i.current),i.current=null)})},m=async()=>{if(!t)return;const T=new ut().writeFeaturesObject(n.current.getFeatures(),{dataProjection:"EPSG:4326",featureProjection:"EPSG:3857"});await window.api.writeTextFile(t,"data/harvests.geojson",JSON.stringify(T,null,2))};a.current=m;const _=()=>p(),g=new Ks({layers:[f]});s.current=g,e.addInteraction(g),g.on("select",T=>{var F;const P=((F=T.selected)==null?void 0:F[0])||null;Xi.getState().setSelected(P?{layerId:"harvests",feature:P}:null)});const y=()=>{if(!Ve.getState().activeUser){window.alert("Please select an Active User before editing geometry.");return}if(o.current)return;const P=new(require("ol/interaction")).Modify({source:n.current});o.current=P,e.addInteraction(P),P.on("modifyend",F=>{var A,M;const k=Ve.getState().activeUser;k&&((M=(A=F.features)==null?void 0:A.forEach)==null||M.call(A,b=>{b.set("updated_by",k),b.set("updated_at",new Date().toISOString())}),m())})},v=()=>{o.current&&(e.removeInteraction(o.current),o.current=null)},w=()=>y(),x=()=>v(),S=()=>void m(),C=()=>{var P,F;const T=(F=(P=s.current)==null?void 0:P.getFeatures)==null?void 0:F.call(P);T&&(T.forEach(k=>n.current.removeFeature(k)),T.clear(),m())};return window.addEventListener("layer:enable-modify:harvests",w),window.addEventListener("layer:disable-modify:harvests",x),window.addEventListener("layer:persist:harvests",S),window.addEventListener("delete-feature-harvests",C),window.addEventListener("start-new-harvest",_),()=>{window.removeEventListener("start-new-harvest",_),window.removeEventListener("layer:enable-modify:harvests",w),window.removeEventListener("layer:disable-modify:harvests",x),window.removeEventListener("layer:persist:harvests",S),window.removeEventListener("delete-feature-harvests",C),i.current&&e.removeInteraction(i.current),s.current&&e.removeInteraction(s.current),o.current&&e.removeInteraction(o.current),r.current&&e.removeLayer(r.current),i.current=null,s.current=null,o.current=null,r.current=null}},[e,t,l]),K.useEffect(()=>{const f=r.current;if(!f)return;const p=()=>{const _=It.getState().isLayerVisible("harvests");f.setVisible(_)};p();const m=It.subscribe(p);return()=>{m()}},[]);const d=async f=>{if(!t||!c)return;const{feature:p}=c,m=Ve.getState().activeUser;if(!m){window.alert("Please select an Active User before saving.");return}p.setProperties(f),p.get("created_by")||p.set("created_by",m),p.get("created_at")||p.set("created_at",new Date().toISOString()),p.set("updated_by",m),p.set("updated_at",new Date().toISOString());const _=new ut().writeFeaturesObject([p],{dataProjection:"EPSG:4326",featureProjection:"EPSG:3857"});try{const g=await window.api.readTextFile(t,"data/harvests.geojson"),y=JSON.parse(g||'{"type":"FeatureCollection","features":[]}');y.features.push(_.features[0]),await window.api.writeTextFile(t,"data/harvests.geojson",JSON.stringify(y,null,2))}catch{await window.api.writeTextFile(t,"data/harvests.geojson",JSON.stringify(_,null,2))}u(null)},h=()=>{c&&n.current.removeFeature(c.feature),u(null)};return c?E.jsxs("div",{style:{position:"fixed",left:0,right:0,bottom:0,padding:12,background:"rgba(255,255,255,0.95)",borderTop:"1px solid #ddd",zIndex:2e3},children:[E.jsx("h3",{style:{marginTop:0},children:"Add Harvest"}),E.jsx(ea,{layerId:"harvests",initialValues:c.initial,onSubmit:d,onCancel:h})]}):null}const oc=Qi(t=>({showSightingsHeatmap:!1,showPathDensity:!1,setShowSightingsHeatmap:e=>t({showSightingsHeatmap:e}),setShowPathDensity:e=>t({showPathDensity:e})}));function ixe(){const[t,e]=K.useState(!1),n=oc(a=>a.showSightingsHeatmap),r=oc(a=>a.setShowSightingsHeatmap),i=oc(a=>a.showPathDensity),s=oc(a=>a.setShowPathDensity),o={padding:"6px 12px",borderRadius:6,border:"1px solid rgba(15,23,42,0.12)",background:"rgba(255,255,255,0.92)",fontSize:12,cursor:"pointer",color:"rgba(15,23,42,0.75)",boxShadow:"0 4px 12px rgba(15,23,42,0.08)",width:"100%",textAlign:"left"};return t?E.jsxs("div",{style:{display:"flex",flexDirection:"column",gap:6,padding:"10px 12px",borderRadius:6,border:"1px solid rgba(15, 23, 42, 0.12)",background:"rgba(255, 255, 255, 0.94)",boxShadow:"0 12px 28px rgba(15, 23, 42, 0.12)",width:"100%",fontSize:12,color:"rgba(15,23,42,0.75)"},children:[E.jsxs("div",{onClick:()=>e(!1),style:{display:"flex",justifyContent:"space-between",alignItems:"center",cursor:"pointer"},title:"Click to collapse",children:[E.jsx("span",{style:{fontSize:12,fontWeight:600},children:"Analytics"}),E.jsx("button",{onClick:()=>e(!1),style:{border:"none",background:"transparent",fontSize:12,color:"rgba(15,23,42,0.55)",cursor:"pointer"},children:"Hide"})]}),E.jsxs("label",{style:{display:"flex",alignItems:"center",gap:6,cursor:"pointer"},children:[E.jsx("input",{type:"checkbox",checked:n,onChange:a=>r(a.target.checked)}),"Sightings Heatmap"]}),E.jsxs("label",{style:{display:"flex",alignItems:"center",gap:6,cursor:"pointer"},children:[E.jsx("input",{type:"checkbox",checked:i,onChange:a=>s(a.target.checked)}),"Path Density"]})]}):E.jsx("button",{onClick:()=>e(!0),style:o,children:"Analytics"})}const Sm=34962,Ab=34963,sxe=35044,iv=35048,oxe=5121,axe=5123,lxe=5125,_N=5126,vI=["experimental-webgl","webgl","webkit-3d","moz-webgl"];function cxe(t,e){e=Object.assign({preserveDrawingBuffer:!0,antialias:!K5},e);const n=vI.length;for(let r=0;r<n;++r)try{const i=t.getContext(vI[r],e);if(i)return i}catch{}return null}const uxe={STATIC_DRAW:sxe};class sv{constructor(e,n){this.array_=null,this.type_=e,ze(e===Sm||e===Ab,"A `WebGLArrayBuffer` must either be of type `ELEMENT_ARRAY_BUFFER` or `ARRAY_BUFFER`"),this.usage_=n!==void 0?n:uxe.STATIC_DRAW}ofSize(e){return this.array_=new(_g(this.type_))(e),this}fromArray(e){return this.array_=_g(this.type_).from(e),this}fromArrayBuffer(e){return this.array_=new(_g(this.type_))(e),this}getType(){return this.type_}getArray(){return this.array_}setArray(e){const n=_g(this.type_);if(!(e instanceof n))throw new Error(`Expected ${n}`);this.array_=e}getUsage(){return this.usage_}getSize(){return this.array_?this.array_.length:0}}function _g(t){switch(t){case Sm:return Float32Array;case Ab:return Uint32Array;default:return Float32Array}}const vg={LOST:"webglcontextlost",RESTORED:"webglcontextrestored"},dxe=`
  precision mediump float;

  attribute vec2 a_position;
  varying vec2 v_texCoord;
  varying vec2 v_screenCoord;

  uniform vec2 u_screenSize;

  void main() {
    v_texCoord = a_position * 0.5 + 0.5;
    v_screenCoord = v_texCoord * u_screenSize;
    gl_Position = vec4(a_position, 0.0, 1.0);
  }
`,hxe=`
  precision mediump float;

  uniform sampler2D u_image;
  uniform float u_opacity;

  varying vec2 v_texCoord;

  void main() {
    gl_FragColor = texture2D(u_image, v_texCoord) * u_opacity;
  }
`;class wI{constructor(e){this.gl_=e.webGlContext;const n=this.gl_;this.scaleRatio_=e.scaleRatio||1,this.renderTargetTexture_=n.createTexture(),this.renderTargetTextureSize_=null,this.frameBuffer_=n.createFramebuffer(),this.depthBuffer_=n.createRenderbuffer();const r=n.createShader(n.VERTEX_SHADER);n.shaderSource(r,e.vertexShader||dxe),n.compileShader(r);const i=n.createShader(n.FRAGMENT_SHADER);n.shaderSource(i,e.fragmentShader||hxe),n.compileShader(i),this.renderTargetProgram_=n.createProgram(),n.attachShader(this.renderTargetProgram_,r),n.attachShader(this.renderTargetProgram_,i),n.linkProgram(this.renderTargetProgram_),this.renderTargetVerticesBuffer_=n.createBuffer();const s=[-1,-1,1,-1,-1,1,1,-1,1,1,-1,1];n.bindBuffer(n.ARRAY_BUFFER,this.renderTargetVerticesBuffer_),n.bufferData(n.ARRAY_BUFFER,new Float32Array(s),n.STATIC_DRAW),this.renderTargetAttribLocation_=n.getAttribLocation(this.renderTargetProgram_,"a_position"),this.renderTargetUniformLocation_=n.getUniformLocation(this.renderTargetProgram_,"u_screenSize"),this.renderTargetOpacityLocation_=n.getUniformLocation(this.renderTargetProgram_,"u_opacity"),this.renderTargetTextureLocation_=n.getUniformLocation(this.renderTargetProgram_,"u_image"),this.uniforms_=[],e.uniforms&&Object.keys(e.uniforms).forEach(o=>{this.uniforms_.push({value:e.uniforms[o],location:n.getUniformLocation(this.renderTargetProgram_,o)})})}getRenderTargetTexture(){return this.renderTargetTexture_}getGL(){return this.gl_}init(e){const n=this.getGL(),r=[n.drawingBufferWidth*this.scaleRatio_,n.drawingBufferHeight*this.scaleRatio_];if(n.bindFramebuffer(n.FRAMEBUFFER,this.getFrameBuffer()),n.bindRenderbuffer(n.RENDERBUFFER,this.getDepthBuffer()),n.viewport(0,0,r[0],r[1]),!this.renderTargetTextureSize_||this.renderTargetTextureSize_[0]!==r[0]||this.renderTargetTextureSize_[1]!==r[1]){this.renderTargetTextureSize_=r;const i=0,s=n.RGBA,o=0,a=n.RGBA,l=n.UNSIGNED_BYTE,c=null;n.bindTexture(n.TEXTURE_2D,this.renderTargetTexture_),n.texImage2D(n.TEXTURE_2D,i,s,r[0],r[1],o,a,l,c),n.texParameteri(n.TEXTURE_2D,n.TEXTURE_MIN_FILTER,n.LINEAR),n.texParameteri(n.TEXTURE_2D,n.TEXTURE_WRAP_S,n.CLAMP_TO_EDGE),n.texParameteri(n.TEXTURE_2D,n.TEXTURE_WRAP_T,n.CLAMP_TO_EDGE),n.framebufferTexture2D(n.FRAMEBUFFER,n.COLOR_ATTACHMENT0,n.TEXTURE_2D,this.renderTargetTexture_,0),n.renderbufferStorage(n.RENDERBUFFER,n.DEPTH_COMPONENT16,r[0],r[1]),n.framebufferRenderbuffer(n.FRAMEBUFFER,n.DEPTH_ATTACHMENT,n.RENDERBUFFER,this.depthBuffer_)}}apply(e,n,r,i){const s=this.getGL(),o=e.size;if(s.bindFramebuffer(s.FRAMEBUFFER,n?n.getFrameBuffer():null),s.activeTexture(s.TEXTURE0),s.bindTexture(s.TEXTURE_2D,this.renderTargetTexture_),!n){const l=fe(s.canvas);if(!e.renderTargets[l]){const c=s.getContextAttributes();c&&c.preserveDrawingBuffer&&(s.clearColor(0,0,0,0),s.clearDepth(1),s.clear(s.COLOR_BUFFER_BIT|s.DEPTH_BUFFER_BIT)),e.renderTargets[l]=!0}}s.disable(s.DEPTH_TEST),s.enable(s.BLEND),s.blendFunc(s.ONE,s.ONE_MINUS_SRC_ALPHA),s.viewport(0,0,s.drawingBufferWidth,s.drawingBufferHeight),s.bindBuffer(s.ARRAY_BUFFER,this.renderTargetVerticesBuffer_),s.useProgram(this.renderTargetProgram_),s.enableVertexAttribArray(this.renderTargetAttribLocation_),s.vertexAttribPointer(this.renderTargetAttribLocation_,2,s.FLOAT,!1,0,0),s.uniform2f(this.renderTargetUniformLocation_,o[0],o[1]),s.uniform1i(this.renderTargetTextureLocation_,0);const a=e.layerStatesArray[e.layerIndex].opacity;s.uniform1f(this.renderTargetOpacityLocation_,a),this.applyUniforms(e),r&&r(s,e),s.drawArrays(s.TRIANGLES,0,6),i&&i(s,e)}getFrameBuffer(){return this.frameBuffer_}getDepthBuffer(){return this.depthBuffer_}applyUniforms(e){const n=this.getGL();let r,i=1;this.uniforms_.forEach(function(s){if(r=typeof s.value=="function"?s.value(e):s.value,r instanceof HTMLCanvasElement||r instanceof ImageData)s.texture||(s.texture=n.createTexture()),n.activeTexture(n[`TEXTURE${i}`]),n.bindTexture(n.TEXTURE_2D,s.texture),n.texParameteri(n.TEXTURE_2D,n.TEXTURE_MIN_FILTER,n.LINEAR),n.texParameteri(n.TEXTURE_2D,n.TEXTURE_WRAP_S,n.CLAMP_TO_EDGE),n.texParameteri(n.TEXTURE_2D,n.TEXTURE_WRAP_T,n.CLAMP_TO_EDGE),r instanceof ImageData?n.texImage2D(n.TEXTURE_2D,0,n.RGBA,n.RGBA,r.width,r.height,0,n.UNSIGNED_BYTE,new Uint8Array(r.data)):n.texImage2D(n.TEXTURE_2D,0,n.RGBA,n.RGBA,n.UNSIGNED_BYTE,r),n.uniform1i(s.location,i++);else if(Array.isArray(r))switch(r.length){case 2:n.uniform2f(s.location,r[0],r[1]);return;case 3:n.uniform3f(s.location,r[0],r[1],r[2]);return;case 4:n.uniform4f(s.location,r[0],r[1],r[2],r[3]);return;default:return}else typeof r=="number"&&n.uniform1f(s.location,r)})}}const fs={PROJECTION_MATRIX:"u_projectionMatrix",SCREEN_TO_WORLD_MATRIX:"u_screenToWorldMatrix",TIME:"u_time",ZOOM:"u_zoom",RESOLUTION:"u_resolution",ROTATION:"u_rotation",VIEWPORT_SIZE_PX:"u_viewportSizePx",PIXEL_RATIO:"u_pixelRatio",HIT_DETECTION:"u_hitDetection"},mn={UNSIGNED_BYTE:oxe,UNSIGNED_SHORT:axe,UNSIGNED_INT:lxe,FLOAT:_N},bm={};function xI(t){return"shared/"+t}let EI=0;function fxe(){const t="unique/"+EI;return EI+=1,t}function gxe(t){let e=bm[t];if(!e){const n=document.createElement("canvas");n.width=1,n.height=1,n.style.position="absolute",n.style.left="0",e={users:0,context:cxe(n)},bm[t]=e}return e.users+=1,e.context}function pxe(t){const e=bm[t];if(!e||(e.users-=1,e.users>0))return;const n=e.context,r=n.getExtension("WEBGL_lose_context");r&&r.loseContext();const i=n.canvas;i.width=1,i.height=1,delete bm[t]}class mxe extends Lh{constructor(e){super(),e=e||{},this.boundHandleWebGLContextLost_=this.handleWebGLContextLost.bind(this),this.boundHandleWebGLContextRestored_=this.handleWebGLContextRestored.bind(this),this.canvasCacheKey_=e.canvasCacheKey?xI(e.canvasCacheKey):fxe(),this.gl_=gxe(this.canvasCacheKey_),this.bufferCache_={},this.extensionCache_={},this.currentProgram_=null,this.needsToBeRecreated_=!1;const n=this.gl_.canvas;n.addEventListener(vg.LOST,this.boundHandleWebGLContextLost_),n.addEventListener(vg.RESTORED,this.boundHandleWebGLContextRestored_),this.offsetRotateMatrix_=Bt(),this.offsetScaleMatrix_=Bt(),this.tmpMat4_=R$(),this.uniformLocationsByProgram_={},this.attribLocationsByProgram_={},this.uniforms_=[],e.uniforms&&this.setUniforms(e.uniforms),this.postProcessPasses_=e.postProcesses?e.postProcesses.map(r=>new wI({webGlContext:this.gl_,scaleRatio:r.scaleRatio,vertexShader:r.vertexShader,fragmentShader:r.fragmentShader,uniforms:r.uniforms})):[new wI({webGlContext:this.gl_})],this.shaderCompileErrors_=null,this.startTime_=Date.now(),this.maxAttributeCount_=this.gl_.getParameter(this.gl_.MAX_VERTEX_ATTRIBS)}setUniforms(e){this.uniforms_=[],this.addUniforms(e)}addUniforms(e){for(const n in e)this.uniforms_.push({name:n,value:e[n]})}canvasCacheKeyMatches(e){return this.canvasCacheKey_===xI(e)}getExtension(e){if(e in this.extensionCache_)return this.extensionCache_[e];const n=this.gl_.getExtension(e);return this.extensionCache_[e]=n,n}getInstancedRenderingExtension_(){const e=this.getExtension("ANGLE_instanced_arrays");return ze(!!e,"WebGL extension 'ANGLE_instanced_arrays' is required for vector rendering"),e}bindBuffer(e){const n=this.gl_,r=fe(e);let i=this.bufferCache_[r];if(!i){const s=n.createBuffer();i={buffer:e,webGlBuffer:s},this.bufferCache_[r]=i}n.bindBuffer(e.getType(),i.webGlBuffer)}flushBufferData(e){const n=this.gl_;this.bindBuffer(e),n.bufferData(e.getType(),e.getArray(),e.getUsage())}deleteBuffer(e){const n=fe(e);delete this.bufferCache_[n]}disposeInternal(){const e=this.gl_.canvas;e.removeEventListener(vg.LOST,this.boundHandleWebGLContextLost_),e.removeEventListener(vg.RESTORED,this.boundHandleWebGLContextRestored_),pxe(this.canvasCacheKey_),delete this.gl_}prepareDraw(e,n,r){const i=this.gl_,s=this.getCanvas(),o=e.size,a=e.pixelRatio;(s.width!==o[0]*a||s.height!==o[1]*a)&&(s.width=o[0]*a,s.height=o[1]*a,s.style.width=o[0]+"px",s.style.height=o[1]+"px");for(let l=this.postProcessPasses_.length-1;l>=0;l--)this.postProcessPasses_[l].init(e);i.bindTexture(i.TEXTURE_2D,null),i.clearColor(0,0,0,0),i.depthRange(0,1),i.clearDepth(1),i.clear(i.COLOR_BUFFER_BIT|i.DEPTH_BUFFER_BIT),i.enable(i.BLEND),i.blendFunc(i.ONE,n?i.ZERO:i.ONE_MINUS_SRC_ALPHA),r?(i.enable(i.DEPTH_TEST),i.depthFunc(i.LEQUAL)):i.disable(i.DEPTH_TEST)}bindFrameBuffer(e,n){const r=this.getGL();r.bindFramebuffer(r.FRAMEBUFFER,e),n&&r.framebufferTexture2D(r.FRAMEBUFFER,r.COLOR_ATTACHMENT0,r.TEXTURE_2D,n,0)}bindInitialFrameBuffer(){const e=this.getGL(),n=this.postProcessPasses_[0].getFrameBuffer();e.bindFramebuffer(e.FRAMEBUFFER,n);const r=this.postProcessPasses_[0].getRenderTargetTexture();e.framebufferTexture2D(e.FRAMEBUFFER,e.COLOR_ATTACHMENT0,e.TEXTURE_2D,r,0)}bindTexture(e,n,r){const i=this.gl_;i.activeTexture(i.TEXTURE0+n),i.bindTexture(i.TEXTURE_2D,e),i.uniform1i(this.getUniformLocation(r),n)}bindAttribute(e,n,r){const i=this.getGL();this.bindBuffer(e);const s=this.getAttributeLocation(n);i.enableVertexAttribArray(s),i.vertexAttribPointer(s,r,i.FLOAT,!1,0,0)}prepareDrawToRenderTarget(e,n,r,i){const s=this.gl_,o=n.getSize();s.bindFramebuffer(s.FRAMEBUFFER,n.getFramebuffer()),s.bindRenderbuffer(s.RENDERBUFFER,n.getDepthbuffer()),s.viewport(0,0,o[0],o[1]),s.bindTexture(s.TEXTURE_2D,n.getTexture()),s.clearColor(0,0,0,0),s.depthRange(0,1),s.clearDepth(1),s.clear(s.COLOR_BUFFER_BIT|s.DEPTH_BUFFER_BIT),s.enable(s.BLEND),s.blendFunc(s.ONE,r?s.ZERO:s.ONE_MINUS_SRC_ALPHA),i?(s.enable(s.DEPTH_TEST),s.depthFunc(s.LEQUAL)):s.disable(s.DEPTH_TEST)}drawElements(e,n){const r=this.gl_;this.getExtension("OES_element_index_uint");const i=r.UNSIGNED_INT,s=4,o=n-e,a=e*s;r.drawElements(r.TRIANGLES,o,i,a)}drawElementsInstanced(e,n,r){const i=this.gl_;this.getExtension("OES_element_index_uint");const s=this.getInstancedRenderingExtension_(),o=i.UNSIGNED_INT,a=4,l=n-e,c=e*a;s.drawElementsInstancedANGLE(i.TRIANGLES,l,o,c,r);for(let u=0;u<this.maxAttributeCount_;u++)s.vertexAttribDivisorANGLE(u,0)}finalizeDraw(e,n,r){for(let i=0,s=this.postProcessPasses_.length;i<s;i++)i===s-1?this.postProcessPasses_[i].apply(e,null,n,r):this.postProcessPasses_[i].apply(e,this.postProcessPasses_[i+1])}getCanvas(){return this.gl_.canvas}getGL(){return this.gl_}applyFrameState(e){const n=e.size,r=e.viewState.rotation,i=e.pixelRatio;this.setUniformFloatValue(fs.TIME,(Date.now()-this.startTime_)*.001),this.setUniformFloatValue(fs.ZOOM,e.viewState.zoom),this.setUniformFloatValue(fs.RESOLUTION,e.viewState.resolution),this.setUniformFloatValue(fs.PIXEL_RATIO,i),this.setUniformFloatVec2(fs.VIEWPORT_SIZE_PX,[n[0],n[1]]),this.setUniformFloatValue(fs.ROTATION,r)}applyHitDetectionUniform(e){const n=this.getUniformLocation(fs.HIT_DETECTION);this.getGL().uniform1i(n,e?1:0),e&&this.setUniformFloatValue(fs.PIXEL_RATIO,.5)}applyUniforms(e){const n=this.gl_;let r,i=0;this.uniforms_.forEach(s=>{if(r=typeof s.value=="function"?s.value(e):s.value,r instanceof HTMLCanvasElement||r instanceof HTMLImageElement||r instanceof ImageData||r instanceof WebGLTexture){r instanceof WebGLTexture&&!s.texture?(s.prevValue=void 0,s.texture=r):s.texture||(s.prevValue=void 0,s.texture=n.createTexture()),this.bindTexture(s.texture,i,s.name),n.texParameteri(n.TEXTURE_2D,n.TEXTURE_MIN_FILTER,n.LINEAR),n.texParameteri(n.TEXTURE_2D,n.TEXTURE_WRAP_S,n.CLAMP_TO_EDGE),n.texParameteri(n.TEXTURE_2D,n.TEXTURE_WRAP_T,n.CLAMP_TO_EDGE);const o=!(r instanceof HTMLImageElement)||r.complete;!(r instanceof WebGLTexture)&&o&&s.prevValue!==r&&(s.prevValue=r,n.texImage2D(n.TEXTURE_2D,0,n.RGBA,n.RGBA,n.UNSIGNED_BYTE,r)),i++}else if(Array.isArray(r)&&r.length===6)this.setUniformMatrixValue(s.name,Iw(this.tmpMat4_,r));else if(Array.isArray(r)&&r.length<=4)switch(r.length){case 2:n.uniform2f(this.getUniformLocation(s.name),r[0],r[1]);return;case 3:n.uniform3f(this.getUniformLocation(s.name),r[0],r[1],r[2]);return;case 4:n.uniform4f(this.getUniformLocation(s.name),r[0],r[1],r[2],r[3]);return;default:return}else typeof r=="number"&&n.uniform1f(this.getUniformLocation(s.name),r)})}useProgram(e,n){this.disableAllAttributes_(),this.gl_.useProgram(e),this.currentProgram_=e,n&&(this.applyFrameState(n),this.applyUniforms(n))}compileShader(e,n){const r=this.gl_,i=r.createShader(n);return r.shaderSource(i,e),r.compileShader(i),i}getProgram(e,n){const r=this.gl_,i=this.compileShader(e,r.FRAGMENT_SHADER),s=this.compileShader(n,r.VERTEX_SHADER),o=r.createProgram();if(r.attachShader(o,i),r.attachShader(o,s),r.linkProgram(o),!r.getShaderParameter(i,r.COMPILE_STATUS)){const a=`Fragment shader compilation failed: ${r.getShaderInfoLog(i)}`;throw new Error(a)}if(r.deleteShader(i),!r.getShaderParameter(s,r.COMPILE_STATUS)){const a=`Vertex shader compilation failed: ${r.getShaderInfoLog(s)}`;throw new Error(a)}if(r.deleteShader(s),!r.getProgramParameter(o,r.LINK_STATUS)){const a=`GL program linking failed: ${r.getProgramInfoLog(o)}`;throw new Error(a)}return o}getUniformLocation(e){const n=fe(this.currentProgram_);return this.uniformLocationsByProgram_[n]===void 0&&(this.uniformLocationsByProgram_[n]={}),this.uniformLocationsByProgram_[n][e]===void 0&&(this.uniformLocationsByProgram_[n][e]=this.gl_.getUniformLocation(this.currentProgram_,e)),this.uniformLocationsByProgram_[n][e]}getAttributeLocation(e){const n=fe(this.currentProgram_);return this.attribLocationsByProgram_[n]===void 0&&(this.attribLocationsByProgram_[n]={}),this.attribLocationsByProgram_[n][e]===void 0&&(this.attribLocationsByProgram_[n][e]=this.gl_.getAttribLocation(this.currentProgram_,e)),this.attribLocationsByProgram_[n][e]}makeProjectionTransform(e,n){const r=e.size,i=e.viewState.rotation,s=e.viewState.resolution,o=e.viewState.center;return Xr(n,0,0,2/(s*r[0]),2/(s*r[1]),-i,-o[0],-o[1]),n}setUniformFloatValue(e,n){this.gl_.uniform1f(this.getUniformLocation(e),n)}setUniformFloatVec2(e,n){this.gl_.uniform2fv(this.getUniformLocation(e),n)}setUniformFloatVec4(e,n){this.gl_.uniform4fv(this.getUniformLocation(e),n)}setUniformMatrixValue(e,n){this.gl_.uniformMatrix4fv(this.getUniformLocation(e),!1,n)}disableAllAttributes_(){for(let e=0;e<this.maxAttributeCount_;e++)this.gl_.disableVertexAttribArray(e)}enableAttributeArray_(e,n,r,i,s,o){const a=this.getAttributeLocation(e);a<0||(this.gl_.enableVertexAttribArray(a),this.gl_.vertexAttribPointer(a,n,r,!1,i,s),o&&this.getInstancedRenderingExtension_().vertexAttribDivisorANGLE(a,1))}enableAttributes_(e,n){const r=yxe(e);let i=0;for(let s=0;s<e.length;s++){const o=e[s];o.name&&this.enableAttributeArray_(o.name,o.size,o.type||_N,r,i,n),i+=o.size*vN(o.type)}}enableAttributes(e){this.enableAttributes_(e,!1)}enableAttributesInstanced(e){this.enableAttributes_(e,!0)}handleWebGLContextLost(e){Qa(this.bufferCache_),this.currentProgram_=null,e.preventDefault()}handleWebGLContextRestored(){this.needsToBeRecreated_=!0}needsToBeRecreated(){return this.needsToBeRecreated_}createTexture(e,n,r,i){const s=this.gl_;r=r||s.createTexture();const o=i?s.NEAREST:s.LINEAR;s.bindTexture(s.TEXTURE_2D,r),s.texParameteri(s.TEXTURE_2D,s.TEXTURE_MIN_FILTER,o),s.texParameteri(s.TEXTURE_2D,s.TEXTURE_MAG_FILTER,o),s.texParameteri(s.TEXTURE_2D,s.TEXTURE_WRAP_S,s.CLAMP_TO_EDGE),s.texParameteri(s.TEXTURE_2D,s.TEXTURE_WRAP_T,s.CLAMP_TO_EDGE);const a=0,l=s.RGBA,c=0,u=s.RGBA,d=s.UNSIGNED_BYTE;return n instanceof Uint8Array?s.texImage2D(s.TEXTURE_2D,a,l,e[0],e[1],c,u,d,n):n?s.texImage2D(s.TEXTURE_2D,a,l,u,d,n):s.texImage2D(s.TEXTURE_2D,a,l,e[0],e[1],c,u,d,null),r}}function yxe(t){let e=0;for(let n=0;n<t.length;n++){const r=t[n];e+=r.size*vN(r.type)}return e}function vN(t){switch(t){case mn.UNSIGNED_BYTE:return Uint8Array.BYTES_PER_ELEMENT;case mn.UNSIGNED_SHORT:return Uint16Array.BYTES_PER_ELEMENT;case mn.UNSIGNED_INT:return Uint32Array.BYTES_PER_ELEMENT;case mn.FLOAT:default:return Float32Array.BYTES_PER_ELEMENT}}class Fb extends y${constructor(e,n){super(e),n=n||{},this.inversePixelTransform_=Bt(),this.postProcesses_=n.postProcesses,this.uniforms_=n.uniforms,this.helper,this.onMapChanged_=()=>{this.clearCache(),this.removeHelper()},e.addChangeListener(Qe.MAP,this.onMapChanged_),this.dispatchPreComposeEvent=this.dispatchPreComposeEvent.bind(this),this.dispatchPostComposeEvent=this.dispatchPostComposeEvent.bind(this)}dispatchPreComposeEvent(e,n){const r=this.getLayer();if(r.hasListener(un.PRECOMPOSE)){const i=new bd(un.PRECOMPOSE,void 0,n,e);r.dispatchEvent(i)}}dispatchPostComposeEvent(e,n){const r=this.getLayer();if(r.hasListener(un.POSTCOMPOSE)){const i=new bd(un.POSTCOMPOSE,void 0,n,e);r.dispatchEvent(i)}}reset(e){this.uniforms_=e.uniforms,this.helper&&this.helper.setUniforms(this.uniforms_)}removeHelper(){this.helper&&(this.helper.dispose(),delete this.helper)}prepareFrame(e){if(this.getLayer().getRenderSource()){let n=!0,r=-1,i;for(let o=0,a=e.layerStatesArray.length;o<a;o++){const l=e.layerStatesArray[o].layer,c=l.getRenderer();if(!(c instanceof Fb)){n=!0;continue}const u=l.getClassName();if((n||u!==i)&&(r+=1,n=!1),i=u,c===this)break}const s="map/"+e.mapId+"/group/"+r;(!this.helper||!this.helper.canvasCacheKeyMatches(s)||this.helper.needsToBeRecreated())&&(this.removeHelper(),this.helper=new mxe({postProcesses:this.postProcesses_,uniforms:this.uniforms_,canvasCacheKey:s}),i&&(this.helper.getCanvas().className=i),this.afterHelperCreated())}return this.prepareFrameInternal(e)}afterHelperCreated(){}prepareFrameInternal(e){return!0}clearCache(){}disposeInternal(){var e;this.clearCache(),this.removeHelper(),(e=this.getLayer())==null||e.removeChangeListener(Qe.MAP,this.onMapChanged_),super.disposeInternal()}dispatchRenderEvent_(e,n,r){const i=this.getLayer();if(i.hasListener(e)){Xr(this.inversePixelTransform_,0,0,r.pixelRatio,-r.pixelRatio,0,0,-r.size[1]);const s=new bd(e,this.inversePixelTransform_,r,n);i.dispatchEvent(s)}}preRender(e,n){this.dispatchRenderEvent_(un.PRERENDER,e,n)}postRender(e,n){this.dispatchRenderEvent_(un.POSTRENDER,e,n)}}const ov={TILE_TEXTURE_ARRAY:"u_tileTextures",TEXTURE_PIXEL_WIDTH:"u_texturePixelWidth",TEXTURE_PIXEL_HEIGHT:"u_texturePixelHeight"};class _xe{constructor(e,n){this.name=e,this.data=n,this.texture_=null}getTexture(e){if(!this.texture_){const n=e.createTexture();e.bindTexture(e.TEXTURE_2D,n),e.texParameteri(e.TEXTURE_2D,e.TEXTURE_WRAP_S,e.CLAMP_TO_EDGE),e.texParameteri(e.TEXTURE_2D,e.TEXTURE_WRAP_T,e.CLAMP_TO_EDGE),e.texParameteri(e.TEXTURE_2D,e.TEXTURE_MIN_FILTER,e.NEAREST),e.texParameteri(e.TEXTURE_2D,e.TEXTURE_MAG_FILTER,e.NEAREST),e.texImage2D(e.TEXTURE_2D,0,e.RGBA,this.data.length/4,1,0,e.RGBA,e.UNSIGNED_BYTE,this.data),this.texture_=n}return this.texture_}delete(e){this.texture_&&e.deleteTexture(this.texture_),this.texture_=null}}function vxe(t,e){return`operator_${t}_${Object.keys(e.functions).length}`}function Do(t){const e=t.toString();return e.includes(".")?e:e+".0"}function Ob(t){if(t.length<2||t.length>4)throw new Error("`formatArray` can only output `vec2`, `vec3` or `vec4` arrays.");return`vec${t.length}(${t.map(Do).join(", ")})`}function Qg(t){const e=Yr(t),n=e.length>3?e[3]:1;return Ob([e[0]/255,e[1]/255,e[2]/255,n])}function wxe(t){const e=dn(t);return Ob(e)}const av={};let xxe=0;function Th(t){return t in av||(av[t]=xxe++),av[t]}function vs(t){return Do(Th(t))}function $b(t){return"u_var_"+t}function wN(){return{variables:{},properties:{},functions:{},bandCount:0,featureId:!1,geometryType:!1}}const lv="getBandValue",Exe="u_paletteTextures",xN="featureId",EN="geometryType",gx=-9999999;function Sxe(t,e,n,r){const i=hn(t,e,n);return Lb(i,e,r)}function Ze(t){return(e,n,r)=>{const i=n.args.length,s=new Array(i);for(let o=0;o<i;++o)s[o]=Lb(n.args[o],r,e);return t(s,e)}}const bxe={[Z.Get]:(t,e)=>{const r=e.args[0].value;r in t.properties||(t.properties[r]={name:r,type:e.type});let s="a_prop_"+r;return $i(e.type,Kt)&&(s=`(${s} > 0.0)`),s},[Z.Id]:t=>(t.featureId=!0,"a_"+xN),[Z.GeometryType]:t=>(t.geometryType=!0,"a_"+EN),[Z.LineMetric]:()=>"currentLineMetric",[Z.Var]:(t,e)=>{const r=e.args[0].value;r in t.variables||(t.variables[r]={name:r,type:e.type});let s=$b(r);return $i(e.type,Kt)&&(s=`(${s} > 0.0)`),s},[Z.Has]:(t,e)=>{const r=e.args[0].value;return r in t.properties||(t.properties[r]={name:r,type:e.type}),`(a_prop_${r} != ${Do(gx)})`},[Z.Resolution]:()=>"u_resolution",[Z.Zoom]:()=>"u_zoom",[Z.Time]:()=>"u_time",[Z.Any]:Ze(t=>`(${t.join(" || ")})`),[Z.All]:Ze(t=>`(${t.join(" && ")})`),[Z.Not]:Ze(([t])=>`(!${t})`),[Z.Equal]:Ze(([t,e])=>`(${t} == ${e})`),[Z.NotEqual]:Ze(([t,e])=>`(${t} != ${e})`),[Z.GreaterThan]:Ze(([t,e])=>`(${t} > ${e})`),[Z.GreaterThanOrEqualTo]:Ze(([t,e])=>`(${t} >= ${e})`),[Z.LessThan]:Ze(([t,e])=>`(${t} < ${e})`),[Z.LessThanOrEqualTo]:Ze(([t,e])=>`(${t} <= ${e})`),[Z.Multiply]:Ze(t=>`(${t.join(" * ")})`),[Z.Divide]:Ze(([t,e])=>`(${t} / ${e})`),[Z.Add]:Ze(t=>`(${t.join(" + ")})`),[Z.Subtract]:Ze(([t,e])=>`(${t} - ${e})`),[Z.Clamp]:Ze(([t,e,n])=>`clamp(${t}, ${e}, ${n})`),[Z.Mod]:Ze(([t,e])=>`mod(${t}, ${e})`),[Z.Pow]:Ze(([t,e])=>`pow(${t}, ${e})`),[Z.Abs]:Ze(([t])=>`abs(${t})`),[Z.Floor]:Ze(([t])=>`floor(${t})`),[Z.Ceil]:Ze(([t])=>`ceil(${t})`),[Z.Round]:Ze(([t])=>`floor(${t} + 0.5)`),[Z.Sin]:Ze(([t])=>`sin(${t})`),[Z.Cos]:Ze(([t])=>`cos(${t})`),[Z.Atan]:Ze(([t,e])=>e!==void 0?`atan(${t}, ${e})`:`atan(${t})`),[Z.Sqrt]:Ze(([t])=>`sqrt(${t})`),[Z.Match]:Ze(t=>{const e=t[0],n=t[t.length-1];let r=null;for(let i=t.length-3;i>=1;i-=2){const s=t[i],o=t[i+1];r=`(${e} == ${s} ? ${o} : ${r||n})`}return r}),[Z.Between]:Ze(([t,e,n])=>`(${t} >= ${e} && ${t} <= ${n})`),[Z.Interpolate]:Ze(([t,e,...n])=>{let r="";for(let i=0;i<n.length-2;i+=2){const s=n[i],o=r||n[i+1],a=n[i+2],l=n[i+3];let c;t===Do(1)?c=`(${e} - ${s}) / (${a} - ${s})`:c=`(pow(${t}, (${e} - ${s})) - 1.0) / (pow(${t}, (${a} - ${s})) - 1.0)`,r=`mix(${o}, ${l}, clamp(${c}, 0.0, 1.0))`}return r}),[Z.Case]:Ze(t=>{const e=t[t.length-1];let n=null;for(let r=t.length-3;r>=0;r-=2){const i=t[r],s=t[r+1];n=`(${i} ? ${s} : ${n||e})`}return n}),[Z.In]:Ze(([t,...e],n)=>{const r=vxe("in",n),i=[];for(let s=0;s<e.length;s+=1)i.push(`  if (inputValue == ${e[s]}) { return true; }`);return n.functions[r]=`bool ${r}(float inputValue) {
${i.join(`
`)}
  return false;
}`,`${r}(${t})`}),[Z.Array]:Ze(t=>`vec${t.length}(${t.join(", ")})`),[Z.Color]:Ze(t=>{if(t.length===1)return`vec4(vec3(${t[0]} / 255.0), 1.0)`;if(t.length===2)return`vec4(vec3(${t[0]} / 255.0), ${t[1]})`;const e=t.slice(0,3).map(r=>`${r} / 255.0`);if(t.length===3)return`vec4(${e.join(", ")}, 1.0)`;const n=t[3];return`vec4(${e.join(", ")}, ${n})`}),[Z.Band]:Ze(([t,e,n],r)=>{if(!(lv in r.functions)){let i="";const s=r.bandCount||1;for(let o=0;o<s;o++){const a=Math.floor(o/4);let l=o%4;o===s-1&&l===1&&(l=3);const c=`${ov.TILE_TEXTURE_ARRAY}[${a}]`;i+=`  if (band == ${o+1}.0) {
    return texture2D(${c}, v_textureCoord + vec2(dx, dy))[${l}];
  }
`}r.functions[lv]=`float getBandValue(float band, float xOffset, float yOffset) {
  float dx = xOffset / ${ov.TEXTURE_PIXEL_WIDTH};
  float dy = yOffset / ${ov.TEXTURE_PIXEL_HEIGHT};
${i}
}`}return`${lv}(${t}, ${e??"0.0"}, ${n??"0.0"})`}),[Z.Palette]:(t,e)=>{const[n,...r]=e.args,i=r.length,s=new Uint8Array(i*4);for(let c=0;c<r.length;c++){const u=r[c].value,d=Yr(u),h=c*4;s[h]=d[0],s[h+1]=d[1],s[h+2]=d[2],s[h+3]=d[3]*255}t.paletteTextures||(t.paletteTextures=[]);const o=`${Exe}[${t.paletteTextures.length}]`,a=new _xe(o,s);t.paletteTextures.push(a);const l=Lb(n,_e,t);return`texture2D(${o}, vec2((${l} + 0.5) / ${i}.0, 0.5))`}};function Lb(t,e,n){if(t instanceof n$){const r=bxe[t.operator];if(r===void 0)throw new Error(`No compiler defined for this operator: ${JSON.stringify(t.operator)}`);return r(n,t,e)}if((t.type&_e)>0)return Do(t.value);if((t.type&Kt)>0)return t.value.toString();if((t.type&Jt)>0)return vs(t.value.toString());if((t.type&Rt)>0)return Qg(t.value);if((t.type&cr)>0)return Ob(t.value);if((t.type&Ur)>0)return wxe(t.value);throw new Error(`Unexpected expression ${t.value} (expected type ${nc(e)})`)}function Cxe(){return{"fill-color":"rgba(255,255,255,0.4)","stroke-color":"#3399CC","stroke-width":1.25,"circle-radius":5,"circle-fill-color":"rgba(255,255,255,0.4)","circle-stroke-width":1.25,"circle-stroke-color":"#3399CC"}}const SI=.985;function Re(t,e,n){const r=tE();return Sxe(e,n,r,t)}function Txe(t){const e=Yr(t),n=e[0]*256,r=e[1],i=e[2]*256,s=Math.round(e[3]*255);return[n+r,i+s]}const Pxe=`vec4 unpackColor(vec2 packedColor) {
  return vec4(
    min(floor(packedColor[0] / 256.0) / 255.0, 1.0),
    min(mod(packedColor[0], 256.0) / 255.0, 1.0),
    min(floor(packedColor[1] / 256.0) / 255.0, 1.0),
    min(mod(packedColor[1], 256.0) / 255.0, 1.0)
  );
}`;function kb(t){return t===Rt||t===Ur?2:t===cr?4:1}function px(t){const e=kb(t);return e>1?`vec${e}`:"float"}function SN(t,e){for(const n in e.variables){const r=e.variables[n],i=$b(r.name);let s=px(r.type);r.type===Rt&&(s="vec4"),t.addUniform(i,s)}for(const n in e.properties){const r=e.properties[n],i=px(r.type),s=`a_prop_${r.name}`;r.type===Rt?t.addAttribute(s,i,`unpackColor(${s})`,"vec4"):t.addAttribute(s,i)}for(const n in e.functions)t.addVertexShaderFunction(e.functions[n]),t.addFragmentShaderFunction(e.functions[n])}function bN(t,e){const n={};for(const r in t.variables){const i=t.variables[r],s=$b(i.name);n[s]=()=>{const o=e[i.name];if(typeof o=="number")return o;if(typeof o=="boolean")return o?1:0;if(i.type===Rt){const a=[...Yr(o||"#eee")];return a[0]/=255,a[1]/=255,a[2]/=255,a[3]??(a[3]=1),a}return typeof o=="string"?Th(o):o}}return n}function CN(t){const e={};for(const n in t.properties){const r=t.properties[n],i=s=>{const o=s.get(r.name);return r.type===Rt?Txe([...Yr(o||"#eee")]):typeof o=="string"?Th(o):typeof o=="boolean"?o?1:0:o};e[`prop_${r.name}`]={size:kb(r.type),callback:i}}return e}const Fl=`#ifdef GL_FRAGMENT_PRECISION_HIGH
precision highp float;
#else
precision mediump float;
#endif
uniform mat4 u_projectionMatrix;
uniform mat4 u_screenToWorldMatrix;
uniform vec2 u_viewportSizePx;
uniform float u_pixelRatio;
uniform float u_globalAlpha;
uniform float u_time;
uniform float u_zoom;
uniform float u_resolution;
uniform float u_rotation;
uniform vec4 u_renderExtent;
uniform vec2 u_patternOrigin;
uniform float u_depth;
uniform mediump int u_hitDetection;

const float PI = 3.141592653589793238;
const float TWO_PI = 2.0 * PI;
float currentLineMetric = 0.; // an actual value will be used in the stroke shaders

${Pxe}
`,Ol=Cxe();class TN{constructor(){this.uniforms_=[],this.attributes_=[],this.hasSymbol_=!1,this.symbolSizeExpression_=`vec2(${Do(Ol["circle-radius"])} + ${Do(Ol["circle-stroke-width"]*.5)})`,this.symbolRotationExpression_="0.0",this.symbolOffsetExpression_="vec2(0.0)",this.symbolColorExpression_=Qg(Ol["circle-fill-color"]),this.texCoordExpression_="vec4(0.0, 0.0, 1.0, 1.0)",this.discardExpression_="false",this.symbolRotateWithView_=!1,this.hasStroke_=!1,this.strokeWidthExpression_=Do(Ol["stroke-width"]),this.strokeColorExpression_=Qg(Ol["stroke-color"]),this.strokeOffsetExpression_="0.",this.strokeCapExpression_=vs("round"),this.strokeJoinExpression_=vs("round"),this.strokeMiterLimitExpression_="10.",this.strokeDistanceFieldExpression_="-1000.",this.strokePatternLengthExpression_=null,this.hasFill_=!1,this.fillColorExpression_=Qg(Ol["fill-color"]),this.vertexShaderFunctions_=[],this.fragmentShaderFunctions_=[]}addUniform(e,n){return this.uniforms_.push({name:e,type:n}),this}addAttribute(e,n,r,i){return this.attributes_.push({name:e,type:n,varyingName:e.replace(/^a_/,"v_"),varyingType:i??n,varyingExpression:r??e}),this}setSymbolSizeExpression(e){return this.hasSymbol_=!0,this.symbolSizeExpression_=e,this}getSymbolSizeExpression(){return this.symbolSizeExpression_}setSymbolRotationExpression(e){return this.symbolRotationExpression_=e,this}setSymbolOffsetExpression(e){return this.symbolOffsetExpression_=e,this}getSymbolOffsetExpression(){return this.symbolOffsetExpression_}setSymbolColorExpression(e){return this.hasSymbol_=!0,this.symbolColorExpression_=e,this}getSymbolColorExpression(){return this.symbolColorExpression_}setTextureCoordinateExpression(e){return this.texCoordExpression_=e,this}setFragmentDiscardExpression(e){return this.discardExpression_=e,this}getFragmentDiscardExpression(){return this.discardExpression_}setSymbolRotateWithView(e){return this.symbolRotateWithView_=e,this}setStrokeWidthExpression(e){return this.hasStroke_=!0,this.strokeWidthExpression_=e,this}setStrokeColorExpression(e){return this.hasStroke_=!0,this.strokeColorExpression_=e,this}getStrokeColorExpression(){return this.strokeColorExpression_}setStrokeOffsetExpression(e){return this.strokeOffsetExpression_=e,this}setStrokeCapExpression(e){return this.strokeCapExpression_=e,this}setStrokeJoinExpression(e){return this.strokeJoinExpression_=e,this}setStrokeMiterLimitExpression(e){return this.strokeMiterLimitExpression_=e,this}setStrokeDistanceFieldExpression(e){return this.strokeDistanceFieldExpression_=e,this}setStrokePatternLengthExpression(e){return this.strokePatternLengthExpression_=e,this}getStrokePatternLengthExpression(){return this.strokePatternLengthExpression_}setFillColorExpression(e){return this.hasFill_=!0,this.fillColorExpression_=e,this}getFillColorExpression(){return this.fillColorExpression_}addVertexShaderFunction(e){return this.vertexShaderFunctions_.includes(e)?this:(this.vertexShaderFunctions_.push(e),this)}addFragmentShaderFunction(e){return this.fragmentShaderFunctions_.includes(e)?this:(this.fragmentShaderFunctions_.push(e),this)}getSymbolVertexShader(){return this.hasSymbol_?`${Fl}
${this.uniforms_.map(e=>`uniform ${e.type} ${e.name};`).join(`
`)}
attribute vec2 a_position;
attribute vec2 a_localPosition;
attribute vec2 a_hitColor;

varying vec2 v_texCoord;
varying vec2 v_quadCoord;
varying vec4 v_hitColor;
varying vec2 v_centerPx;
varying float v_angle;
varying vec2 v_quadSizePx;

${this.attributes_.map(e=>`attribute ${e.type} ${e.name};
varying ${e.varyingType} ${e.varyingName};`).join(`
`)}
${this.vertexShaderFunctions_.join(`
`)}
vec2 pxToScreen(vec2 coordPx) {
  vec2 scaled = coordPx / u_viewportSizePx / 0.5;
  return scaled;
}

vec2 screenToPx(vec2 coordScreen) {
  return (coordScreen * 0.5 + 0.5) * u_viewportSizePx;
}

void main(void) {
  v_quadSizePx = ${this.symbolSizeExpression_};
  vec2 halfSizePx = v_quadSizePx * 0.5;
  vec2 centerOffsetPx = ${this.symbolOffsetExpression_};
  vec2 offsetPx = centerOffsetPx + a_localPosition * halfSizePx * vec2(1., -1.);
  float angle = ${this.symbolRotationExpression_}${this.symbolRotateWithView_?" + u_rotation":""};
  float c = cos(-angle);
  float s = sin(-angle);
  offsetPx = vec2(c * offsetPx.x - s * offsetPx.y, s * offsetPx.x + c * offsetPx.y);
  vec4 center = u_projectionMatrix * vec4(a_position, 0.0, 1.0);
  gl_Position = center + vec4(pxToScreen(offsetPx), u_depth, 0.);
  vec4 texCoord = ${this.texCoordExpression_};
  float u = mix(texCoord.s, texCoord.p, a_localPosition.x * 0.5 + 0.5);
  float v = mix(texCoord.t, texCoord.q, a_localPosition.y * 0.5 + 0.5);
  v_texCoord = vec2(u, v);
  v_hitColor = unpackColor(a_hitColor);
  v_angle = angle;
  c = cos(-v_angle);
  s = sin(-v_angle);
  centerOffsetPx = vec2(c * centerOffsetPx.x - s * centerOffsetPx.y, s * centerOffsetPx.x + c * centerOffsetPx.y);
  v_centerPx = screenToPx(center.xy) + centerOffsetPx;
${this.attributes_.map(e=>`  ${e.varyingName} = ${e.varyingExpression};`).join(`
`)}
}`:null}getSymbolFragmentShader(){return this.hasSymbol_?`${Fl}
${this.uniforms_.map(e=>`uniform ${e.type} ${e.name};`).join(`
`)}
varying vec2 v_texCoord;
varying vec4 v_hitColor;
varying vec2 v_centerPx;
varying float v_angle;
varying vec2 v_quadSizePx;
${this.attributes_.map(e=>`varying ${e.varyingType} ${e.varyingName};`).join(`
`)}
${this.fragmentShaderFunctions_.join(`
`)}

void main(void) {
${this.attributes_.map(e=>`  ${e.varyingType} ${e.name} = ${e.varyingName}; // assign to original attribute name`).join(`
`)}
  if (${this.discardExpression_}) { discard; }
  vec2 coordsPx = gl_FragCoord.xy / u_pixelRatio - v_centerPx; // relative to center
  float c = cos(v_angle);
  float s = sin(v_angle);
  coordsPx = vec2(c * coordsPx.x - s * coordsPx.y, s * coordsPx.x + c * coordsPx.y);
  gl_FragColor = ${this.symbolColorExpression_};
  gl_FragColor.rgb *= gl_FragColor.a;
  if (u_hitDetection > 0) {
    if (gl_FragColor.a < 0.05) { discard; };
    gl_FragColor = v_hitColor;
  }
}`:null}getStrokeVertexShader(){return this.hasStroke_?`${Fl}
${this.uniforms_.map(e=>`uniform ${e.type} ${e.name};`).join(`
`)}
attribute vec2 a_segmentStart;
attribute vec2 a_segmentEnd;
attribute vec2 a_localPosition;
attribute float a_measureStart;
attribute float a_measureEnd;
attribute float a_angleTangentSum;
attribute float a_distanceLow;
attribute float a_distanceHigh;
attribute vec2 a_joinAngles;
attribute vec2 a_hitColor;

varying vec2 v_segmentStartPx;
varying vec2 v_segmentEndPx;
varying float v_angleStart;
varying float v_angleEnd;
varying float v_width;
varying vec4 v_hitColor;
varying float v_distancePx;
varying float v_measureStart;
varying float v_measureEnd;

${this.attributes_.map(e=>`attribute ${e.type} ${e.name};
varying ${e.varyingType} ${e.varyingName};`).join(`
`)}
${this.vertexShaderFunctions_.join(`
`)}
vec2 worldToPx(vec2 worldPos) {
  vec4 screenPos = u_projectionMatrix * vec4(worldPos, 0.0, 1.0);
  return (0.5 * screenPos.xy + 0.5) * u_viewportSizePx;
}

vec4 pxToScreen(vec2 pxPos) {
  vec2 screenPos = 2.0 * pxPos / u_viewportSizePx - 1.0;
  return vec4(screenPos, u_depth, 1.0);
}

bool isCap(float joinAngle) {
  return joinAngle < -0.1;
}

vec2 getJoinOffsetDirection(vec2 normalPx, float joinAngle) {
  float halfAngle = joinAngle / 2.0;
  float c = cos(halfAngle);
  float s = sin(halfAngle);
  vec2 angleBisectorNormal = vec2(s * normalPx.x + c * normalPx.y, -c * normalPx.x + s * normalPx.y);
  float length = 1.0 / s;
  return angleBisectorNormal * length;
}

vec2 getOffsetPoint(vec2 point, vec2 normal, float joinAngle, float offsetPx) {
  // if on a cap or the join angle is too high, offset the line along the segment normal
  if (cos(joinAngle) > 0.998 || isCap(joinAngle)) {
    return point - normal * offsetPx;
  }
  // offset is applied along the inverted normal (positive offset goes "right" relative to line direction)
  return point - getJoinOffsetDirection(normal, joinAngle) * offsetPx;
}

void main(void) {
  v_angleStart = a_joinAngles.x;
  v_angleEnd = a_joinAngles.y;
  float startEndRatio = a_localPosition.x * 0.5 + 0.5;
  currentLineMetric = mix(a_measureStart, a_measureEnd, startEndRatio);
  // we're reading the fractional part while keeping the sign (so -4.12 gives -0.12, 3.45 gives 0.45)

  float lineWidth = ${this.strokeWidthExpression_};
  float lineOffsetPx = ${this.strokeOffsetExpression_};

  // compute segment start/end in px with offset
  vec2 segmentStartPx = worldToPx(a_segmentStart);
  vec2 segmentEndPx = worldToPx(a_segmentEnd);
  vec2 tangentPx = normalize(segmentEndPx - segmentStartPx);
  vec2 normalPx = vec2(-tangentPx.y, tangentPx.x);
  segmentStartPx = getOffsetPoint(segmentStartPx, normalPx, v_angleStart, lineOffsetPx),
  segmentEndPx = getOffsetPoint(segmentEndPx, normalPx, v_angleEnd, lineOffsetPx);

  // compute current vertex position
  float normalDir = -1. * a_localPosition.y;
  float tangentDir = -1. * a_localPosition.x;
  float angle = mix(v_angleStart, v_angleEnd, startEndRatio);
  vec2 joinDirection;
  vec2 positionPx = mix(segmentStartPx, segmentEndPx, startEndRatio);
  // if angle is too high, do not make a proper join
  if (cos(angle) > ${SI} || isCap(angle)) {
    joinDirection = normalPx * normalDir - tangentPx * tangentDir;
  } else {
    joinDirection = getJoinOffsetDirection(normalPx * normalDir, angle);
  }
  positionPx = positionPx + joinDirection * (lineWidth * 0.5 + 1.); // adding 1 pixel for antialiasing
  gl_Position = pxToScreen(positionPx);

  v_segmentStartPx = segmentStartPx;
  v_segmentEndPx = segmentEndPx;
  v_width = lineWidth;
  v_hitColor = unpackColor(a_hitColor);

  v_distancePx = a_distanceLow / u_resolution - (lineOffsetPx * a_angleTangentSum);
  float distanceHighPx = a_distanceHigh / u_resolution;
  ${this.strokePatternLengthExpression_!==null?`v_distancePx = mod(v_distancePx, ${this.strokePatternLengthExpression_});
  distanceHighPx = mod(distanceHighPx, ${this.strokePatternLengthExpression_});
  `:""}v_distancePx += distanceHighPx;

  v_measureStart = a_measureStart;
  v_measureEnd = a_measureEnd;
${this.attributes_.map(e=>`  ${e.varyingName} = ${e.varyingExpression};`).join(`
`)}
}`:null}getStrokeFragmentShader(){return this.hasStroke_?`${Fl}
${this.uniforms_.map(e=>`uniform ${e.type} ${e.name};`).join(`
`)}
varying vec2 v_segmentStartPx;
varying vec2 v_segmentEndPx;
varying float v_angleStart;
varying float v_angleEnd;
varying float v_width;
varying vec4 v_hitColor;
varying float v_distancePx;
varying float v_measureStart;
varying float v_measureEnd;
${this.attributes_.map(e=>`varying ${e.varyingType} ${e.varyingName};`).join(`
`)}
${this.fragmentShaderFunctions_.join(`
`)}

vec2 pxToWorld(vec2 pxPos) {
  vec2 screenPos = 2.0 * pxPos / u_viewportSizePx - 1.0;
  return (u_screenToWorldMatrix * vec4(screenPos, 0.0, 1.0)).xy;
}

bool isCap(float joinAngle) {
  return joinAngle < -0.1;
}

float segmentDistanceField(vec2 point, vec2 start, vec2 end, float width) {
  vec2 tangent = normalize(end - start);
  vec2 normal = vec2(-tangent.y, tangent.x);
  vec2 startToPoint = point - start;
  return abs(dot(startToPoint, normal)) - width * 0.5;
}

float buttCapDistanceField(vec2 point, vec2 start, vec2 end) {
  vec2 startToPoint = point - start;
  vec2 tangent = normalize(end - start);
  return dot(startToPoint, -tangent);
}

float squareCapDistanceField(vec2 point, vec2 start, vec2 end, float width) {
  return buttCapDistanceField(point, start, end) - width * 0.5;
}

float roundCapDistanceField(vec2 point, vec2 start, vec2 end, float width) {
  float onSegment = max(0., 1000. * dot(point - start, end - start)); // this is very high when inside the segment
  return length(point - start) - width * 0.5 - onSegment;
}

float roundJoinDistanceField(vec2 point, vec2 start, vec2 end, float width) {
  return roundCapDistanceField(point, start, end, width);
}

float bevelJoinField(vec2 point, vec2 start, vec2 end, float width, float joinAngle) {
  vec2 startToPoint = point - start;
  vec2 tangent = normalize(end - start);
  float c = cos(joinAngle * 0.5);
  float s = sin(joinAngle * 0.5);
  float direction = -sign(sin(joinAngle));
  vec2 bisector = vec2(c * tangent.x - s * tangent.y, s * tangent.x + c * tangent.y);
  float radius = width * 0.5 * s;
  return dot(startToPoint, bisector * direction) - radius;
}

float miterJoinDistanceField(vec2 point, vec2 start, vec2 end, float width, float joinAngle) {
  if (cos(joinAngle) > ${SI}) { // avoid risking a division by zero
    return bevelJoinField(point, start, end, width, joinAngle);
  }
  float miterLength = 1. / sin(joinAngle * 0.5);
  float miterLimit = ${this.strokeMiterLimitExpression_};
  if (miterLength > miterLimit) {
    return bevelJoinField(point, start, end, width, joinAngle);
  }
  return -1000.;
}

float capDistanceField(vec2 point, vec2 start, vec2 end, float width, float capType) {
   if (capType == ${vs("butt")}) {
    return buttCapDistanceField(point, start, end);
  } else if (capType == ${vs("square")}) {
    return squareCapDistanceField(point, start, end, width);
  }
  return roundCapDistanceField(point, start, end, width);
}

float joinDistanceField(vec2 point, vec2 start, vec2 end, float width, float joinAngle, float joinType) {
  if (joinType == ${vs("bevel")}) {
    return bevelJoinField(point, start, end, width, joinAngle);
  } else if (joinType == ${vs("miter")}) {
    return miterJoinDistanceField(point, start, end, width, joinAngle);
  }
  return roundJoinDistanceField(point, start, end, width);
}

float computeSegmentPointDistance(vec2 point, vec2 start, vec2 end, float width, float joinAngle, float capType, float joinType) {
  if (isCap(joinAngle)) {
    return capDistanceField(point, start, end, width, capType);
  }
  return joinDistanceField(point, start, end, width, joinAngle, joinType);
}

float distanceFromSegment(vec2 point, vec2 start, vec2 end) {
  vec2 tangent = end - start;
  vec2 startToPoint = point - start;
  // inspire by capsule fn in https://iquilezles.org/articles/distfunctions/
  float h = clamp(dot(startToPoint, tangent) / dot(tangent, tangent), 0.0, 1.0);
  return length(startToPoint - tangent * h);
}

void main(void) {
${this.attributes_.map(e=>`  ${e.varyingType} ${e.name} = ${e.varyingName}; // assign to original attribute name`).join(`
`)}

  vec2 currentPointPx = gl_FragCoord.xy / u_pixelRatio;
  #ifdef GL_FRAGMENT_PRECISION_HIGH
  vec2 worldPos = pxToWorld(currentPointPx);
  if (
    abs(u_renderExtent[0] - u_renderExtent[2]) > 0.0 && (
      worldPos[0] < u_renderExtent[0] ||
      worldPos[1] < u_renderExtent[1] ||
      worldPos[0] > u_renderExtent[2] ||
      worldPos[1] > u_renderExtent[3]
    )
  ) {
    discard;
  }
  #endif

  float segmentLengthPx = length(v_segmentEndPx - v_segmentStartPx);
  segmentLengthPx = max(segmentLengthPx, 1.17549429e-38); // avoid divide by zero
  vec2 segmentTangent = (v_segmentEndPx - v_segmentStartPx) / segmentLengthPx;
  vec2 segmentNormal = vec2(-segmentTangent.y, segmentTangent.x);
  vec2 startToPointPx = currentPointPx - v_segmentStartPx;
  float lengthToPointPx = max(0., min(dot(segmentTangent, startToPointPx), segmentLengthPx));
  float currentLengthPx = lengthToPointPx + v_distancePx;
  float currentRadiusPx = distanceFromSegment(currentPointPx, v_segmentStartPx, v_segmentEndPx);
  float currentRadiusRatio = dot(segmentNormal, startToPointPx) * 2. / v_width;
  currentLineMetric = mix(v_measureStart, v_measureEnd, lengthToPointPx / segmentLengthPx);

  if (${this.discardExpression_}) { discard; }

  float capType = ${this.strokeCapExpression_};
  float joinType = ${this.strokeJoinExpression_};
  float segmentStartDistance = computeSegmentPointDistance(currentPointPx, v_segmentStartPx, v_segmentEndPx, v_width, v_angleStart, capType, joinType);
  float segmentEndDistance = computeSegmentPointDistance(currentPointPx, v_segmentEndPx, v_segmentStartPx, v_width, v_angleEnd, capType, joinType);
  float distanceField = max(
    segmentDistanceField(currentPointPx, v_segmentStartPx, v_segmentEndPx, v_width),
    max(segmentStartDistance, segmentEndDistance)
  );
  distanceField = max(distanceField, ${this.strokeDistanceFieldExpression_});

  vec4 color = ${this.strokeColorExpression_};
  color.a *= smoothstep(0.5, -0.5, distanceField);
  gl_FragColor = color;
  gl_FragColor.a *= u_globalAlpha;
  gl_FragColor.rgb *= gl_FragColor.a;
  if (u_hitDetection > 0) {
    if (gl_FragColor.a < 0.1) { discard; };
    gl_FragColor = v_hitColor;
  }
}`:null}getFillVertexShader(){return this.hasFill_?`${Fl}
${this.uniforms_.map(e=>`uniform ${e.type} ${e.name};`).join(`
`)}
attribute vec2 a_position;
attribute vec2 a_hitColor;

varying vec4 v_hitColor;

${this.attributes_.map(e=>`attribute ${e.type} ${e.name};
varying ${e.varyingType} ${e.varyingName};`).join(`
`)}
${this.vertexShaderFunctions_.join(`
`)}
void main(void) {
  gl_Position = u_projectionMatrix * vec4(a_position, u_depth, 1.0);
  v_hitColor = unpackColor(a_hitColor);
${this.attributes_.map(e=>`  ${e.varyingName} = ${e.varyingExpression};`).join(`
`)}
}`:null}getFillFragmentShader(){return this.hasFill_?`${Fl}
${this.uniforms_.map(e=>`uniform ${e.type} ${e.name};`).join(`
`)}
varying vec4 v_hitColor;
${this.attributes_.map(e=>`varying ${e.varyingType} ${e.varyingName};`).join(`
`)}
${this.fragmentShaderFunctions_.join(`
`)}
vec2 pxToWorld(vec2 pxPos) {
  vec2 screenPos = 2.0 * pxPos / u_viewportSizePx - 1.0;
  return (u_screenToWorldMatrix * vec4(screenPos, 0.0, 1.0)).xy;
}

vec2 worldToPx(vec2 worldPos) {
  vec4 screenPos = u_projectionMatrix * vec4(worldPos, 0.0, 1.0);
  return (0.5 * screenPos.xy + 0.5) * u_viewportSizePx;
}

void main(void) {
${this.attributes_.map(e=>`  ${e.varyingType} ${e.name} = ${e.varyingName}; // assign to original attribute name`).join(`
`)}
  vec2 pxPos = gl_FragCoord.xy / u_pixelRatio;
  vec2 pxOrigin = worldToPx(u_patternOrigin);
  #ifdef GL_FRAGMENT_PRECISION_HIGH
  vec2 worldPos = pxToWorld(pxPos);
  if (
    abs(u_renderExtent[0] - u_renderExtent[2]) > 0.0 && (
      worldPos[0] < u_renderExtent[0] ||
      worldPos[1] < u_renderExtent[1] ||
      worldPos[0] > u_renderExtent[2] ||
      worldPos[1] > u_renderExtent[3]
    )
  ) {
    discard;
  }
  #endif
  if (${this.discardExpression_}) { discard; }
  gl_FragColor = ${this.fillColorExpression_};
  gl_FragColor.a *= u_globalAlpha;
  gl_FragColor.rgb *= gl_FragColor.a;
  if (u_hitDetection > 0) {
    if (gl_FragColor.a < 0.1) { discard; };
    gl_FragColor = v_hitColor;
  }
}`:null}}class Cm{constructor(){this.globalCounter_=0,this.refToFeature_=new Map,this.uidToRef_=new Map,this.freeGlobalRef_=[],this.polygonBatch={entries:{},geometriesCount:0,verticesCount:0,ringsCount:0},this.pointBatch={entries:{},geometriesCount:0},this.lineStringBatch={entries:{},geometriesCount:0,verticesCount:0}}addFeatures(e,n){for(let r=0;r<e.length;r++)this.addFeature(e[r],n)}addFeature(e,n){let r=e.getGeometry();r&&(n&&(r=r.clone(),r.applyTransform(n)),this.addGeometry_(r,e))}clearFeatureEntryInPointBatch_(e){const n=fe(e),r=this.pointBatch.entries[n];if(r)return this.pointBatch.geometriesCount-=r.flatCoordss.length,delete this.pointBatch.entries[n],r}clearFeatureEntryInLineStringBatch_(e){const n=fe(e),r=this.lineStringBatch.entries[n];if(r)return this.lineStringBatch.verticesCount-=r.verticesCount,this.lineStringBatch.geometriesCount-=r.flatCoordss.length,delete this.lineStringBatch.entries[n],r}clearFeatureEntryInPolygonBatch_(e){const n=fe(e),r=this.polygonBatch.entries[n];if(r)return this.polygonBatch.verticesCount-=r.verticesCount,this.polygonBatch.ringsCount-=r.ringsCount,this.polygonBatch.geometriesCount-=r.flatCoordss.length,delete this.polygonBatch.entries[n],r}addGeometry_(e,n){var i;const r=e.getType();switch(r){case"GeometryCollection":{const s=e.getGeometriesArray();for(const o of s)this.addGeometry_(o,n);break}case"MultiPolygon":{const s=e;this.addCoordinates_(r,s.getFlatCoordinates(),s.getEndss(),n,fe(n),s.getStride());break}case"MultiLineString":{const s=e;this.addCoordinates_(r,s.getFlatCoordinates(),s.getEnds(),n,fe(n),s.getStride());break}case"MultiPoint":{const s=e;this.addCoordinates_(r,s.getFlatCoordinates(),null,n,fe(n),s.getStride());break}case"Polygon":{const s=e;this.addCoordinates_(r,s.getFlatCoordinates(),s.getEnds(),n,fe(n),s.getStride());break}case"Point":{const s=e;this.addCoordinates_(r,s.getFlatCoordinates(),null,n,fe(n),s.getStride());break}case"LineString":case"LinearRing":{const s=e,o=s.getStride();this.addCoordinates_(r,s.getFlatCoordinates(),null,n,fe(n),o,(i=s.getLayout)==null?void 0:i.call(s));break}}}addCoordinates_(e,n,r,i,s,o,a){let l;switch(e){case"MultiPolygon":{const c=r;for(let u=0,d=c.length;u<d;u++){let h=c[u];const f=u>0?c[u-1]:null,p=f?f[f.length-1]:0,m=h[h.length-1];h=p>0?h.map(_=>_-p):h,this.addCoordinates_("Polygon",n.slice(p,m),h,i,s,o,a)}break}case"MultiLineString":{const c=r;for(let u=0,d=c.length;u<d;u++){const h=u>0?c[u-1]:0;this.addCoordinates_("LineString",n.slice(h,c[u]),null,i,s,o,a)}break}case"MultiPoint":for(let c=0,u=n.length;c<u;c+=o)this.addCoordinates_("Point",n.slice(c,c+2),null,i,s,null,null);break;case"Polygon":{const c=r;if(i instanceof wn){const h=W1(n,c);if(h.length>1){this.addCoordinates_("MultiPolygon",n,h,i,s,o,a);return}}this.polygonBatch.entries[s]||(this.polygonBatch.entries[s]=this.addRefToEntry_(s,{feature:i,flatCoordss:[],verticesCount:0,ringsCount:0,ringsVerticesCounts:[]})),l=n.length/o;const u=r.length,d=r.map((h,f,p)=>f>0?(h-p[f-1])/o:h/o);this.polygonBatch.verticesCount+=l,this.polygonBatch.ringsCount+=u,this.polygonBatch.geometriesCount++,this.polygonBatch.entries[s].flatCoordss.push(Rxe(n,o)),this.polygonBatch.entries[s].ringsVerticesCounts.push(d),this.polygonBatch.entries[s].verticesCount+=l,this.polygonBatch.entries[s].ringsCount+=u;for(let h=0,f=c.length;h<f;h++){const p=h>0?c[h-1]:0;this.addCoordinates_("LinearRing",n.slice(p,c[h]),null,i,s,o,a)}break}case"Point":this.pointBatch.entries[s]||(this.pointBatch.entries[s]=this.addRefToEntry_(s,{feature:i,flatCoordss:[]})),this.pointBatch.geometriesCount++,this.pointBatch.entries[s].flatCoordss.push(n);break;case"LineString":case"LinearRing":this.lineStringBatch.entries[s]||(this.lineStringBatch.entries[s]=this.addRefToEntry_(s,{feature:i,flatCoordss:[],verticesCount:0})),l=n.length/o,this.lineStringBatch.verticesCount+=l,this.lineStringBatch.geometriesCount++,this.lineStringBatch.entries[s].flatCoordss.push(Ixe(n,o,a)),this.lineStringBatch.entries[s].verticesCount+=l;break}}addRefToEntry_(e,n){const r=this.uidToRef_.get(e),i=r||this.freeGlobalRef_.pop()||++this.globalCounter_;return n.ref=i,r||(this.refToFeature_.set(i,n.feature),this.uidToRef_.set(e,i)),n}removeRef_(e,n){if(!e)throw new Error("This feature has no ref: "+n);this.refToFeature_.delete(e),this.uidToRef_.delete(n),this.freeGlobalRef_.push(e)}changeFeature(e,n){if(!this.uidToRef_.get(fe(e)))return;this.removeFeature(e);let r=e.getGeometry();r&&(n&&(r=r.clone(),r.applyTransform(n)),this.addGeometry_(r,e))}removeFeature(e){let n=this.clearFeatureEntryInPointBatch_(e);n=this.clearFeatureEntryInPolygonBatch_(e)||n,n=this.clearFeatureEntryInLineStringBatch_(e)||n,n&&this.removeRef_(n.ref,fe(n.feature))}clear(){this.polygonBatch.entries={},this.polygonBatch.geometriesCount=0,this.polygonBatch.verticesCount=0,this.polygonBatch.ringsCount=0,this.lineStringBatch.entries={},this.lineStringBatch.geometriesCount=0,this.lineStringBatch.verticesCount=0,this.pointBatch.entries={},this.pointBatch.geometriesCount=0,this.globalCounter_=0,this.freeGlobalRef_=[],this.refToFeature_.clear(),this.uidToRef_.clear()}getFeatureFromRef(e){return this.refToFeature_.get(e)}isEmpty(){return this.globalCounter_===0}filter(e){const n=new Cm;n.globalCounter_=this.globalCounter_,n.uidToRef_=this.uidToRef_,n.refToFeature_=this.refToFeature_;let r=!0;for(const i of this.refToFeature_.values())e(i)&&(n.addFeature(i),r=!1);return r?new Cm:n}}function Rxe(t,e){return e===2?t:t.filter((n,r)=>r%e<2)}function Ixe(t,e,n){return e===3&&n==="XYM"?t:e===4?t.filter((r,i)=>i%e!==2):e===3?t.map((r,i)=>i%e!==2?r:0):new Array(t.length*1.5).fill(0).map((r,i)=>i%3===2?0:t[Math.round(i/1.5)])}function Axe(){const t='function t(t,n,x=2){const o=n&&n.length,i=o?n[0]*x:t.length;let f=e(t,0,i,x,!0);const l=[];if(!f||f.next===f.prev)return l;let c,y,h;if(o&&(f=function(t,n,r,x){const o=[];for(let r=0,i=n.length;r<i;r++){const f=e(t,n[r]*x,r<i-1?n[r+1]*x:t.length,x,!1);f===f.next&&(f.steiner=!0),o.push(a(f))}o.sort(u);for(let t=0;t<o.length;t++)r=s(o[t],r);return r}(t,n,f,x)),t.length>80*x){c=t[0],y=t[1];let e=c,n=y;for(let r=x;r<i;r+=x){const x=t[r],o=t[r+1];x<c&&(c=x),o<y&&(y=o),x>e&&(e=x),o>n&&(n=o)}h=Math.max(e-c,n-y),h=0!==h?32767/h:0}return r(f,l,x,c,y,h,0),l}function e(t,e,n,r,x){let o;if(x===function(t,e,n,r){let x=0;for(let o=e,i=n-r;o<n;o+=r)x+=(t[i]-t[o])*(t[o+1]+t[i+1]),i=o;return x}(t,e,n,r)>0)for(let x=e;x<n;x+=r)o=d(x/r|0,t[x],t[x+1],o);else for(let x=n-r;x>=e;x-=r)o=d(x/r|0,t[x],t[x+1],o);return o&&b(o,o.next)&&(w(o),o=o.next),o}function n(t,e){if(!t)return t;e||(e=t);let n,r=t;do{if(n=!1,r.steiner||!b(r,r.next)&&0!==v(r.prev,r,r.next))r=r.next;else{if(w(r),r=e=r.prev,r===r.next)break;n=!0}}while(n||r!==e);return e}function r(t,e,u,s,l,a,y){if(!t)return;!y&&a&&function(t,e,n,r){let x=t;do{0===x.z&&(x.z=c(x.x,x.y,e,n,r)),x.prevZ=x.prev,x.nextZ=x.next,x=x.next}while(x!==t);x.prevZ.nextZ=null,x.prevZ=null,function(t){let e,n=1;do{let r,x=t;t=null;let o=null;for(e=0;x;){e++;let i=x,f=0;for(let t=0;t<n&&(f++,i=i.nextZ,i);t++);let u=n;for(;f>0||u>0&&i;)0!==f&&(0===u||!i||x.z<=i.z)?(r=x,x=x.nextZ,f--):(r=i,i=i.nextZ,u--),o?o.nextZ=r:t=r,r.prevZ=o,o=r;x=i}o.nextZ=null,n*=2}while(e>1)}(x)}(t,s,l,a);let h=t;for(;t.prev!==t.next;){const c=t.prev,p=t.next;if(a?o(t,s,l,a):x(t))e.push(c.i,t.i,p.i),w(t),t=p.next,h=p.next;else if((t=p)===h){y?1===y?r(t=i(n(t),e),e,u,s,l,a,2):2===y&&f(t,e,u,s,l,a):r(n(t),e,u,s,l,a,1);break}}}function x(t){const e=t.prev,n=t,r=t.next;if(v(e,n,r)>=0)return!1;const x=e.x,o=n.x,i=r.x,f=e.y,u=n.y,s=r.y,l=Math.min(x,o,i),c=Math.min(f,u,s),a=Math.max(x,o,i),y=Math.max(f,u,s);let p=r.next;for(;p!==e;){if(p.x>=l&&p.x<=a&&p.y>=c&&p.y<=y&&h(x,f,o,u,i,s,p.x,p.y)&&v(p.prev,p,p.next)>=0)return!1;p=p.next}return!0}function o(t,e,n,r){const x=t.prev,o=t,i=t.next;if(v(x,o,i)>=0)return!1;const f=x.x,u=o.x,s=i.x,l=x.y,a=o.y,y=i.y,p=Math.min(f,u,s),b=Math.min(l,a,y),M=Math.max(f,u,s),m=Math.max(l,a,y),A=c(p,b,e,n,r),g=c(M,m,e,n,r);let Z=t.prevZ,d=t.nextZ;for(;Z&&Z.z>=A&&d&&d.z<=g;){if(Z.x>=p&&Z.x<=M&&Z.y>=b&&Z.y<=m&&Z!==x&&Z!==i&&h(f,l,u,a,s,y,Z.x,Z.y)&&v(Z.prev,Z,Z.next)>=0)return!1;if(Z=Z.prevZ,d.x>=p&&d.x<=M&&d.y>=b&&d.y<=m&&d!==x&&d!==i&&h(f,l,u,a,s,y,d.x,d.y)&&v(d.prev,d,d.next)>=0)return!1;d=d.nextZ}for(;Z&&Z.z>=A;){if(Z.x>=p&&Z.x<=M&&Z.y>=b&&Z.y<=m&&Z!==x&&Z!==i&&h(f,l,u,a,s,y,Z.x,Z.y)&&v(Z.prev,Z,Z.next)>=0)return!1;Z=Z.prevZ}for(;d&&d.z<=g;){if(d.x>=p&&d.x<=M&&d.y>=b&&d.y<=m&&d!==x&&d!==i&&h(f,l,u,a,s,y,d.x,d.y)&&v(d.prev,d,d.next)>=0)return!1;d=d.nextZ}return!0}function i(t,e){let r=t;do{const n=r.prev,x=r.next.next;!b(n,x)&&M(n,r,r.next,x)&&g(n,x)&&g(x,n)&&(e.push(n.i,r.i,x.i),w(r),w(r.next),r=t=x),r=r.next}while(r!==t);return n(r)}function f(t,e,x,o,i,f){let u=t;do{let t=u.next.next;for(;t!==u.prev;){if(u.i!==t.i&&p(u,t)){let s=Z(u,t);return u=n(u,u.next),s=n(s,s.next),r(u,e,x,o,i,f,0),void r(s,e,x,o,i,f,0)}t=t.next}u=u.next}while(u!==t)}function u(t,e){let n=t.x-e.x;if(0===n&&(n=t.y-e.y,0===n)){n=(t.next.y-t.y)/(t.next.x-t.x)-(e.next.y-e.y)/(e.next.x-e.x)}return n}function s(t,e){const r=function(t,e){let n=e;const r=t.x,x=t.y;let o,i=-1/0;if(b(t,n))return n;do{if(b(t,n.next))return n.next;if(x<=n.y&&x>=n.next.y&&n.next.y!==n.y){const t=n.x+(x-n.y)*(n.next.x-n.x)/(n.next.y-n.y);if(t<=r&&t>i&&(i=t,o=n.x<n.next.x?n:n.next,t===r))return o}n=n.next}while(n!==e);if(!o)return null;const f=o,u=o.x,s=o.y;let c=1/0;n=o;do{if(r>=n.x&&n.x>=u&&r!==n.x&&y(x<s?r:i,x,u,s,x<s?i:r,x,n.x,n.y)){const e=Math.abs(x-n.y)/(r-n.x);g(n,t)&&(e<c||e===c&&(n.x>o.x||n.x===o.x&&l(o,n)))&&(o=n,c=e)}n=n.next}while(n!==f);return o}(t,e);if(!r)return e;const x=Z(r,t);return n(x,x.next),n(r,r.next)}function l(t,e){return v(t.prev,t,e.prev)<0&&v(e.next,t,t.next)<0}function c(t,e,n,r,x){return(t=1431655765&((t=858993459&((t=252645135&((t=16711935&((t=(t-n)*x|0)|t<<8))|t<<4))|t<<2))|t<<1))|(e=1431655765&((e=858993459&((e=252645135&((e=16711935&((e=(e-r)*x|0)|e<<8))|e<<4))|e<<2))|e<<1))<<1}function a(t){let e=t,n=t;do{(e.x<n.x||e.x===n.x&&e.y<n.y)&&(n=e),e=e.next}while(e!==t);return n}function y(t,e,n,r,x,o,i,f){return(x-i)*(e-f)>=(t-i)*(o-f)&&(t-i)*(r-f)>=(n-i)*(e-f)&&(n-i)*(o-f)>=(x-i)*(r-f)}function h(t,e,n,r,x,o,i,f){return!(t===i&&e===f)&&y(t,e,n,r,x,o,i,f)}function p(t,e){return t.next.i!==e.i&&t.prev.i!==e.i&&!function(t,e){let n=t;do{if(n.i!==t.i&&n.next.i!==t.i&&n.i!==e.i&&n.next.i!==e.i&&M(n,n.next,t,e))return!0;n=n.next}while(n!==t);return!1}(t,e)&&(g(t,e)&&g(e,t)&&function(t,e){let n=t,r=!1;const x=(t.x+e.x)/2,o=(t.y+e.y)/2;do{n.y>o!=n.next.y>o&&n.next.y!==n.y&&x<(n.next.x-n.x)*(o-n.y)/(n.next.y-n.y)+n.x&&(r=!r),n=n.next}while(n!==t);return r}(t,e)&&(v(t.prev,t,e.prev)||v(t,e.prev,e))||b(t,e)&&v(t.prev,t,t.next)>0&&v(e.prev,e,e.next)>0)}function v(t,e,n){return(e.y-t.y)*(n.x-e.x)-(e.x-t.x)*(n.y-e.y)}function b(t,e){return t.x===e.x&&t.y===e.y}function M(t,e,n,r){const x=A(v(t,e,n)),o=A(v(t,e,r)),i=A(v(n,r,t)),f=A(v(n,r,e));return x!==o&&i!==f||(!(0!==x||!m(t,n,e))||(!(0!==o||!m(t,r,e))||(!(0!==i||!m(n,t,r))||!(0!==f||!m(n,e,r)))))}function m(t,e,n){return e.x<=Math.max(t.x,n.x)&&e.x>=Math.min(t.x,n.x)&&e.y<=Math.max(t.y,n.y)&&e.y>=Math.min(t.y,n.y)}function A(t){return t>0?1:t<0?-1:0}function g(t,e){return v(t.prev,t,t.next)<0?v(t,e,t.next)>=0&&v(t,t.prev,e)>=0:v(t,e,t.prev)<0||v(t,t.next,e)<0}function Z(t,e){const n=F(t.i,t.x,t.y),r=F(e.i,e.x,e.y),x=t.next,o=e.prev;return t.next=e,e.prev=t,n.next=x,x.prev=n,r.next=n,n.prev=r,o.next=r,r.prev=o,r}function d(t,e,n,r){const x=F(t,e,n);return r?(x.next=r.next,x.prev=r,r.next.prev=x,r.next=x):(x.prev=x,x.next=x),x}function w(t){t.next.prev=t.prev,t.prev.next=t.next,t.prevZ&&(t.prevZ.nextZ=t.nextZ),t.nextZ&&(t.nextZ.prevZ=t.prevZ)}function F(t,e,n){return{i:t,x:e,y:n,prev:null,next:null,z:0,prevZ:null,nextZ:null,steiner:!1}}function E(t,e){const n=e[0],r=e[1];return e[0]=t[0]*n+t[2]*r+t[4],e[1]=t[1]*n+t[3]*r+t[5],e}function I(t,e){const n=(r=e)[0]*r[3]-r[1]*r[2];var r;!function(t,e){if(!t)throw new Error(e)}(0!==n,"Transformation matrix cannot be inverted");const x=e[0],o=e[1],i=e[2],f=e[3],u=e[4],s=e[5];return t[0]=f/n,t[1]=-o/n,t[2]=-i/n,t[3]=x/n,t[4]=(i*s-f*u)/n,t[5]=-(x*s-o*u)/n,t}new Array(6);const z=[],B={vertexAttributesPosition:0,instanceAttributesPosition:0,indicesPosition:0};function P(t,e,n,r,x){const o=t[e++],i=t[e++],f=z;f.length=r;for(let n=0;n<f.length;n++)f[n]=t[e+n];let u=x?x.instanceAttributesPosition:0;return n[u++]=o,n[u++]=i,f.length&&(n.set(f,u),u+=f.length),B.instanceAttributesPosition=u,B}function N(t,e,n,r,x,o,i,f,u,s){const l=[t[e],t[e+1]],c=[t[n],t[n+1]],a=t[e+2],y=t[n+2],h=E(f,[...l]),p=E(f,[...c]);function v(t,e,n){const r=Math.sqrt((e[0]-t[0])*(e[0]-t[0])+(e[1]-t[1])*(e[1]-t[1])),x=[(e[0]-t[0])/r,(e[1]-t[1])/r],o=[-x[1],x[0]],i=Math.sqrt((n[0]-t[0])*(n[0]-t[0])+(n[1]-t[1])*(n[1]-t[1])),f=[(n[0]-t[0])/i,(n[1]-t[1])/i];let u=0===r||0===i?0:Math.acos((s=f[0]*x[0]+f[1]*x[1],l=-1,c=1,Math.min(Math.max(s,l),c)));var s,l,c;u=Math.max(u,1e-5);return f[0]*o[0]+f[1]*o[1]>0?u:2*Math.PI-u}let b=-1,M=-1,m=s;const A=null!==x;if(null!==r){b=v(h,p,E(f,[...[t[r],t[r+1]]])),Math.cos(b)<=.985&&(m+=Math.tan((b-Math.PI)/2))}if(A){M=v(p,h,E(f,[...[t[x],t[x+1]]])),Math.cos(M)<=.985&&(m+=Math.tan((Math.PI-M)/2))}const g=Math.pow(2,24),Z=u%g,d=Math.floor(u/g)*g;return o.push(l[0],l[1],a,c[0],c[1],y,b,M,Z,d,s),o.push(...i),{length:u+Math.sqrt((p[0]-h[0])*(p[0]-h[0])+(p[1]-h[1])*(p[1]-h[1])),angle:m}}function R(e,n,r,x,o){const i=2+o;let f=n;const u=e.slice(f,f+o);f+=o;const s=e[f++];let l=0;const c=new Array(s-1);for(let t=0;t<s;t++)l+=e[f++],t<s-1&&(c[t]=l);const a=e.slice(f,f+2*l),y=t(a,c,2);for(let t=0;t<y.length;t++)x.push(y[t]+r.length/i);for(let t=0;t<a.length;t+=2)r.push(a[t],a[t+1],...u);return f+2*l}const S="GENERATE_POLYGON_BUFFERS",T="GENERATE_POINT_BUFFERS",_="GENERATE_LINE_STRING_BUFFERS",O=self;O.onmessage=t=>{const e=t.data;switch(e.type){case T:{const t=2,n=2,r=e.customAttributesSize,x=n+r,o=new Float32Array(e.renderInstructions),i=o.length/x*(t+r),f=Uint32Array.from([0,1,3,1,2,3]),u=Float32Array.from([-1,-1,1,-1,1,1,-1,1]),s=new Float32Array(i);let l;for(let t=0;t<o.length;t+=x)l=P(o,t,s,r,l);const c=Object.assign({indicesBuffer:f.buffer,vertexAttributesBuffer:u.buffer,instanceAttributesBuffer:s.buffer,renderInstructions:o.buffer},e);O.postMessage(c,[u.buffer,s.buffer,f.buffer,o.buffer]);break}case _:{const t=[],n=e.customAttributesSize,r=3,x=new Float32Array(e.renderInstructions);let o=0;const i=[1,0,0,1,0,0];let f,u;for(I(i,e.renderInstructionsTransform);o<x.length;){u=Array.from(x.slice(o,o+n)),o+=n,f=x[o++];const e=o,s=o+(f-1)*r,l=x[e]===x[s]&&x[e+1]===x[s+1];let c=0,a=0;for(let n=0;n<f-1;n++){let y=null;n>0?y=o+(n-1)*r:l&&(y=s-r);let h=null;n<f-2?h=o+(n+2)*r:l&&(h=e+r);const p=N(x,o+n*r,o+(n+1)*r,y,h,t,u,i,c,a);c=p.length,a=p.angle}o+=f*r}const s=Uint32Array.from([0,1,3,1,2,3]),l=Float32Array.from([-1,-1,1,-1,1,1,-1,1]),c=Float32Array.from(t),a=Object.assign({indicesBuffer:s.buffer,vertexAttributesBuffer:l.buffer,instanceAttributesBuffer:c.buffer,renderInstructions:x.buffer},e);O.postMessage(a,[l.buffer,c.buffer,s.buffer,x.buffer]);break}case S:{const t=[],n=[],r=e.customAttributesSize,x=new Float32Array(e.renderInstructions);let o=0;for(;o<x.length;)o=R(x,o,t,n,r);const i=Uint32Array.from(n),f=Float32Array.from(t),u=Float32Array.from([]),s=Object.assign({indicesBuffer:i.buffer,vertexAttributesBuffer:f.buffer,instanceAttributesBuffer:u.buffer,renderInstructions:x.buffer},e);O.postMessage(s,[f.buffer,u.buffer,i.buffer,x.buffer]);break}}};';return new Worker(typeof Blob>"u"?"data:application/javascript;base64,"+Buffer.from(t,"binary").toString("base64"):URL.createObjectURL(new Blob([t],{type:"application/javascript"})))}const cv={GENERATE_POLYGON_BUFFERS:"GENERATE_POLYGON_BUFFERS",GENERATE_POINT_BUFFERS:"GENERATE_POINT_BUFFERS",GENERATE_LINE_STRING_BUFFERS:"GENERATE_LINE_STRING_BUFFERS"};function Fxe(t,e){e=e||[];const n=256,r=n-1,i=Math.floor(t/n/n/n)/r,s=Math.floor(t/n/n)%n/r,o=Math.floor(t/n)%n/r,a=t%n/r;return e[0]=i*256*255+s*255,e[1]=o*256*255+a*255,e}function Oxe(t){let e=0;const n=256,r=n-1;return e+=Math.round(t[0]*n*n*n*r),e+=Math.round(t[1]*n*n*r),e+=Math.round(t[2]*n*r),e+=Math.round(t[3]*r),e}function Mb(t,e,n,r){let i=0;for(const s in e){const o=e[s],a=o.callback.call(n,n.feature);let l=(a==null?void 0:a[0])??a;l===gx&&console.warn('The "has" operator might return false positives.'),l===void 0?l=gx:l===null&&(l=0),t[r+i++]=l,!(!o.size||o.size===1)&&(t[r+i++]=a[1],!(o.size<3)&&(t[r+i++]=a[2],!(o.size<4)&&(t[r+i++]=a[3])))}return i}function g_(t){return Object.keys(t).reduce((e,n)=>e+(t[n].size||1),0)}function $xe(t,e,n,r){const i=(2+g_(n))*t.geometriesCount;(!e||e.length!==i)&&(e=new Float32Array(i));const s=[];let o=0;for(const a in t.entries){const l=t.entries[a];for(let c=0,u=l.flatCoordss.length;c<u;c++)s[0]=l.flatCoordss[c][0],s[1]=l.flatCoordss[c][1],$t(r,s),e[o++]=s[0],e[o++]=s[1],o+=Mb(e,n,l,o)}return e}function Lxe(t,e,n,r){const i=3*t.verticesCount+(1+g_(n))*t.geometriesCount;(!e||e.length!==i)&&(e=new Float32Array(i));const s=[];let o=0;for(const a in t.entries){const l=t.entries[a];for(let c=0,u=l.flatCoordss.length;c<u;c++){s.length=l.flatCoordss[c].length,Ki(l.flatCoordss[c],0,s.length,3,r,s,3),o+=Mb(e,n,l,o),e[o++]=s.length/3;for(let d=0,h=s.length;d<h;d+=3)e[o++]=s[d],e[o++]=s[d+1],e[o++]=s[d+2]}}return e}function kxe(t,e,n,r){const i=2*t.verticesCount+(1+g_(n))*t.geometriesCount+t.ringsCount;(!e||e.length!==i)&&(e=new Float32Array(i));const s=[];let o=0;for(const a in t.entries){const l=t.entries[a];for(let c=0,u=l.flatCoordss.length;c<u;c++){s.length=l.flatCoordss[c].length,Ki(l.flatCoordss[c],0,s.length,2,r,s),o+=Mb(e,n,l,o),e[o++]=l.ringsVerticesCounts[c].length;for(let d=0,h=l.ringsVerticesCounts[c].length;d<h;d++)e[o++]=l.ringsVerticesCounts[c][d];for(let d=0,h=s.length;d<h;d+=2)e[o++]=s[d],e[o++]=s[d+1]}}return e}function Tm(t){return(JSON.stringify(t).split("").reduce((n,r)=>(n<<5)-n+r.charCodeAt(0),0)>>>0).toString()}function Db(t,e,n,r){if(`${r}radius`in t&&r!=="icon-"){let i=Re(n,t[`${r}radius`],_e);if(`${r}radius2`in t){const s=Re(n,t[`${r}radius2`],_e);i=`max(${i}, ${s})`}`${r}stroke-width`in t&&(i=`(${i} + ${Re(n,t[`${r}stroke-width`],_e)} * 0.5)`),e.setSymbolSizeExpression(`vec2(${i} * 2. + 0.5)`)}if(`${r}scale`in t){const i=Re(n,t[`${r}scale`],Ur);e.setSymbolSizeExpression(`${e.getSymbolSizeExpression()} * ${i}`)}`${r}displacement`in t&&e.setSymbolOffsetExpression(Re(n,t[`${r}displacement`],cr)),`${r}rotation`in t&&e.setSymbolRotationExpression(Re(n,t[`${r}rotation`],_e)),`${r}rotate-with-view`in t&&e.setSymbolRotateWithView(!!t[`${r}rotate-with-view`])}function PN(t,e,n,r,i){let s="vec4(0.)";if(e!==null&&(s=e),n!==null&&r!==null){const l=`smoothstep(-${r} + 0.63, -${r} - 0.58, ${t})`;s=`mix(${n}, ${s}, ${l})`}const o=`(1.0 - smoothstep(-0.63, 0.58, ${t}))`;let a=`${s} * vec4(1.0, 1.0, 1.0, ${o})`;return i!==null&&(a=`${a} * vec4(1.0, 1.0, 1.0, ${i})`),a}function Nb(t,e,n,r,i){const s=new Image;s.crossOrigin=t[`${r}cross-origin`]===void 0?"anonymous":t[`${r}cross-origin`],ze(typeof t[`${r}src`]=="string",`WebGL layers do not support expressions for the ${r}src style property`),s.src=t[`${r}src`],n[`u_texture${i}_size`]=()=>s.complete?[s.width,s.height]:[0,0],e.addUniform(`u_texture${i}_size`,"vec2");const o=`u_texture${i}_size`;return n[`u_texture${i}`]=s,e.addUniform(`u_texture${i}`,"sampler2D"),o}function jb(t,e,n,r,i){let s=Re(n,t[`${e}offset`],Ur);if(`${e}offset-origin`in t)switch(t[`${e}offset-origin`]){case"top-right":s=`vec2(${r}.x, 0.) + ${i} * vec2(-1., 0.) + ${s} * vec2(-1., 1.)`;break;case"bottom-left":s=`vec2(0., ${r}.y) + ${i} * vec2(0., -1.) + ${s} * vec2(1., -1.)`;break;case"bottom-right":s=`${r} - ${i} - ${s}`;break}return s}function Mxe(t,e,n,r){r.functions.circleDistanceField=`float circleDistanceField(vec2 point, float radius) {
  return length(point) - radius;
}`,Db(t,e,r,"circle-");let i=null;"circle-opacity"in t&&(i=Re(r,t["circle-opacity"],_e));let s="coordsPx";"circle-scale"in t&&(s=`coordsPx / ${Re(r,t["circle-scale"],Ur)}`);let o=null;"circle-fill-color"in t&&(o=Re(r,t["circle-fill-color"],Rt));let a=null;"circle-stroke-color"in t&&(a=Re(r,t["circle-stroke-color"],Rt));let l=Re(r,t["circle-radius"],_e),c=null;"circle-stroke-width"in t&&(c=Re(r,t["circle-stroke-width"],_e),l=`(${l} + ${c} * 0.5)`);const u=`circleDistanceField(${s}, ${l})`,d=PN(u,o,a,c,i);e.setSymbolColorExpression(d)}function Dxe(t,e,n,r){r.functions.round=`float round(float v) {
  return sign(v) * floor(abs(v) + 0.5);
}`,r.functions.starDistanceField=`float starDistanceField(vec2 point, float numPoints, float radius, float radius2, float angle) {
  float startAngle = -PI * 0.5 + angle; // tip starts upwards and rotates clockwise with angle
  float c = cos(startAngle);
  float s = sin(startAngle);
  vec2 pointRotated = vec2(c * point.x - s * point.y, s * point.x + c * point.y);
  float alpha = TWO_PI / numPoints; // the angle of one sector
  float beta = atan(pointRotated.y, pointRotated.x);
  float gamma = round(beta / alpha) * alpha; // angle in sector
  c = cos(-gamma);
  s = sin(-gamma);
  vec2 inSector = vec2(c * pointRotated.x - s * pointRotated.y, abs(s * pointRotated.x + c * pointRotated.y));
  vec2 tipToPoint = inSector + vec2(-radius, 0.);
  vec2 edgeNormal = vec2(radius2 * sin(alpha * 0.5), -radius2 * cos(alpha * 0.5) + radius);
  return dot(normalize(edgeNormal), tipToPoint);
}`,r.functions.regularDistanceField=`float regularDistanceField(vec2 point, float numPoints, float radius, float angle) {
  float startAngle = -PI * 0.5 + angle; // tip starts upwards and rotates clockwise with angle
  float c = cos(startAngle);
  float s = sin(startAngle);
  vec2 pointRotated = vec2(c * point.x - s * point.y, s * point.x + c * point.y);
  float alpha = TWO_PI / numPoints; // the angle of one sector
  float radiusIn = radius * cos(PI / numPoints);
  float beta = atan(pointRotated.y, pointRotated.x);
  float gamma = round((beta - alpha * 0.5) / alpha) * alpha + alpha * 0.5; // angle in sector from mid
  c = cos(-gamma);
  s = sin(-gamma);
  vec2 inSector = vec2(c * pointRotated.x - s * pointRotated.y, abs(s * pointRotated.x + c * pointRotated.y));
  return inSector.x - radiusIn;
}`,Db(t,e,r,"shape-");let i=null;"shape-opacity"in t&&(i=Re(r,t["shape-opacity"],_e));let s="coordsPx";"shape-scale"in t&&(s=`coordsPx / ${Re(r,t["shape-scale"],Ur)}`);let o=null;"shape-fill-color"in t&&(o=Re(r,t["shape-fill-color"],Rt));let a=null;"shape-stroke-color"in t&&(a=Re(r,t["shape-stroke-color"],Rt));let l=null;"shape-stroke-width"in t&&(l=Re(r,t["shape-stroke-width"],_e));const c=Re(r,t["shape-points"],_e);let u="0.";"shape-angle"in t&&(u=Re(r,t["shape-angle"],_e));let d,h=Re(r,t["shape-radius"],_e);if(l!==null&&(h=`${h} + ${l} * 0.5`),"shape-radius2"in t){let p=Re(r,t["shape-radius2"],_e);l!==null&&(p=`${p} + ${l} * 0.5`),d=`starDistanceField(${s}, ${c}, ${h}, ${p}, ${u})`}else d=`regularDistanceField(${s}, ${c}, ${h}, ${u})`;const f=PN(d,o,a,l,i);e.setSymbolColorExpression(f)}function Nxe(t,e,n,r){let i="vec4(1.0)";"icon-color"in t&&(i=Re(r,t["icon-color"],Rt)),"icon-opacity"in t&&(i=`${i} * vec4(1.0, 1.0, 1.0, ${Re(r,t["icon-opacity"],_e)})`);const s=Tm(t["icon-src"]),o=Nb(t,e,n,"icon-",s);if(e.setSymbolColorExpression(`${i} * texture2D(u_texture${s}, v_texCoord)`).setSymbolSizeExpression(o),"icon-width"in t&&"icon-height"in t&&e.setSymbolSizeExpression(`vec2(${Re(r,t["icon-width"],_e)}, ${Re(r,t["icon-height"],_e)})`),"icon-offset"in t&&"icon-size"in t){const a=Re(r,t["icon-size"],cr),l=e.getSymbolSizeExpression();e.setSymbolSizeExpression(a);const c=jb(t,"icon-",r,"v_quadSizePx",a);e.setTextureCoordinateExpression(`(vec4((${c}).xyxy) + vec4(0., 0., ${a})) / (${l}).xyxy`)}if(Db(t,e,r,"icon-"),"icon-anchor"in t){const a=Re(r,t["icon-anchor"],cr);let l="1.0";"icon-scale"in t&&(l=Re(r,t["icon-scale"],Ur));let c;t["icon-anchor-x-units"]==="pixels"&&t["icon-anchor-y-units"]==="pixels"?c=`${a} * ${l}`:t["icon-anchor-x-units"]==="pixels"?c=`${a} * vec2(vec2(${l}).x, v_quadSizePx.y)`:t["icon-anchor-y-units"]==="pixels"?c=`${a} * vec2(v_quadSizePx.x, vec2(${l}).x)`:c=`${a} * v_quadSizePx`;let u=`v_quadSizePx * vec2(0.5, -0.5) + ${c} * vec2(-1., 1.)`;if("icon-anchor-origin"in t)switch(t["icon-anchor-origin"]){case"top-right":u=`v_quadSizePx * -0.5 + ${c}`;break;case"bottom-left":u=`v_quadSizePx * 0.5 - ${c}`;break;case"bottom-right":u=`v_quadSizePx * vec2(-0.5, 0.5) + ${c} * vec2(1., -1.)`;break}e.setSymbolOffsetExpression(`${e.getSymbolOffsetExpression()} + ${u}`)}}function jxe(t,e,n,r){if("stroke-color"in t&&e.setStrokeColorExpression(Re(r,t["stroke-color"],Rt)),"stroke-pattern-src"in t){const i=Tm(t["stroke-pattern-src"]),s=Nb(t,e,n,"stroke-pattern-",i);let o=s,a="vec2(0.)";"stroke-pattern-offset"in t&&"stroke-pattern-size"in t&&(o=Re(r,t["stroke-pattern-size"],cr),a=jb(t,"stroke-pattern-",r,s,o));let l="0.";"stroke-pattern-spacing"in t&&(l=Re(r,t["stroke-pattern-spacing"],_e));let c="0.";"stroke-pattern-start-offset"in t&&(c=Re(r,t["stroke-pattern-start-offset"],_e)),r.functions.sampleStrokePattern=`vec4 sampleStrokePattern(sampler2D texture, vec2 textureSize, vec2 textureOffset, vec2 sampleSize, float spacingPx, float startOffsetPx, float currentLengthPx, float currentRadiusRatio, float lineWidth) {
  float currentLengthScaled = (currentLengthPx - startOffsetPx) * sampleSize.y / lineWidth;
  float spacingScaled = spacingPx * sampleSize.y / lineWidth;
  float uCoordPx = mod(currentLengthScaled, (sampleSize.x + spacingScaled));
  float isInsideOfPattern = step(uCoordPx, sampleSize.x);
  float vCoordPx = (-currentRadiusRatio * 0.5 + 0.5) * sampleSize.y;
  // make sure that we're not sampling too close to the borders to avoid interpolation with outside pixels
  uCoordPx = clamp(uCoordPx, 0.5, sampleSize.x - 0.5);
  vCoordPx = clamp(vCoordPx, 0.5, sampleSize.y - 0.5);
  vec2 texCoord = (vec2(uCoordPx, vCoordPx) + textureOffset) / textureSize;
  return texture2D(texture, texCoord) * vec4(1.0, 1.0, 1.0, isInsideOfPattern);
}`;const u=`u_texture${i}`;let d="1.";"stroke-color"in t&&(d=e.getStrokeColorExpression()),e.setStrokeColorExpression(`${d} * sampleStrokePattern(${u}, ${s}, ${a}, ${o}, ${l}, ${c}, currentLengthPx, currentRadiusRatio, v_width)`),r.functions.computeStrokePatternLength=`float computeStrokePatternLength(vec2 sampleSize, float spacingPx, float lineWidth) {
  float patternLengthPx = sampleSize.x / sampleSize.y * lineWidth;
  return patternLengthPx + spacingPx;
}`,e.setStrokePatternLengthExpression(`computeStrokePatternLength(${o}, ${l}, v_width)`)}if("stroke-width"in t&&e.setStrokeWidthExpression(Re(r,t["stroke-width"],_e)),"stroke-offset"in t&&e.setStrokeOffsetExpression(Re(r,t["stroke-offset"],_e)),"stroke-line-cap"in t&&e.setStrokeCapExpression(Re(r,t["stroke-line-cap"],Jt)),"stroke-line-join"in t&&e.setStrokeJoinExpression(Re(r,t["stroke-line-join"],Jt)),"stroke-miter-limit"in t&&e.setStrokeMiterLimitExpression(Re(r,t["stroke-miter-limit"],_e)),"stroke-line-dash"in t){r.functions.getSingleDashDistance=`float getSingleDashDistance(float distance, float radius, float dashOffset, float dashLength, float dashLengthTotal, float capType, float lineWidth) {
  float localDistance = mod(distance, dashLengthTotal);
  float distanceSegment = abs(localDistance - dashOffset - dashLength * 0.5) - dashLength * 0.5;
  distanceSegment = min(distanceSegment, dashLengthTotal - localDistance);
  if (capType == ${vs("square")}) {
    distanceSegment -= lineWidth * 0.5;
  } else if (capType == ${vs("round")}) {
    distanceSegment = min(distanceSegment, sqrt(distanceSegment * distanceSegment + radius * radius) - lineWidth * 0.5);
  }
  return distanceSegment;
}`;let i=t["stroke-line-dash"].map(p=>Re(r,p,_e));i.length%2===1&&(i=[...i,...i]);let s="0.";"stroke-line-dash-offset"in t&&(s=Re(r,t["stroke-line-dash-offset"],_e));const a=`dashDistanceField_${Tm(t["stroke-line-dash"])}`,l=i.map((p,m)=>`float dashLength${m}`).join(", "),c=i.map((p,m)=>`dashLength${m}`).join(" + ");let u="0.",d=`getSingleDashDistance(distance, radius, ${u}, dashLength0, totalDashLength, capType, lineWidth)`;for(let p=2;p<i.length;p+=2)u=`${u} + dashLength${p-2} + dashLength${p-1}`,d=`min(${d}, getSingleDashDistance(distance, radius, ${u}, dashLength${p}, totalDashLength, capType, lineWidth))`;r.functions[a]=`float ${a}(float distance, float radius, float capType, float lineWidth, ${l}) {
  float totalDashLength = ${c};
  return ${d};
}`;const h=i.map((p,m)=>`${p}`).join(", ");e.setStrokeDistanceFieldExpression(`${a}(currentLengthPx + ${s}, currentRadiusPx, capType, v_width, ${h})`);let f=i.join(" + ");e.getStrokePatternLengthExpression()&&(r.functions.combinePatternLengths=`float combinePatternLengths(float patternLength1, float patternLength2) {
  return patternLength1 * patternLength2;
}`,f=`combinePatternLengths(${e.getStrokePatternLengthExpression()}, ${f})`),e.setStrokePatternLengthExpression(f)}}function zxe(t,e,n,r){if("fill-color"in t&&e.setFillColorExpression(Re(r,t["fill-color"],Rt)),"fill-pattern-src"in t){const i=Tm(t["fill-pattern-src"]),s=Nb(t,e,n,"fill-pattern-",i);let o=s,a="vec2(0.)";"fill-pattern-offset"in t&&"fill-pattern-size"in t&&(o=Re(r,t["fill-pattern-size"],cr),a=jb(t,"fill-pattern-",r,s,o)),r.functions.sampleFillPattern=`vec4 sampleFillPattern(sampler2D texture, vec2 textureSize, vec2 textureOffset, vec2 sampleSize, vec2 pxOrigin, vec2 pxPosition) {
  float scaleRatio = pow(2., mod(u_zoom + 0.5, 1.) - 0.5);
  vec2 pxRelativePos = pxPosition - pxOrigin;
  // rotate the relative position from origin by the current view rotation
  pxRelativePos = vec2(pxRelativePos.x * cos(u_rotation) - pxRelativePos.y * sin(u_rotation), pxRelativePos.x * sin(u_rotation) + pxRelativePos.y * cos(u_rotation));
  // sample position is computed according to the sample offset & size
  vec2 samplePos = mod(pxRelativePos / scaleRatio, sampleSize);
  // also make sure that we're not sampling too close to the borders to avoid interpolation with outside pixels
  samplePos = clamp(samplePos, vec2(0.5), sampleSize - vec2(0.5));
  samplePos.y = sampleSize.y - samplePos.y; // invert y axis so that images appear upright
  return texture2D(texture, (samplePos + textureOffset) / textureSize);
}`;const l=`u_texture${i}`;let c="1.";"fill-color"in t&&(c=e.getFillColorExpression()),e.setFillColorExpression(`${c} * sampleFillPattern(${l}, ${s}, ${a}, ${o}, pxOrigin, pxPos)`)}}function bI(t,e,n){const r=wN(),i=new TN,s={};if("icon-src"in t?Nxe(t,i,s,r):"shape-points"in t?Dxe(t,i,s,r):"circle-radius"in t&&Mxe(t,i,s,r),jxe(t,i,s,r),zxe(t,i,s,r),n){const l=Re(r,n,Kt);i.setFragmentDiscardExpression(`!${l}`)}const o={};function a(l,c,u,d){if(!r[l])return;const h=px(u),f=kb(u);i.addAttribute(`a_${c}`,h),o[c]={size:f,callback:d}}return a("geometryType",EN,Jt,l=>Th(nE(l.getGeometry()))),a("featureId",xN,Jt|_e,l=>{const c=l.getId()??null;return typeof c=="string"?Th(c):c}),SN(i,r),{builder:i,attributes:{...o,...CN(r)},uniforms:{...s,...bN(r,e)}}}const Uxe=[];let uv;function Gxe(){return uv||(uv=Axe()),uv}let Bxe=0;const $r={POSITION:"a_position",LOCAL_POSITION:"a_localPosition",SEGMENT_START:"a_segmentStart",SEGMENT_END:"a_segmentEnd",MEASURE_START:"a_measureStart",MEASURE_END:"a_measureEnd",ANGLE_TANGENT_SUM:"a_angleTangentSum",JOIN_ANGLES:"a_joinAngles",DISTANCE_LOW:"a_distanceLow",DISTANCE_HIGH:"a_distanceHigh"};class Vxe{constructor(e,n,r,i){this.helper_,this.hitDetectionEnabled_=!!i,this.styleShaders=Wxe(e,n),this.customAttributes_={},this.uniforms_={},this.hitDetectionEnabled_&&(this.customAttributes_.hitColor={callback(){return Fxe(this.ref,Uxe)},size:2});for(const s of this.styleShaders){for(const o in s.attributes)o in this.customAttributes_||(this.customAttributes_[o]=s.attributes[o]);for(const o in s.uniforms)o in this.uniforms_||(this.uniforms_[o]=s.uniforms[o])}this.renderPasses_=this.styleShaders.map(s=>{const o={},a=Object.entries(this.customAttributes_).map(([l,c])=>({name:l in s.attributes||l==="hitColor"?`a_${l}`:null,size:c.size||1,type:mn.FLOAT}));return s.builder.getFillVertexShader()&&(o.fillRenderPass={vertexShader:s.builder.getFillVertexShader(),fragmentShader:s.builder.getFillFragmentShader(),attributesDesc:[{name:$r.POSITION,size:2,type:mn.FLOAT},...a],instancedAttributesDesc:[],instancePrimitiveVertexCount:3}),s.builder.getStrokeVertexShader()&&(o.strokeRenderPass={vertexShader:s.builder.getStrokeVertexShader(),fragmentShader:s.builder.getStrokeFragmentShader(),attributesDesc:[{name:$r.LOCAL_POSITION,size:2,type:mn.FLOAT}],instancedAttributesDesc:[{name:$r.SEGMENT_START,size:2,type:mn.FLOAT},{name:$r.MEASURE_START,size:1,type:mn.FLOAT},{name:$r.SEGMENT_END,size:2,type:mn.FLOAT},{name:$r.MEASURE_END,size:1,type:mn.FLOAT},{name:$r.JOIN_ANGLES,size:2,type:mn.FLOAT},{name:$r.DISTANCE_LOW,size:1,type:mn.FLOAT},{name:$r.DISTANCE_HIGH,size:1,type:mn.FLOAT},{name:$r.ANGLE_TANGENT_SUM,size:1,type:mn.FLOAT},...a],instancePrimitiveVertexCount:6}),s.builder.getSymbolVertexShader()&&(o.symbolRenderPass={vertexShader:s.builder.getSymbolVertexShader(),fragmentShader:s.builder.getSymbolFragmentShader(),attributesDesc:[{name:$r.LOCAL_POSITION,size:2,type:mn.FLOAT}],instancedAttributesDesc:[{name:$r.POSITION,size:2,type:mn.FLOAT},...a],instancePrimitiveVertexCount:6}),o}),this.hasFill_=this.renderPasses_.some(s=>s.fillRenderPass),this.hasStroke_=this.renderPasses_.some(s=>s.strokeRenderPass),this.hasSymbol_=this.renderPasses_.some(s=>s.symbolRenderPass),this.setHelper(r)}async generateBuffers(e,n){if(e.isEmpty())return null;const r=this.generateRenderInstructions_(e,n),[i,s,o]=await Promise.all([this.generateBuffersForType_(r.polygonInstructions,"Polygon",n),this.generateBuffersForType_(r.lineStringInstructions,"LineString",n),this.generateBuffersForType_(r.pointInstructions,"Point",n)]),a=lh(Bt(),n);return{polygonBuffers:i,lineStringBuffers:s,pointBuffers:o,invertVerticesTransform:a}}generateRenderInstructions_(e,n){const r=this.hasFill_?kxe(e.polygonBatch,new Float32Array(0),this.customAttributes_,n):null,i=this.hasStroke_?Lxe(e.lineStringBatch,new Float32Array(0),this.customAttributes_,n):null,s=this.hasSymbol_?$xe(e.pointBatch,new Float32Array(0),this.customAttributes_,n):null;return{polygonInstructions:r,lineStringInstructions:i,pointInstructions:s}}generateBuffersForType_(e,n,r){if(e===null)return null;const i=Bxe++;let s;switch(n){case"Polygon":s=cv.GENERATE_POLYGON_BUFFERS;break;case"LineString":s=cv.GENERATE_LINE_STRING_BUFFERS;break;case"Point":s=cv.GENERATE_POINT_BUFFERS;break}const o={id:i,type:s,renderInstructions:e.buffer,renderInstructionsTransform:r,customAttributesSize:g_(this.customAttributes_)},a=Gxe();return a.postMessage(o,[e.buffer]),e=null,new Promise(l=>{const c=u=>{const d=u.data;if(d.id!==i||(a.removeEventListener("message",c),!this.helper_.getGL()))return;const h=new sv(Ab,iv).fromArrayBuffer(d.indicesBuffer),f=new sv(Sm,iv).fromArrayBuffer(d.vertexAttributesBuffer),p=new sv(Sm,iv).fromArrayBuffer(d.instanceAttributesBuffer);this.helper_.flushBufferData(h),this.helper_.flushBufferData(f),this.helper_.flushBufferData(p),l([h,f,p])};a.addEventListener("message",c)})}render(e,n,r){for(const i of this.renderPasses_)i.fillRenderPass&&this.renderInternal_(e.polygonBuffers[0],e.polygonBuffers[1],e.polygonBuffers[2],i.fillRenderPass,n,r),i.strokeRenderPass&&this.renderInternal_(e.lineStringBuffers[0],e.lineStringBuffers[1],e.lineStringBuffers[2],i.strokeRenderPass,n,r),i.symbolRenderPass&&this.renderInternal_(e.pointBuffers[0],e.pointBuffers[1],e.pointBuffers[2],i.symbolRenderPass,n,r)}renderInternal_(e,n,r,i,s,o){const a=e.getSize();if(a===0)return;const l=i.instancedAttributesDesc.length;if(this.helper_.useProgram(i.program,s),this.helper_.bindBuffer(n),this.helper_.bindBuffer(e),this.helper_.enableAttributes(i.attributesDesc),this.helper_.bindBuffer(r),this.helper_.enableAttributesInstanced(i.instancedAttributesDesc),o(),l){const c=i.instancedAttributesDesc.reduce((d,h)=>d+(h.size||1),0),u=r.getSize()/c;this.helper_.drawElementsInstanced(0,a,u)}else this.helper_.drawElements(0,a)}setHelper(e,n=null){this.helper_=e;for(const r of this.renderPasses_)r.fillRenderPass&&(r.fillRenderPass.program=this.helper_.getProgram(r.fillRenderPass.fragmentShader,r.fillRenderPass.vertexShader)),r.strokeRenderPass&&(r.strokeRenderPass.program=this.helper_.getProgram(r.strokeRenderPass.fragmentShader,r.strokeRenderPass.vertexShader)),r.symbolRenderPass&&(r.symbolRenderPass.program=this.helper_.getProgram(r.symbolRenderPass.fragmentShader,r.symbolRenderPass.vertexShader));this.helper_.addUniforms(this.uniforms_),n&&(n.polygonBuffers&&(this.helper_.flushBufferData(n.polygonBuffers[0]),this.helper_.flushBufferData(n.polygonBuffers[1]),this.helper_.flushBufferData(n.polygonBuffers[2])),n.lineStringBuffers&&(this.helper_.flushBufferData(n.lineStringBuffers[0]),this.helper_.flushBufferData(n.lineStringBuffers[1]),this.helper_.flushBufferData(n.lineStringBuffers[2])),n.pointBuffers&&(this.helper_.flushBufferData(n.pointBuffers[0]),this.helper_.flushBufferData(n.pointBuffers[1]),this.helper_.flushBufferData(n.pointBuffers[2])))}}function Wxe(t,e){const n=Array.isArray(t)?t:[t];if("style"in n[0]){const r=[],i=n,s=[];for(const o of i){const a=Array.isArray(o.style)?o.style:[o.style];let l=o.filter;o.else&&s.length&&(l=["all",...s.map(u=>["!",u])],o.filter&&l.push(o.filter),l.length<3&&(l=l[1])),o.filter&&s.push(o.filter);const c=a.map(u=>bI(u,e,l));r.push(...c)}return r}return"builder"in n[0]?n:n.map(r=>bI(r,e,null))}const Fi=new Uint8Array(4);class Hxe{constructor(e,n){this.helper_=e;const r=e.getGL();this.texture_=r.createTexture(),this.framebuffer_=r.createFramebuffer(),this.depthbuffer_=r.createRenderbuffer(),this.size_=n||[1,1],this.data_=new Uint8Array(0),this.dataCacheDirty_=!0,this.updateSize_()}setSize(e){es(e,this.size_)||(this.size_[0]=e[0],this.size_[1]=e[1],this.updateSize_())}getSize(){return this.size_}clearCachedData(){this.dataCacheDirty_=!0}readAll(){if(this.dataCacheDirty_){const e=this.size_,n=this.helper_.getGL();n.bindFramebuffer(n.FRAMEBUFFER,this.framebuffer_),n.readPixels(0,0,e[0],e[1],n.RGBA,n.UNSIGNED_BYTE,this.data_),this.dataCacheDirty_=!1}return this.data_}readPixel(e,n){if(e<0||n<0||e>this.size_[0]||n>=this.size_[1])return Fi[0]=0,Fi[1]=0,Fi[2]=0,Fi[3]=0,Fi;this.readAll();const r=Math.floor(e)+(this.size_[1]-Math.floor(n)-1)*this.size_[0];return Fi[0]=this.data_[r*4],Fi[1]=this.data_[r*4+1],Fi[2]=this.data_[r*4+2],Fi[3]=this.data_[r*4+3],Fi}getTexture(){return this.texture_}getFramebuffer(){return this.framebuffer_}getDepthbuffer(){return this.depthbuffer_}updateSize_(){const e=this.size_,n=this.helper_.getGL();this.texture_=this.helper_.createTexture(e,null,this.texture_),n.bindFramebuffer(n.FRAMEBUFFER,this.framebuffer_),n.viewport(0,0,e[0],e[1]),n.framebufferTexture2D(n.FRAMEBUFFER,n.COLOR_ATTACHMENT0,n.TEXTURE_2D,this.texture_,0),n.bindRenderbuffer(n.RENDERBUFFER,this.depthbuffer_),n.renderbufferStorage(n.RENDERBUFFER,n.DEPTH_COMPONENT16,e[0],e[1]),n.framebufferRenderbuffer(n.FRAMEBUFFER,n.DEPTH_ATTACHMENT,n.RENDERBUFFER,this.depthbuffer_),this.data_=new Uint8Array(e[0]*e[1]*4)}}function Kxe(t,e){const n=t.viewState.projection,i=e.getSource().getWrapX()&&n.canWrapX(),s=n.getExtent(),o=t.extent,a=i?Me(s):null,l=i?Math.ceil((o[2]-s[2])/a)+1:1;return[i?Math.floor((o[0]-s[0])/a):0,l,a]}const $l={...fs,RENDER_EXTENT:"u_renderExtent",PATTERN_ORIGIN:"u_patternOrigin",GLOBAL_ALPHA:"u_globalAlpha"};class Yxe extends Fb{constructor(e,n){const r={[$l.RENDER_EXTENT]:[0,0,0,0],[$l.PATTERN_ORIGIN]:[0,0],[$l.GLOBAL_ALPHA]:1};super(e,{uniforms:r,postProcesses:n.postProcesses}),this.hitDetectionEnabled_=!n.disableHitDetection,this.hitRenderTarget_,this.sourceRevision_=-1,this.previousExtent_=Mn(),this.currentTransform_=Bt(),this.tmpCoords_=[0,0],this.tmpTransform_=Bt(),this.tmpMat4_=R$(),this.currentFrameStateTransform_=Bt(),this.styleVariables_={},this.style_=[],this.styleRenderer_=null,this.buffers_=null,this.applyOptions_(n),this.batch_=new Cm,this.initialFeaturesAdded_=!1,this.sourceListenKeys_=null}addInitialFeatures_(e){const n=this.getLayer().getSource();let r;this.batch_.addFeatures(n.getFeatures(),r),this.sourceListenKeys_=[Oe(n,an.ADDFEATURE,this.handleSourceFeatureAdded_.bind(this,r)),Oe(n,an.CHANGEFEATURE,this.handleSourceFeatureChanged_.bind(this,r),this),Oe(n,an.REMOVEFEATURE,this.handleSourceFeatureDelete_,this),Oe(n,an.CLEAR,this.handleSourceFeatureClear_,this)]}applyOptions_(e){this.styleVariables_=e.variables,this.style_=e.style}createRenderers_(){this.buffers_=null,this.styleRenderer_=new Vxe(this.style_,this.styleVariables_,this.helper,this.hitDetectionEnabled_)}reset(e){this.applyOptions_(e),this.helper&&this.createRenderers_(),super.reset(e)}afterHelperCreated(){this.styleRenderer_?this.styleRenderer_.setHelper(this.helper,this.buffers_):this.createRenderers_(),this.hitDetectionEnabled_&&(this.hitRenderTarget_=new Hxe(this.helper))}handleSourceFeatureAdded_(e,n){const r=n.feature;this.batch_.addFeature(r,e)}handleSourceFeatureChanged_(e,n){const r=n.feature;this.batch_.changeFeature(r,e)}handleSourceFeatureDelete_(e){const n=e.feature;this.batch_.removeFeature(n)}handleSourceFeatureClear_(){this.batch_.clear()}applyUniforms_(e){LO(this.tmpTransform_,this.currentFrameStateTransform_),iy(this.tmpTransform_,e),this.helper.setUniformMatrixValue($l.PROJECTION_MATRIX,Iw(this.tmpMat4_,this.tmpTransform_)),lh(this.tmpTransform_,this.tmpTransform_),this.helper.setUniformMatrixValue($l.SCREEN_TO_WORLD_MATRIX,Iw(this.tmpMat4_,this.tmpTransform_)),this.tmpCoords_[0]=0,this.tmpCoords_[1]=0,lh(this.tmpTransform_,e),$t(this.tmpTransform_,this.tmpCoords_),this.helper.setUniformFloatVec2($l.PATTERN_ORIGIN,this.tmpCoords_)}renderFrame(e){const n=this.helper.getGL();this.preRender(n,e);const[r,i,s]=Kxe(e,this.getLayer());this.helper.prepareDraw(e),this.renderWorlds(e,!1,r,i,s),this.helper.finalizeDraw(e,this.dispatchPreComposeEvent,this.dispatchPostComposeEvent);const o=this.helper.getCanvas();return this.hitDetectionEnabled_&&(this.renderWorlds(e,!0,r,i,s),this.hitRenderTarget_.clearCachedData()),this.postRender(n,e),o}prepareFrameInternal(e){this.initialFeaturesAdded_||(this.addInitialFeatures_(e),this.initialFeaturesAdded_=!0);const n=this.getLayer(),r=n.getSource(),i=e.viewState,s=!e.viewHints[gt.ANIMATING]&&!e.viewHints[gt.INTERACTING],o=!Bo(this.previousExtent_,e.extent),a=this.sourceRevision_<r.getRevision();if(a&&(this.sourceRevision_=r.getRevision()),s&&(o||a)){const l=i.projection,c=i.resolution,u=n instanceof cu?n.getRenderBuffer():0,d=wr(e.extent,u*c);r.loadFeatures(d,c,l),this.ready=!1;const h=this.helper.makeProjectionTransform(e,Bt());this.styleRenderer_.generateBuffers(this.batch_,h).then(f=>{this.buffers_&&this.disposeBuffers(this.buffers_),this.buffers_=f,this.ready=!0,this.getLayer().changed()}),this.previousExtent_=e.extent.slice()}return!0}renderWorlds(e,n,r,i,s){let o=r;n&&(this.hitRenderTarget_.setSize([Math.floor(e.size[0]/2),Math.floor(e.size[1]/2)]),this.helper.prepareDrawToRenderTarget(e,this.hitRenderTarget_,!0));do this.helper.makeProjectionTransform(e,this.currentFrameStateTransform_),kO(this.currentFrameStateTransform_,o*s,0),this.buffers_&&this.styleRenderer_.render(this.buffers_,e,()=>{this.applyUniforms_(this.buffers_.invertVerticesTransform),this.helper.applyHitDetectionUniform(n)});while(++o<i)}forEachFeatureAtCoordinate(e,n,r,i,s){if(ze(this.hitDetectionEnabled_,"`forEachFeatureAtCoordinate` cannot be used on a WebGL layer if the hit detection logic has been disabled using the `disableHitDetection: true` option."),!this.styleRenderer_||!this.hitDetectionEnabled_)return;const o=$t(n.coordinateToPixelTransform,e.slice()),a=this.hitRenderTarget_.readPixel(o[0]/2,o[1]/2),l=[a[0]/255,a[1]/255,a[2]/255,a[3]/255],c=Oxe(l),u=this.batch_.getFeatureFromRef(c);if(u)return i(u,this.getLayer(),null)}disposeBuffers(e){const n=r=>{for(const i of r)i&&this.helper.deleteBuffer(i)};e.pointBuffers&&n(e.pointBuffers),e.lineStringBuffers&&n(e.lineStringBuffers),e.polygonBuffers&&n(e.polygonBuffers)}disposeInternal(){this.buffers_&&this.disposeBuffers(this.buffers_),this.sourceListenKeys_&&(this.sourceListenKeys_.forEach(function(e){it(e)}),this.sourceListenKeys_=null),super.disposeInternal()}renderDeclutter(){}}const hs={BLUR:"blur",GRADIENT:"gradient",RADIUS:"radius"},Xxe=["#00f","#0ff","#0f0","#ff0","#f00"];class RN extends cu{constructor(e){e=e||{};const n=Object.assign({},e);delete n.gradient,delete n.radius,delete n.blur,delete n.weight,super(n),this.filter_=e.filter??!0,this.styleVariables_=e.variables||{},this.gradient_=null,this.addChangeListener(hs.GRADIENT,this.handleGradientChanged_),this.setGradient(e.gradient?e.gradient:Xxe),this.setBlur(e.blur!==void 0?e.blur:15),this.setRadius(e.radius!==void 0?e.radius:8);const r=e.weight?e.weight:"weight";this.weight_=r,this.setRenderOrder(null)}getBlur(){return this.get(hs.BLUR)}getGradient(){return this.get(hs.GRADIENT)}getRadius(){return this.get(hs.RADIUS)}handleGradientChanged_(){this.gradient_=Zxe(this.getGradient())}setBlur(e){const n=this.get(hs.BLUR);if(this.set(hs.BLUR,e),typeof e=="number"&&typeof n=="number"){this.changed();return}this.clearRenderer()}setGradient(e){this.set(hs.GRADIENT,e)}setRadius(e){const n=this.get(hs.RADIUS);if(this.set(hs.RADIUS,e),typeof e=="number"&&typeof n=="number"){this.changed();return}this.clearRenderer()}setFilter(e){this.filter_=e,this.changed(),this.clearRenderer()}setWeight(e){this.weight_=e,this.changed(),this.clearRenderer()}createRenderer(){const e=new TN,n=wN(),r=Re(n,this.filter_,Kt);let i=Re(n,this.getRadius(),_e),s=Re(n,this.getBlur(),_e);const o={};typeof this.getBlur()=="number"&&(s="a_blur",o.a_blur=()=>this.getBlur(),e.addUniform("a_blur","float")),typeof this.getRadius()=="number"&&(i="a_radius",o.a_radius=()=>this.getRadius(),e.addUniform("a_radius","float"));const a={};let l=null;if(typeof this.weight_=="string"||typeof this.weight_=="function"){const d=typeof this.weight_=="string"?h=>h.get(this.weight_):this.weight_;a.prop_weight={size:1,callback:h=>{const f=d(h);return f!==void 0?ct(f,0,1):1}},l="a_prop_weight",e.addAttribute("a_prop_weight","float")}else{const d=["clamp",this.weight_,0,1];l=Re(n,d,_e)}e.addFragmentShaderFunction(`float getBlurSlope() {
  float blur = max(1., ${s});
  float radius = ${i};
  return radius / blur;
}`).setSymbolSizeExpression(`vec2(${i} + ${s}) * 2.`).setSymbolColorExpression(`vec4(smoothstep(0., 1., (1. - length(coordsPx * 2. / v_quadSizePx)) * getBlurSlope()) * ${l})`).setStrokeColorExpression(`vec4(smoothstep(0., 1., (1. - length(currentRadiusPx * 2. / v_width)) * getBlurSlope()) * ${l})`).setStrokeWidthExpression(`(${i} + ${s}) * 2.`).setFillColorExpression(`vec4(${l})`).setFragmentDiscardExpression(`!${r}`),SN(e,n);const c=CN(n),u=bN(n,this.styleVariables_);return new Yxe(this,{className:this.getClassName(),variables:this.styleVariables_,style:{builder:e,attributes:{...c,...a},uniforms:{...u,...o}},disableHitDetection:!1,postProcesses:[{fragmentShader:`
            precision mediump float;

            uniform sampler2D u_image;
            uniform sampler2D u_gradientTexture;
            uniform float u_opacity;

            varying vec2 v_texCoord;

            void main() {
              vec4 color = texture2D(u_image, v_texCoord);
              gl_FragColor.a = color.a * u_opacity;
              gl_FragColor.rgb = texture2D(u_gradientTexture, vec2(0.5, color.a)).rgb;
              gl_FragColor.rgb *= gl_FragColor.a;
            }`,uniforms:{u_gradientTexture:()=>this.gradient_,u_opacity:()=>this.getOpacity()}}]})}updateStyleVariables(e){Object.assign(this.styleVariables_,e),this.changed()}renderDeclutter(){}}function Zxe(t){const r=Vt(1,256),i=r.createLinearGradient(0,0,1,256),s=1/(t.length-1);for(let o=0,a=t.length;o<a;++o)i.addColorStop(o*s,t[o]);return r.fillStyle=i,r.fillRect(0,0,1,256),r.canvas}function qxe(t,e){if(e==="all")return!0;const n=new Date,r=new Date(n.getFullYear()-(e==="1y"?1:5),n.getMonth(),n.getDate());return new Date(t)>=r}function Jxe(){const{projectPath:t}=He(),e=Tr(),n=K.useRef(null),r=K.useRef(new Cn),i=It(o=>o.timeWindow),s=oc(o=>o.showSightingsHeatmap);return K.useEffect(()=>{if(!e||!t)return;const o=new RN({source:r.current,blur:15,radius:12});return o.setVisible(s),n.current=o,e.addLayer(o),(async()=>{var l,c;try{const[u,d]=await Promise.all([window.api.readTextFile(t,"data/animal_sightings.geojson"),window.api.readTextFile(t,"data/hunts.geojson")]),h=JSON.parse(u||'{"type":"FeatureCollection","features":[]}'),f=JSON.parse(d||'{"type":"FeatureCollection","features":[]}'),p=new Map;for(const g of f.features||[])(l=g==null?void 0:g.properties)!=null&&l.hunt_id&&((c=g==null?void 0:g.properties)!=null&&c.date)&&p.set(g.properties.hunt_id,g.properties.date);const m={type:"FeatureCollection",properties:{},features:(h.features||[]).filter(g=>{var w;const y=(w=g==null?void 0:g.properties)==null?void 0:w.hunt_id,v=y?p.get(y):null;return qxe(v||"1970-01-01",i)})},_=new ut().readFeatures(m,{dataProjection:"EPSG:4326",featureProjection:"EPSG:3857"});r.current.clear(),r.current.addFeatures(_)}catch{}})(),()=>{n.current&&e.removeLayer(n.current),n.current=null}},[e,t,i]),K.useEffect(()=>{n.current&&n.current.setVisible(s)},[s]),null}function Qxe(t){return t==="observed"?1:t==="likely"?.6:.3}function e1e(){const{projectPath:t}=He(),e=Tr(),n=K.useRef(null),r=K.useRef(new Cn),i=It(o=>o.timeWindow),s=oc(o=>o.showPathDensity);return K.useEffect(()=>{if(!e||!t)return;const o=new RN({source:r.current,blur:20,radius:10});return o.setVisible(s),n.current=o,e.addLayer(o),(async()=>{var l,c,u,d;try{const[h,f]=await Promise.all([window.api.readTextFile(t,"data/animal_paths.geojson"),window.api.readTextFile(t,"data/hunts.geojson")]),p=JSON.parse(h||'{"type":"FeatureCollection","features":[]}'),m=JSON.parse(f||'{"type":"FeatureCollection","features":[]}'),_=new Map;for(const S of m.features||[])(l=S==null?void 0:S.properties)!=null&&l.hunt_id&&((c=S==null?void 0:S.properties)!=null&&c.date)&&_.set(S.properties.hunt_id,S.properties.date);const g=new Date,y=new Date(g.getFullYear()-(i==="1y"?1:i==="5y"?5:500),g.getMonth(),g.getDate()),v=[];for(const S of p.features||[]){const C=(u=S==null?void 0:S.properties)==null?void 0:u.hunt_id,T=C?_.get(C||""):"1970-01-01",P=new Date(T||"1970-01-01");if(i!=="all"&&P<y||!(S!=null&&S.geometry)||S.geometry.type!=="LineString")continue;const F=S,k=cH(F,{units:"kilometers"}),A=.01,M=Math.max(1,Math.floor(k/A)),b=Qxe((d=S==null?void 0:S.properties)==null?void 0:d.confidence);for(let j=0;j<=M;j++){const V=lH(F,j*A,{units:"kilometers"});(V.properties??(V.properties={})).weight=b,v.push(V)}}const w={type:"FeatureCollection",features:v},x=new ut().readFeatures(w,{dataProjection:"EPSG:4326",featureProjection:"EPSG:3857"});r.current.clear(),r.current.addFeatures(x)}catch{}})(),()=>{n.current&&e.removeLayer(n.current),n.current=null}},[e,t,i]),K.useEffect(()=>{n.current&&n.current.setVisible(s)},[s]),null}function CI(t){return`mbtiles://${t}/{z}/{x}/{y}.png`}const ci=Qi(t=>({enabled:!1,selectedId:null,entries:[{id:"usgs_latest",label:"USGS Imagery (Latest)",year:new Date().getFullYear(),urlTemplate:"https://basemap.nationalmap.gov/arcgis/rest/services/USGSImageryOnly/MapServer/tile/{z}/{y}/{x}",attribution:"USGS"}],setEnabled:e=>t({enabled:e}),setSelected:e=>t({selectedId:e}),addEntry:e=>t(n=>n.entries.some(i=>i.id===e.id)?n:{entries:[...n.entries,e]}),removeEntry:e=>t(n=>({entries:n.entries.filter(r=>r.id!==e),selectedId:n.selectedId===e?null:n.selectedId}))})),TI={topo:"https://basemap.nationalmap.gov/arcgis/rest/services/USGSTopo/MapServer/tile/{z}/{y}/{x}",aerial:"https://basemap.nationalmap.gov/arcgis/rest/services/USGSImageryOnly/MapServer/tile/{z}/{y}/{x}"};function t1e(){const t=Tr(),{projectPath:e}=He(),n=K.useRef(null),r=K.useRef(null),i=K.useRef(null),s=K.useRef(null),o=K.useRef(null),a=K.useRef(null);return K.useEffect(()=>{if(!t)return;const l=new Hu({url:TI.topo,attributions:"USGS Topo"});l.set("olcs_skip",!0);const c=new jl({source:l,zIndex:0});c.set("basemapKey","topo");const u=new Hu({url:TI.aerial,attributions:"USGS Imagery"});u.set("olcs_skip",!0);const d=new jl({source:u,zIndex:0});d.set("basemapKey","aerial");const h=e?(()=>{const v=new Hu({url:CI("hillshade")});v.set("olcs_skip",!0);const w=new jl({source:v,zIndex:1});return w.set("basemapKey","hillshade"),w})():null,f=e?(()=>{const v=new Hu({url:CI("slope")});v.set("olcs_skip",!0);const w=new jl({source:v,zIndex:1});return w.set("basemapKey","slope"),w})():null;n.current=c,r.current=d,i.current=h,s.current=f,t.addLayer(c),t.addLayer(d),h&&t.addLayer(h),f&&t.addLayer(f);const p=new jl({visible:!1,zIndex:0}),m=new v$({visible:!1,zIndex:0});o.current=p,a.current=m,t.addLayer(p),t.addLayer(m);const _=Wo.getState().visible;c.setVisible(!!_.topo),d.setVisible(!!_.aerial),h&&h.setVisible(!!_.hillshade),f&&f.setVisible(!!_.slope);const g=Wo.subscribe(v=>{c.setVisible(!!v.visible.topo),d.setVisible(!!v.visible.aerial),i.current&&i.current.setVisible(!!v.visible.hillshade),s.current&&s.current.setVisible(!!v.visible.slope)}),y=ci.subscribe(v=>{const w=o.current,x=a.current;if(!w||!x)return;if(!v.enabled||!v.selectedId){w.setVisible(!1),x.setVisible(!1);return}const S=v.entries.find(C=>C.id===v.selectedId)||null;if(!S){w.setVisible(!1),x.setVisible(!1);return}if(w.setVisible(!1),x.setVisible(!1),S.type==="xyz"&&S.urlTemplate){const C=new Hu({url:S.urlTemplate,attributions:S.attribution||"Historical Imagery",crossOrigin:"anonymous"});C.set("olcs_skip",!0),w.setSource(C),w.setVisible(!0);return}if(S.type==="arcgis-map"&&S.arcgisMapUrl){const C=new p6({url:S.arcgisMapUrl,attributions:S.attribution||"Historical Imagery",crossOrigin:"anonymous"});C.set("olcs_skip",!0),w.setSource(C),w.setVisible(!0);return}if((S.type==="arcgis-image"||S.arcgisImageUrl)&&S.arcgisImageUrl){const C=S.timeParam?{TIME:S.timeParam}:void 0,T=new g6({url:S.arcgisImageUrl,params:C,attributions:S.attribution||"Historical Imagery",crossOrigin:"anonymous"});T.set("olcs_skip",!0),x.setSource(T),x.setVisible(!0);return}});return()=>{g(),y(),n.current&&t.removeLayer(n.current),r.current&&t.removeLayer(r.current),i.current&&t.removeLayer(i.current),s.current&&t.removeLayer(s.current),o.current&&t.removeLayer(o.current),a.current&&t.removeLayer(a.current),n.current=null,r.current=null,i.current=null,s.current=null,o.current=null,a.current=null}},[t,e]),null}function n1e(){const[t,e]=K.useState(!1),n=Wo(d=>d.visible),r=Wo(d=>d.setVisible),i=ci(d=>d.enabled),s=ci(d=>d.setEnabled),o=ci(d=>d.entries),a=ci(d=>d.selectedId),l=ci(d=>d.setSelected),c=ci(d=>d.addEntry),u={padding:"6px 12px",borderRadius:6,border:"1px solid rgba(15,23,42,0.12)",background:"rgba(255,255,255,0.92)",fontSize:12,cursor:"pointer",color:"rgba(15,23,42,0.75)",boxShadow:"0 4px 12px rgba(15,23,42,0.08)",width:"100%",textAlign:"left"};return t?E.jsxs("div",{style:{padding:"12px 14px",background:"rgba(255,255,255,0.94)",border:"1px solid rgba(15, 23, 42, 0.12)",borderRadius:6,boxShadow:"0 12px 28px rgba(15, 23, 42, 0.12)",display:"flex",flexDirection:"column",gap:4,width:"100%"},children:[E.jsxs("div",{onClick:()=>e(!1),style:{display:"flex",justifyContent:"space-between",alignItems:"center",cursor:"pointer"},title:"Click to collapse",children:[E.jsx("strong",{style:{fontSize:13,color:"rgba(15,23,42,0.75)"},children:"Basemaps"}),E.jsx("button",{onClick:()=>e(!1),style:{border:"none",background:"transparent",fontSize:12,color:"rgba(15,23,42,0.55)",cursor:"pointer"},children:"Hide"})]}),E.jsxs("div",{style:{display:"grid",gridTemplateColumns:"1fr 1fr",gap:6,fontSize:13,color:"rgba(15,23,42,0.75)"},children:[E.jsxs("label",{style:{display:"flex",alignItems:"center",gap:6,cursor:"pointer"},children:[E.jsx("input",{type:"checkbox",checked:n.topo,onChange:d=>r("topo",d.target.checked)}),"Topo"]}),E.jsxs("label",{style:{display:"flex",alignItems:"center",gap:6,cursor:"pointer"},children:[E.jsx("input",{type:"checkbox",checked:n.aerial,onChange:d=>r("aerial",d.target.checked)}),"Aerial"]}),E.jsxs("label",{style:{display:"flex",alignItems:"center",gap:6,cursor:"pointer"},children:[E.jsx("input",{type:"checkbox",checked:n.hillshade,onChange:d=>r("hillshade",d.target.checked)}),"Hillshade"]}),E.jsxs("label",{style:{display:"flex",alignItems:"center",gap:6,cursor:"pointer"},children:[E.jsx("input",{type:"checkbox",checked:n.slope,onChange:d=>r("slope",d.target.checked)}),"Slope"]}),E.jsxs("label",{style:{display:"flex",alignItems:"center",gap:6,cursor:"pointer"},children:[E.jsx("input",{type:"checkbox",checked:n.contours,onChange:d=>r("contours",d.target.checked)}),"Contours"]})]}),E.jsx("hr",{style:{border:"none",borderTop:"1px solid rgba(15,23,42,0.12)",margin:"8px 0"}}),E.jsxs("div",{style:{display:"flex",alignItems:"center",gap:8},children:[E.jsx("input",{type:"checkbox",checked:i,onChange:d=>s(d.target.checked)}),E.jsx("span",{style:{fontWeight:600,fontSize:12},children:"Historical Imagery"})]}),i?E.jsxs("div",{style:{display:"flex",gap:6,alignItems:"center",marginTop:6},children:[E.jsxs("select",{value:a||"",onChange:d=>l(d.target.value||null),style:{flex:1,fontSize:12,padding:"4px 6px"},children:[E.jsx("option",{value:"",children:" Select "}),o.slice().sort((d,h)=>h.year-d.year).map(d=>E.jsxs("option",{value:d.id,children:[d.year,"  ",d.label]},d.id))]}),E.jsx("button",{onClick:()=>{const d=window.prompt("Year (e.g., 1985):")||"",h=window.prompt("Label (e.g., NHAP 1985 or Wayback 2018-05):")||"",f=(window.prompt("Type: xyz or arcgis-image (default xyz):")||"xyz").trim().toLowerCase(),p=Number(d);if(!(!h||!Number.isFinite(p)))if(f==="arcgis-image"){const m=window.prompt("ArcGIS ImageServer URL (/ImageServer):")||"",_=window.prompt("TIME (optional, e.g., 1985-01-01,1985-12-31):")||"";if(!m)return;c({id:`${h.replace(/\s+/g,"_")}_${p}`,label:h,year:p,type:"arcgis-image",arcgisImageUrl:m,timeParam:_||void 0})}else{const m=window.prompt("XYZ URL template with {z}/{y}/{x}:")||"";if(!m)return;c({id:`${h.replace(/\s+/g,"_")}_${p}`,label:h,year:p,type:"xyz",urlTemplate:m})}},style:{fontSize:12,padding:"4px 8px"},children:"Add"})]}):null]}):E.jsx("button",{onClick:()=>e(!0),style:u,children:"Basemaps"})}const r1e=new nt({stroke:new yt({color:"rgba(120, 120, 120, 0.7)",width:1})});function i1e(){const t=Tr(),{projectPath:e}=He(),n=K.useRef(null);return K.useEffect(()=>{if(!t||!e)return;let r=!1;const i=new Cn,s=new Pr({source:i,style:r1e,zIndex:2});s.setVisible(Wo.getState().visible.contours),n.current=s,t.addLayer(s),(async()=>{try{const l=await window.api.readTextFile(e,"tiles/contours.geojson");if(!l||r)return;const c=new ut().readFeatures(l,{dataProjection:"EPSG:4326",featureProjection:t.getView().getProjection()});i.clear(),i.addFeatures(c)}catch(l){console.error("Failed to load contours",l)}})();const a=Wo.subscribe(l=>{s.setVisible(!!l.visible.contours)});return()=>{r=!0,a(),n.current&&(t.removeLayer(n.current),n.current=null)}},[t,e]),null}function s1e(t,e){if(Object.is(t,e))return!0;if(typeof t!="object"||t===null||typeof e!="object"||e===null)return!1;if(t instanceof Map&&e instanceof Map){if(t.size!==e.size)return!1;for(const[r,i]of t)if(!Object.is(i,e.get(r)))return!1;return!0}if(t instanceof Set&&e instanceof Set){if(t.size!==e.size)return!1;for(const r of t)if(!e.has(r))return!1;return!0}const n=Object.keys(t);if(n.length!==Object.keys(e).length)return!1;for(const r of n)if(!Object.prototype.hasOwnProperty.call(e,r)||!Object.is(t[r],e[r]))return!1;return!0}const o1e=[{key:"property",title:"Property",icon:""},{key:"animal",title:"Animal Sign",icon:""},{key:"terrain",title:"Terrain & Access",icon:""},{key:"habitat",title:"Habitat & Food",icon:""},{key:"stands",title:"Stands & Hunts",icon:""}],a1e={property_boundary:"property",streams:"terrain",cliffs:"terrain",ravines:"terrain",trails:"terrain",tree_stands:"stands",open_woods:"habitat",cover_points:"habitat",acorn_flats:"habitat",bedding_areas:"habitat",trees_points:"habitat",beds_points:"animal",mast_check_points:"habitat",big_rocks:"terrain",scrapes:"animal",rubs:"animal",stands:"stands",animal_sign:"animal",animal_paths:"animal",hunts:"stands",harvests:"stands",animal_sightings:"animal"},PI=o1e.map(t=>({...t,layerIds:pO.filter(e=>a1e[e]===t.key)})).filter(t=>t.layerIds.length>0);function l1e(){const t=It(l=>l.setLayerOverride),e=It(l=>l.isLayerVisible),[n,r]=It(l=>[l.preset,l.overrides],s1e),[i,s]=K.useState(!1),[o,a]=K.useState(()=>{const l={};for(const c of PI)l[c.key]=c.key!=="property";return l});return i?E.jsxs("div",{"data-preset":n,style:{position:"fixed",left:12,top:12,maxHeight:"70vh",overflow:"auto",padding:"12px 14px",background:"rgba(255,255,255,0.94)",border:"1px solid rgba(15, 23, 42, 0.12)",borderRadius:6,boxShadow:"0 12px 28px rgba(15, 23, 42, 0.12)",zIndex:1100,minWidth:220},children:[E.jsxs("div",{onClick:()=>s(!1),style:{display:"flex",justifyContent:"space-between",alignItems:"center",cursor:"pointer"},title:"Click to collapse",children:[E.jsx("strong",{style:{fontSize:14},children:"Legend"}),E.jsx("button",{onClick:()=>s(!1),style:{border:"none",background:"transparent",fontSize:12,color:"rgba(0,0,0,0.6)",cursor:"pointer"},children:"Hide"})]}),E.jsx("div",{style:{display:"flex",flexDirection:"column",gap:8,marginTop:8},children:PI.map(l=>{const c=o[l.key]??!0;return E.jsxs("div",{style:{border:"1px solid rgba(15,23,42,0.12)",borderRadius:6,overflow:"hidden",background:"rgba(247,249,252,0.85)"},children:[E.jsxs("button",{onClick:()=>a(u=>({...u,[l.key]:!(u[l.key]??!0)})),style:{width:"100%",display:"flex",alignItems:"center",justifyContent:"space-between",padding:"8px 10px",background:"rgba(255,255,255,0.95)",border:"none",outline:"none",cursor:"pointer",fontSize:12,fontWeight:600,color:"rgba(15,23,42,0.75)"},children:[E.jsxs("span",{style:{display:"flex",alignItems:"center",gap:6},children:[E.jsx("span",{children:l.icon}),l.title]}),E.jsx("span",{style:{fontSize:12,color:"rgba(15,23,42,0.55)"},children:c?"":""})]}),c?E.jsx("div",{style:{display:"flex",flexDirection:"column",gap:6,padding:"8px 10px"},children:l.layerIds.map(u=>{const d=ja[u],h=["trees_points","big_rocks"].includes(u);return E.jsxs("div",{style:{display:"flex",alignItems:"center",gap:8},children:[E.jsx("input",{type:"checkbox",checked:e(u),onChange:f=>t(u,f.target.checked),style:{accentColor:"#3b82f6"}}),E.jsxs("span",{children:[d.icon," ",d.label]}),h&&E.jsx("div",{style:{fontSize:10},children:" (Small | Large)"}),d.addable&&E.jsx("button",{onClick:()=>window.dispatchEvent(new Event(`add-feature-${u}`)),children:"Add"})]},u)})}):null]},l.key)})})]}):E.jsx("button",{onClick:()=>s(!0),style:{position:"fixed",left:12,top:12,padding:"8px 14px",borderRadius:6,border:"1px solid rgba(15,23,42,0.12)",background:"#ffffff",fontSize:13,zIndex:1e3,cursor:"pointer",boxShadow:"0 6px 18px rgba(15,23,42,0.12)"},children:"Show layers"})}function c1e({layerId:t}){const e=ja[t],{projectPath:n}=He(),r=Tr(),i=K.useRef(new Cn),s=K.useRef(null),o=K.useRef(null),a=K.useRef(null),l=K.useRef(null),c=K.useRef(async()=>{}),[u,d]=K.useState(null);K.useEffect(()=>{if(!r||!n)return;const p=e.style,m=new Pr({source:i.current,style:U=>yl(t,U)?typeof p=="function"?p(U):p:null});s.current=m,r.addLayer(m);const _=e.areaField,g=r.getView().getProjection(),y=U=>{if(!_)return!1;const B=U.getGeometry();if(!B)return!1;const N=B.getType();if(N!=="Polygon"&&N!=="MultiPolygon")return!1;const O=B.clone();O.transform(g,"EPSG:4326");const $=hw(O,{projection:"EPSG:4326"});if(!Number.isFinite($))return!1;const G=Number(($/4046.8564224).toFixed(2)),R=U.get(_);return typeof R=="number"&&Math.abs(R-G)<.01?!1:(U.set(_,G),!0)},v=U=>{let B=!1;const N=U.get("photo");if(N){const $=Array.isArray(N)?N.filter(G=>typeof G=="string"):typeof N=="string"?[N]:[];U.unset("photo"),$.length>0&&(U.set("photos",$),B=!0)}const O=U.get("photos");return O&&!Array.isArray(O)&&(typeof O=="string"?U.set("photos",[O]):U.set("photos",[]),B=!0),B},w=async()=>{const U=new ut().writeFeaturesObject(i.current.getFeatures(),{dataProjection:"EPSG:4326",featureProjection:"EPSG:3857"});await window.api.writeTextFile(n,`data/${e.file}`,JSON.stringify(U,null,2))};c.current=w;const x=async()=>{try{const U=await window.api.readTextFile(n,`data/${e.file}`),B=JSON.parse(U||'{"type":"FeatureCollection","features":[]}'),N=new ut().readFeatures(B,{dataProjection:"EPSG:4326",featureProjection:"EPSG:3857"});i.current.clear(),i.current.addFeatures(N);let O=!1;i.current.getFeatures().forEach($=>{v($)&&(O=!0),y($)&&(O=!0)}),O&&await w()}catch(U){if(String((U==null?void 0:U.message)||U||"").includes("ENOENT"))try{const N=JSON.stringify({type:"FeatureCollection",features:[]},null,2);await window.api.writeTextFile(n,`data/${e.file}`,N);const O=await window.api.readTextFile(n,`data/${e.file}`),$=JSON.parse(O||'{"type":"FeatureCollection","features":[]}'),G=new ut().readFeatures($,{dataProjection:"EPSG:4326",featureProjection:"EPSG:3857"});i.current.clear(),i.current.addFeatures(G)}catch(N){console.warn(`Failed to seed missing data file for ${t}`,N)}else console.error(`Failed to load layer ${t}`,U)}};if(x(),e.selectable!==!1){const U=new Ks({layers:[m]});l.current=U,r.addInteraction(U),U.on("select",B=>{var O;const N=((O=B.selected)==null?void 0:O[0])||null;Xi.getState().setSelected(N?{layerId:t,feature:N}:null)})}const S=new RL({source:i.current});a.current=S,r.addInteraction(S),S.on("modifystart",U=>{U.mapBrowserEvent.originalEvent.altKey&&(U.features.getArray()[0],U.mapBrowserEvent.coordinate)}),S.on("modifyend",U=>{U.mapBrowserEvent.originalEvent.altKey;const B=Ve.getState().activeUser;if(!B){window.alert("Please select an Active User before editing geometry."),x();return}U.features&&U.features.forEach(N=>{N.set("updated_by",B),N.set("updated_at",new Date().toISOString()),_&&y(N)}),w()});const C=()=>{if(!Ve.getState().activeUser){window.alert("Please select an Active User before adding features.");return}if(o.current)return;const B=new Qo({source:i.current,type:e.geometry});o.current=B,r.addInteraction(B),B.on("drawend",N=>{const O=N.feature;let $;y(O)&&($={...e.areaField?{[e.areaField]:O.get(e.areaField)}:{}}),d({f:O,initial:$}),o.current&&(r.removeInteraction(o.current),o.current=null)})},T=async()=>{var B,N;const U=(N=(B=l.current)==null?void 0:B.getFeatures)==null?void 0:N.call(B);U&&(U.forEach(O=>i.current.removeFeature(O)),U.clear(),await w())},P=`add-feature-${t}`,F=`delete-feature-${t}`,k=`layer:reload:${t}`,A=`layer:persist:${t}`,M=()=>C(),b=()=>void T(),j=()=>void x(),V=()=>void w(),H=()=>void x();return window.addEventListener(P,M),window.addEventListener(F,b),window.addEventListener(k,j),window.addEventListener(A,V),window.addEventListener("layers:reload",H),()=>{window.removeEventListener(P,M),window.removeEventListener(F,b),window.removeEventListener(k,j),window.removeEventListener(A,V),window.removeEventListener("layers:reload",H),o.current&&r.removeInteraction(o.current),a.current&&r.removeInteraction(a.current),l.current&&r.removeInteraction(l.current),s.current&&r.removeLayer(s.current),o.current=null,a.current=null,l.current=null,s.current=null}},[r,n,t,e]),K.useEffect(()=>{const p=s.current;if(!p)return;const m=()=>{const g=It.getState().isLayerVisible(t);p.setVisible(g)};m();const _=It.subscribe(m);return()=>{_()}},[t]);const h=async p=>{if(!u)return;const m=Ve.getState().activeUser;if(!m){window.alert("Please select an Active User before saving.");return}u.f.setProperties(p),u.f.get("created_by")||u.f.set("created_by",m),u.f.get("created_at")||u.f.set("created_at",new Date().toISOString()),u.f.set("updated_by",m),u.f.set("updated_at",new Date().toISOString());try{const _=Ve.getState().activeUser;_&&u.f.set("created_by",_)}catch{}if(e.areaField){const _=r;if(_){const g=_.getView().getProjection(),y=u.f.getGeometry();if(y&&(y.getType()==="Polygon"||y.getType()==="MultiPolygon")){const v=(y.getType()==="Polygon",y.clone());v.transform(g,"EPSG:4326");const w=hw(v,{projection:"EPSG:4326"}),x=Number((w/4046.8564224).toFixed(2));u.f.set(e.areaField,x)}}}d(null),await c.current()},f=()=>{u&&(i.current.removeFeature(u.f),d(null))};return u?E.jsxs("div",{style:{position:"fixed",left:0,right:0,bottom:0,padding:12,background:"rgba(255,255,255,0.95)",borderTop:"1px solid #ddd",zIndex:2e3},children:[E.jsx("h3",{style:{marginTop:0},children:"Add"}),E.jsx(ea,{layerId:t,initialValues:u.initial,onSubmit:h,onCancel:f})]}):null}function Ln(t,e){return Array.from(t.getElementsByTagName(e))}function Pm(t){return t[0]==="#"?t:`#${t}`}function u1e(t,e,n){return Array.from(t.getElementsByTagNameNS(n,e))}function Tn(t){return t==null||t.normalize(),t&&t.textContent||""}function Wn(t,e,n){const r=t.getElementsByTagName(e);return r.length?r[0]:null}function Jr(t,e,n){const r={};if(!t)return r;const i=t.getElementsByTagName(e),s=i.length?i[0]:null;return s&&n?n(s,r):r}function Xa(t,e,n){const r=Tn(Wn(t,e));return r&&n?n(r)||{}:{}}function RI(t,e,n){const r=parseFloat(Tn(Wn(t,e)));if(!isNaN(r))return r&&n?n(r)||{}:{}}function wa(t,e,n){const r=parseFloat(Tn(Wn(t,e)));if(!isNaN(r))return n&&n(r),r}function Ph(t,e){const n={};for(const r of e)Xa(t,r,i=>{n[r]=i});return n}function zb(t){return(t==null?void 0:t.nodeType)===1}function IN(t){return Jr(t,"line",e=>Object.assign({},Xa(e,"color",r=>({stroke:`#${r}`})),RI(e,"opacity",r=>({"stroke-opacity":r})),RI(e,"width",r=>({"stroke-width":r*96/25.4}))))}function AN(t){let e=[];if(t===null)return e;for(const n of Array.from(t.childNodes)){if(!zb(n))continue;const r=d1e(n.nodeName);if(r==="gpxtpx:TrackPointExtension")e=e.concat(AN(n));else{const i=Tn(n);e.push([r,h1e(i)])}}return e}function d1e(t){return["heart","gpxtpx:hr","hr"].includes(t)?"heart":t}function h1e(t){const e=parseFloat(t);return isNaN(e)?t:e}function FN(t){const e=[parseFloat(t.getAttribute("lon")||""),parseFloat(t.getAttribute("lat")||"")];if(isNaN(e[0])||isNaN(e[1]))return null;wa(t,"ele",r=>{e.push(r)});const n=Wn(t,"time");return{coordinates:e,time:n?Tn(n):null,extendedValues:AN(Wn(t,"extensions"))}}function Ub(t){var i;const e=Ph(t,["name","cmt","desc","type","time","keywords"]),n=Array.from(t.getElementsByTagNameNS("http://www.garmin.com/xmlschemas/GpxExtensions/v3","*"));for(const s of n)((i=s.parentNode)==null?void 0:i.parentNode)===t&&(e[s.tagName.replace(":","_")]=Tn(s));const r=Ln(t,"link");return r.length&&(e.links=r.map(s=>Object.assign({href:s.getAttribute("href")},Ph(s,["text","type"])))),e}function ON(t,e){const n=Ln(t,e),r=[],i=[],s={};for(let o=0;o<n.length;o++){const a=FN(n[o]);if(a){r.push(a.coordinates),a.time&&i.push(a.time);for(const[l,c]of a.extendedValues){const u=l==="heart"?l:l.replace("gpxtpx:","")+"s";s[u]||(s[u]=Array(n.length).fill(null)),s[u][o]=c}}}if(!(r.length<2))return{line:r,times:i,extendedValues:s}}function f1e(t){const e=ON(t,"rtept");if(e)return{type:"Feature",properties:Object.assign({_gpxType:"rte"},Ub(t),IN(Wn(t,"extensions"))),geometry:{type:"LineString",coordinates:e.line}}}function g1e(t){const e=Ln(t,"trkseg"),n=[],r=[],i=[];for(const a of e){const l=ON(a,"trkpt");l&&(i.push(l),l.times&&l.times.length&&r.push(l.times))}if(i.length===0)return null;const s=i.length>1,o=Object.assign({_gpxType:"trk"},Ub(t),IN(Wn(t,"extensions")),r.length?{coordinateProperties:{times:s?r:r[0]}}:{});for(const a of i){n.push(a.line),o.coordinateProperties||(o.coordinateProperties={});const l=o.coordinateProperties,c=Object.entries(a.extendedValues);for(let u=0;u<c.length;u++){const[d,h]=c[u];s?(l[d]||(l[d]=i.map(f=>new Array(f.line.length).fill(null))),l[d][u]=h):l[d]=h}}return{type:"Feature",properties:o,geometry:s?{type:"MultiLineString",coordinates:n}:{type:"LineString",coordinates:n[0]}}}function p1e(t){const e=Object.assign(Ub(t),Ph(t,["sym"])),n=FN(t);return n?{type:"Feature",properties:e,geometry:{type:"Point",coordinates:n.coordinates}}:null}function*m1e(t){for(const e of Ln(t,"trk")){const n=g1e(e);n&&(yield n)}for(const e of Ln(t,"rte")){const n=f1e(e);n&&(yield n)}for(const e of Ln(t,"wpt")){const n=p1e(e);n&&(yield n)}}function y1e(t){return{type:"FeatureCollection",features:Array.from(m1e(t))}}function $N(t,e){const n={},r=e=="stroke"||e==="fill"?e:e+"-color";return t[0]==="#"&&(t=t.substring(1)),t.length===6||t.length===3?n[r]="#"+t:t.length===8&&(n[e+"-opacity"]=parseInt(t.substring(0,2),16)/255,n[r]="#"+t.substring(6,8)+t.substring(4,6)+t.substring(2,4)),n}function Rm(t,e,n){const r={};return wa(t,e,i=>{r[n]=i}),r}function Gb(t,e){return Jr(t,"color",n=>$N(Tn(n),e))}function LN(t){return Jr(t,"Icon",(e,n)=>(Xa(e,"href",r=>{n.icon=r}),n))}function _1e(t){return Jr(t,"IconStyle",e=>Object.assign(Gb(e,"icon"),Rm(e,"scale","icon-scale"),Rm(e,"heading","icon-heading"),Jr(e,"hotSpot",n=>{const r=parseFloat(n.getAttribute("x")||""),i=parseFloat(n.getAttribute("y")||""),s=n.getAttribute("xunits")||"",o=n.getAttribute("yunits")||"";return!isNaN(r)&&!isNaN(i)?{"icon-offset":[r,i],"icon-offset-units":[s,o]}:{}}),LN(e)))}function v1e(t){return Jr(t,"LabelStyle",e=>Object.assign(Gb(e,"label"),Rm(e,"scale","label-scale")))}function w1e(t){return Jr(t,"LineStyle",e=>Object.assign(Gb(e,"stroke"),Rm(e,"width","stroke-width")))}function x1e(t){return Jr(t,"PolyStyle",(e,n)=>Object.assign(n,Jr(e,"color",r=>$N(Tn(r),"fill")),Xa(e,"fill",r=>{if(r==="0")return{"fill-opacity":0}}),Xa(e,"outline",r=>{if(r==="0")return{"stroke-opacity":0}})))}function Bb(t){return Object.assign({},x1e(t),w1e(t),v1e(t),_1e(t))}const Ll=t=>Number(t),mx={string:t=>t,int:Ll,uint:Ll,short:Ll,ushort:Ll,float:Ll,double:Ll,bool:t=>!!t};function kN(t,e){return Jr(t,"ExtendedData",(n,r)=>{for(const i of Ln(n,"Data"))r[i.getAttribute("name")||""]=Tn(Wn(i,"value"));for(const i of Ln(n,"SimpleData")){const s=i.getAttribute("name")||"",o=e[s]||mx.string;r[s]=o(Tn(i))}return r})}function MN(t){const e=Wn(t,"description");for(const n of Array.from((e==null?void 0:e.childNodes)||[]))if(n.nodeType===4)return{description:{"@type":"html",value:Tn(n)}};return{}}function DN(t){return Jr(t,"TimeSpan",e=>({timespan:{begin:Tn(Wn(e,"begin")),end:Tn(Wn(e,"end"))}}))}function NN(t){return Jr(t,"TimeStamp",e=>({timestamp:Tn(Wn(e,"when"))}))}function jN(t,e){return Xa(t,"styleUrl",n=>(n=Pm(n),e[n]?Object.assign({styleUrl:n},e[n]):{styleUrl:n}))}const E1e=/\s*/g,S1e=/^\s*|\s*$/g,b1e=/\s+/;function zN(t){return t.replace(E1e,"").split(",").map(parseFloat).filter(e=>!isNaN(e)).slice(0,3)}function yx(t){return t.replace(S1e,"").split(b1e).map(zN).filter(e=>e.length>=2)}function C1e(t){let e=Ln(t,"coord");e.length===0&&(e=u1e(t,"coord","*"));const n=e.map(r=>Tn(r).split(" ").map(parseFloat));return n.length===0?null:{geometry:n.length>2?{type:"LineString",coordinates:n}:{type:"Point",coordinates:n[0]},times:Ln(t,"when").map(r=>Tn(r))}}function UN(t){if(t.length===0)return t;const e=t[0],n=t[t.length-1];let r=!0;for(let i=0;i<Math.max(e.length,n.length);i++)if(e[i]!==n[i]){r=!1;break}return r?t:t.concat([t[0]])}function ep(t){return Tn(Wn(t,"coordinates"))}function GN(t){let e=[],n=[];for(let r=0;r<t.childNodes.length;r++){const i=t.childNodes.item(r);if(zb(i))switch(i.tagName){case"MultiGeometry":case"MultiTrack":case"gx:MultiTrack":{const s=GN(i);e=e.concat(s.geometries),n=n.concat(s.coordTimes);break}case"Point":{const s=zN(ep(i));s.length>=2&&e.push({type:"Point",coordinates:s});break}case"LinearRing":case"LineString":{const s=yx(ep(i));s.length>=2&&e.push({type:"LineString",coordinates:s});break}case"Polygon":{const s=[];for(const o of Ln(i,"LinearRing")){const a=UN(yx(ep(o)));a.length>=4&&s.push(a)}s.length&&e.push({type:"Polygon",coordinates:s});break}case"Track":case"gx:Track":{const s=C1e(i);if(!s)break;const{times:o,geometry:a}=s;e.push(a),o.length&&n.push(o);break}}}return{geometries:e,coordTimes:n}}function T1e(t){return t.length===0?null:t.length===1?t[0]:{type:"GeometryCollection",geometries:t}}function P1e(t,e,n,r){var c;const{coordTimes:i,geometries:s}=GN(t),o=T1e(s);if(!o&&r.skipNullGeometry)return null;const a={type:"Feature",geometry:o,properties:Object.assign(Ph(t,["name","address","visibility","open","phoneNumber","description"]),MN(t),jN(t,e),Bb(t),kN(t,n),DN(t),NN(t),i.length?{coordinateProperties:{times:i.length===1?i[0]:i}}:{})};((c=a.properties)==null?void 0:c.visibility)!==void 0&&(a.properties.visibility=a.properties.visibility!=="0");const l=t.getAttribute("id");return l!==null&&l!==""&&(a.id=l),a}function R1e(t){return Wn(t,"gx:LatLonQuad")?{geometry:{type:"Polygon",coordinates:[UN(yx(ep(t)))]}}:F1e(t)}const I1e=Math.PI/180;function A1e(t,e,n){const r=[(t[0]+t[2])/2,(t[1]+t[3])/2];return[e[0].map(i=>{const s=i[1]-r[1],o=i[0]-r[0],a=Math.sqrt(Math.pow(s,2)+Math.pow(o,2)),l=Math.atan2(s,o)+n*I1e;return[r[0]+Math.cos(l)*a,r[1]+Math.sin(l)*a]})]}function F1e(t){const e=Wn(t,"LatLonBox");if(e){const n=wa(e,"north"),r=wa(e,"west"),i=wa(e,"east"),s=wa(e,"south"),o=wa(e,"rotation");if(typeof n=="number"&&typeof s=="number"&&typeof r=="number"&&typeof i=="number"){const a=[r,s,i,n];let l=[[[r,n],[i,n],[i,s],[r,s],[r,n]]];return typeof o=="number"&&(l=A1e(a,l,o)),{bbox:a,geometry:{type:"Polygon",coordinates:l}}}}return null}function O1e(t,e,n,r){var l;const i=R1e(t),s=(i==null?void 0:i.geometry)||null;if(!s&&r.skipNullGeometry)return null;const o={type:"Feature",geometry:s,properties:Object.assign({"@geometry-type":"groundoverlay"},Ph(t,["name","address","visibility","open","phoneNumber","description"]),MN(t),jN(t,e),Bb(t),LN(t),kN(t,n),DN(t),NN(t))};i!=null&&i.bbox&&(o.bbox=i.bbox),((l=o.properties)==null?void 0:l.visibility)!==void 0&&(o.properties.visibility=o.properties.visibility!=="0");const a=t.getAttribute("id");return a!==null&&a!==""&&(o.id=a),o}function $1e(t){let e=t.getAttribute("id");const n=t.parentNode;return!e&&zb(n)&&n.localName==="CascadingStyle"&&(e=n.getAttribute("kml:id")||n.getAttribute("id")),Pm(e||"")}function L1e(t){const e={};for(const n of Ln(t,"Style"))e[$1e(n)]=Bb(n);for(const n of Ln(t,"StyleMap")){const r=Pm(n.getAttribute("id")||"");Xa(n,"styleUrl",i=>{i=Pm(i),e[i]&&(e[r]=e[i])})}return e}function k1e(t){const e={};for(const n of Ln(t,"SimpleField"))e[n.getAttribute("name")||""]=mx[n.getAttribute("type")||""]||mx.string;return e}function*M1e(t,e={skipNullGeometry:!1}){const n=L1e(t),r=k1e(t);for(const i of Ln(t,"Placemark")){const s=P1e(i,n,r,e);s&&(yield s)}for(const i of Ln(t,"GroundOverlay")){const s=O1e(i,n,r,e);s&&(yield s)}}function D1e(t,e={skipNullGeometry:!1}){return{type:"FeatureCollection",features:Array.from(M1e(t,e))}}async function N1e(t){var r,i,s;const e=await window.api.readExternalFile(t),n=[];try{const o=new DOMParser().parseFromString(e,"text/xml"),a=D1e(o),l=new Map;try{const c=Array.from(o.getElementsByTagName("Placemark"));for(const u of c){const d=u.getElementsByTagName("name")[0],h=((d==null?void 0:d.textContent)||"").trim();if(!h)continue;let f=u.parentNode,p="";for(;f;){if(f.tagName==="Folder"){const m=((r=f.getElementsByTagName("name")[0])==null?void 0:r.textContent)||"";if(m){p=m.trim();break}}f=f.parentNode}p&&l.set(h,p)}}catch{}for(const c of a.features||[]){const u=String(((i=c.properties)==null?void 0:i.name)||"").trim(),d=(s=c.properties)==null?void 0:s.description;c.geometry&&n.push({name:u,desc:d,geometry:c.geometry,props:{...c.properties,folder_hint:l.get(u)}})}if(n.length===0){const c=/<Placemark[\s\S]*?<name>([\s\S]*?)<\/name>[\s\S]*?<Point>[\s\S]*?<coordinates>\s*([-0-9.]+),\s*([-0-9.]+)[^<]*<\/coordinates>[\s\S]*?<\/Placemark>/gi;for(const u of e.matchAll(c)){const d=(u[1]||"").trim(),h=Number(u[2]),f=Number(u[3]);!Number.isFinite(h)||!Number.isFinite(f)||n.push({name:d,desc:"",geometry:{type:"Point",coordinates:[h,f]},props:{}})}}return n}catch{try{const o=/<Placemark[\s\S]*?<name>([\s\S]*?)<\/name>[\s\S]*?<Point>[\s\S]*?<coordinates>\s*([-0-9.]+),\s*([-0-9.]+)[^<]*<\/coordinates>[\s\S]*?<\/Placemark>/gi;for(const a of e.matchAll(o)){const l=(a[1]||"").trim(),c=Number(a[2]),u=Number(a[3]);!Number.isFinite(c)||!Number.isFinite(u)||n.push({name:l,desc:"",geometry:{type:"Point",coordinates:[c,u]},props:{}})}return n}catch{throw new Error("Failed to parse KML")}}}async function j1e(t){var s,o;const e=await window.api.readExternalFile(t),n=new DOMParser().parseFromString(e,"text/xml"),r=y1e(n),i=[];for(const a of r.features||[]){const l=String(((s=a.properties)==null?void 0:s.name)||"").trim(),c=(o=a.properties)==null?void 0:o.desc;a.geometry&&i.push({name:l,desc:c,geometry:a.geometry,props:a.properties})}return i}function z1e(t,e){var v,w;const n=(t.name||"").toLowerCase().trim(),[r,...i]=n.split(":"),s=(r==null?void 0:r.trim())||"",o=i.join(":").trim(),a=t.desc||"",l=t.geometry.type,c=(x,S)=>({type:"Feature",geometry:t.geometry,properties:{...S,notes:a}}),u=x=>{const S=x.match(/(\d+(\.\d+)?)/);return S?Number(S[1]):void 0},d={stands:c("stands",{stand_type:o.includes("climber")?"climber":o.includes("shanty")?"shanty":o.includes("blind")?"blind":o.includes("saddle")?"saddle":void 0}),tree_stands:l==="Polygon"?c("tree_stands",{stand_type:o.includes("climber")?"climber":o.includes("shanty")?"shanty":o.includes("blind")?"blind":o.includes("saddle")?"saddle":void 0}):null,scrapes:c("scrapes",{freshness:o.includes("fresh")?"fresh":o.includes("recent")?"recent":void 0}),rubs:c("rubs",{diameter_in:u(o)}),trees_points:c("trees_points",{species:o.replace(/\s+/g,"_")}),trails:l==="LineString"?c("trails",{trail_type:o.includes("atv")?"atv":o.includes("deer")?"deer":"foot",prominence:o.includes("faint")?"faint":"main"}):null,bedding_areas:l==="Polygon"?c("bedding_areas",{cover_type:o.includes("hemlock")?"hemlocks":void 0}):null,beds_points:c("beds_points",{}),acorn_flats:l==="Polygon"?c("acorn_flats",{acorn_density_0_5:u(o)}):null,open_woods:l==="Polygon"?c("open_woods",{openness_1_5:u(o)}):null,big_rocks:c("big_rocks",{rock_type:o.includes("boulder")?"boulder":void 0}),cliffs:l==="LineString"?c("cliffs",{}):null,ravines:l==="LineString"?c("ravines",{}):null,streams:l==="LineString"?c("streams",{}):null,hunts:c("hunts",{}),animal_sightings:c("animal_sightings",{}),animal_paths:l==="LineString"?c("animal_paths",{confidence:"observed"}):null};let h=null;const f=s.replace(/s$/,""),m=(x=>{switch(x){case"stand":return l==="Polygon"?"tree_stands":"stands";case"spot":return"stands";case"spot":return"stands";case"scrape":return"scrapes";case"rub":return"rubs";case"tree":return"trees_points";case"trail":return l==="LineString"?"trails":null;case"bedding":return l==="Polygon"?"bedding_areas":"beds_points";case"bed":return"beds_points";case"flat":case"acorn":return l==="Polygon"?"acorn_flats":null;case"open":return l==="Polygon"?"open_woods":null;case"rock":return"big_rocks";case"cliff":return l==="LineString"?"cliffs":null;case"ravine":return l==="LineString"?"ravines":null;case"stream":case"creek":return l==="LineString"?"streams":null;case"hunt":return"hunts";case"sighting":return"animal_sightings";default:return null}})(f);if(m&&d[m])h=m;else if(e.useHeuristics){const x=String(((v=t.props)==null?void 0:v.folder_hint)||"").toLowerCase(),S=C=>n.includes(C)||x.includes(C);if(x&&(x.includes("trail")?h="trails":x.includes("bedding")?h=l==="Polygon"?"bedding_areas":"beds_points":x.includes("bed")?h="beds_points":x.includes("acorn")||x.includes("flat")?h=l==="Polygon"?"acorn_flats":null:x.includes("open")?h=l==="Polygon"?"open_woods":null:x.includes("rock")?h="big_rocks":x.includes("cliff")?h=l==="LineString"?"cliffs":null:x.includes("ravine")?h=l==="LineString"?"ravines":null:x.includes("stream")||x.includes("creek")?h=l==="LineString"?"streams":null:x.includes("sighting")?h="animal_sightings":x.includes("hunt")?h="hunts":x.includes("stand")&&(h=l==="Polygon"?"tree_stands":"stands")),h||(S("stand")?h=l==="Polygon"?"tree_stands":"stands":S("spot")?h="stands":S("scrape")?h="scrapes":S("rub")?h="rubs":S("tree")?h="trees_points":S("bed")?h=l==="Polygon"?"bedding_areas":"beds_points":S("sighting")?h="animal_sightings":S("hunt")?h="hunts":S("cliff")?h=l==="LineString"?"cliffs":null:S("ravine")?h=l==="LineString"?"ravines":null:(S("creek")||S("stream"))&&(h=l==="LineString"?"streams":null)),!h)if(l==="LineString")h=e.tracksTarget==="animal_paths"?"animal_paths":"trails";else if(l==="Polygon")h="open_woods";else return null}else return null;const _=d[h]||c(h,{});if(h==="hunts"){const x=String(((w=t.props)==null?void 0:w.time)||"").trim();if(x){const S=new Date(x);if(!isNaN(S.getTime()))try{const T=new Intl.DateTimeFormat("en-CA",{timeZone:e.timeZone,year:"numeric",month:"2-digit",day:"2-digit",hour:"2-digit",minute:"2-digit",hour12:!1}).formatToParts(S),P=j=>{var V;return((V=T.find(H=>H.type===j))==null?void 0:V.value)||""},F=P("year"),k=P("month"),A=P("day"),M=P("hour"),b=P("minute");_.properties.date=`${F}-${k}-${A}`,_.properties.start_time=`${M}:${b}`}catch{}}}const g=_.properties||{};if(g.name||(g.name=t.name||""),!g.date){const x=new Date(e.importTimestamp),S=x.getFullYear(),C=String(x.getMonth()+1).padStart(2,"0"),T=String(x.getDate()).padStart(2,"0");g.date=`${S}-${C}-${T}`}g.imported_by=e.activeUser,g.imported_at=e.importTimestamp,g.created_by||(g.created_by=e.activeUser),g.created_at||(g.created_at=e.importTimestamp),_.properties=g;const y=U1e(_);return{layerId:h,feature:_,signature:y}}function U1e(t){var n;const e=String(((n=t.properties)==null?void 0:n.name)||"").toLowerCase();if(t.geometry.type==="Point"){const[r,i]=t.geometry.coordinates.map(s=>Number(s.toFixed(6)));return`pt:${r},${i}:${e}`}if(t.geometry.type==="LineString"){const r=t.geometry.coordinates;if(r.length<2)return`line:${e}`;const i=r[0].map(o=>Number(o.toFixed(6))).join(","),s=r[r.length-1].map(o=>Number(o.toFixed(6))).join(",");return`line:${i}-${s}:${e}`}return t.geometry.type==="Polygon"?`poly:${((t.geometry.coordinates[0]||[])[0]||[]).map(o=>Number(o.toFixed(6))).join(",")}:${e}`:`geom:${t.geometry.type}:${e}`}async function G1e(t,e,n){try{const r=await window.api.readTextFile(t,`data/${e}`),i=JSON.parse(r||'{"type":"FeatureCollection","features":[]}');for(const s of i.features||[])if(B1e(s)===n.signature)return!0;return!1}catch{return!1}}function B1e(t){var n,r,i,s,o,a;const e=String(((n=t==null?void 0:t.properties)==null?void 0:n.name)||"").toLowerCase();if(((r=t==null?void 0:t.geometry)==null?void 0:r.type)==="Point"){const[l,c]=t.geometry.coordinates.map(u=>Number(u.toFixed(6)));return`pt:${l},${c}:${e}`}if(((i=t==null?void 0:t.geometry)==null?void 0:i.type)==="LineString"){const l=t.geometry.coordinates;if(!l||l.length<2)return`line:${e}`;const c=l[0].map(d=>Number(d.toFixed(6))).join(","),u=l[l.length-1].map(d=>Number(d.toFixed(6))).join(",");return`line:${c}-${u}:${e}`}return((s=t==null?void 0:t.geometry)==null?void 0:s.type)==="Polygon"?`poly:${((((o=t.geometry.coordinates)==null?void 0:o[0])||[])[0]||[]).map(u=>Number(u.toFixed(6))).join(",")}:${e}`:`geom:${(a=t==null?void 0:t.geometry)==null?void 0:a.type}:${e}`}async function V1e(t,e,n){try{const r=await window.api.readTextFile(t,`data/${e}`),i=JSON.parse(r||'{"type":"FeatureCollection","features":[]}');i.features.push(n),await II(t,e,i)}catch{await II(t,e,{type:"FeatureCollection",features:[n]})}}async function II(t,e,n){const r=JSON.stringify(n,null,2),i=window.api.atomicWriteTextFile;if(typeof i=="function")try{await i(t,`data/${e}`,r);return}catch(s){console.warn("atomic write failed, falling back to non-atomic write",s)}await window.api.writeTextFile(t,`data/${e}`,r)}async function W1e(t,e){const r=`imports/import_report_${new Date().toISOString().replace(/[:.]/g,"-")}.json`;return await window.api.writeTextFile(t,r,JSON.stringify(e,null,2)),r}async function H1e(t){var r,i,s;const e={countsByLayer:{},duplicates:0,unknown:[],errors:[],warnings:["Photos are not included in onX exports"]},n=[];for(const o of t.inputFiles)try{if(o.toLowerCase().endsWith(".kml")){const a=await N1e(o);n.push(...a.map(l=>({file:o,pf:l})))}else if(o.toLowerCase().endsWith(".gpx")){const a=await j1e(o);n.push(...a.map(l=>({file:o,pf:l})))}else e.warnings.push(`Unsupported file: ${o}`)}catch(a){e.errors.push({file:o,error:String((a==null?void 0:a.message)||a)})}for(const{file:o,pf:a}of n)try{if(t.onlyPoints&&((r=a==null?void 0:a.geometry)==null?void 0:r.type)!=="Point")continue;const l=z1e(a,t);if(!l){e.unknown.push({name:a.name||"",reason:"no prefix or unsupported geometry",geometryType:((i=a==null?void 0:a.geometry)==null?void 0:i.type)||"Unknown"});continue}const c=ja[l.layerId];if(!c){e.unknown.push({name:a.name||"",reason:`no layer config for ${l.layerId}`,geometryType:((s=a==null?void 0:a.geometry)==null?void 0:s.type)||"Unknown"});continue}if(await G1e(t.projectDir,c.file,l)){e.duplicates+=1;continue}await V1e(t.projectDir,c.file,l.feature),e.countsByLayer[l.layerId]=(e.countsByLayer[l.layerId]||0)+1}catch(l){e.errors.push({file:o,error:String((l==null?void 0:l.message)||l)})}return e}async function K1e(t,e){const n=await window.api.chooseFiles([{name:"onX Exports",extensions:["kml","gpx"]}]);if(!n||n.length===0)return null;const r=(e==null?void 0:e.tracksTarget)||"trails",i=(e==null?void 0:e.timeZone)||Intl.DateTimeFormat().resolvedOptions().timeZone||"America/New_York",s=(e==null?void 0:e.useHeuristics)??!0,o=(e==null?void 0:e.onlyPoints)??!1,a=e==null?void 0:e.activeUser;if(!a)throw new Error("Active user required for import");const l=new Date().toISOString(),c=await H1e({projectDir:t,inputFiles:n,tracksTarget:r,timeZone:i,useHeuristics:s,onlyPoints:o,activeUser:a,importTimestamp:l}),u=await W1e(t,c);try{window.dispatchEvent(new Event("layers:reload"))}catch{}return u}function Y1e({visible:t,defaultTracksTarget:e,defaultTimeZone:n,defaultUseHeuristics:r,defaultOnlyPoints:i,onCancel:s,onConfirm:o}){const a=Intl.DateTimeFormat().resolvedOptions().timeZone||"America/New_York",[l,c]=K.useState(e||"trails"),[u,d]=K.useState(n||a),[h,f]=K.useState(typeof r=="boolean"?r:!0),[p,m]=K.useState(!!i);return K.useEffect(()=>{t&&(c(e||"trails"),d(n||a),f(typeof r=="boolean"?r:!0),m(!!i))},[t]),t?E.jsx("div",{style:{position:"fixed",inset:0,background:"rgba(0,0,0,0.35)",zIndex:2e3,display:"flex",alignItems:"center",justifyContent:"center"},children:E.jsxs("div",{style:{width:420,maxWidth:"90vw",background:"#ffffff",borderRadius:10,boxShadow:"0 10px 30px rgba(15,23,42,0.22)",border:"1px solid rgba(15,23,42,0.12)",padding:16},children:[E.jsx("div",{style:{fontSize:16,fontWeight:600,marginBottom:12},children:"Import onX Options"}),E.jsxs("div",{style:{display:"flex",flexDirection:"column",gap:12},children:[E.jsxs("label",{style:{display:"flex",flexDirection:"column",gap:6},children:[E.jsx("span",{style:{fontSize:12,color:"#334155"},children:"Tracks target"}),E.jsxs("div",{style:{display:"flex",gap:12},children:[E.jsxs("label",{style:{display:"flex",alignItems:"center",gap:6},children:[E.jsx("input",{type:"radio",name:"tracksTarget",checked:l==="trails",onChange:()=>c("trails")}),E.jsx("span",{children:"Trails"})]}),E.jsxs("label",{style:{display:"flex",alignItems:"center",gap:6},children:[E.jsx("input",{type:"radio",name:"tracksTarget",checked:l==="animal_paths",onChange:()=>c("animal_paths")}),E.jsx("span",{children:"Animal paths"})]})]})]}),E.jsxs("label",{style:{display:"flex",flexDirection:"column",gap:6},children:[E.jsx("span",{style:{fontSize:12,color:"#334155"},children:"Time zone for GPX timestamps"}),E.jsx("input",{type:"text",value:u,onChange:_=>d(_.target.value),placeholder:"e.g., America/New_York",style:{border:"1px solid rgba(15,23,42,0.18)",borderRadius:6,padding:"8px 10px",fontSize:13}})]}),E.jsxs("label",{style:{display:"flex",alignItems:"center",gap:8},children:[E.jsx("input",{type:"checkbox",checked:h,onChange:_=>f(_.target.checked)}),E.jsx("span",{children:"Use heuristic mapping from names"})]}),E.jsxs("label",{style:{display:"flex",alignItems:"center",gap:8},children:[E.jsx("input",{type:"checkbox",checked:p,onChange:_=>m(_.target.checked)}),E.jsx("span",{children:"Points only (skip lines and polygons)"})]})]}),E.jsxs("div",{style:{display:"flex",justifyContent:"flex-end",gap:8,marginTop:16},children:[E.jsx("button",{onClick:s,style:{padding:"8px 12px",borderRadius:6,border:"1px solid rgba(15,23,42,0.12)",background:"#ffffff",cursor:"pointer",fontSize:13},children:"Cancel"}),E.jsx("button",{onClick:()=>o({tracksTarget:l,timeZone:u,useHeuristics:h,onlyPoints:p}),style:{padding:"8px 12px",borderRadius:6,border:"1px solid #0a84ff",background:"#0a84ff",color:"#ffffff",cursor:"pointer",fontSize:13,fontWeight:600},children:"Continue"})]})]})}):null}function X1e(){const{projectPath:t}=He(),e=Ve(f=>f.activeUser),[n,r]=K.useState(""),[i,s]=K.useState(!1),[o,a]=K.useState(null),[l,c]=K.useState(!1),[u,d]=K.useState(null),h=async()=>{if(t){if(!e){window.alert("Select an Active User before importing onX data.");return}r("Importing...");try{const f=await K1e(t,{tracksTarget:o==null?void 0:o.tracksTarget,timeZone:o==null?void 0:o.timeZone,useHeuristics:o==null?void 0:o.useHeuristics,onlyPoints:l,activeUser:e});if(f)try{const p=await window.api.readTextFile(t,f),m=JSON.parse(p||"{}"),_=m.countsByLayer||{},g=Object.values(_).reduce((v,w)=>v+(w||0),0),y=Object.keys(_).length;d({reportRel:f,importedTotal:g,layerCount:y,duplicates:m.duplicates||0,unknown:(m.unknown||[]).length,errors:(m.errors||[]).length}),r("Import complete")}catch{r("Import complete")}else r("Canceled")}catch(f){console.error("onX import failed",f),r("Import failed")}setTimeout(()=>r(""),5e3)}};return t?E.jsxs(E.Fragment,{children:[E.jsx("button",{onClick:()=>{if(!e){window.alert("Select an Active User before importing onX data.");return}s(!0)},title:"Import KML/GPX from onX",style:{position:"fixed",top:12,left:360,padding:"8px 14px",borderRadius:6,border:"1px solid rgba(15,23,42,0.12)",background:"#ffffff",cursor:"pointer",fontSize:13,fontWeight:500,zIndex:1e3,boxShadow:"0 6px 18px rgba(15,23,42,0.12)"},children:n||"Import onX"}),u?E.jsxs("div",{style:{position:"fixed",top:52,left:244,padding:12,borderRadius:8,border:"1px solid rgba(15,23,42,0.12)",background:"#ffffff",boxShadow:"0 6px 18px rgba(15,23,42,0.12)",zIndex:1e3,minWidth:260},children:[E.jsx("div",{style:{fontWeight:600,marginBottom:6},children:"Import Summary"}),E.jsxs("div",{style:{fontSize:12,color:"#334155",lineHeight:1.6},children:[E.jsxs("div",{children:["Imported: ",u.importedTotal," feature(s) across ",u.layerCount," layer(s)"]}),E.jsxs("div",{children:["Duplicates: ",u.duplicates]}),E.jsxs("div",{children:["Unknown: ",u.unknown]}),E.jsxs("div",{children:["Errors: ",u.errors]})]}),E.jsxs("div",{style:{display:"flex",gap:8,marginTop:10},children:[E.jsx("button",{onClick:async()=>{try{const f=await window.api.resolveMediaPath(t,u.reportRel);window.api.openPath&&await window.api.openPath(f)||window.alert(f)}catch{}},style:{padding:"6px 10px",borderRadius:6,border:"1px solid #0a84ff",background:"#0a84ff",color:"#ffffff",cursor:"pointer",fontSize:12,fontWeight:600},children:"Open report"}),E.jsx("button",{onClick:()=>d(null),style:{padding:"6px 10px",borderRadius:6,border:"1px solid rgba(15,23,42,0.12)",background:"#ffffff",cursor:"pointer",fontSize:12},children:"Dismiss"})]})]}):null,E.jsx(Y1e,{visible:i,defaultOnlyPoints:l,onCancel:()=>s(!1),onConfirm:f=>{if(!e){window.alert("Select an Active User before importing onX data.");return}a(f),c(!!f.onlyPoints),s(!1),h()}})]}):null}const AI="media/metadata.json",tp=Qi((t,e)=>({folders:[],files:[],currentFolderPath:"",selectedFile:null,viewerOpen:!1,setCurrentFolder:n=>t({currentFolderPath:n}),addFolder:n=>t(r=>({folders:[...r.folders,n]})),updateFolder:(n,r)=>t(i=>({folders:i.folders.map(s=>s.id===n?{...s,...r}:s)})),deleteFolder:n=>t(r=>({folders:r.folders.filter(i=>i.id!==n),files:r.files.filter(i=>{var s;return!i.path.startsWith(((s=r.folders.find(o=>o.id===n))==null?void 0:s.path)||"")})})),addFile:n=>t(r=>({files:[...r.files,n]})),updateFile:(n,r)=>t(i=>({files:i.files.map(s=>s.id===n?{...s,...r,updatedAt:new Date().toISOString()}:s)})),deleteFile:n=>t(r=>({files:r.files.filter(i=>i.id!==n)})),moveFile:(n,r)=>t(i=>{const s=i.files.find(a=>a.id===n);if(!s)return i;const o=r?`${r}/${s.name}`:s.name;return{files:i.files.map(a=>a.id===n?{...a,path:o,updatedAt:new Date().toISOString()}:a)}}),setSelectedFile:n=>t({selectedFile:n}),setViewerOpen:n=>t({viewerOpen:n}),loadFromProject:async n=>{try{const r=await window.api.readTextFile(n,AI),i=JSON.parse(r);t({folders:i.folders||[],files:i.files||[]})}catch{t({folders:[],files:[]})}},saveToProject:async n=>{const{folders:r,files:i}=e(),s={folders:r,files:i};await window.api.writeTextFile(n,AI,JSON.stringify(s,null,2))}})),Z1e=(t,e)=>{const n=t.replace(/\\/g,"/"),r=e.replace(/\\/g,"/");if(n.startsWith(r)){let s=n.slice(r.length).replace(/^\/+/,"");return s.startsWith("media/")&&(s=s.slice(6)),`media:///${s.split("/").map(a=>encodeURIComponent(a)).join("/")}`}const i=n.match(/media\/(.+)$/);return i?`media:///${i[1].split("/").map(o=>encodeURIComponent(o)).join("/")}`:""};function q1e(){const{projectPath:t}=He(),{selectedFile:e,viewerOpen:n,setViewerOpen:r,updateFile:i,saveToProject:s,files:o}=tp(),[a,l]=K.useState(""),[c,u]=K.useState(!1),[d,h]=K.useState(""),[f,p]=K.useState(null);if(K.useEffect(()=>{e&&(l(e.notes||""),u(!1),p(null))},[e]),K.useEffect(()=>{if(!e||!t){h("");return}(async()=>{try{const F=`media/${e.path.includes("/")?e.path:e.name}`,k=await window.api.resolveMediaPath(t,F);h(Z1e(k,t))}catch(P){console.error("Failed to resolve media path",P),h("")}})()},[e,t]),!n||!e||!t)return null;const m=o.findIndex(T=>T.id===e.id),_=m<o.length-1,g=m>0,y=()=>{if(_){const T=o[m+1];tp.getState().setSelectedFile(T)}},v=()=>{if(g){const T=o[m-1];tp.getState().setSelectedFile(T)}},w=async()=>{e&&(i(e.id,{notes:a}),await s(t),u(!1))},x={position:"fixed",top:0,left:0,right:0,bottom:0,background:"rgba(0,0,0,0.95)",zIndex:3e3,display:"flex",flexDirection:"column",alignItems:"center",justifyContent:"center"},S={width:"100%",height:"100%",display:"flex",flexDirection:"column",alignItems:"center",justifyContent:"center",position:"relative"},C={flex:1,display:"flex",alignItems:"center",justifyContent:"center",width:"100%",maxHeight:"calc(100vh - 200px)",position:"relative"};return E.jsx("div",{style:x,onClick:()=>r(!1),children:E.jsxs("div",{style:S,onClick:T=>T.stopPropagation(),children:[E.jsx("button",{onClick:()=>r(!1),style:{position:"absolute",top:20,right:20,padding:"8px 16px",border:"1px solid rgba(255,255,255,0.3)",borderRadius:6,background:"rgba(255,255,255,0.1)",color:"#ffffff",cursor:"pointer",fontSize:13,zIndex:10},children:"Close (ESC)"}),g&&E.jsx("button",{onClick:v,style:{position:"absolute",left:20,top:"50%",transform:"translateY(-50%)",padding:"12px 20px",border:"1px solid rgba(255,255,255,0.3)",borderRadius:6,background:"rgba(255,255,255,0.1)",color:"#ffffff",cursor:"pointer",fontSize:16,zIndex:10},children:" Prev"}),_&&E.jsx("button",{onClick:y,style:{position:"absolute",right:20,top:"50%",transform:"translateY(-50%)",padding:"12px 20px",border:"1px solid rgba(255,255,255,0.3)",borderRadius:6,background:"rgba(255,255,255,0.1)",color:"#ffffff",cursor:"pointer",fontSize:16,zIndex:10},children:"Next "}),E.jsx("div",{style:C,children:e.type==="image"?E.jsx("img",{src:d,alt:e.name,style:{maxWidth:"100%",maxHeight:"100%",objectFit:"contain"}}):f?E.jsxs("div",{style:{padding:40,textAlign:"center",color:"#ffffff",background:"rgba(255,0,0,0.1)",borderRadius:8,border:"1px solid rgba(255,0,0,0.3)"},children:[E.jsx("div",{style:{fontSize:18,fontWeight:600,marginBottom:12},children:"Video Playback Error"}),E.jsx("div",{style:{fontSize:14,color:"#94a3b8",marginBottom:8},children:e.name}),E.jsx("div",{style:{fontSize:13,color:"#cbd5e1"},children:f}),E.jsxs("div",{style:{fontSize:12,color:"#64748b",marginTop:16},children:[".avi files may use codecs not supported by this player.",E.jsx("br",{}),"Try converting to MP4 or use a different video format."]})]}):d?E.jsx("video",{src:d,controls:!0,autoPlay:!0,preload:"auto",playsInline:!0,style:{maxWidth:"100%",maxHeight:"100%"},onError:T=>{const F=T.currentTarget.error;let k="Unable to play video.";if(F)switch(F.code){case MediaError.MEDIA_ERR_ABORTED:k="Video playback was aborted.";break;case MediaError.MEDIA_ERR_NETWORK:k="Network error while loading video.";break;case MediaError.MEDIA_ERR_DECODE:k="Video codec not supported or file is corrupted.";break;case MediaError.MEDIA_ERR_SRC_NOT_SUPPORTED:k="Video format not supported.";break;default:k=F.message||`Error code: ${F.code}`}else k="Video failed to load (no error details available).";console.error("Video playback error:",k,F,"URL:",d),p(k)},onLoadedMetadata:()=>{console.log("Video metadata loaded successfully:",d),p(null)},onCanPlay:()=>{console.log("Video can play:",d),p(null)},onLoadStart:()=>{console.log("Video load started:",d)},children:"Your browser does not support the video tag or this video format."},d):E.jsx("div",{style:{padding:40,textAlign:"center",color:"#ffffff"},children:"Loading video..."})}),E.jsxs("div",{style:{width:"100%",maxWidth:800,padding:20,background:"rgba(30,41,59,0.8)",borderTop:"1px solid rgba(255,255,255,0.1)"},children:[E.jsxs("div",{style:{color:"#ffffff",marginBottom:12},children:[E.jsx("div",{style:{fontSize:16,fontWeight:600,marginBottom:4},children:e.name}),E.jsxs("div",{style:{fontSize:12,color:"#94a3b8"},children:[new Date(e.createdAt).toLocaleDateString(),"  ",e.type]})]}),c?E.jsxs("div",{children:[E.jsx("textarea",{value:a,onChange:T=>l(T.target.value),placeholder:"Add notes...",style:{width:"100%",minHeight:80,padding:8,border:"1px solid rgba(255,255,255,0.2)",borderRadius:4,background:"rgba(0,0,0,0.3)",color:"#ffffff",fontSize:13,fontFamily:"inherit",resize:"vertical"}}),E.jsxs("div",{style:{display:"flex",gap:8,marginTop:8},children:[E.jsx("button",{onClick:()=>void w(),style:{padding:"6px 12px",border:"1px solid #0a84ff",borderRadius:4,background:"#0a84ff",color:"#ffffff",cursor:"pointer",fontSize:12},children:"Save"}),E.jsx("button",{onClick:()=>{l(e.notes||""),u(!1)},style:{padding:"6px 12px",border:"1px solid rgba(255,255,255,0.2)",borderRadius:4,background:"transparent",color:"#ffffff",cursor:"pointer",fontSize:12},children:"Cancel"})]})]}):E.jsxs("div",{children:[E.jsx("div",{style:{padding:12,background:"rgba(0,0,0,0.3)",borderRadius:4,color:"#e2e8f0",fontSize:13,minHeight:60,whiteSpace:"pre-wrap"},children:e.notes||"No notes"}),E.jsx("button",{onClick:()=>u(!0),style:{marginTop:8,padding:"6px 12px",border:"1px solid rgba(255,255,255,0.2)",borderRadius:4,background:"transparent",color:"#ffffff",cursor:"pointer",fontSize:12},children:e.notes?"Edit Notes":"Add Notes"})]})]})]})})}const J1e=(t,e)=>{const n=t.replace(/\\/g,"/"),r=e.replace(/\\/g,"/");if(n.startsWith(r)){let s=n.slice(r.length).replace(/^\/+/,"");return s.startsWith("media/")&&(s=s.slice(6)),`media:///${s.split("/").map(a=>encodeURIComponent(a)).join("/")}`}const i=n.match(/media\/(.+)$/);return i?`media:///${i[1].split("/").map(o=>encodeURIComponent(o)).join("/")}`:""};function Q1e({onClose:t}){const{projectPath:e}=He(),{folders:n,files:r,currentFolderPath:i,setCurrentFolder:s,addFolder:o,updateFolder:a,deleteFolder:l,addFile:c,updateFile:u,deleteFile:d,moveFile:h,setSelectedFile:f,setViewerOpen:p,loadFromProject:m,saveToProject:_}=tp(),[g,y]=K.useState(!1),[v,w]=K.useState(""),[x,S]=K.useState(null),[C,T]=K.useState(""),P=K.useRef(null),[F,k]=K.useState({});K.useEffect(()=>{e&&m(e)},[e]);const A=K.useMemo(()=>r.filter(R=>(R.path.includes("/")?R.path.substring(0,R.path.lastIndexOf("/")):"")===i),[r,i]);K.useEffect(()=>{let R=!1;return!e||A.length===0?(k({}),()=>{R=!0}):((async()=>{const W={};for(const te of A)try{const ce=`media/${te.path.includes("/")?te.path:te.name}`,ge=await window.api.resolveMediaPath(e,ce);W[te.id]=J1e(ge,e)}catch(ee){console.error(`Failed to resolve path for ${te.name}`,ee),W[te.id]=""}R||k(W)})(),()=>{R=!0})},[e,A]);const M=n.filter(R=>(R.path.includes("/")?R.path.substring(0,R.path.lastIndexOf("/")):"")===i),b=(()=>{if(!i)return[];const R=i.split("/").filter(Boolean),L=[];for(let W=0;W<R.length;W++)L.push({name:R[W],path:R.slice(0,W+1).join("/")});return L})(),j=async()=>{if(!v.trim()||!e)return;const R=i?`${i}/${v.trim()}`:v.trim(),L={id:`folder_${Date.now()}_${Math.random().toString(36).slice(2)}`,name:v.trim(),path:R,createdAt:new Date().toISOString(),updatedAt:new Date().toISOString()};o(L),await _(e),w(""),y(!1)},V=async()=>{if(!e)return;const R=await window.api.chooseFiles([{name:"All Media Files",extensions:["jpg","jpeg","png","gif","webp","mp4","mov","avi","mkv","webm"]},{name:"Images",extensions:["jpg","jpeg","png","gif","webp"]},{name:"Videos",extensions:["mp4","mov","avi","mkv","webm"]},{name:"All Files",extensions:["*"]}]);if(!(!R||R.length===0)){for(const L of R){const W=L.split(/[/\\]/).pop()||"",te=/\.(mp4|mov|avi|mkv|webm)$/i.test(W),ee=/\.(jpg|jpeg|png|gif|webp)$/i.test(W);if(!te&&!ee)continue;const ce=await window.api.copyToMedia(e,L,i||void 0),Ce=(ce.startsWith("media/")?ce.slice(6):ce).split("/").pop()||W;console.log(`[upload] Original: ${W}, Copied path: ${ce}, Actual filename: ${Ce}`);const _t=i?`${i}/${Ce}`:Ce,vt={id:`file_${Date.now()}_${Math.random().toString(36).slice(2)}`,name:Ce,path:_t,type:te?"video":"image",createdAt:new Date().toISOString(),updatedAt:new Date().toISOString()};c(vt)}await _(e)}},H=R=>{f(R),p(!0)},U=async R=>{var W,te;if(!e||!window.confirm("Delete this file?"))return;const L=r.find(ee=>ee.id===R);if(L)try{const ee=await window.api.resolveMediaPath(e,`media/${L.path}`);await((te=(W=window.api).deleteFile)==null?void 0:te.call(W,ee))}catch{}d(R),await _(e)},B=async R=>{if(!e||!window.confirm("Delete this folder and all contents?"))return;const L=n.find(W=>W.id===R);L&&r.filter(W=>W.path.startsWith(L.path)).forEach(W=>{U(W.id)}),l(R),await _(e)},N=(R,L)=>{if(R==="file"){const W=r.find(te=>te.id===L);T((W==null?void 0:W.notes)||"")}else{const W=n.find(te=>te.id===L);T((W==null?void 0:W.notes)||"")}S({type:R,id:L})},O=async()=>{!x||!e||(x.type==="file"?u(x.id,{notes:C}):a(x.id,{notes:C}),await _(e),S(null),T(""))},$={position:"fixed",top:0,left:0,right:0,bottom:0,background:"rgba(0,0,0,0.5)",zIndex:2e3,display:"flex",alignItems:"center",justifyContent:"center"},G={width:"90%",maxWidth:1200,height:"85%",background:"#ffffff",borderRadius:8,boxShadow:"0 20px 60px rgba(0,0,0,0.3)",display:"flex",flexDirection:"column",overflow:"hidden"};return E.jsxs(E.Fragment,{children:[E.jsx("div",{style:$,onClick:R=>R.target===R.currentTarget&&t(),children:E.jsxs("div",{style:G,onClick:R=>R.stopPropagation(),children:[E.jsxs("div",{style:{padding:"16px 20px",borderBottom:"1px solid rgba(15,23,42,0.1)",display:"flex",justifyContent:"space-between",alignItems:"center"},children:[E.jsx("h2",{style:{margin:0,fontSize:18,fontWeight:600},children:"My Content"}),E.jsx("button",{onClick:t,style:{padding:"6px 12px",border:"1px solid rgba(15,23,42,0.2)",borderRadius:6,background:"#ffffff",cursor:"pointer",fontSize:13},children:"Close"})]}),E.jsxs("div",{style:{padding:"12px 20px",borderBottom:"1px solid rgba(15,23,42,0.1)",display:"flex",gap:8,alignItems:"center"},children:[E.jsxs("div",{style:{display:"flex",gap:4,alignItems:"center",flex:1},children:[E.jsx("button",{onClick:()=>s(""),style:{padding:"4px 8px",border:"none",background:"transparent",cursor:"pointer",fontSize:12,color:i?"#0a84ff":"#334155"},children:"Root"}),b.map((R,L)=>E.jsxs("span",{style:{display:"flex",alignItems:"center",gap:4},children:[E.jsx("span",{style:{color:"#94a3b8"},children:"/"}),E.jsx("button",{onClick:()=>s(R.path),style:{padding:"4px 8px",border:"none",background:"transparent",cursor:"pointer",fontSize:12,color:L===b.length-1?"#334155":"#0a84ff"},children:R.name})]},R.path))]}),g?E.jsxs("div",{style:{display:"flex",gap:4},children:[E.jsx("input",{ref:P,type:"text",value:v,onChange:R=>w(R.target.value),onKeyDown:R=>{R.key==="Enter"&&j(),R.key==="Escape"&&(y(!1),w(""))},placeholder:"Folder name",autoFocus:!0,style:{padding:"4px 8px",border:"1px solid rgba(15,23,42,0.2)",borderRadius:4,fontSize:12,width:150}}),E.jsx("button",{onClick:()=>void j(),style:{padding:"4px 8px",border:"1px solid #0a84ff",borderRadius:4,background:"#0a84ff",color:"#ffffff",cursor:"pointer",fontSize:12},children:"Create"}),E.jsx("button",{onClick:()=>{y(!1),w("")},style:{padding:"4px 8px",border:"1px solid rgba(15,23,42,0.2)",borderRadius:4,background:"#ffffff",cursor:"pointer",fontSize:12},children:"Cancel"})]}):E.jsx("button",{onClick:()=>y(!0),style:{padding:"6px 12px",border:"1px solid rgba(15,23,42,0.2)",borderRadius:6,background:"#ffffff",cursor:"pointer",fontSize:12},children:"New Folder"}),E.jsx("button",{onClick:()=>void V(),style:{padding:"6px 12px",border:"1px solid #0a84ff",borderRadius:6,background:"#0a84ff",color:"#ffffff",cursor:"pointer",fontSize:12,fontWeight:500},children:"Upload Files"})]}),E.jsxs("div",{style:{flex:1,overflow:"auto",padding:20},children:[x?E.jsxs("div",{style:{position:"absolute",top:"50%",left:"50%",transform:"translate(-50%, -50%)",background:"#ffffff",padding:20,borderRadius:8,boxShadow:"0 12px 40px rgba(0,0,0,0.2)",zIndex:3e3,minWidth:400},children:[E.jsx("h3",{style:{margin:"0 0 12px 0",fontSize:14,fontWeight:600},children:"Edit Notes"}),E.jsx("textarea",{value:C,onChange:R=>T(R.target.value),style:{width:"100%",minHeight:120,padding:8,border:"1px solid rgba(15,23,42,0.2)",borderRadius:4,fontSize:13,fontFamily:"inherit",resize:"vertical"},placeholder:"Add notes..."}),E.jsxs("div",{style:{display:"flex",gap:8,marginTop:12,justifyContent:"flex-end"},children:[E.jsx("button",{onClick:()=>{S(null),T("")},style:{padding:"6px 12px",border:"1px solid rgba(15,23,42,0.2)",borderRadius:4,background:"#ffffff",cursor:"pointer",fontSize:12},children:"Cancel"}),E.jsx("button",{onClick:()=>void O(),style:{padding:"6px 12px",border:"1px solid #0a84ff",borderRadius:4,background:"#0a84ff",color:"#ffffff",cursor:"pointer",fontSize:12},children:"Save"})]})]}):null,M.length>0&&E.jsxs("div",{style:{marginBottom:24},children:[E.jsx("h3",{style:{fontSize:13,fontWeight:600,marginBottom:12,color:"#64748b"},children:"Folders"}),E.jsx("div",{style:{display:"grid",gridTemplateColumns:"repeat(auto-fill, minmax(140px, 1fr))",gap:12},children:M.map(R=>E.jsxs("div",{style:{border:"1px solid rgba(15,23,42,0.1)",borderRadius:6,padding:12,cursor:"pointer",background:"#ffffff",transition:"all 0.2s"},onClick:()=>s(R.path),onMouseEnter:L=>{L.currentTarget.style.background="#f8fafc",L.currentTarget.style.borderColor="#0a84ff"},onMouseLeave:L=>{L.currentTarget.style.background="#ffffff",L.currentTarget.style.borderColor="rgba(15,23,42,0.1)"},children:[E.jsx("div",{style:{fontSize:32,marginBottom:8},children:""}),E.jsx("div",{style:{fontSize:12,fontWeight:500,marginBottom:4,overflow:"hidden",textOverflow:"ellipsis",whiteSpace:"nowrap"},children:R.name}),E.jsxs("div",{style:{fontSize:10,color:"#94a3b8"},children:[r.filter(L=>L.path.startsWith(R.path)).length," items"]}),E.jsxs("div",{style:{display:"flex",gap:4,marginTop:8},children:[E.jsx("button",{onClick:L=>{L.stopPropagation(),N("folder",R.id)},title:"Edit notes",style:{padding:"2px 6px",border:"none",background:"transparent",cursor:"pointer",fontSize:10,color:"#64748b"},children:""}),E.jsx("button",{onClick:L=>{L.stopPropagation(),B(R.id)},title:"Delete",style:{padding:"2px 6px",border:"none",background:"transparent",cursor:"pointer",fontSize:10,color:"#ef4444"},children:""})]})]},R.id))})]}),A.length>0&&E.jsxs("div",{children:[E.jsx("h3",{style:{fontSize:13,fontWeight:600,marginBottom:12,color:"#64748b"},children:"Files"}),E.jsx("div",{style:{display:"grid",gridTemplateColumns:"repeat(auto-fill, minmax(160px, 1fr))",gap:12},children:A.map(R=>{const L=F[R.id]||"";return E.jsxs("div",{style:{border:"1px solid rgba(15,23,42,0.1)",borderRadius:6,overflow:"hidden",background:"#ffffff",cursor:"pointer",transition:"all 0.2s"},onClick:()=>H(R),onMouseEnter:W=>{W.currentTarget.style.borderColor="#0a84ff",W.currentTarget.style.boxShadow="0 4px 12px rgba(10,132,255,0.15)"},onMouseLeave:W=>{W.currentTarget.style.borderColor="rgba(15,23,42,0.1)",W.currentTarget.style.boxShadow="none"},children:[R.type==="image"?E.jsx("img",{src:L,alt:R.name,style:{width:"100%",height:120,objectFit:"cover",display:"block"}}):E.jsx("div",{style:{width:"100%",height:120,background:"#1e293b",display:"flex",alignItems:"center",justifyContent:"center",color:"#ffffff",fontSize:32},children:""}),E.jsxs("div",{style:{padding:8},children:[E.jsx("div",{style:{fontSize:11,fontWeight:500,marginBottom:4,overflow:"hidden",textOverflow:"ellipsis",whiteSpace:"nowrap"},children:R.name}),E.jsxs("div",{style:{display:"flex",gap:4},children:[E.jsx("button",{onClick:W=>{W.stopPropagation(),N("file",R.id)},title:"Edit notes",style:{padding:"2px 6px",border:"none",background:"transparent",cursor:"pointer",fontSize:10,color:"#64748b"},children:""}),E.jsx("button",{onClick:W=>{W.stopPropagation(),U(R.id)},title:"Delete",style:{padding:"2px 6px",border:"none",background:"transparent",cursor:"pointer",fontSize:10,color:"#ef4444"},children:""})]})]})]},R.id)})})]}),M.length===0&&A.length===0&&E.jsx("div",{style:{textAlign:"center",padding:60,color:"#94a3b8",fontSize:14},children:i?"This folder is empty":"No content yet. Upload files or create a folder."})]})]})}),E.jsx(q1e,{})]})}function eEe(){const{projectPath:t}=He(),[e,n]=K.useState(!1);return t?E.jsxs(E.Fragment,{children:[E.jsx("button",{onClick:()=>n(!0),title:"My Content - Photos & Videos",style:{position:"fixed",top:12,left:500,padding:"8px 14px",borderRadius:6,border:"1px solid rgba(15,23,42,0.12)",background:"#ffffff",cursor:"pointer",fontSize:13,fontWeight:500,zIndex:1e3,boxShadow:"0 6px 18px rgba(15,23,42,0.12)"},children:"My Content"}),e&&E.jsx(Q1e,{onClose:()=>n(!1)})]}):null}function tEe(){var v;const t=Xi(w=>w.selected),e=Tr(),[n,r]=K.useState(!1),[i,s]=K.useState(""),o=(t==null?void 0:t.layerId)||void 0,a=(t==null?void 0:t.feature)||null,l=K.useMemo(()=>o?ja[o]:null,[o]),c=((v=a==null?void 0:a.getProperties)==null?void 0:v.call(a))||{},u=typeof c.name=="string"&&c.name.trim().length>0?c.name.trim():null,d=o==="trails"||!!o&&o in ja,[h,f]=K.useState(!1),p=()=>{var w,x;try{const S=(w=a.getGeometry)==null?void 0:w.call(a);if(!S||!e)return;const C=(x=S.getExtent)==null?void 0:x.call(S);if(C&&C.every(T=>typeof T=="number")){const T=[(C[0]+C[2])/2,(C[1]+C[3])/2],[P,F]=$1(T);window.dispatchEvent(new CustomEvent("map:jump-to",{detail:{lon:P,lat:F,zoom:17}}))}}catch{}},m=()=>{if(o){if(o==="trails"){window.dispatchEvent(new Event("delete-selected-trail")),Xi.getState().setSelected(null);return}window.dispatchEvent(new Event(`delete-feature-${o}`)),Xi.getState().setSelected(null)}},_=()=>{const w=!h;f(w);const x=w?`layer:enable-modify:${o}`:`layer:disable-modify:${o}`;window.dispatchEvent(new Event(x))};K.useMemo(()=>(f(!1),o&&window.dispatchEvent(new Event(`layer:disable-modify:${o}`)),null),[o,a]);const g=()=>{const w=String(i||"").trim();if(!w)return;const x=new Date,S=x.getFullYear(),C=String(x.getMonth()+1).padStart(2,"0"),T=String(x.getDate()).padStart(2,"0"),P=String(x.getHours()).padStart(2,"0"),F=String(x.getMinutes()).padStart(2,"0"),k=`[${S}-${C}-${T} ${P}:${F}] `,A=a.get("notes"),M=(A?String(A)+`
`:"")+k+w;a.set("notes",M),s(""),window.dispatchEvent(new Event(`layer:persist:${o}`))},y=K.useMemo(()=>{const w={...c};return delete w.geometry,w},[a]);return!t||!l||!o?null:E.jsxs("div",{style:{position:"fixed",left:12,bottom:12,padding:12,borderRadius:8,border:"1px solid rgba(0,0,0,0.12)",background:"rgba(255,255,255,0.96)",boxShadow:"0 16px 32px rgba(15,23,42,0.18)",zIndex:1800,minWidth:320,maxWidth:560},children:[E.jsxs("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center",marginBottom:8},children:[E.jsxs("div",{style:{display:"flex",flexDirection:"column"},children:[E.jsxs("span",{style:{fontWeight:600,fontSize:14},children:[l.icon?`${l.icon} `:"",u||l.label]}),u?E.jsx("span",{style:{fontSize:11,color:"rgba(15,23,42,0.6)"},children:l.label}):null]}),E.jsxs("div",{style:{display:"flex",gap:6},children:[E.jsx("button",{onClick:_,style:{fontSize:12,padding:"4px 8px"},children:h?"Stop Edit":"Edit geometry"}),E.jsx("button",{onClick:p,style:{fontSize:12,padding:"4px 8px"},children:"Zoom to"}),d?E.jsx("button",{onClick:m,style:{fontSize:12,padding:"4px 8px",color:"#c62828",borderColor:"rgba(198,40,40,0.3)"},children:"Delete"}):null,E.jsx("button",{onClick:()=>r(w=>!w),style:{fontSize:12,padding:"4px 8px"},children:n?"Close Edit":"Edit"})]})]}),n?E.jsx("div",{style:{marginTop:8},children:E.jsx(ea,{layerId:o,initialValues:y,onSubmit:w=>{a.setProperties(w),r(!1),window.dispatchEvent(new Event(`layer:persist:${o}`))},onCancel:()=>r(!1)})}):E.jsxs(E.Fragment,{children:[E.jsxs("div",{style:{fontSize:12,color:"rgba(0,0,0,0.7)",display:"flex",flexDirection:"column",gap:4},children:[Object.entries(c).filter(([w])=>!["geometry","name","imported_by","imported_at","created_by","created_at"].includes(w)).slice(0,10).map(([w,x])=>E.jsxs("div",{children:[E.jsx("strong",{children:w}),": ",Array.isArray(x)?x.join(", "):String(x)]},w)),(()=>{const w=[],x=typeof c.imported_by=="string"&&c.imported_by||typeof c.created_by=="string"&&c.created_by||"";x&&w.push({label:"Imported by",value:x});const S=c.imported_at||c.created_at||"";if(S){const C=new Date(S),T=Number.isNaN(C.getTime())?S:C.toLocaleString(void 0,{year:"numeric",month:"short",day:"2-digit",hour:"2-digit",minute:"2-digit"});w.push({label:"Imported at",value:T})}return w.map(C=>E.jsxs("div",{children:[E.jsx("strong",{children:C.label}),": ",C.value]},C.label))})()]}),E.jsxs("div",{style:{display:"flex",gap:6,marginTop:8},children:[E.jsx("input",{type:"text",value:i,onChange:w=>s(w.target.value),placeholder:"Quick note",style:{flex:1,fontSize:12,padding:"6px 8px",borderRadius:6,border:"1px solid #ddd"},onKeyDown:w=>{(w.metaKey||w.ctrlKey)&&w.key==="Enter"&&g()}}),E.jsx("button",{onClick:g,style:{fontSize:12,padding:"6px 10px"},children:"Save"})]})]})]})}const nEe={padding:"10px 12px",borderRadius:6,border:"1px solid rgba(15, 23, 42, 0.12)",background:"rgba(255, 255, 255, 0.94)",boxShadow:"0 12px 28px rgba(15, 23, 42, 0.12)",width:"100%",fontSize:12,color:"rgba(15,23,42,0.75)"},FI=t=>({padding:"4px 8px",borderRadius:999,border:`1px solid ${t?"rgba(10,132,255,0.45)":"rgba(15,23,42,0.15)"}`,background:t?"rgba(10,132,255,0.12)":"rgba(247,249,252,0.9)",color:t?"#0a84ff":"rgba(15,23,42,0.75)",cursor:"pointer",userSelect:"none"}),rEe=["whitetail","turkey","bear","fisher","coyote","bobcat","other"],iEe=["scat","tracks","bed","rub","scrape","feathers","kill_site","hair","other"];function sEe(){const[t,e]=K.useState(!1),n=Fn(f=>f.species),r=Fn(f=>f.toggleSpecies),i=Fn(f=>f.signTypes),s=Fn(f=>f.toggleSignType),o=Fn(f=>f.onlyMine),a=Fn(f=>f.setOnlyMine),l=Fn(f=>f.temporalView),c=Fn(f=>f.setTemporalView),u=It(f=>f.timeWindow),d=It(f=>f.setTimeWindow),h=Fn(f=>f.clear);return t?E.jsxs("div",{style:nEe,children:[E.jsxs("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center"},children:[E.jsxs("div",{onClick:()=>e(!1),style:{display:"flex",alignItems:"center",gap:10,cursor:"pointer"},title:"Click to collapse",children:[E.jsx("span",{style:{fontSize:12,fontWeight:600},children:"Filters"}),E.jsx("button",{onClick:()=>e(!1),style:{border:"none",background:"transparent",fontSize:12,color:"rgba(15,23,42,0.55)",cursor:"pointer"},children:"Hide"})]}),E.jsx("div",{style:{display:"flex",gap:6},children:E.jsx("button",{onClick:()=>h(),style:{border:"1px solid rgba(15,23,42,0.12)",background:"rgba(255,255,255,0.96)",fontSize:11,cursor:"pointer",borderRadius:4,padding:"2px 6px"},children:"Clear"})})]}),E.jsxs("div",{style:{display:"flex",flexDirection:"column",gap:8,marginTop:8},children:[E.jsxs("div",{children:[E.jsx("div",{style:{marginBottom:6,fontWeight:600},children:"Species"}),E.jsx("div",{style:{display:"flex",flexWrap:"wrap",gap:6},children:rEe.map(f=>{const p=n.has(f);return E.jsx("span",{style:FI(p),onClick:()=>r(f),children:f},f)})})]}),E.jsxs("div",{children:[E.jsx("div",{style:{marginBottom:6,fontWeight:600},children:"Sign type"}),E.jsx("div",{style:{display:"flex",flexWrap:"wrap",gap:6},children:iEe.map(f=>{const p=i.has(f);return E.jsx("span",{style:FI(p),onClick:()=>s(f),children:f},f)})})]}),E.jsxs("label",{style:{display:"flex",alignItems:"center",gap:8,cursor:"pointer"},children:[E.jsx("input",{type:"checkbox",checked:o,onChange:f=>a(f.target.checked)}),"Only mine"]}),E.jsx("hr",{style:{border:"none",borderTop:"1px solid rgba(15,23,42,0.12)"}}),E.jsxs("div",{style:{display:"flex",alignItems:"center",gap:10,flexWrap:"wrap"},children:[E.jsx("div",{style:{fontWeight:600},children:"Time"}),E.jsxs("label",{style:{display:"flex",alignItems:"center",gap:6,cursor:"pointer"},children:[E.jsx("input",{type:"radio",name:"tw",checked:u==="all"&&l==="all",onChange:()=>{d("all"),c("all")}}),"All"]}),E.jsxs("label",{style:{display:"flex",alignItems:"center",gap:6,cursor:"pointer"},children:[E.jsx("input",{type:"radio",name:"tw",checked:u==="1y",onChange:()=>{d("1y"),c("all")}}),"1 year"]}),E.jsxs("label",{style:{display:"flex",alignItems:"center",gap:6,cursor:"pointer"},children:[E.jsx("input",{type:"radio",name:"tw",checked:u==="5y",onChange:()=>{d("5y"),c("all")}}),"5 years"]}),E.jsxs("label",{style:{display:"flex",alignItems:"center",gap:6,cursor:"pointer"},children:[E.jsx("input",{type:"radio",name:"tw",checked:l==="permanentOnly",onChange:()=>{c("permanentOnly"),d("all")}}),"Historical (permanent)"]}),E.jsxs("label",{style:{display:"flex",alignItems:"center",gap:6,cursor:"pointer"},children:[E.jsx("input",{type:"radio",name:"tw",checked:l==="recentOnly",onChange:()=>{c("recentOnly"),d("all")}}),"Recent only"]})]})]})]}):E.jsx("button",{onClick:()=>e(!0),style:{padding:"6px 12px",borderRadius:6,border:"1px solid rgba(15,23,42,0.12)",background:"rgba(255,255,255,0.92)",fontSize:12,cursor:"pointer",color:"rgba(15,23,42,0.75)",boxShadow:"0 4px 12px rgba(15,23,42,0.08)",width:"100%",textAlign:"left"},children:"Filters"})}function oEe(){const t=Ve(a=>a.activeUser),e=Ve(a=>a.users),n=Ve(a=>a.setActiveUser),r=Ve(a=>a.loadUsers),i=Ve(a=>a.addUser),[s,o]=K.useState("");return K.useEffect(()=>{r()},[r]),E.jsxs("div",{style:{padding:"8px 10px",borderRadius:6,border:"1px solid rgba(15,23,42,0.12)",background:"rgba(255,255,255,0.94)",boxShadow:"0 8px 18px rgba(15,23,42,0.12)",display:"flex",flexDirection:"column",gap:6,width:"100%"},children:[E.jsxs("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center"},children:[E.jsx("strong",{style:{fontSize:12,color:"rgba(15,23,42,0.75)"},children:"Active User"}),E.jsxs("select",{value:t||"",onChange:a=>void n(a.target.value||null),style:{fontSize:12,padding:"2px 6px"},children:[E.jsx("option",{value:"",children:""}),e.map(a=>E.jsx("option",{value:a,children:a},a))]})]}),E.jsxs("div",{style:{display:"flex",gap:6},children:[E.jsx("input",{type:"text",placeholder:"Add user",value:s,onChange:a=>o(a.target.value),style:{flex:1,fontSize:12,padding:"6px 8px",borderRadius:6,border:"1px solid rgba(15,23,42,0.15)"},onKeyDown:a=>{a.key==="Enter"&&s.trim()&&(i(s.trim()),o(""))}}),E.jsx("button",{onClick:()=>{s.trim()&&(i(s.trim()),o(""))},style:{fontSize:12,padding:"6px 10px"},children:"Add"})]})]})}function wg(t){throw new Error('Could not dynamically require "'+t+'". Please configure the dynamicRequireTargets or/and ignoreDynamicRequires option of @rollup/plugin-commonjs appropriately for this require call to work.')}var BN={exports:{}};/*!

JSZip v3.10.1 - A JavaScript class for generating and reading zip files
<http://stuartk.com/jszip>

(c) 2009-2016 Stuart Knightley <stuart [at] stuartk.com>
Dual licenced under the MIT license or GPLv3. See https://raw.github.com/Stuk/jszip/main/LICENSE.markdown.

JSZip uses the library pako released under the MIT license :
https://github.com/nodeca/pako/blob/main/LICENSE
*/(function(t,e){(function(n){t.exports=n()})(function(){return function n(r,i,s){function o(c,u){if(!i[c]){if(!r[c]){var d=typeof wg=="function"&&wg;if(!u&&d)return d(c,!0);if(a)return a(c,!0);var h=new Error("Cannot find module '"+c+"'");throw h.code="MODULE_NOT_FOUND",h}var f=i[c]={exports:{}};r[c][0].call(f.exports,function(p){var m=r[c][1][p];return o(m||p)},f,f.exports,n,r,i,s)}return i[c].exports}for(var a=typeof wg=="function"&&wg,l=0;l<s.length;l++)o(s[l]);return o}({1:[function(n,r,i){var s=n("./utils"),o=n("./support"),a="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=";i.encode=function(l){for(var c,u,d,h,f,p,m,_=[],g=0,y=l.length,v=y,w=s.getTypeOf(l)!=="string";g<l.length;)v=y-g,d=w?(c=l[g++],u=g<y?l[g++]:0,g<y?l[g++]:0):(c=l.charCodeAt(g++),u=g<y?l.charCodeAt(g++):0,g<y?l.charCodeAt(g++):0),h=c>>2,f=(3&c)<<4|u>>4,p=1<v?(15&u)<<2|d>>6:64,m=2<v?63&d:64,_.push(a.charAt(h)+a.charAt(f)+a.charAt(p)+a.charAt(m));return _.join("")},i.decode=function(l){var c,u,d,h,f,p,m=0,_=0,g="data:";if(l.substr(0,g.length)===g)throw new Error("Invalid base64 input, it looks like a data url.");var y,v=3*(l=l.replace(/[^A-Za-z0-9+/=]/g,"")).length/4;if(l.charAt(l.length-1)===a.charAt(64)&&v--,l.charAt(l.length-2)===a.charAt(64)&&v--,v%1!=0)throw new Error("Invalid base64 input, bad content length.");for(y=o.uint8array?new Uint8Array(0|v):new Array(0|v);m<l.length;)c=a.indexOf(l.charAt(m++))<<2|(h=a.indexOf(l.charAt(m++)))>>4,u=(15&h)<<4|(f=a.indexOf(l.charAt(m++)))>>2,d=(3&f)<<6|(p=a.indexOf(l.charAt(m++))),y[_++]=c,f!==64&&(y[_++]=u),p!==64&&(y[_++]=d);return y}},{"./support":30,"./utils":32}],2:[function(n,r,i){var s=n("./external"),o=n("./stream/DataWorker"),a=n("./stream/Crc32Probe"),l=n("./stream/DataLengthProbe");function c(u,d,h,f,p){this.compressedSize=u,this.uncompressedSize=d,this.crc32=h,this.compression=f,this.compressedContent=p}c.prototype={getContentWorker:function(){var u=new o(s.Promise.resolve(this.compressedContent)).pipe(this.compression.uncompressWorker()).pipe(new l("data_length")),d=this;return u.on("end",function(){if(this.streamInfo.data_length!==d.uncompressedSize)throw new Error("Bug : uncompressed data size mismatch")}),u},getCompressedWorker:function(){return new o(s.Promise.resolve(this.compressedContent)).withStreamInfo("compressedSize",this.compressedSize).withStreamInfo("uncompressedSize",this.uncompressedSize).withStreamInfo("crc32",this.crc32).withStreamInfo("compression",this.compression)}},c.createWorkerFrom=function(u,d,h){return u.pipe(new a).pipe(new l("uncompressedSize")).pipe(d.compressWorker(h)).pipe(new l("compressedSize")).withStreamInfo("compression",d)},r.exports=c},{"./external":6,"./stream/Crc32Probe":25,"./stream/DataLengthProbe":26,"./stream/DataWorker":27}],3:[function(n,r,i){var s=n("./stream/GenericWorker");i.STORE={magic:"\0\0",compressWorker:function(){return new s("STORE compression")},uncompressWorker:function(){return new s("STORE decompression")}},i.DEFLATE=n("./flate")},{"./flate":7,"./stream/GenericWorker":28}],4:[function(n,r,i){var s=n("./utils"),o=function(){for(var a,l=[],c=0;c<256;c++){a=c;for(var u=0;u<8;u++)a=1&a?3988292384^a>>>1:a>>>1;l[c]=a}return l}();r.exports=function(a,l){return a!==void 0&&a.length?s.getTypeOf(a)!=="string"?function(c,u,d,h){var f=o,p=h+d;c^=-1;for(var m=h;m<p;m++)c=c>>>8^f[255&(c^u[m])];return-1^c}(0|l,a,a.length,0):function(c,u,d,h){var f=o,p=h+d;c^=-1;for(var m=h;m<p;m++)c=c>>>8^f[255&(c^u.charCodeAt(m))];return-1^c}(0|l,a,a.length,0):0}},{"./utils":32}],5:[function(n,r,i){i.base64=!1,i.binary=!1,i.dir=!1,i.createFolders=!0,i.date=null,i.compression=null,i.compressionOptions=null,i.comment=null,i.unixPermissions=null,i.dosPermissions=null},{}],6:[function(n,r,i){var s=null;s=typeof Promise<"u"?Promise:n("lie"),r.exports={Promise:s}},{lie:37}],7:[function(n,r,i){var s=typeof Uint8Array<"u"&&typeof Uint16Array<"u"&&typeof Uint32Array<"u",o=n("pako"),a=n("./utils"),l=n("./stream/GenericWorker"),c=s?"uint8array":"array";function u(d,h){l.call(this,"FlateWorker/"+d),this._pako=null,this._pakoAction=d,this._pakoOptions=h,this.meta={}}i.magic="\b\0",a.inherits(u,l),u.prototype.processChunk=function(d){this.meta=d.meta,this._pako===null&&this._createPako(),this._pako.push(a.transformTo(c,d.data),!1)},u.prototype.flush=function(){l.prototype.flush.call(this),this._pako===null&&this._createPako(),this._pako.push([],!0)},u.prototype.cleanUp=function(){l.prototype.cleanUp.call(this),this._pako=null},u.prototype._createPako=function(){this._pako=new o[this._pakoAction]({raw:!0,level:this._pakoOptions.level||-1});var d=this;this._pako.onData=function(h){d.push({data:h,meta:d.meta})}},i.compressWorker=function(d){return new u("Deflate",d)},i.uncompressWorker=function(){return new u("Inflate",{})}},{"./stream/GenericWorker":28,"./utils":32,pako:38}],8:[function(n,r,i){function s(f,p){var m,_="";for(m=0;m<p;m++)_+=String.fromCharCode(255&f),f>>>=8;return _}function o(f,p,m,_,g,y){var v,w,x=f.file,S=f.compression,C=y!==c.utf8encode,T=a.transformTo("string",y(x.name)),P=a.transformTo("string",c.utf8encode(x.name)),F=x.comment,k=a.transformTo("string",y(F)),A=a.transformTo("string",c.utf8encode(F)),M=P.length!==x.name.length,b=A.length!==F.length,j="",V="",H="",U=x.dir,B=x.date,N={crc32:0,compressedSize:0,uncompressedSize:0};p&&!m||(N.crc32=f.crc32,N.compressedSize=f.compressedSize,N.uncompressedSize=f.uncompressedSize);var O=0;p&&(O|=8),C||!M&&!b||(O|=2048);var $=0,G=0;U&&($|=16),g==="UNIX"?(G=798,$|=function(L,W){var te=L;return L||(te=W?16893:33204),(65535&te)<<16}(x.unixPermissions,U)):(G=20,$|=function(L){return 63&(L||0)}(x.dosPermissions)),v=B.getUTCHours(),v<<=6,v|=B.getUTCMinutes(),v<<=5,v|=B.getUTCSeconds()/2,w=B.getUTCFullYear()-1980,w<<=4,w|=B.getUTCMonth()+1,w<<=5,w|=B.getUTCDate(),M&&(V=s(1,1)+s(u(T),4)+P,j+="up"+s(V.length,2)+V),b&&(H=s(1,1)+s(u(k),4)+A,j+="uc"+s(H.length,2)+H);var R="";return R+=`
\0`,R+=s(O,2),R+=S.magic,R+=s(v,2),R+=s(w,2),R+=s(N.crc32,4),R+=s(N.compressedSize,4),R+=s(N.uncompressedSize,4),R+=s(T.length,2),R+=s(j.length,2),{fileRecord:d.LOCAL_FILE_HEADER+R+T+j,dirRecord:d.CENTRAL_FILE_HEADER+s(G,2)+R+s(k.length,2)+"\0\0\0\0"+s($,4)+s(_,4)+T+j+k}}var a=n("../utils"),l=n("../stream/GenericWorker"),c=n("../utf8"),u=n("../crc32"),d=n("../signature");function h(f,p,m,_){l.call(this,"ZipFileWorker"),this.bytesWritten=0,this.zipComment=p,this.zipPlatform=m,this.encodeFileName=_,this.streamFiles=f,this.accumulate=!1,this.contentBuffer=[],this.dirRecords=[],this.currentSourceOffset=0,this.entriesCount=0,this.currentFile=null,this._sources=[]}a.inherits(h,l),h.prototype.push=function(f){var p=f.meta.percent||0,m=this.entriesCount,_=this._sources.length;this.accumulate?this.contentBuffer.push(f):(this.bytesWritten+=f.data.length,l.prototype.push.call(this,{data:f.data,meta:{currentFile:this.currentFile,percent:m?(p+100*(m-_-1))/m:100}}))},h.prototype.openedSource=function(f){this.currentSourceOffset=this.bytesWritten,this.currentFile=f.file.name;var p=this.streamFiles&&!f.file.dir;if(p){var m=o(f,p,!1,this.currentSourceOffset,this.zipPlatform,this.encodeFileName);this.push({data:m.fileRecord,meta:{percent:0}})}else this.accumulate=!0},h.prototype.closedSource=function(f){this.accumulate=!1;var p=this.streamFiles&&!f.file.dir,m=o(f,p,!0,this.currentSourceOffset,this.zipPlatform,this.encodeFileName);if(this.dirRecords.push(m.dirRecord),p)this.push({data:function(_){return d.DATA_DESCRIPTOR+s(_.crc32,4)+s(_.compressedSize,4)+s(_.uncompressedSize,4)}(f),meta:{percent:100}});else for(this.push({data:m.fileRecord,meta:{percent:0}});this.contentBuffer.length;)this.push(this.contentBuffer.shift());this.currentFile=null},h.prototype.flush=function(){for(var f=this.bytesWritten,p=0;p<this.dirRecords.length;p++)this.push({data:this.dirRecords[p],meta:{percent:100}});var m=this.bytesWritten-f,_=function(g,y,v,w,x){var S=a.transformTo("string",x(w));return d.CENTRAL_DIRECTORY_END+"\0\0\0\0"+s(g,2)+s(g,2)+s(y,4)+s(v,4)+s(S.length,2)+S}(this.dirRecords.length,m,f,this.zipComment,this.encodeFileName);this.push({data:_,meta:{percent:100}})},h.prototype.prepareNextSource=function(){this.previous=this._sources.shift(),this.openedSource(this.previous.streamInfo),this.isPaused?this.previous.pause():this.previous.resume()},h.prototype.registerPrevious=function(f){this._sources.push(f);var p=this;return f.on("data",function(m){p.processChunk(m)}),f.on("end",function(){p.closedSource(p.previous.streamInfo),p._sources.length?p.prepareNextSource():p.end()}),f.on("error",function(m){p.error(m)}),this},h.prototype.resume=function(){return!!l.prototype.resume.call(this)&&(!this.previous&&this._sources.length?(this.prepareNextSource(),!0):this.previous||this._sources.length||this.generatedError?void 0:(this.end(),!0))},h.prototype.error=function(f){var p=this._sources;if(!l.prototype.error.call(this,f))return!1;for(var m=0;m<p.length;m++)try{p[m].error(f)}catch{}return!0},h.prototype.lock=function(){l.prototype.lock.call(this);for(var f=this._sources,p=0;p<f.length;p++)f[p].lock()},r.exports=h},{"../crc32":4,"../signature":23,"../stream/GenericWorker":28,"../utf8":31,"../utils":32}],9:[function(n,r,i){var s=n("../compressions"),o=n("./ZipFileWorker");i.generateWorker=function(a,l,c){var u=new o(l.streamFiles,c,l.platform,l.encodeFileName),d=0;try{a.forEach(function(h,f){d++;var p=function(y,v){var w=y||v,x=s[w];if(!x)throw new Error(w+" is not a valid compression method !");return x}(f.options.compression,l.compression),m=f.options.compressionOptions||l.compressionOptions||{},_=f.dir,g=f.date;f._compressWorker(p,m).withStreamInfo("file",{name:h,dir:_,date:g,comment:f.comment||"",unixPermissions:f.unixPermissions,dosPermissions:f.dosPermissions}).pipe(u)}),u.entriesCount=d}catch(h){u.error(h)}return u}},{"../compressions":3,"./ZipFileWorker":8}],10:[function(n,r,i){function s(){if(!(this instanceof s))return new s;if(arguments.length)throw new Error("The constructor with parameters has been removed in JSZip 3.0, please check the upgrade guide.");this.files=Object.create(null),this.comment=null,this.root="",this.clone=function(){var o=new s;for(var a in this)typeof this[a]!="function"&&(o[a]=this[a]);return o}}(s.prototype=n("./object")).loadAsync=n("./load"),s.support=n("./support"),s.defaults=n("./defaults"),s.version="3.10.1",s.loadAsync=function(o,a){return new s().loadAsync(o,a)},s.external=n("./external"),r.exports=s},{"./defaults":5,"./external":6,"./load":11,"./object":15,"./support":30}],11:[function(n,r,i){var s=n("./utils"),o=n("./external"),a=n("./utf8"),l=n("./zipEntries"),c=n("./stream/Crc32Probe"),u=n("./nodejsUtils");function d(h){return new o.Promise(function(f,p){var m=h.decompressed.getContentWorker().pipe(new c);m.on("error",function(_){p(_)}).on("end",function(){m.streamInfo.crc32!==h.decompressed.crc32?p(new Error("Corrupted zip : CRC32 mismatch")):f()}).resume()})}r.exports=function(h,f){var p=this;return f=s.extend(f||{},{base64:!1,checkCRC32:!1,optimizedBinaryString:!1,createFolders:!1,decodeFileName:a.utf8decode}),u.isNode&&u.isStream(h)?o.Promise.reject(new Error("JSZip can't accept a stream when loading a zip file.")):s.prepareContent("the loaded zip file",h,!0,f.optimizedBinaryString,f.base64).then(function(m){var _=new l(f);return _.load(m),_}).then(function(m){var _=[o.Promise.resolve(m)],g=m.files;if(f.checkCRC32)for(var y=0;y<g.length;y++)_.push(d(g[y]));return o.Promise.all(_)}).then(function(m){for(var _=m.shift(),g=_.files,y=0;y<g.length;y++){var v=g[y],w=v.fileNameStr,x=s.resolve(v.fileNameStr);p.file(x,v.decompressed,{binary:!0,optimizedBinaryString:!0,date:v.date,dir:v.dir,comment:v.fileCommentStr.length?v.fileCommentStr:null,unixPermissions:v.unixPermissions,dosPermissions:v.dosPermissions,createFolders:f.createFolders}),v.dir||(p.file(x).unsafeOriginalName=w)}return _.zipComment.length&&(p.comment=_.zipComment),p})}},{"./external":6,"./nodejsUtils":14,"./stream/Crc32Probe":25,"./utf8":31,"./utils":32,"./zipEntries":33}],12:[function(n,r,i){var s=n("../utils"),o=n("../stream/GenericWorker");function a(l,c){o.call(this,"Nodejs stream input adapter for "+l),this._upstreamEnded=!1,this._bindStream(c)}s.inherits(a,o),a.prototype._bindStream=function(l){var c=this;(this._stream=l).pause(),l.on("data",function(u){c.push({data:u,meta:{percent:0}})}).on("error",function(u){c.isPaused?this.generatedError=u:c.error(u)}).on("end",function(){c.isPaused?c._upstreamEnded=!0:c.end()})},a.prototype.pause=function(){return!!o.prototype.pause.call(this)&&(this._stream.pause(),!0)},a.prototype.resume=function(){return!!o.prototype.resume.call(this)&&(this._upstreamEnded?this.end():this._stream.resume(),!0)},r.exports=a},{"../stream/GenericWorker":28,"../utils":32}],13:[function(n,r,i){var s=n("readable-stream").Readable;function o(a,l,c){s.call(this,l),this._helper=a;var u=this;a.on("data",function(d,h){u.push(d)||u._helper.pause(),c&&c(h)}).on("error",function(d){u.emit("error",d)}).on("end",function(){u.push(null)})}n("../utils").inherits(o,s),o.prototype._read=function(){this._helper.resume()},r.exports=o},{"../utils":32,"readable-stream":16}],14:[function(n,r,i){r.exports={isNode:typeof Buffer<"u",newBufferFrom:function(s,o){if(Buffer.from&&Buffer.from!==Uint8Array.from)return Buffer.from(s,o);if(typeof s=="number")throw new Error('The "data" argument must not be a number');return new Buffer(s,o)},allocBuffer:function(s){if(Buffer.alloc)return Buffer.alloc(s);var o=new Buffer(s);return o.fill(0),o},isBuffer:function(s){return Buffer.isBuffer(s)},isStream:function(s){return s&&typeof s.on=="function"&&typeof s.pause=="function"&&typeof s.resume=="function"}}},{}],15:[function(n,r,i){function s(x,S,C){var T,P=a.getTypeOf(S),F=a.extend(C||{},u);F.date=F.date||new Date,F.compression!==null&&(F.compression=F.compression.toUpperCase()),typeof F.unixPermissions=="string"&&(F.unixPermissions=parseInt(F.unixPermissions,8)),F.unixPermissions&&16384&F.unixPermissions&&(F.dir=!0),F.dosPermissions&&16&F.dosPermissions&&(F.dir=!0),F.dir&&(x=g(x)),F.createFolders&&(T=_(x))&&y.call(this,T,!0);var k=P==="string"&&F.binary===!1&&F.base64===!1;C&&C.binary!==void 0||(F.binary=!k),(S instanceof d&&S.uncompressedSize===0||F.dir||!S||S.length===0)&&(F.base64=!1,F.binary=!0,S="",F.compression="STORE",P="string");var A=null;A=S instanceof d||S instanceof l?S:p.isNode&&p.isStream(S)?new m(x,S):a.prepareContent(x,S,F.binary,F.optimizedBinaryString,F.base64);var M=new h(x,A,F);this.files[x]=M}var o=n("./utf8"),a=n("./utils"),l=n("./stream/GenericWorker"),c=n("./stream/StreamHelper"),u=n("./defaults"),d=n("./compressedObject"),h=n("./zipObject"),f=n("./generate"),p=n("./nodejsUtils"),m=n("./nodejs/NodejsStreamInputAdapter"),_=function(x){x.slice(-1)==="/"&&(x=x.substring(0,x.length-1));var S=x.lastIndexOf("/");return 0<S?x.substring(0,S):""},g=function(x){return x.slice(-1)!=="/"&&(x+="/"),x},y=function(x,S){return S=S!==void 0?S:u.createFolders,x=g(x),this.files[x]||s.call(this,x,null,{dir:!0,createFolders:S}),this.files[x]};function v(x){return Object.prototype.toString.call(x)==="[object RegExp]"}var w={load:function(){throw new Error("This method has been removed in JSZip 3.0, please check the upgrade guide.")},forEach:function(x){var S,C,T;for(S in this.files)T=this.files[S],(C=S.slice(this.root.length,S.length))&&S.slice(0,this.root.length)===this.root&&x(C,T)},filter:function(x){var S=[];return this.forEach(function(C,T){x(C,T)&&S.push(T)}),S},file:function(x,S,C){if(arguments.length!==1)return x=this.root+x,s.call(this,x,S,C),this;if(v(x)){var T=x;return this.filter(function(F,k){return!k.dir&&T.test(F)})}var P=this.files[this.root+x];return P&&!P.dir?P:null},folder:function(x){if(!x)return this;if(v(x))return this.filter(function(P,F){return F.dir&&x.test(P)});var S=this.root+x,C=y.call(this,S),T=this.clone();return T.root=C.name,T},remove:function(x){x=this.root+x;var S=this.files[x];if(S||(x.slice(-1)!=="/"&&(x+="/"),S=this.files[x]),S&&!S.dir)delete this.files[x];else for(var C=this.filter(function(P,F){return F.name.slice(0,x.length)===x}),T=0;T<C.length;T++)delete this.files[C[T].name];return this},generate:function(){throw new Error("This method has been removed in JSZip 3.0, please check the upgrade guide.")},generateInternalStream:function(x){var S,C={};try{if((C=a.extend(x||{},{streamFiles:!1,compression:"STORE",compressionOptions:null,type:"",platform:"DOS",comment:null,mimeType:"application/zip",encodeFileName:o.utf8encode})).type=C.type.toLowerCase(),C.compression=C.compression.toUpperCase(),C.type==="binarystring"&&(C.type="string"),!C.type)throw new Error("No output type specified.");a.checkSupport(C.type),C.platform!=="darwin"&&C.platform!=="freebsd"&&C.platform!=="linux"&&C.platform!=="sunos"||(C.platform="UNIX"),C.platform==="win32"&&(C.platform="DOS");var T=C.comment||this.comment||"";S=f.generateWorker(this,C,T)}catch(P){(S=new l("error")).error(P)}return new c(S,C.type||"string",C.mimeType)},generateAsync:function(x,S){return this.generateInternalStream(x).accumulate(S)},generateNodeStream:function(x,S){return(x=x||{}).type||(x.type="nodebuffer"),this.generateInternalStream(x).toNodejsStream(S)}};r.exports=w},{"./compressedObject":2,"./defaults":5,"./generate":9,"./nodejs/NodejsStreamInputAdapter":12,"./nodejsUtils":14,"./stream/GenericWorker":28,"./stream/StreamHelper":29,"./utf8":31,"./utils":32,"./zipObject":35}],16:[function(n,r,i){r.exports=n("stream")},{stream:void 0}],17:[function(n,r,i){var s=n("./DataReader");function o(a){s.call(this,a);for(var l=0;l<this.data.length;l++)a[l]=255&a[l]}n("../utils").inherits(o,s),o.prototype.byteAt=function(a){return this.data[this.zero+a]},o.prototype.lastIndexOfSignature=function(a){for(var l=a.charCodeAt(0),c=a.charCodeAt(1),u=a.charCodeAt(2),d=a.charCodeAt(3),h=this.length-4;0<=h;--h)if(this.data[h]===l&&this.data[h+1]===c&&this.data[h+2]===u&&this.data[h+3]===d)return h-this.zero;return-1},o.prototype.readAndCheckSignature=function(a){var l=a.charCodeAt(0),c=a.charCodeAt(1),u=a.charCodeAt(2),d=a.charCodeAt(3),h=this.readData(4);return l===h[0]&&c===h[1]&&u===h[2]&&d===h[3]},o.prototype.readData=function(a){if(this.checkOffset(a),a===0)return[];var l=this.data.slice(this.zero+this.index,this.zero+this.index+a);return this.index+=a,l},r.exports=o},{"../utils":32,"./DataReader":18}],18:[function(n,r,i){var s=n("../utils");function o(a){this.data=a,this.length=a.length,this.index=0,this.zero=0}o.prototype={checkOffset:function(a){this.checkIndex(this.index+a)},checkIndex:function(a){if(this.length<this.zero+a||a<0)throw new Error("End of data reached (data length = "+this.length+", asked index = "+a+"). Corrupted zip ?")},setIndex:function(a){this.checkIndex(a),this.index=a},skip:function(a){this.setIndex(this.index+a)},byteAt:function(){},readInt:function(a){var l,c=0;for(this.checkOffset(a),l=this.index+a-1;l>=this.index;l--)c=(c<<8)+this.byteAt(l);return this.index+=a,c},readString:function(a){return s.transformTo("string",this.readData(a))},readData:function(){},lastIndexOfSignature:function(){},readAndCheckSignature:function(){},readDate:function(){var a=this.readInt(4);return new Date(Date.UTC(1980+(a>>25&127),(a>>21&15)-1,a>>16&31,a>>11&31,a>>5&63,(31&a)<<1))}},r.exports=o},{"../utils":32}],19:[function(n,r,i){var s=n("./Uint8ArrayReader");function o(a){s.call(this,a)}n("../utils").inherits(o,s),o.prototype.readData=function(a){this.checkOffset(a);var l=this.data.slice(this.zero+this.index,this.zero+this.index+a);return this.index+=a,l},r.exports=o},{"../utils":32,"./Uint8ArrayReader":21}],20:[function(n,r,i){var s=n("./DataReader");function o(a){s.call(this,a)}n("../utils").inherits(o,s),o.prototype.byteAt=function(a){return this.data.charCodeAt(this.zero+a)},o.prototype.lastIndexOfSignature=function(a){return this.data.lastIndexOf(a)-this.zero},o.prototype.readAndCheckSignature=function(a){return a===this.readData(4)},o.prototype.readData=function(a){this.checkOffset(a);var l=this.data.slice(this.zero+this.index,this.zero+this.index+a);return this.index+=a,l},r.exports=o},{"../utils":32,"./DataReader":18}],21:[function(n,r,i){var s=n("./ArrayReader");function o(a){s.call(this,a)}n("../utils").inherits(o,s),o.prototype.readData=function(a){if(this.checkOffset(a),a===0)return new Uint8Array(0);var l=this.data.subarray(this.zero+this.index,this.zero+this.index+a);return this.index+=a,l},r.exports=o},{"../utils":32,"./ArrayReader":17}],22:[function(n,r,i){var s=n("../utils"),o=n("../support"),a=n("./ArrayReader"),l=n("./StringReader"),c=n("./NodeBufferReader"),u=n("./Uint8ArrayReader");r.exports=function(d){var h=s.getTypeOf(d);return s.checkSupport(h),h!=="string"||o.uint8array?h==="nodebuffer"?new c(d):o.uint8array?new u(s.transformTo("uint8array",d)):new a(s.transformTo("array",d)):new l(d)}},{"../support":30,"../utils":32,"./ArrayReader":17,"./NodeBufferReader":19,"./StringReader":20,"./Uint8ArrayReader":21}],23:[function(n,r,i){i.LOCAL_FILE_HEADER="PK",i.CENTRAL_FILE_HEADER="PK",i.CENTRAL_DIRECTORY_END="PK",i.ZIP64_CENTRAL_DIRECTORY_LOCATOR="PK\x07",i.ZIP64_CENTRAL_DIRECTORY_END="PK",i.DATA_DESCRIPTOR="PK\x07\b"},{}],24:[function(n,r,i){var s=n("./GenericWorker"),o=n("../utils");function a(l){s.call(this,"ConvertWorker to "+l),this.destType=l}o.inherits(a,s),a.prototype.processChunk=function(l){this.push({data:o.transformTo(this.destType,l.data),meta:l.meta})},r.exports=a},{"../utils":32,"./GenericWorker":28}],25:[function(n,r,i){var s=n("./GenericWorker"),o=n("../crc32");function a(){s.call(this,"Crc32Probe"),this.withStreamInfo("crc32",0)}n("../utils").inherits(a,s),a.prototype.processChunk=function(l){this.streamInfo.crc32=o(l.data,this.streamInfo.crc32||0),this.push(l)},r.exports=a},{"../crc32":4,"../utils":32,"./GenericWorker":28}],26:[function(n,r,i){var s=n("../utils"),o=n("./GenericWorker");function a(l){o.call(this,"DataLengthProbe for "+l),this.propName=l,this.withStreamInfo(l,0)}s.inherits(a,o),a.prototype.processChunk=function(l){if(l){var c=this.streamInfo[this.propName]||0;this.streamInfo[this.propName]=c+l.data.length}o.prototype.processChunk.call(this,l)},r.exports=a},{"../utils":32,"./GenericWorker":28}],27:[function(n,r,i){var s=n("../utils"),o=n("./GenericWorker");function a(l){o.call(this,"DataWorker");var c=this;this.dataIsReady=!1,this.index=0,this.max=0,this.data=null,this.type="",this._tickScheduled=!1,l.then(function(u){c.dataIsReady=!0,c.data=u,c.max=u&&u.length||0,c.type=s.getTypeOf(u),c.isPaused||c._tickAndRepeat()},function(u){c.error(u)})}s.inherits(a,o),a.prototype.cleanUp=function(){o.prototype.cleanUp.call(this),this.data=null},a.prototype.resume=function(){return!!o.prototype.resume.call(this)&&(!this._tickScheduled&&this.dataIsReady&&(this._tickScheduled=!0,s.delay(this._tickAndRepeat,[],this)),!0)},a.prototype._tickAndRepeat=function(){this._tickScheduled=!1,this.isPaused||this.isFinished||(this._tick(),this.isFinished||(s.delay(this._tickAndRepeat,[],this),this._tickScheduled=!0))},a.prototype._tick=function(){if(this.isPaused||this.isFinished)return!1;var l=null,c=Math.min(this.max,this.index+16384);if(this.index>=this.max)return this.end();switch(this.type){case"string":l=this.data.substring(this.index,c);break;case"uint8array":l=this.data.subarray(this.index,c);break;case"array":case"nodebuffer":l=this.data.slice(this.index,c)}return this.index=c,this.push({data:l,meta:{percent:this.max?this.index/this.max*100:0}})},r.exports=a},{"../utils":32,"./GenericWorker":28}],28:[function(n,r,i){function s(o){this.name=o||"default",this.streamInfo={},this.generatedError=null,this.extraStreamInfo={},this.isPaused=!0,this.isFinished=!1,this.isLocked=!1,this._listeners={data:[],end:[],error:[]},this.previous=null}s.prototype={push:function(o){this.emit("data",o)},end:function(){if(this.isFinished)return!1;this.flush();try{this.emit("end"),this.cleanUp(),this.isFinished=!0}catch(o){this.emit("error",o)}return!0},error:function(o){return!this.isFinished&&(this.isPaused?this.generatedError=o:(this.isFinished=!0,this.emit("error",o),this.previous&&this.previous.error(o),this.cleanUp()),!0)},on:function(o,a){return this._listeners[o].push(a),this},cleanUp:function(){this.streamInfo=this.generatedError=this.extraStreamInfo=null,this._listeners=[]},emit:function(o,a){if(this._listeners[o])for(var l=0;l<this._listeners[o].length;l++)this._listeners[o][l].call(this,a)},pipe:function(o){return o.registerPrevious(this)},registerPrevious:function(o){if(this.isLocked)throw new Error("The stream '"+this+"' has already been used.");this.streamInfo=o.streamInfo,this.mergeStreamInfo(),this.previous=o;var a=this;return o.on("data",function(l){a.processChunk(l)}),o.on("end",function(){a.end()}),o.on("error",function(l){a.error(l)}),this},pause:function(){return!this.isPaused&&!this.isFinished&&(this.isPaused=!0,this.previous&&this.previous.pause(),!0)},resume:function(){if(!this.isPaused||this.isFinished)return!1;var o=this.isPaused=!1;return this.generatedError&&(this.error(this.generatedError),o=!0),this.previous&&this.previous.resume(),!o},flush:function(){},processChunk:function(o){this.push(o)},withStreamInfo:function(o,a){return this.extraStreamInfo[o]=a,this.mergeStreamInfo(),this},mergeStreamInfo:function(){for(var o in this.extraStreamInfo)Object.prototype.hasOwnProperty.call(this.extraStreamInfo,o)&&(this.streamInfo[o]=this.extraStreamInfo[o])},lock:function(){if(this.isLocked)throw new Error("The stream '"+this+"' has already been used.");this.isLocked=!0,this.previous&&this.previous.lock()},toString:function(){var o="Worker "+this.name;return this.previous?this.previous+" -> "+o:o}},r.exports=s},{}],29:[function(n,r,i){var s=n("../utils"),o=n("./ConvertWorker"),a=n("./GenericWorker"),l=n("../base64"),c=n("../support"),u=n("../external"),d=null;if(c.nodestream)try{d=n("../nodejs/NodejsStreamOutputAdapter")}catch{}function h(p,m){return new u.Promise(function(_,g){var y=[],v=p._internalType,w=p._outputType,x=p._mimeType;p.on("data",function(S,C){y.push(S),m&&m(C)}).on("error",function(S){y=[],g(S)}).on("end",function(){try{var S=function(C,T,P){switch(C){case"blob":return s.newBlob(s.transformTo("arraybuffer",T),P);case"base64":return l.encode(T);default:return s.transformTo(C,T)}}(w,function(C,T){var P,F=0,k=null,A=0;for(P=0;P<T.length;P++)A+=T[P].length;switch(C){case"string":return T.join("");case"array":return Array.prototype.concat.apply([],T);case"uint8array":for(k=new Uint8Array(A),P=0;P<T.length;P++)k.set(T[P],F),F+=T[P].length;return k;case"nodebuffer":return Buffer.concat(T);default:throw new Error("concat : unsupported type '"+C+"'")}}(v,y),x);_(S)}catch(C){g(C)}y=[]}).resume()})}function f(p,m,_){var g=m;switch(m){case"blob":case"arraybuffer":g="uint8array";break;case"base64":g="string"}try{this._internalType=g,this._outputType=m,this._mimeType=_,s.checkSupport(g),this._worker=p.pipe(new o(g)),p.lock()}catch(y){this._worker=new a("error"),this._worker.error(y)}}f.prototype={accumulate:function(p){return h(this,p)},on:function(p,m){var _=this;return p==="data"?this._worker.on(p,function(g){m.call(_,g.data,g.meta)}):this._worker.on(p,function(){s.delay(m,arguments,_)}),this},resume:function(){return s.delay(this._worker.resume,[],this._worker),this},pause:function(){return this._worker.pause(),this},toNodejsStream:function(p){if(s.checkSupport("nodestream"),this._outputType!=="nodebuffer")throw new Error(this._outputType+" is not supported by this method");return new d(this,{objectMode:this._outputType!=="nodebuffer"},p)}},r.exports=f},{"../base64":1,"../external":6,"../nodejs/NodejsStreamOutputAdapter":13,"../support":30,"../utils":32,"./ConvertWorker":24,"./GenericWorker":28}],30:[function(n,r,i){if(i.base64=!0,i.array=!0,i.string=!0,i.arraybuffer=typeof ArrayBuffer<"u"&&typeof Uint8Array<"u",i.nodebuffer=typeof Buffer<"u",i.uint8array=typeof Uint8Array<"u",typeof ArrayBuffer>"u")i.blob=!1;else{var s=new ArrayBuffer(0);try{i.blob=new Blob([s],{type:"application/zip"}).size===0}catch{try{var o=new(self.BlobBuilder||self.WebKitBlobBuilder||self.MozBlobBuilder||self.MSBlobBuilder);o.append(s),i.blob=o.getBlob("application/zip").size===0}catch{i.blob=!1}}}try{i.nodestream=!!n("readable-stream").Readable}catch{i.nodestream=!1}},{"readable-stream":16}],31:[function(n,r,i){for(var s=n("./utils"),o=n("./support"),a=n("./nodejsUtils"),l=n("./stream/GenericWorker"),c=new Array(256),u=0;u<256;u++)c[u]=252<=u?6:248<=u?5:240<=u?4:224<=u?3:192<=u?2:1;c[254]=c[254]=1;function d(){l.call(this,"utf-8 decode"),this.leftOver=null}function h(){l.call(this,"utf-8 encode")}i.utf8encode=function(f){return o.nodebuffer?a.newBufferFrom(f,"utf-8"):function(p){var m,_,g,y,v,w=p.length,x=0;for(y=0;y<w;y++)(64512&(_=p.charCodeAt(y)))==55296&&y+1<w&&(64512&(g=p.charCodeAt(y+1)))==56320&&(_=65536+(_-55296<<10)+(g-56320),y++),x+=_<128?1:_<2048?2:_<65536?3:4;for(m=o.uint8array?new Uint8Array(x):new Array(x),y=v=0;v<x;y++)(64512&(_=p.charCodeAt(y)))==55296&&y+1<w&&(64512&(g=p.charCodeAt(y+1)))==56320&&(_=65536+(_-55296<<10)+(g-56320),y++),_<128?m[v++]=_:(_<2048?m[v++]=192|_>>>6:(_<65536?m[v++]=224|_>>>12:(m[v++]=240|_>>>18,m[v++]=128|_>>>12&63),m[v++]=128|_>>>6&63),m[v++]=128|63&_);return m}(f)},i.utf8decode=function(f){return o.nodebuffer?s.transformTo("nodebuffer",f).toString("utf-8"):function(p){var m,_,g,y,v=p.length,w=new Array(2*v);for(m=_=0;m<v;)if((g=p[m++])<128)w[_++]=g;else if(4<(y=c[g]))w[_++]=65533,m+=y-1;else{for(g&=y===2?31:y===3?15:7;1<y&&m<v;)g=g<<6|63&p[m++],y--;1<y?w[_++]=65533:g<65536?w[_++]=g:(g-=65536,w[_++]=55296|g>>10&1023,w[_++]=56320|1023&g)}return w.length!==_&&(w.subarray?w=w.subarray(0,_):w.length=_),s.applyFromCharCode(w)}(f=s.transformTo(o.uint8array?"uint8array":"array",f))},s.inherits(d,l),d.prototype.processChunk=function(f){var p=s.transformTo(o.uint8array?"uint8array":"array",f.data);if(this.leftOver&&this.leftOver.length){if(o.uint8array){var m=p;(p=new Uint8Array(m.length+this.leftOver.length)).set(this.leftOver,0),p.set(m,this.leftOver.length)}else p=this.leftOver.concat(p);this.leftOver=null}var _=function(y,v){var w;for((v=v||y.length)>y.length&&(v=y.length),w=v-1;0<=w&&(192&y[w])==128;)w--;return w<0||w===0?v:w+c[y[w]]>v?w:v}(p),g=p;_!==p.length&&(o.uint8array?(g=p.subarray(0,_),this.leftOver=p.subarray(_,p.length)):(g=p.slice(0,_),this.leftOver=p.slice(_,p.length))),this.push({data:i.utf8decode(g),meta:f.meta})},d.prototype.flush=function(){this.leftOver&&this.leftOver.length&&(this.push({data:i.utf8decode(this.leftOver),meta:{}}),this.leftOver=null)},i.Utf8DecodeWorker=d,s.inherits(h,l),h.prototype.processChunk=function(f){this.push({data:i.utf8encode(f.data),meta:f.meta})},i.Utf8EncodeWorker=h},{"./nodejsUtils":14,"./stream/GenericWorker":28,"./support":30,"./utils":32}],32:[function(n,r,i){var s=n("./support"),o=n("./base64"),a=n("./nodejsUtils"),l=n("./external");function c(m){return m}function u(m,_){for(var g=0;g<m.length;++g)_[g]=255&m.charCodeAt(g);return _}n("setimmediate"),i.newBlob=function(m,_){i.checkSupport("blob");try{return new Blob([m],{type:_})}catch{try{var g=new(self.BlobBuilder||self.WebKitBlobBuilder||self.MozBlobBuilder||self.MSBlobBuilder);return g.append(m),g.getBlob(_)}catch{throw new Error("Bug : can't construct the Blob.")}}};var d={stringifyByChunk:function(m,_,g){var y=[],v=0,w=m.length;if(w<=g)return String.fromCharCode.apply(null,m);for(;v<w;)_==="array"||_==="nodebuffer"?y.push(String.fromCharCode.apply(null,m.slice(v,Math.min(v+g,w)))):y.push(String.fromCharCode.apply(null,m.subarray(v,Math.min(v+g,w)))),v+=g;return y.join("")},stringifyByChar:function(m){for(var _="",g=0;g<m.length;g++)_+=String.fromCharCode(m[g]);return _},applyCanBeUsed:{uint8array:function(){try{return s.uint8array&&String.fromCharCode.apply(null,new Uint8Array(1)).length===1}catch{return!1}}(),nodebuffer:function(){try{return s.nodebuffer&&String.fromCharCode.apply(null,a.allocBuffer(1)).length===1}catch{return!1}}()}};function h(m){var _=65536,g=i.getTypeOf(m),y=!0;if(g==="uint8array"?y=d.applyCanBeUsed.uint8array:g==="nodebuffer"&&(y=d.applyCanBeUsed.nodebuffer),y)for(;1<_;)try{return d.stringifyByChunk(m,g,_)}catch{_=Math.floor(_/2)}return d.stringifyByChar(m)}function f(m,_){for(var g=0;g<m.length;g++)_[g]=m[g];return _}i.applyFromCharCode=h;var p={};p.string={string:c,array:function(m){return u(m,new Array(m.length))},arraybuffer:function(m){return p.string.uint8array(m).buffer},uint8array:function(m){return u(m,new Uint8Array(m.length))},nodebuffer:function(m){return u(m,a.allocBuffer(m.length))}},p.array={string:h,array:c,arraybuffer:function(m){return new Uint8Array(m).buffer},uint8array:function(m){return new Uint8Array(m)},nodebuffer:function(m){return a.newBufferFrom(m)}},p.arraybuffer={string:function(m){return h(new Uint8Array(m))},array:function(m){return f(new Uint8Array(m),new Array(m.byteLength))},arraybuffer:c,uint8array:function(m){return new Uint8Array(m)},nodebuffer:function(m){return a.newBufferFrom(new Uint8Array(m))}},p.uint8array={string:h,array:function(m){return f(m,new Array(m.length))},arraybuffer:function(m){return m.buffer},uint8array:c,nodebuffer:function(m){return a.newBufferFrom(m)}},p.nodebuffer={string:h,array:function(m){return f(m,new Array(m.length))},arraybuffer:function(m){return p.nodebuffer.uint8array(m).buffer},uint8array:function(m){return f(m,new Uint8Array(m.length))},nodebuffer:c},i.transformTo=function(m,_){if(_=_||"",!m)return _;i.checkSupport(m);var g=i.getTypeOf(_);return p[g][m](_)},i.resolve=function(m){for(var _=m.split("/"),g=[],y=0;y<_.length;y++){var v=_[y];v==="."||v===""&&y!==0&&y!==_.length-1||(v===".."?g.pop():g.push(v))}return g.join("/")},i.getTypeOf=function(m){return typeof m=="string"?"string":Object.prototype.toString.call(m)==="[object Array]"?"array":s.nodebuffer&&a.isBuffer(m)?"nodebuffer":s.uint8array&&m instanceof Uint8Array?"uint8array":s.arraybuffer&&m instanceof ArrayBuffer?"arraybuffer":void 0},i.checkSupport=function(m){if(!s[m.toLowerCase()])throw new Error(m+" is not supported by this platform")},i.MAX_VALUE_16BITS=65535,i.MAX_VALUE_32BITS=-1,i.pretty=function(m){var _,g,y="";for(g=0;g<(m||"").length;g++)y+="\\x"+((_=m.charCodeAt(g))<16?"0":"")+_.toString(16).toUpperCase();return y},i.delay=function(m,_,g){setImmediate(function(){m.apply(g||null,_||[])})},i.inherits=function(m,_){function g(){}g.prototype=_.prototype,m.prototype=new g},i.extend=function(){var m,_,g={};for(m=0;m<arguments.length;m++)for(_ in arguments[m])Object.prototype.hasOwnProperty.call(arguments[m],_)&&g[_]===void 0&&(g[_]=arguments[m][_]);return g},i.prepareContent=function(m,_,g,y,v){return l.Promise.resolve(_).then(function(w){return s.blob&&(w instanceof Blob||["[object File]","[object Blob]"].indexOf(Object.prototype.toString.call(w))!==-1)&&typeof FileReader<"u"?new l.Promise(function(x,S){var C=new FileReader;C.onload=function(T){x(T.target.result)},C.onerror=function(T){S(T.target.error)},C.readAsArrayBuffer(w)}):w}).then(function(w){var x=i.getTypeOf(w);return x?(x==="arraybuffer"?w=i.transformTo("uint8array",w):x==="string"&&(v?w=o.decode(w):g&&y!==!0&&(w=function(S){return u(S,s.uint8array?new Uint8Array(S.length):new Array(S.length))}(w))),w):l.Promise.reject(new Error("Can't read the data of '"+m+"'. Is it in a supported JavaScript type (String, Blob, ArrayBuffer, etc) ?"))})}},{"./base64":1,"./external":6,"./nodejsUtils":14,"./support":30,setimmediate:54}],33:[function(n,r,i){var s=n("./reader/readerFor"),o=n("./utils"),a=n("./signature"),l=n("./zipEntry"),c=n("./support");function u(d){this.files=[],this.loadOptions=d}u.prototype={checkSignature:function(d){if(!this.reader.readAndCheckSignature(d)){this.reader.index-=4;var h=this.reader.readString(4);throw new Error("Corrupted zip or bug: unexpected signature ("+o.pretty(h)+", expected "+o.pretty(d)+")")}},isSignature:function(d,h){var f=this.reader.index;this.reader.setIndex(d);var p=this.reader.readString(4)===h;return this.reader.setIndex(f),p},readBlockEndOfCentral:function(){this.diskNumber=this.reader.readInt(2),this.diskWithCentralDirStart=this.reader.readInt(2),this.centralDirRecordsOnThisDisk=this.reader.readInt(2),this.centralDirRecords=this.reader.readInt(2),this.centralDirSize=this.reader.readInt(4),this.centralDirOffset=this.reader.readInt(4),this.zipCommentLength=this.reader.readInt(2);var d=this.reader.readData(this.zipCommentLength),h=c.uint8array?"uint8array":"array",f=o.transformTo(h,d);this.zipComment=this.loadOptions.decodeFileName(f)},readBlockZip64EndOfCentral:function(){this.zip64EndOfCentralSize=this.reader.readInt(8),this.reader.skip(4),this.diskNumber=this.reader.readInt(4),this.diskWithCentralDirStart=this.reader.readInt(4),this.centralDirRecordsOnThisDisk=this.reader.readInt(8),this.centralDirRecords=this.reader.readInt(8),this.centralDirSize=this.reader.readInt(8),this.centralDirOffset=this.reader.readInt(8),this.zip64ExtensibleData={};for(var d,h,f,p=this.zip64EndOfCentralSize-44;0<p;)d=this.reader.readInt(2),h=this.reader.readInt(4),f=this.reader.readData(h),this.zip64ExtensibleData[d]={id:d,length:h,value:f}},readBlockZip64EndOfCentralLocator:function(){if(this.diskWithZip64CentralDirStart=this.reader.readInt(4),this.relativeOffsetEndOfZip64CentralDir=this.reader.readInt(8),this.disksCount=this.reader.readInt(4),1<this.disksCount)throw new Error("Multi-volumes zip are not supported")},readLocalFiles:function(){var d,h;for(d=0;d<this.files.length;d++)h=this.files[d],this.reader.setIndex(h.localHeaderOffset),this.checkSignature(a.LOCAL_FILE_HEADER),h.readLocalPart(this.reader),h.handleUTF8(),h.processAttributes()},readCentralDir:function(){var d;for(this.reader.setIndex(this.centralDirOffset);this.reader.readAndCheckSignature(a.CENTRAL_FILE_HEADER);)(d=new l({zip64:this.zip64},this.loadOptions)).readCentralPart(this.reader),this.files.push(d);if(this.centralDirRecords!==this.files.length&&this.centralDirRecords!==0&&this.files.length===0)throw new Error("Corrupted zip or bug: expected "+this.centralDirRecords+" records in central dir, got "+this.files.length)},readEndOfCentral:function(){var d=this.reader.lastIndexOfSignature(a.CENTRAL_DIRECTORY_END);if(d<0)throw this.isSignature(0,a.LOCAL_FILE_HEADER)?new Error("Corrupted zip: can't find end of central directory"):new Error("Can't find end of central directory : is this a zip file ? If it is, see https://stuk.github.io/jszip/documentation/howto/read_zip.html");this.reader.setIndex(d);var h=d;if(this.checkSignature(a.CENTRAL_DIRECTORY_END),this.readBlockEndOfCentral(),this.diskNumber===o.MAX_VALUE_16BITS||this.diskWithCentralDirStart===o.MAX_VALUE_16BITS||this.centralDirRecordsOnThisDisk===o.MAX_VALUE_16BITS||this.centralDirRecords===o.MAX_VALUE_16BITS||this.centralDirSize===o.MAX_VALUE_32BITS||this.centralDirOffset===o.MAX_VALUE_32BITS){if(this.zip64=!0,(d=this.reader.lastIndexOfSignature(a.ZIP64_CENTRAL_DIRECTORY_LOCATOR))<0)throw new Error("Corrupted zip: can't find the ZIP64 end of central directory locator");if(this.reader.setIndex(d),this.checkSignature(a.ZIP64_CENTRAL_DIRECTORY_LOCATOR),this.readBlockZip64EndOfCentralLocator(),!this.isSignature(this.relativeOffsetEndOfZip64CentralDir,a.ZIP64_CENTRAL_DIRECTORY_END)&&(this.relativeOffsetEndOfZip64CentralDir=this.reader.lastIndexOfSignature(a.ZIP64_CENTRAL_DIRECTORY_END),this.relativeOffsetEndOfZip64CentralDir<0))throw new Error("Corrupted zip: can't find the ZIP64 end of central directory");this.reader.setIndex(this.relativeOffsetEndOfZip64CentralDir),this.checkSignature(a.ZIP64_CENTRAL_DIRECTORY_END),this.readBlockZip64EndOfCentral()}var f=this.centralDirOffset+this.centralDirSize;this.zip64&&(f+=20,f+=12+this.zip64EndOfCentralSize);var p=h-f;if(0<p)this.isSignature(h,a.CENTRAL_FILE_HEADER)||(this.reader.zero=p);else if(p<0)throw new Error("Corrupted zip: missing "+Math.abs(p)+" bytes.")},prepareReader:function(d){this.reader=s(d)},load:function(d){this.prepareReader(d),this.readEndOfCentral(),this.readCentralDir(),this.readLocalFiles()}},r.exports=u},{"./reader/readerFor":22,"./signature":23,"./support":30,"./utils":32,"./zipEntry":34}],34:[function(n,r,i){var s=n("./reader/readerFor"),o=n("./utils"),a=n("./compressedObject"),l=n("./crc32"),c=n("./utf8"),u=n("./compressions"),d=n("./support");function h(f,p){this.options=f,this.loadOptions=p}h.prototype={isEncrypted:function(){return(1&this.bitFlag)==1},useUTF8:function(){return(2048&this.bitFlag)==2048},readLocalPart:function(f){var p,m;if(f.skip(22),this.fileNameLength=f.readInt(2),m=f.readInt(2),this.fileName=f.readData(this.fileNameLength),f.skip(m),this.compressedSize===-1||this.uncompressedSize===-1)throw new Error("Bug or corrupted zip : didn't get enough information from the central directory (compressedSize === -1 || uncompressedSize === -1)");if((p=function(_){for(var g in u)if(Object.prototype.hasOwnProperty.call(u,g)&&u[g].magic===_)return u[g];return null}(this.compressionMethod))===null)throw new Error("Corrupted zip : compression "+o.pretty(this.compressionMethod)+" unknown (inner file : "+o.transformTo("string",this.fileName)+")");this.decompressed=new a(this.compressedSize,this.uncompressedSize,this.crc32,p,f.readData(this.compressedSize))},readCentralPart:function(f){this.versionMadeBy=f.readInt(2),f.skip(2),this.bitFlag=f.readInt(2),this.compressionMethod=f.readString(2),this.date=f.readDate(),this.crc32=f.readInt(4),this.compressedSize=f.readInt(4),this.uncompressedSize=f.readInt(4);var p=f.readInt(2);if(this.extraFieldsLength=f.readInt(2),this.fileCommentLength=f.readInt(2),this.diskNumberStart=f.readInt(2),this.internalFileAttributes=f.readInt(2),this.externalFileAttributes=f.readInt(4),this.localHeaderOffset=f.readInt(4),this.isEncrypted())throw new Error("Encrypted zip are not supported");f.skip(p),this.readExtraFields(f),this.parseZIP64ExtraField(f),this.fileComment=f.readData(this.fileCommentLength)},processAttributes:function(){this.unixPermissions=null,this.dosPermissions=null;var f=this.versionMadeBy>>8;this.dir=!!(16&this.externalFileAttributes),f==0&&(this.dosPermissions=63&this.externalFileAttributes),f==3&&(this.unixPermissions=this.externalFileAttributes>>16&65535),this.dir||this.fileNameStr.slice(-1)!=="/"||(this.dir=!0)},parseZIP64ExtraField:function(){if(this.extraFields[1]){var f=s(this.extraFields[1].value);this.uncompressedSize===o.MAX_VALUE_32BITS&&(this.uncompressedSize=f.readInt(8)),this.compressedSize===o.MAX_VALUE_32BITS&&(this.compressedSize=f.readInt(8)),this.localHeaderOffset===o.MAX_VALUE_32BITS&&(this.localHeaderOffset=f.readInt(8)),this.diskNumberStart===o.MAX_VALUE_32BITS&&(this.diskNumberStart=f.readInt(4))}},readExtraFields:function(f){var p,m,_,g=f.index+this.extraFieldsLength;for(this.extraFields||(this.extraFields={});f.index+4<g;)p=f.readInt(2),m=f.readInt(2),_=f.readData(m),this.extraFields[p]={id:p,length:m,value:_};f.setIndex(g)},handleUTF8:function(){var f=d.uint8array?"uint8array":"array";if(this.useUTF8())this.fileNameStr=c.utf8decode(this.fileName),this.fileCommentStr=c.utf8decode(this.fileComment);else{var p=this.findExtraFieldUnicodePath();if(p!==null)this.fileNameStr=p;else{var m=o.transformTo(f,this.fileName);this.fileNameStr=this.loadOptions.decodeFileName(m)}var _=this.findExtraFieldUnicodeComment();if(_!==null)this.fileCommentStr=_;else{var g=o.transformTo(f,this.fileComment);this.fileCommentStr=this.loadOptions.decodeFileName(g)}}},findExtraFieldUnicodePath:function(){var f=this.extraFields[28789];if(f){var p=s(f.value);return p.readInt(1)!==1||l(this.fileName)!==p.readInt(4)?null:c.utf8decode(p.readData(f.length-5))}return null},findExtraFieldUnicodeComment:function(){var f=this.extraFields[25461];if(f){var p=s(f.value);return p.readInt(1)!==1||l(this.fileComment)!==p.readInt(4)?null:c.utf8decode(p.readData(f.length-5))}return null}},r.exports=h},{"./compressedObject":2,"./compressions":3,"./crc32":4,"./reader/readerFor":22,"./support":30,"./utf8":31,"./utils":32}],35:[function(n,r,i){function s(p,m,_){this.name=p,this.dir=_.dir,this.date=_.date,this.comment=_.comment,this.unixPermissions=_.unixPermissions,this.dosPermissions=_.dosPermissions,this._data=m,this._dataBinary=_.binary,this.options={compression:_.compression,compressionOptions:_.compressionOptions}}var o=n("./stream/StreamHelper"),a=n("./stream/DataWorker"),l=n("./utf8"),c=n("./compressedObject"),u=n("./stream/GenericWorker");s.prototype={internalStream:function(p){var m=null,_="string";try{if(!p)throw new Error("No output type specified.");var g=(_=p.toLowerCase())==="string"||_==="text";_!=="binarystring"&&_!=="text"||(_="string"),m=this._decompressWorker();var y=!this._dataBinary;y&&!g&&(m=m.pipe(new l.Utf8EncodeWorker)),!y&&g&&(m=m.pipe(new l.Utf8DecodeWorker))}catch(v){(m=new u("error")).error(v)}return new o(m,_,"")},async:function(p,m){return this.internalStream(p).accumulate(m)},nodeStream:function(p,m){return this.internalStream(p||"nodebuffer").toNodejsStream(m)},_compressWorker:function(p,m){if(this._data instanceof c&&this._data.compression.magic===p.magic)return this._data.getCompressedWorker();var _=this._decompressWorker();return this._dataBinary||(_=_.pipe(new l.Utf8EncodeWorker)),c.createWorkerFrom(_,p,m)},_decompressWorker:function(){return this._data instanceof c?this._data.getContentWorker():this._data instanceof u?this._data:new a(this._data)}};for(var d=["asText","asBinary","asNodeBuffer","asUint8Array","asArrayBuffer"],h=function(){throw new Error("This method has been removed in JSZip 3.0, please check the upgrade guide.")},f=0;f<d.length;f++)s.prototype[d[f]]=h;r.exports=s},{"./compressedObject":2,"./stream/DataWorker":27,"./stream/GenericWorker":28,"./stream/StreamHelper":29,"./utf8":31}],36:[function(n,r,i){(function(s){var o,a,l=s.MutationObserver||s.WebKitMutationObserver;if(l){var c=0,u=new l(p),d=s.document.createTextNode("");u.observe(d,{characterData:!0}),o=function(){d.data=c=++c%2}}else if(s.setImmediate||s.MessageChannel===void 0)o="document"in s&&"onreadystatechange"in s.document.createElement("script")?function(){var m=s.document.createElement("script");m.onreadystatechange=function(){p(),m.onreadystatechange=null,m.parentNode.removeChild(m),m=null},s.document.documentElement.appendChild(m)}:function(){setTimeout(p,0)};else{var h=new s.MessageChannel;h.port1.onmessage=p,o=function(){h.port2.postMessage(0)}}var f=[];function p(){var m,_;a=!0;for(var g=f.length;g;){for(_=f,f=[],m=-1;++m<g;)_[m]();g=f.length}a=!1}r.exports=function(m){f.push(m)!==1||a||o()}}).call(this,typeof po<"u"?po:typeof self<"u"?self:typeof window<"u"?window:{})},{}],37:[function(n,r,i){var s=n("immediate");function o(){}var a={},l=["REJECTED"],c=["FULFILLED"],u=["PENDING"];function d(g){if(typeof g!="function")throw new TypeError("resolver must be a function");this.state=u,this.queue=[],this.outcome=void 0,g!==o&&m(this,g)}function h(g,y,v){this.promise=g,typeof y=="function"&&(this.onFulfilled=y,this.callFulfilled=this.otherCallFulfilled),typeof v=="function"&&(this.onRejected=v,this.callRejected=this.otherCallRejected)}function f(g,y,v){s(function(){var w;try{w=y(v)}catch(x){return a.reject(g,x)}w===g?a.reject(g,new TypeError("Cannot resolve promise with itself")):a.resolve(g,w)})}function p(g){var y=g&&g.then;if(g&&(typeof g=="object"||typeof g=="function")&&typeof y=="function")return function(){y.apply(g,arguments)}}function m(g,y){var v=!1;function w(C){v||(v=!0,a.reject(g,C))}function x(C){v||(v=!0,a.resolve(g,C))}var S=_(function(){y(x,w)});S.status==="error"&&w(S.value)}function _(g,y){var v={};try{v.value=g(y),v.status="success"}catch(w){v.status="error",v.value=w}return v}(r.exports=d).prototype.finally=function(g){if(typeof g!="function")return this;var y=this.constructor;return this.then(function(v){return y.resolve(g()).then(function(){return v})},function(v){return y.resolve(g()).then(function(){throw v})})},d.prototype.catch=function(g){return this.then(null,g)},d.prototype.then=function(g,y){if(typeof g!="function"&&this.state===c||typeof y!="function"&&this.state===l)return this;var v=new this.constructor(o);return this.state!==u?f(v,this.state===c?g:y,this.outcome):this.queue.push(new h(v,g,y)),v},h.prototype.callFulfilled=function(g){a.resolve(this.promise,g)},h.prototype.otherCallFulfilled=function(g){f(this.promise,this.onFulfilled,g)},h.prototype.callRejected=function(g){a.reject(this.promise,g)},h.prototype.otherCallRejected=function(g){f(this.promise,this.onRejected,g)},a.resolve=function(g,y){var v=_(p,y);if(v.status==="error")return a.reject(g,v.value);var w=v.value;if(w)m(g,w);else{g.state=c,g.outcome=y;for(var x=-1,S=g.queue.length;++x<S;)g.queue[x].callFulfilled(y)}return g},a.reject=function(g,y){g.state=l,g.outcome=y;for(var v=-1,w=g.queue.length;++v<w;)g.queue[v].callRejected(y);return g},d.resolve=function(g){return g instanceof this?g:a.resolve(new this(o),g)},d.reject=function(g){var y=new this(o);return a.reject(y,g)},d.all=function(g){var y=this;if(Object.prototype.toString.call(g)!=="[object Array]")return this.reject(new TypeError("must be an array"));var v=g.length,w=!1;if(!v)return this.resolve([]);for(var x=new Array(v),S=0,C=-1,T=new this(o);++C<v;)P(g[C],C);return T;function P(F,k){y.resolve(F).then(function(A){x[k]=A,++S!==v||w||(w=!0,a.resolve(T,x))},function(A){w||(w=!0,a.reject(T,A))})}},d.race=function(g){var y=this;if(Object.prototype.toString.call(g)!=="[object Array]")return this.reject(new TypeError("must be an array"));var v=g.length,w=!1;if(!v)return this.resolve([]);for(var x=-1,S=new this(o);++x<v;)C=g[x],y.resolve(C).then(function(T){w||(w=!0,a.resolve(S,T))},function(T){w||(w=!0,a.reject(S,T))});var C;return S}},{immediate:36}],38:[function(n,r,i){var s={};(0,n("./lib/utils/common").assign)(s,n("./lib/deflate"),n("./lib/inflate"),n("./lib/zlib/constants")),r.exports=s},{"./lib/deflate":39,"./lib/inflate":40,"./lib/utils/common":41,"./lib/zlib/constants":44}],39:[function(n,r,i){var s=n("./zlib/deflate"),o=n("./utils/common"),a=n("./utils/strings"),l=n("./zlib/messages"),c=n("./zlib/zstream"),u=Object.prototype.toString,d=0,h=-1,f=0,p=8;function m(g){if(!(this instanceof m))return new m(g);this.options=o.assign({level:h,method:p,chunkSize:16384,windowBits:15,memLevel:8,strategy:f,to:""},g||{});var y=this.options;y.raw&&0<y.windowBits?y.windowBits=-y.windowBits:y.gzip&&0<y.windowBits&&y.windowBits<16&&(y.windowBits+=16),this.err=0,this.msg="",this.ended=!1,this.chunks=[],this.strm=new c,this.strm.avail_out=0;var v=s.deflateInit2(this.strm,y.level,y.method,y.windowBits,y.memLevel,y.strategy);if(v!==d)throw new Error(l[v]);if(y.header&&s.deflateSetHeader(this.strm,y.header),y.dictionary){var w;if(w=typeof y.dictionary=="string"?a.string2buf(y.dictionary):u.call(y.dictionary)==="[object ArrayBuffer]"?new Uint8Array(y.dictionary):y.dictionary,(v=s.deflateSetDictionary(this.strm,w))!==d)throw new Error(l[v]);this._dict_set=!0}}function _(g,y){var v=new m(y);if(v.push(g,!0),v.err)throw v.msg||l[v.err];return v.result}m.prototype.push=function(g,y){var v,w,x=this.strm,S=this.options.chunkSize;if(this.ended)return!1;w=y===~~y?y:y===!0?4:0,typeof g=="string"?x.input=a.string2buf(g):u.call(g)==="[object ArrayBuffer]"?x.input=new Uint8Array(g):x.input=g,x.next_in=0,x.avail_in=x.input.length;do{if(x.avail_out===0&&(x.output=new o.Buf8(S),x.next_out=0,x.avail_out=S),(v=s.deflate(x,w))!==1&&v!==d)return this.onEnd(v),!(this.ended=!0);x.avail_out!==0&&(x.avail_in!==0||w!==4&&w!==2)||(this.options.to==="string"?this.onData(a.buf2binstring(o.shrinkBuf(x.output,x.next_out))):this.onData(o.shrinkBuf(x.output,x.next_out)))}while((0<x.avail_in||x.avail_out===0)&&v!==1);return w===4?(v=s.deflateEnd(this.strm),this.onEnd(v),this.ended=!0,v===d):w!==2||(this.onEnd(d),!(x.avail_out=0))},m.prototype.onData=function(g){this.chunks.push(g)},m.prototype.onEnd=function(g){g===d&&(this.options.to==="string"?this.result=this.chunks.join(""):this.result=o.flattenChunks(this.chunks)),this.chunks=[],this.err=g,this.msg=this.strm.msg},i.Deflate=m,i.deflate=_,i.deflateRaw=function(g,y){return(y=y||{}).raw=!0,_(g,y)},i.gzip=function(g,y){return(y=y||{}).gzip=!0,_(g,y)}},{"./utils/common":41,"./utils/strings":42,"./zlib/deflate":46,"./zlib/messages":51,"./zlib/zstream":53}],40:[function(n,r,i){var s=n("./zlib/inflate"),o=n("./utils/common"),a=n("./utils/strings"),l=n("./zlib/constants"),c=n("./zlib/messages"),u=n("./zlib/zstream"),d=n("./zlib/gzheader"),h=Object.prototype.toString;function f(m){if(!(this instanceof f))return new f(m);this.options=o.assign({chunkSize:16384,windowBits:0,to:""},m||{});var _=this.options;_.raw&&0<=_.windowBits&&_.windowBits<16&&(_.windowBits=-_.windowBits,_.windowBits===0&&(_.windowBits=-15)),!(0<=_.windowBits&&_.windowBits<16)||m&&m.windowBits||(_.windowBits+=32),15<_.windowBits&&_.windowBits<48&&!(15&_.windowBits)&&(_.windowBits|=15),this.err=0,this.msg="",this.ended=!1,this.chunks=[],this.strm=new u,this.strm.avail_out=0;var g=s.inflateInit2(this.strm,_.windowBits);if(g!==l.Z_OK)throw new Error(c[g]);this.header=new d,s.inflateGetHeader(this.strm,this.header)}function p(m,_){var g=new f(_);if(g.push(m,!0),g.err)throw g.msg||c[g.err];return g.result}f.prototype.push=function(m,_){var g,y,v,w,x,S,C=this.strm,T=this.options.chunkSize,P=this.options.dictionary,F=!1;if(this.ended)return!1;y=_===~~_?_:_===!0?l.Z_FINISH:l.Z_NO_FLUSH,typeof m=="string"?C.input=a.binstring2buf(m):h.call(m)==="[object ArrayBuffer]"?C.input=new Uint8Array(m):C.input=m,C.next_in=0,C.avail_in=C.input.length;do{if(C.avail_out===0&&(C.output=new o.Buf8(T),C.next_out=0,C.avail_out=T),(g=s.inflate(C,l.Z_NO_FLUSH))===l.Z_NEED_DICT&&P&&(S=typeof P=="string"?a.string2buf(P):h.call(P)==="[object ArrayBuffer]"?new Uint8Array(P):P,g=s.inflateSetDictionary(this.strm,S)),g===l.Z_BUF_ERROR&&F===!0&&(g=l.Z_OK,F=!1),g!==l.Z_STREAM_END&&g!==l.Z_OK)return this.onEnd(g),!(this.ended=!0);C.next_out&&(C.avail_out!==0&&g!==l.Z_STREAM_END&&(C.avail_in!==0||y!==l.Z_FINISH&&y!==l.Z_SYNC_FLUSH)||(this.options.to==="string"?(v=a.utf8border(C.output,C.next_out),w=C.next_out-v,x=a.buf2string(C.output,v),C.next_out=w,C.avail_out=T-w,w&&o.arraySet(C.output,C.output,v,w,0),this.onData(x)):this.onData(o.shrinkBuf(C.output,C.next_out)))),C.avail_in===0&&C.avail_out===0&&(F=!0)}while((0<C.avail_in||C.avail_out===0)&&g!==l.Z_STREAM_END);return g===l.Z_STREAM_END&&(y=l.Z_FINISH),y===l.Z_FINISH?(g=s.inflateEnd(this.strm),this.onEnd(g),this.ended=!0,g===l.Z_OK):y!==l.Z_SYNC_FLUSH||(this.onEnd(l.Z_OK),!(C.avail_out=0))},f.prototype.onData=function(m){this.chunks.push(m)},f.prototype.onEnd=function(m){m===l.Z_OK&&(this.options.to==="string"?this.result=this.chunks.join(""):this.result=o.flattenChunks(this.chunks)),this.chunks=[],this.err=m,this.msg=this.strm.msg},i.Inflate=f,i.inflate=p,i.inflateRaw=function(m,_){return(_=_||{}).raw=!0,p(m,_)},i.ungzip=p},{"./utils/common":41,"./utils/strings":42,"./zlib/constants":44,"./zlib/gzheader":47,"./zlib/inflate":49,"./zlib/messages":51,"./zlib/zstream":53}],41:[function(n,r,i){var s=typeof Uint8Array<"u"&&typeof Uint16Array<"u"&&typeof Int32Array<"u";i.assign=function(l){for(var c=Array.prototype.slice.call(arguments,1);c.length;){var u=c.shift();if(u){if(typeof u!="object")throw new TypeError(u+"must be non-object");for(var d in u)u.hasOwnProperty(d)&&(l[d]=u[d])}}return l},i.shrinkBuf=function(l,c){return l.length===c?l:l.subarray?l.subarray(0,c):(l.length=c,l)};var o={arraySet:function(l,c,u,d,h){if(c.subarray&&l.subarray)l.set(c.subarray(u,u+d),h);else for(var f=0;f<d;f++)l[h+f]=c[u+f]},flattenChunks:function(l){var c,u,d,h,f,p;for(c=d=0,u=l.length;c<u;c++)d+=l[c].length;for(p=new Uint8Array(d),c=h=0,u=l.length;c<u;c++)f=l[c],p.set(f,h),h+=f.length;return p}},a={arraySet:function(l,c,u,d,h){for(var f=0;f<d;f++)l[h+f]=c[u+f]},flattenChunks:function(l){return[].concat.apply([],l)}};i.setTyped=function(l){l?(i.Buf8=Uint8Array,i.Buf16=Uint16Array,i.Buf32=Int32Array,i.assign(i,o)):(i.Buf8=Array,i.Buf16=Array,i.Buf32=Array,i.assign(i,a))},i.setTyped(s)},{}],42:[function(n,r,i){var s=n("./common"),o=!0,a=!0;try{String.fromCharCode.apply(null,[0])}catch{o=!1}try{String.fromCharCode.apply(null,new Uint8Array(1))}catch{a=!1}for(var l=new s.Buf8(256),c=0;c<256;c++)l[c]=252<=c?6:248<=c?5:240<=c?4:224<=c?3:192<=c?2:1;function u(d,h){if(h<65537&&(d.subarray&&a||!d.subarray&&o))return String.fromCharCode.apply(null,s.shrinkBuf(d,h));for(var f="",p=0;p<h;p++)f+=String.fromCharCode(d[p]);return f}l[254]=l[254]=1,i.string2buf=function(d){var h,f,p,m,_,g=d.length,y=0;for(m=0;m<g;m++)(64512&(f=d.charCodeAt(m)))==55296&&m+1<g&&(64512&(p=d.charCodeAt(m+1)))==56320&&(f=65536+(f-55296<<10)+(p-56320),m++),y+=f<128?1:f<2048?2:f<65536?3:4;for(h=new s.Buf8(y),m=_=0;_<y;m++)(64512&(f=d.charCodeAt(m)))==55296&&m+1<g&&(64512&(p=d.charCodeAt(m+1)))==56320&&(f=65536+(f-55296<<10)+(p-56320),m++),f<128?h[_++]=f:(f<2048?h[_++]=192|f>>>6:(f<65536?h[_++]=224|f>>>12:(h[_++]=240|f>>>18,h[_++]=128|f>>>12&63),h[_++]=128|f>>>6&63),h[_++]=128|63&f);return h},i.buf2binstring=function(d){return u(d,d.length)},i.binstring2buf=function(d){for(var h=new s.Buf8(d.length),f=0,p=h.length;f<p;f++)h[f]=d.charCodeAt(f);return h},i.buf2string=function(d,h){var f,p,m,_,g=h||d.length,y=new Array(2*g);for(f=p=0;f<g;)if((m=d[f++])<128)y[p++]=m;else if(4<(_=l[m]))y[p++]=65533,f+=_-1;else{for(m&=_===2?31:_===3?15:7;1<_&&f<g;)m=m<<6|63&d[f++],_--;1<_?y[p++]=65533:m<65536?y[p++]=m:(m-=65536,y[p++]=55296|m>>10&1023,y[p++]=56320|1023&m)}return u(y,p)},i.utf8border=function(d,h){var f;for((h=h||d.length)>d.length&&(h=d.length),f=h-1;0<=f&&(192&d[f])==128;)f--;return f<0||f===0?h:f+l[d[f]]>h?f:h}},{"./common":41}],43:[function(n,r,i){r.exports=function(s,o,a,l){for(var c=65535&s|0,u=s>>>16&65535|0,d=0;a!==0;){for(a-=d=2e3<a?2e3:a;u=u+(c=c+o[l++]|0)|0,--d;);c%=65521,u%=65521}return c|u<<16|0}},{}],44:[function(n,r,i){r.exports={Z_NO_FLUSH:0,Z_PARTIAL_FLUSH:1,Z_SYNC_FLUSH:2,Z_FULL_FLUSH:3,Z_FINISH:4,Z_BLOCK:5,Z_TREES:6,Z_OK:0,Z_STREAM_END:1,Z_NEED_DICT:2,Z_ERRNO:-1,Z_STREAM_ERROR:-2,Z_DATA_ERROR:-3,Z_BUF_ERROR:-5,Z_NO_COMPRESSION:0,Z_BEST_SPEED:1,Z_BEST_COMPRESSION:9,Z_DEFAULT_COMPRESSION:-1,Z_FILTERED:1,Z_HUFFMAN_ONLY:2,Z_RLE:3,Z_FIXED:4,Z_DEFAULT_STRATEGY:0,Z_BINARY:0,Z_TEXT:1,Z_UNKNOWN:2,Z_DEFLATED:8}},{}],45:[function(n,r,i){var s=function(){for(var o,a=[],l=0;l<256;l++){o=l;for(var c=0;c<8;c++)o=1&o?3988292384^o>>>1:o>>>1;a[l]=o}return a}();r.exports=function(o,a,l,c){var u=s,d=c+l;o^=-1;for(var h=c;h<d;h++)o=o>>>8^u[255&(o^a[h])];return-1^o}},{}],46:[function(n,r,i){var s,o=n("../utils/common"),a=n("./trees"),l=n("./adler32"),c=n("./crc32"),u=n("./messages"),d=0,h=4,f=0,p=-2,m=-1,_=4,g=2,y=8,v=9,w=286,x=30,S=19,C=2*w+1,T=15,P=3,F=258,k=F+P+1,A=42,M=113,b=1,j=2,V=3,H=4;function U(I,Q){return I.msg=u[Q],Q}function B(I){return(I<<1)-(4<I?9:0)}function N(I){for(var Q=I.length;0<=--Q;)I[Q]=0}function O(I){var Q=I.state,J=Q.pending;J>I.avail_out&&(J=I.avail_out),J!==0&&(o.arraySet(I.output,Q.pending_buf,Q.pending_out,J,I.next_out),I.next_out+=J,Q.pending_out+=J,I.total_out+=J,I.avail_out-=J,Q.pending-=J,Q.pending===0&&(Q.pending_out=0))}function $(I,Q){a._tr_flush_block(I,0<=I.block_start?I.block_start:-1,I.strstart-I.block_start,Q),I.block_start=I.strstart,O(I.strm)}function G(I,Q){I.pending_buf[I.pending++]=Q}function R(I,Q){I.pending_buf[I.pending++]=Q>>>8&255,I.pending_buf[I.pending++]=255&Q}function L(I,Q){var J,z,D=I.max_chain_length,Y=I.strstart,ne=I.prev_length,re=I.nice_match,X=I.strstart>I.w_size-k?I.strstart-(I.w_size-k):0,ie=I.window,he=I.w_mask,le=I.prev,ve=I.strstart+F,Ge=ie[Y+ne-1],ke=ie[Y+ne];I.prev_length>=I.good_match&&(D>>=2),re>I.lookahead&&(re=I.lookahead);do if(ie[(J=Q)+ne]===ke&&ie[J+ne-1]===Ge&&ie[J]===ie[Y]&&ie[++J]===ie[Y+1]){Y+=2,J++;do;while(ie[++Y]===ie[++J]&&ie[++Y]===ie[++J]&&ie[++Y]===ie[++J]&&ie[++Y]===ie[++J]&&ie[++Y]===ie[++J]&&ie[++Y]===ie[++J]&&ie[++Y]===ie[++J]&&ie[++Y]===ie[++J]&&Y<ve);if(z=F-(ve-Y),Y=ve-F,ne<z){if(I.match_start=Q,re<=(ne=z))break;Ge=ie[Y+ne-1],ke=ie[Y+ne]}}while((Q=le[Q&he])>X&&--D!=0);return ne<=I.lookahead?ne:I.lookahead}function W(I){var Q,J,z,D,Y,ne,re,X,ie,he,le=I.w_size;do{if(D=I.window_size-I.lookahead-I.strstart,I.strstart>=le+(le-k)){for(o.arraySet(I.window,I.window,le,le,0),I.match_start-=le,I.strstart-=le,I.block_start-=le,Q=J=I.hash_size;z=I.head[--Q],I.head[Q]=le<=z?z-le:0,--J;);for(Q=J=le;z=I.prev[--Q],I.prev[Q]=le<=z?z-le:0,--J;);D+=le}if(I.strm.avail_in===0)break;if(ne=I.strm,re=I.window,X=I.strstart+I.lookahead,ie=D,he=void 0,he=ne.avail_in,ie<he&&(he=ie),J=he===0?0:(ne.avail_in-=he,o.arraySet(re,ne.input,ne.next_in,he,X),ne.state.wrap===1?ne.adler=l(ne.adler,re,he,X):ne.state.wrap===2&&(ne.adler=c(ne.adler,re,he,X)),ne.next_in+=he,ne.total_in+=he,he),I.lookahead+=J,I.lookahead+I.insert>=P)for(Y=I.strstart-I.insert,I.ins_h=I.window[Y],I.ins_h=(I.ins_h<<I.hash_shift^I.window[Y+1])&I.hash_mask;I.insert&&(I.ins_h=(I.ins_h<<I.hash_shift^I.window[Y+P-1])&I.hash_mask,I.prev[Y&I.w_mask]=I.head[I.ins_h],I.head[I.ins_h]=Y,Y++,I.insert--,!(I.lookahead+I.insert<P)););}while(I.lookahead<k&&I.strm.avail_in!==0)}function te(I,Q){for(var J,z;;){if(I.lookahead<k){if(W(I),I.lookahead<k&&Q===d)return b;if(I.lookahead===0)break}if(J=0,I.lookahead>=P&&(I.ins_h=(I.ins_h<<I.hash_shift^I.window[I.strstart+P-1])&I.hash_mask,J=I.prev[I.strstart&I.w_mask]=I.head[I.ins_h],I.head[I.ins_h]=I.strstart),J!==0&&I.strstart-J<=I.w_size-k&&(I.match_length=L(I,J)),I.match_length>=P)if(z=a._tr_tally(I,I.strstart-I.match_start,I.match_length-P),I.lookahead-=I.match_length,I.match_length<=I.max_lazy_match&&I.lookahead>=P){for(I.match_length--;I.strstart++,I.ins_h=(I.ins_h<<I.hash_shift^I.window[I.strstart+P-1])&I.hash_mask,J=I.prev[I.strstart&I.w_mask]=I.head[I.ins_h],I.head[I.ins_h]=I.strstart,--I.match_length!=0;);I.strstart++}else I.strstart+=I.match_length,I.match_length=0,I.ins_h=I.window[I.strstart],I.ins_h=(I.ins_h<<I.hash_shift^I.window[I.strstart+1])&I.hash_mask;else z=a._tr_tally(I,0,I.window[I.strstart]),I.lookahead--,I.strstart++;if(z&&($(I,!1),I.strm.avail_out===0))return b}return I.insert=I.strstart<P-1?I.strstart:P-1,Q===h?($(I,!0),I.strm.avail_out===0?V:H):I.last_lit&&($(I,!1),I.strm.avail_out===0)?b:j}function ee(I,Q){for(var J,z,D;;){if(I.lookahead<k){if(W(I),I.lookahead<k&&Q===d)return b;if(I.lookahead===0)break}if(J=0,I.lookahead>=P&&(I.ins_h=(I.ins_h<<I.hash_shift^I.window[I.strstart+P-1])&I.hash_mask,J=I.prev[I.strstart&I.w_mask]=I.head[I.ins_h],I.head[I.ins_h]=I.strstart),I.prev_length=I.match_length,I.prev_match=I.match_start,I.match_length=P-1,J!==0&&I.prev_length<I.max_lazy_match&&I.strstart-J<=I.w_size-k&&(I.match_length=L(I,J),I.match_length<=5&&(I.strategy===1||I.match_length===P&&4096<I.strstart-I.match_start)&&(I.match_length=P-1)),I.prev_length>=P&&I.match_length<=I.prev_length){for(D=I.strstart+I.lookahead-P,z=a._tr_tally(I,I.strstart-1-I.prev_match,I.prev_length-P),I.lookahead-=I.prev_length-1,I.prev_length-=2;++I.strstart<=D&&(I.ins_h=(I.ins_h<<I.hash_shift^I.window[I.strstart+P-1])&I.hash_mask,J=I.prev[I.strstart&I.w_mask]=I.head[I.ins_h],I.head[I.ins_h]=I.strstart),--I.prev_length!=0;);if(I.match_available=0,I.match_length=P-1,I.strstart++,z&&($(I,!1),I.strm.avail_out===0))return b}else if(I.match_available){if((z=a._tr_tally(I,0,I.window[I.strstart-1]))&&$(I,!1),I.strstart++,I.lookahead--,I.strm.avail_out===0)return b}else I.match_available=1,I.strstart++,I.lookahead--}return I.match_available&&(z=a._tr_tally(I,0,I.window[I.strstart-1]),I.match_available=0),I.insert=I.strstart<P-1?I.strstart:P-1,Q===h?($(I,!0),I.strm.avail_out===0?V:H):I.last_lit&&($(I,!1),I.strm.avail_out===0)?b:j}function ce(I,Q,J,z,D){this.good_length=I,this.max_lazy=Q,this.nice_length=J,this.max_chain=z,this.func=D}function ge(){this.strm=null,this.status=0,this.pending_buf=null,this.pending_buf_size=0,this.pending_out=0,this.pending=0,this.wrap=0,this.gzhead=null,this.gzindex=0,this.method=y,this.last_flush=-1,this.w_size=0,this.w_bits=0,this.w_mask=0,this.window=null,this.window_size=0,this.prev=null,this.head=null,this.ins_h=0,this.hash_size=0,this.hash_bits=0,this.hash_mask=0,this.hash_shift=0,this.block_start=0,this.match_length=0,this.prev_match=0,this.match_available=0,this.strstart=0,this.match_start=0,this.lookahead=0,this.prev_length=0,this.max_chain_length=0,this.max_lazy_match=0,this.level=0,this.strategy=0,this.good_match=0,this.nice_match=0,this.dyn_ltree=new o.Buf16(2*C),this.dyn_dtree=new o.Buf16(2*(2*x+1)),this.bl_tree=new o.Buf16(2*(2*S+1)),N(this.dyn_ltree),N(this.dyn_dtree),N(this.bl_tree),this.l_desc=null,this.d_desc=null,this.bl_desc=null,this.bl_count=new o.Buf16(T+1),this.heap=new o.Buf16(2*w+1),N(this.heap),this.heap_len=0,this.heap_max=0,this.depth=new o.Buf16(2*w+1),N(this.depth),this.l_buf=0,this.lit_bufsize=0,this.last_lit=0,this.d_buf=0,this.opt_len=0,this.static_len=0,this.matches=0,this.insert=0,this.bi_buf=0,this.bi_valid=0}function Ce(I){var Q;return I&&I.state?(I.total_in=I.total_out=0,I.data_type=g,(Q=I.state).pending=0,Q.pending_out=0,Q.wrap<0&&(Q.wrap=-Q.wrap),Q.status=Q.wrap?A:M,I.adler=Q.wrap===2?0:1,Q.last_flush=d,a._tr_init(Q),f):U(I,p)}function _t(I){var Q=Ce(I);return Q===f&&function(J){J.window_size=2*J.w_size,N(J.head),J.max_lazy_match=s[J.level].max_lazy,J.good_match=s[J.level].good_length,J.nice_match=s[J.level].nice_length,J.max_chain_length=s[J.level].max_chain,J.strstart=0,J.block_start=0,J.lookahead=0,J.insert=0,J.match_length=J.prev_length=P-1,J.match_available=0,J.ins_h=0}(I.state),Q}function vt(I,Q,J,z,D,Y){if(!I)return p;var ne=1;if(Q===m&&(Q=6),z<0?(ne=0,z=-z):15<z&&(ne=2,z-=16),D<1||v<D||J!==y||z<8||15<z||Q<0||9<Q||Y<0||_<Y)return U(I,p);z===8&&(z=9);var re=new ge;return(I.state=re).strm=I,re.wrap=ne,re.gzhead=null,re.w_bits=z,re.w_size=1<<re.w_bits,re.w_mask=re.w_size-1,re.hash_bits=D+7,re.hash_size=1<<re.hash_bits,re.hash_mask=re.hash_size-1,re.hash_shift=~~((re.hash_bits+P-1)/P),re.window=new o.Buf8(2*re.w_size),re.head=new o.Buf16(re.hash_size),re.prev=new o.Buf16(re.w_size),re.lit_bufsize=1<<D+6,re.pending_buf_size=4*re.lit_bufsize,re.pending_buf=new o.Buf8(re.pending_buf_size),re.d_buf=1*re.lit_bufsize,re.l_buf=3*re.lit_bufsize,re.level=Q,re.strategy=Y,re.method=J,_t(I)}s=[new ce(0,0,0,0,function(I,Q){var J=65535;for(J>I.pending_buf_size-5&&(J=I.pending_buf_size-5);;){if(I.lookahead<=1){if(W(I),I.lookahead===0&&Q===d)return b;if(I.lookahead===0)break}I.strstart+=I.lookahead,I.lookahead=0;var z=I.block_start+J;if((I.strstart===0||I.strstart>=z)&&(I.lookahead=I.strstart-z,I.strstart=z,$(I,!1),I.strm.avail_out===0)||I.strstart-I.block_start>=I.w_size-k&&($(I,!1),I.strm.avail_out===0))return b}return I.insert=0,Q===h?($(I,!0),I.strm.avail_out===0?V:H):(I.strstart>I.block_start&&($(I,!1),I.strm.avail_out),b)}),new ce(4,4,8,4,te),new ce(4,5,16,8,te),new ce(4,6,32,32,te),new ce(4,4,16,16,ee),new ce(8,16,32,32,ee),new ce(8,16,128,128,ee),new ce(8,32,128,256,ee),new ce(32,128,258,1024,ee),new ce(32,258,258,4096,ee)],i.deflateInit=function(I,Q){return vt(I,Q,y,15,8,0)},i.deflateInit2=vt,i.deflateReset=_t,i.deflateResetKeep=Ce,i.deflateSetHeader=function(I,Q){return I&&I.state?I.state.wrap!==2?p:(I.state.gzhead=Q,f):p},i.deflate=function(I,Q){var J,z,D,Y;if(!I||!I.state||5<Q||Q<0)return I?U(I,p):p;if(z=I.state,!I.output||!I.input&&I.avail_in!==0||z.status===666&&Q!==h)return U(I,I.avail_out===0?-5:p);if(z.strm=I,J=z.last_flush,z.last_flush=Q,z.status===A)if(z.wrap===2)I.adler=0,G(z,31),G(z,139),G(z,8),z.gzhead?(G(z,(z.gzhead.text?1:0)+(z.gzhead.hcrc?2:0)+(z.gzhead.extra?4:0)+(z.gzhead.name?8:0)+(z.gzhead.comment?16:0)),G(z,255&z.gzhead.time),G(z,z.gzhead.time>>8&255),G(z,z.gzhead.time>>16&255),G(z,z.gzhead.time>>24&255),G(z,z.level===9?2:2<=z.strategy||z.level<2?4:0),G(z,255&z.gzhead.os),z.gzhead.extra&&z.gzhead.extra.length&&(G(z,255&z.gzhead.extra.length),G(z,z.gzhead.extra.length>>8&255)),z.gzhead.hcrc&&(I.adler=c(I.adler,z.pending_buf,z.pending,0)),z.gzindex=0,z.status=69):(G(z,0),G(z,0),G(z,0),G(z,0),G(z,0),G(z,z.level===9?2:2<=z.strategy||z.level<2?4:0),G(z,3),z.status=M);else{var ne=y+(z.w_bits-8<<4)<<8;ne|=(2<=z.strategy||z.level<2?0:z.level<6?1:z.level===6?2:3)<<6,z.strstart!==0&&(ne|=32),ne+=31-ne%31,z.status=M,R(z,ne),z.strstart!==0&&(R(z,I.adler>>>16),R(z,65535&I.adler)),I.adler=1}if(z.status===69)if(z.gzhead.extra){for(D=z.pending;z.gzindex<(65535&z.gzhead.extra.length)&&(z.pending!==z.pending_buf_size||(z.gzhead.hcrc&&z.pending>D&&(I.adler=c(I.adler,z.pending_buf,z.pending-D,D)),O(I),D=z.pending,z.pending!==z.pending_buf_size));)G(z,255&z.gzhead.extra[z.gzindex]),z.gzindex++;z.gzhead.hcrc&&z.pending>D&&(I.adler=c(I.adler,z.pending_buf,z.pending-D,D)),z.gzindex===z.gzhead.extra.length&&(z.gzindex=0,z.status=73)}else z.status=73;if(z.status===73)if(z.gzhead.name){D=z.pending;do{if(z.pending===z.pending_buf_size&&(z.gzhead.hcrc&&z.pending>D&&(I.adler=c(I.adler,z.pending_buf,z.pending-D,D)),O(I),D=z.pending,z.pending===z.pending_buf_size)){Y=1;break}Y=z.gzindex<z.gzhead.name.length?255&z.gzhead.name.charCodeAt(z.gzindex++):0,G(z,Y)}while(Y!==0);z.gzhead.hcrc&&z.pending>D&&(I.adler=c(I.adler,z.pending_buf,z.pending-D,D)),Y===0&&(z.gzindex=0,z.status=91)}else z.status=91;if(z.status===91)if(z.gzhead.comment){D=z.pending;do{if(z.pending===z.pending_buf_size&&(z.gzhead.hcrc&&z.pending>D&&(I.adler=c(I.adler,z.pending_buf,z.pending-D,D)),O(I),D=z.pending,z.pending===z.pending_buf_size)){Y=1;break}Y=z.gzindex<z.gzhead.comment.length?255&z.gzhead.comment.charCodeAt(z.gzindex++):0,G(z,Y)}while(Y!==0);z.gzhead.hcrc&&z.pending>D&&(I.adler=c(I.adler,z.pending_buf,z.pending-D,D)),Y===0&&(z.status=103)}else z.status=103;if(z.status===103&&(z.gzhead.hcrc?(z.pending+2>z.pending_buf_size&&O(I),z.pending+2<=z.pending_buf_size&&(G(z,255&I.adler),G(z,I.adler>>8&255),I.adler=0,z.status=M)):z.status=M),z.pending!==0){if(O(I),I.avail_out===0)return z.last_flush=-1,f}else if(I.avail_in===0&&B(Q)<=B(J)&&Q!==h)return U(I,-5);if(z.status===666&&I.avail_in!==0)return U(I,-5);if(I.avail_in!==0||z.lookahead!==0||Q!==d&&z.status!==666){var re=z.strategy===2?function(X,ie){for(var he;;){if(X.lookahead===0&&(W(X),X.lookahead===0)){if(ie===d)return b;break}if(X.match_length=0,he=a._tr_tally(X,0,X.window[X.strstart]),X.lookahead--,X.strstart++,he&&($(X,!1),X.strm.avail_out===0))return b}return X.insert=0,ie===h?($(X,!0),X.strm.avail_out===0?V:H):X.last_lit&&($(X,!1),X.strm.avail_out===0)?b:j}(z,Q):z.strategy===3?function(X,ie){for(var he,le,ve,Ge,ke=X.window;;){if(X.lookahead<=F){if(W(X),X.lookahead<=F&&ie===d)return b;if(X.lookahead===0)break}if(X.match_length=0,X.lookahead>=P&&0<X.strstart&&(le=ke[ve=X.strstart-1])===ke[++ve]&&le===ke[++ve]&&le===ke[++ve]){Ge=X.strstart+F;do;while(le===ke[++ve]&&le===ke[++ve]&&le===ke[++ve]&&le===ke[++ve]&&le===ke[++ve]&&le===ke[++ve]&&le===ke[++ve]&&le===ke[++ve]&&ve<Ge);X.match_length=F-(Ge-ve),X.match_length>X.lookahead&&(X.match_length=X.lookahead)}if(X.match_length>=P?(he=a._tr_tally(X,1,X.match_length-P),X.lookahead-=X.match_length,X.strstart+=X.match_length,X.match_length=0):(he=a._tr_tally(X,0,X.window[X.strstart]),X.lookahead--,X.strstart++),he&&($(X,!1),X.strm.avail_out===0))return b}return X.insert=0,ie===h?($(X,!0),X.strm.avail_out===0?V:H):X.last_lit&&($(X,!1),X.strm.avail_out===0)?b:j}(z,Q):s[z.level].func(z,Q);if(re!==V&&re!==H||(z.status=666),re===b||re===V)return I.avail_out===0&&(z.last_flush=-1),f;if(re===j&&(Q===1?a._tr_align(z):Q!==5&&(a._tr_stored_block(z,0,0,!1),Q===3&&(N(z.head),z.lookahead===0&&(z.strstart=0,z.block_start=0,z.insert=0))),O(I),I.avail_out===0))return z.last_flush=-1,f}return Q!==h?f:z.wrap<=0?1:(z.wrap===2?(G(z,255&I.adler),G(z,I.adler>>8&255),G(z,I.adler>>16&255),G(z,I.adler>>24&255),G(z,255&I.total_in),G(z,I.total_in>>8&255),G(z,I.total_in>>16&255),G(z,I.total_in>>24&255)):(R(z,I.adler>>>16),R(z,65535&I.adler)),O(I),0<z.wrap&&(z.wrap=-z.wrap),z.pending!==0?f:1)},i.deflateEnd=function(I){var Q;return I&&I.state?(Q=I.state.status)!==A&&Q!==69&&Q!==73&&Q!==91&&Q!==103&&Q!==M&&Q!==666?U(I,p):(I.state=null,Q===M?U(I,-3):f):p},i.deflateSetDictionary=function(I,Q){var J,z,D,Y,ne,re,X,ie,he=Q.length;if(!I||!I.state||(Y=(J=I.state).wrap)===2||Y===1&&J.status!==A||J.lookahead)return p;for(Y===1&&(I.adler=l(I.adler,Q,he,0)),J.wrap=0,he>=J.w_size&&(Y===0&&(N(J.head),J.strstart=0,J.block_start=0,J.insert=0),ie=new o.Buf8(J.w_size),o.arraySet(ie,Q,he-J.w_size,J.w_size,0),Q=ie,he=J.w_size),ne=I.avail_in,re=I.next_in,X=I.input,I.avail_in=he,I.next_in=0,I.input=Q,W(J);J.lookahead>=P;){for(z=J.strstart,D=J.lookahead-(P-1);J.ins_h=(J.ins_h<<J.hash_shift^J.window[z+P-1])&J.hash_mask,J.prev[z&J.w_mask]=J.head[J.ins_h],J.head[J.ins_h]=z,z++,--D;);J.strstart=z,J.lookahead=P-1,W(J)}return J.strstart+=J.lookahead,J.block_start=J.strstart,J.insert=J.lookahead,J.lookahead=0,J.match_length=J.prev_length=P-1,J.match_available=0,I.next_in=re,I.input=X,I.avail_in=ne,J.wrap=Y,f},i.deflateInfo="pako deflate (from Nodeca project)"},{"../utils/common":41,"./adler32":43,"./crc32":45,"./messages":51,"./trees":52}],47:[function(n,r,i){r.exports=function(){this.text=0,this.time=0,this.xflags=0,this.os=0,this.extra=null,this.extra_len=0,this.name="",this.comment="",this.hcrc=0,this.done=!1}},{}],48:[function(n,r,i){r.exports=function(s,o){var a,l,c,u,d,h,f,p,m,_,g,y,v,w,x,S,C,T,P,F,k,A,M,b,j;a=s.state,l=s.next_in,b=s.input,c=l+(s.avail_in-5),u=s.next_out,j=s.output,d=u-(o-s.avail_out),h=u+(s.avail_out-257),f=a.dmax,p=a.wsize,m=a.whave,_=a.wnext,g=a.window,y=a.hold,v=a.bits,w=a.lencode,x=a.distcode,S=(1<<a.lenbits)-1,C=(1<<a.distbits)-1;e:do{v<15&&(y+=b[l++]<<v,v+=8,y+=b[l++]<<v,v+=8),T=w[y&S];t:for(;;){if(y>>>=P=T>>>24,v-=P,(P=T>>>16&255)===0)j[u++]=65535&T;else{if(!(16&P)){if(!(64&P)){T=w[(65535&T)+(y&(1<<P)-1)];continue t}if(32&P){a.mode=12;break e}s.msg="invalid literal/length code",a.mode=30;break e}F=65535&T,(P&=15)&&(v<P&&(y+=b[l++]<<v,v+=8),F+=y&(1<<P)-1,y>>>=P,v-=P),v<15&&(y+=b[l++]<<v,v+=8,y+=b[l++]<<v,v+=8),T=x[y&C];n:for(;;){if(y>>>=P=T>>>24,v-=P,!(16&(P=T>>>16&255))){if(!(64&P)){T=x[(65535&T)+(y&(1<<P)-1)];continue n}s.msg="invalid distance code",a.mode=30;break e}if(k=65535&T,v<(P&=15)&&(y+=b[l++]<<v,(v+=8)<P&&(y+=b[l++]<<v,v+=8)),f<(k+=y&(1<<P)-1)){s.msg="invalid distance too far back",a.mode=30;break e}if(y>>>=P,v-=P,(P=u-d)<k){if(m<(P=k-P)&&a.sane){s.msg="invalid distance too far back",a.mode=30;break e}if(M=g,(A=0)===_){if(A+=p-P,P<F){for(F-=P;j[u++]=g[A++],--P;);A=u-k,M=j}}else if(_<P){if(A+=p+_-P,(P-=_)<F){for(F-=P;j[u++]=g[A++],--P;);if(A=0,_<F){for(F-=P=_;j[u++]=g[A++],--P;);A=u-k,M=j}}}else if(A+=_-P,P<F){for(F-=P;j[u++]=g[A++],--P;);A=u-k,M=j}for(;2<F;)j[u++]=M[A++],j[u++]=M[A++],j[u++]=M[A++],F-=3;F&&(j[u++]=M[A++],1<F&&(j[u++]=M[A++]))}else{for(A=u-k;j[u++]=j[A++],j[u++]=j[A++],j[u++]=j[A++],2<(F-=3););F&&(j[u++]=j[A++],1<F&&(j[u++]=j[A++]))}break}}break}}while(l<c&&u<h);l-=F=v>>3,y&=(1<<(v-=F<<3))-1,s.next_in=l,s.next_out=u,s.avail_in=l<c?c-l+5:5-(l-c),s.avail_out=u<h?h-u+257:257-(u-h),a.hold=y,a.bits=v}},{}],49:[function(n,r,i){var s=n("../utils/common"),o=n("./adler32"),a=n("./crc32"),l=n("./inffast"),c=n("./inftrees"),u=1,d=2,h=0,f=-2,p=1,m=852,_=592;function g(A){return(A>>>24&255)+(A>>>8&65280)+((65280&A)<<8)+((255&A)<<24)}function y(){this.mode=0,this.last=!1,this.wrap=0,this.havedict=!1,this.flags=0,this.dmax=0,this.check=0,this.total=0,this.head=null,this.wbits=0,this.wsize=0,this.whave=0,this.wnext=0,this.window=null,this.hold=0,this.bits=0,this.length=0,this.offset=0,this.extra=0,this.lencode=null,this.distcode=null,this.lenbits=0,this.distbits=0,this.ncode=0,this.nlen=0,this.ndist=0,this.have=0,this.next=null,this.lens=new s.Buf16(320),this.work=new s.Buf16(288),this.lendyn=null,this.distdyn=null,this.sane=0,this.back=0,this.was=0}function v(A){var M;return A&&A.state?(M=A.state,A.total_in=A.total_out=M.total=0,A.msg="",M.wrap&&(A.adler=1&M.wrap),M.mode=p,M.last=0,M.havedict=0,M.dmax=32768,M.head=null,M.hold=0,M.bits=0,M.lencode=M.lendyn=new s.Buf32(m),M.distcode=M.distdyn=new s.Buf32(_),M.sane=1,M.back=-1,h):f}function w(A){var M;return A&&A.state?((M=A.state).wsize=0,M.whave=0,M.wnext=0,v(A)):f}function x(A,M){var b,j;return A&&A.state?(j=A.state,M<0?(b=0,M=-M):(b=1+(M>>4),M<48&&(M&=15)),M&&(M<8||15<M)?f:(j.window!==null&&j.wbits!==M&&(j.window=null),j.wrap=b,j.wbits=M,w(A))):f}function S(A,M){var b,j;return A?(j=new y,(A.state=j).window=null,(b=x(A,M))!==h&&(A.state=null),b):f}var C,T,P=!0;function F(A){if(P){var M;for(C=new s.Buf32(512),T=new s.Buf32(32),M=0;M<144;)A.lens[M++]=8;for(;M<256;)A.lens[M++]=9;for(;M<280;)A.lens[M++]=7;for(;M<288;)A.lens[M++]=8;for(c(u,A.lens,0,288,C,0,A.work,{bits:9}),M=0;M<32;)A.lens[M++]=5;c(d,A.lens,0,32,T,0,A.work,{bits:5}),P=!1}A.lencode=C,A.lenbits=9,A.distcode=T,A.distbits=5}function k(A,M,b,j){var V,H=A.state;return H.window===null&&(H.wsize=1<<H.wbits,H.wnext=0,H.whave=0,H.window=new s.Buf8(H.wsize)),j>=H.wsize?(s.arraySet(H.window,M,b-H.wsize,H.wsize,0),H.wnext=0,H.whave=H.wsize):(j<(V=H.wsize-H.wnext)&&(V=j),s.arraySet(H.window,M,b-j,V,H.wnext),(j-=V)?(s.arraySet(H.window,M,b-j,j,0),H.wnext=j,H.whave=H.wsize):(H.wnext+=V,H.wnext===H.wsize&&(H.wnext=0),H.whave<H.wsize&&(H.whave+=V))),0}i.inflateReset=w,i.inflateReset2=x,i.inflateResetKeep=v,i.inflateInit=function(A){return S(A,15)},i.inflateInit2=S,i.inflate=function(A,M){var b,j,V,H,U,B,N,O,$,G,R,L,W,te,ee,ce,ge,Ce,_t,vt,I,Q,J,z,D=0,Y=new s.Buf8(4),ne=[16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15];if(!A||!A.state||!A.output||!A.input&&A.avail_in!==0)return f;(b=A.state).mode===12&&(b.mode=13),U=A.next_out,V=A.output,N=A.avail_out,H=A.next_in,j=A.input,B=A.avail_in,O=b.hold,$=b.bits,G=B,R=N,Q=h;e:for(;;)switch(b.mode){case p:if(b.wrap===0){b.mode=13;break}for(;$<16;){if(B===0)break e;B--,O+=j[H++]<<$,$+=8}if(2&b.wrap&&O===35615){Y[b.check=0]=255&O,Y[1]=O>>>8&255,b.check=a(b.check,Y,2,0),$=O=0,b.mode=2;break}if(b.flags=0,b.head&&(b.head.done=!1),!(1&b.wrap)||(((255&O)<<8)+(O>>8))%31){A.msg="incorrect header check",b.mode=30;break}if((15&O)!=8){A.msg="unknown compression method",b.mode=30;break}if($-=4,I=8+(15&(O>>>=4)),b.wbits===0)b.wbits=I;else if(I>b.wbits){A.msg="invalid window size",b.mode=30;break}b.dmax=1<<I,A.adler=b.check=1,b.mode=512&O?10:12,$=O=0;break;case 2:for(;$<16;){if(B===0)break e;B--,O+=j[H++]<<$,$+=8}if(b.flags=O,(255&b.flags)!=8){A.msg="unknown compression method",b.mode=30;break}if(57344&b.flags){A.msg="unknown header flags set",b.mode=30;break}b.head&&(b.head.text=O>>8&1),512&b.flags&&(Y[0]=255&O,Y[1]=O>>>8&255,b.check=a(b.check,Y,2,0)),$=O=0,b.mode=3;case 3:for(;$<32;){if(B===0)break e;B--,O+=j[H++]<<$,$+=8}b.head&&(b.head.time=O),512&b.flags&&(Y[0]=255&O,Y[1]=O>>>8&255,Y[2]=O>>>16&255,Y[3]=O>>>24&255,b.check=a(b.check,Y,4,0)),$=O=0,b.mode=4;case 4:for(;$<16;){if(B===0)break e;B--,O+=j[H++]<<$,$+=8}b.head&&(b.head.xflags=255&O,b.head.os=O>>8),512&b.flags&&(Y[0]=255&O,Y[1]=O>>>8&255,b.check=a(b.check,Y,2,0)),$=O=0,b.mode=5;case 5:if(1024&b.flags){for(;$<16;){if(B===0)break e;B--,O+=j[H++]<<$,$+=8}b.length=O,b.head&&(b.head.extra_len=O),512&b.flags&&(Y[0]=255&O,Y[1]=O>>>8&255,b.check=a(b.check,Y,2,0)),$=O=0}else b.head&&(b.head.extra=null);b.mode=6;case 6:if(1024&b.flags&&(B<(L=b.length)&&(L=B),L&&(b.head&&(I=b.head.extra_len-b.length,b.head.extra||(b.head.extra=new Array(b.head.extra_len)),s.arraySet(b.head.extra,j,H,L,I)),512&b.flags&&(b.check=a(b.check,j,L,H)),B-=L,H+=L,b.length-=L),b.length))break e;b.length=0,b.mode=7;case 7:if(2048&b.flags){if(B===0)break e;for(L=0;I=j[H+L++],b.head&&I&&b.length<65536&&(b.head.name+=String.fromCharCode(I)),I&&L<B;);if(512&b.flags&&(b.check=a(b.check,j,L,H)),B-=L,H+=L,I)break e}else b.head&&(b.head.name=null);b.length=0,b.mode=8;case 8:if(4096&b.flags){if(B===0)break e;for(L=0;I=j[H+L++],b.head&&I&&b.length<65536&&(b.head.comment+=String.fromCharCode(I)),I&&L<B;);if(512&b.flags&&(b.check=a(b.check,j,L,H)),B-=L,H+=L,I)break e}else b.head&&(b.head.comment=null);b.mode=9;case 9:if(512&b.flags){for(;$<16;){if(B===0)break e;B--,O+=j[H++]<<$,$+=8}if(O!==(65535&b.check)){A.msg="header crc mismatch",b.mode=30;break}$=O=0}b.head&&(b.head.hcrc=b.flags>>9&1,b.head.done=!0),A.adler=b.check=0,b.mode=12;break;case 10:for(;$<32;){if(B===0)break e;B--,O+=j[H++]<<$,$+=8}A.adler=b.check=g(O),$=O=0,b.mode=11;case 11:if(b.havedict===0)return A.next_out=U,A.avail_out=N,A.next_in=H,A.avail_in=B,b.hold=O,b.bits=$,2;A.adler=b.check=1,b.mode=12;case 12:if(M===5||M===6)break e;case 13:if(b.last){O>>>=7&$,$-=7&$,b.mode=27;break}for(;$<3;){if(B===0)break e;B--,O+=j[H++]<<$,$+=8}switch(b.last=1&O,$-=1,3&(O>>>=1)){case 0:b.mode=14;break;case 1:if(F(b),b.mode=20,M!==6)break;O>>>=2,$-=2;break e;case 2:b.mode=17;break;case 3:A.msg="invalid block type",b.mode=30}O>>>=2,$-=2;break;case 14:for(O>>>=7&$,$-=7&$;$<32;){if(B===0)break e;B--,O+=j[H++]<<$,$+=8}if((65535&O)!=(O>>>16^65535)){A.msg="invalid stored block lengths",b.mode=30;break}if(b.length=65535&O,$=O=0,b.mode=15,M===6)break e;case 15:b.mode=16;case 16:if(L=b.length){if(B<L&&(L=B),N<L&&(L=N),L===0)break e;s.arraySet(V,j,H,L,U),B-=L,H+=L,N-=L,U+=L,b.length-=L;break}b.mode=12;break;case 17:for(;$<14;){if(B===0)break e;B--,O+=j[H++]<<$,$+=8}if(b.nlen=257+(31&O),O>>>=5,$-=5,b.ndist=1+(31&O),O>>>=5,$-=5,b.ncode=4+(15&O),O>>>=4,$-=4,286<b.nlen||30<b.ndist){A.msg="too many length or distance symbols",b.mode=30;break}b.have=0,b.mode=18;case 18:for(;b.have<b.ncode;){for(;$<3;){if(B===0)break e;B--,O+=j[H++]<<$,$+=8}b.lens[ne[b.have++]]=7&O,O>>>=3,$-=3}for(;b.have<19;)b.lens[ne[b.have++]]=0;if(b.lencode=b.lendyn,b.lenbits=7,J={bits:b.lenbits},Q=c(0,b.lens,0,19,b.lencode,0,b.work,J),b.lenbits=J.bits,Q){A.msg="invalid code lengths set",b.mode=30;break}b.have=0,b.mode=19;case 19:for(;b.have<b.nlen+b.ndist;){for(;ce=(D=b.lencode[O&(1<<b.lenbits)-1])>>>16&255,ge=65535&D,!((ee=D>>>24)<=$);){if(B===0)break e;B--,O+=j[H++]<<$,$+=8}if(ge<16)O>>>=ee,$-=ee,b.lens[b.have++]=ge;else{if(ge===16){for(z=ee+2;$<z;){if(B===0)break e;B--,O+=j[H++]<<$,$+=8}if(O>>>=ee,$-=ee,b.have===0){A.msg="invalid bit length repeat",b.mode=30;break}I=b.lens[b.have-1],L=3+(3&O),O>>>=2,$-=2}else if(ge===17){for(z=ee+3;$<z;){if(B===0)break e;B--,O+=j[H++]<<$,$+=8}$-=ee,I=0,L=3+(7&(O>>>=ee)),O>>>=3,$-=3}else{for(z=ee+7;$<z;){if(B===0)break e;B--,O+=j[H++]<<$,$+=8}$-=ee,I=0,L=11+(127&(O>>>=ee)),O>>>=7,$-=7}if(b.have+L>b.nlen+b.ndist){A.msg="invalid bit length repeat",b.mode=30;break}for(;L--;)b.lens[b.have++]=I}}if(b.mode===30)break;if(b.lens[256]===0){A.msg="invalid code -- missing end-of-block",b.mode=30;break}if(b.lenbits=9,J={bits:b.lenbits},Q=c(u,b.lens,0,b.nlen,b.lencode,0,b.work,J),b.lenbits=J.bits,Q){A.msg="invalid literal/lengths set",b.mode=30;break}if(b.distbits=6,b.distcode=b.distdyn,J={bits:b.distbits},Q=c(d,b.lens,b.nlen,b.ndist,b.distcode,0,b.work,J),b.distbits=J.bits,Q){A.msg="invalid distances set",b.mode=30;break}if(b.mode=20,M===6)break e;case 20:b.mode=21;case 21:if(6<=B&&258<=N){A.next_out=U,A.avail_out=N,A.next_in=H,A.avail_in=B,b.hold=O,b.bits=$,l(A,R),U=A.next_out,V=A.output,N=A.avail_out,H=A.next_in,j=A.input,B=A.avail_in,O=b.hold,$=b.bits,b.mode===12&&(b.back=-1);break}for(b.back=0;ce=(D=b.lencode[O&(1<<b.lenbits)-1])>>>16&255,ge=65535&D,!((ee=D>>>24)<=$);){if(B===0)break e;B--,O+=j[H++]<<$,$+=8}if(ce&&!(240&ce)){for(Ce=ee,_t=ce,vt=ge;ce=(D=b.lencode[vt+((O&(1<<Ce+_t)-1)>>Ce)])>>>16&255,ge=65535&D,!(Ce+(ee=D>>>24)<=$);){if(B===0)break e;B--,O+=j[H++]<<$,$+=8}O>>>=Ce,$-=Ce,b.back+=Ce}if(O>>>=ee,$-=ee,b.back+=ee,b.length=ge,ce===0){b.mode=26;break}if(32&ce){b.back=-1,b.mode=12;break}if(64&ce){A.msg="invalid literal/length code",b.mode=30;break}b.extra=15&ce,b.mode=22;case 22:if(b.extra){for(z=b.extra;$<z;){if(B===0)break e;B--,O+=j[H++]<<$,$+=8}b.length+=O&(1<<b.extra)-1,O>>>=b.extra,$-=b.extra,b.back+=b.extra}b.was=b.length,b.mode=23;case 23:for(;ce=(D=b.distcode[O&(1<<b.distbits)-1])>>>16&255,ge=65535&D,!((ee=D>>>24)<=$);){if(B===0)break e;B--,O+=j[H++]<<$,$+=8}if(!(240&ce)){for(Ce=ee,_t=ce,vt=ge;ce=(D=b.distcode[vt+((O&(1<<Ce+_t)-1)>>Ce)])>>>16&255,ge=65535&D,!(Ce+(ee=D>>>24)<=$);){if(B===0)break e;B--,O+=j[H++]<<$,$+=8}O>>>=Ce,$-=Ce,b.back+=Ce}if(O>>>=ee,$-=ee,b.back+=ee,64&ce){A.msg="invalid distance code",b.mode=30;break}b.offset=ge,b.extra=15&ce,b.mode=24;case 24:if(b.extra){for(z=b.extra;$<z;){if(B===0)break e;B--,O+=j[H++]<<$,$+=8}b.offset+=O&(1<<b.extra)-1,O>>>=b.extra,$-=b.extra,b.back+=b.extra}if(b.offset>b.dmax){A.msg="invalid distance too far back",b.mode=30;break}b.mode=25;case 25:if(N===0)break e;if(L=R-N,b.offset>L){if((L=b.offset-L)>b.whave&&b.sane){A.msg="invalid distance too far back",b.mode=30;break}W=L>b.wnext?(L-=b.wnext,b.wsize-L):b.wnext-L,L>b.length&&(L=b.length),te=b.window}else te=V,W=U-b.offset,L=b.length;for(N<L&&(L=N),N-=L,b.length-=L;V[U++]=te[W++],--L;);b.length===0&&(b.mode=21);break;case 26:if(N===0)break e;V[U++]=b.length,N--,b.mode=21;break;case 27:if(b.wrap){for(;$<32;){if(B===0)break e;B--,O|=j[H++]<<$,$+=8}if(R-=N,A.total_out+=R,b.total+=R,R&&(A.adler=b.check=b.flags?a(b.check,V,R,U-R):o(b.check,V,R,U-R)),R=N,(b.flags?O:g(O))!==b.check){A.msg="incorrect data check",b.mode=30;break}$=O=0}b.mode=28;case 28:if(b.wrap&&b.flags){for(;$<32;){if(B===0)break e;B--,O+=j[H++]<<$,$+=8}if(O!==(4294967295&b.total)){A.msg="incorrect length check",b.mode=30;break}$=O=0}b.mode=29;case 29:Q=1;break e;case 30:Q=-3;break e;case 31:return-4;case 32:default:return f}return A.next_out=U,A.avail_out=N,A.next_in=H,A.avail_in=B,b.hold=O,b.bits=$,(b.wsize||R!==A.avail_out&&b.mode<30&&(b.mode<27||M!==4))&&k(A,A.output,A.next_out,R-A.avail_out)?(b.mode=31,-4):(G-=A.avail_in,R-=A.avail_out,A.total_in+=G,A.total_out+=R,b.total+=R,b.wrap&&R&&(A.adler=b.check=b.flags?a(b.check,V,R,A.next_out-R):o(b.check,V,R,A.next_out-R)),A.data_type=b.bits+(b.last?64:0)+(b.mode===12?128:0)+(b.mode===20||b.mode===15?256:0),(G==0&&R===0||M===4)&&Q===h&&(Q=-5),Q)},i.inflateEnd=function(A){if(!A||!A.state)return f;var M=A.state;return M.window&&(M.window=null),A.state=null,h},i.inflateGetHeader=function(A,M){var b;return A&&A.state&&2&(b=A.state).wrap?((b.head=M).done=!1,h):f},i.inflateSetDictionary=function(A,M){var b,j=M.length;return A&&A.state?(b=A.state).wrap!==0&&b.mode!==11?f:b.mode===11&&o(1,M,j,0)!==b.check?-3:k(A,M,j,j)?(b.mode=31,-4):(b.havedict=1,h):f},i.inflateInfo="pako inflate (from Nodeca project)"},{"../utils/common":41,"./adler32":43,"./crc32":45,"./inffast":48,"./inftrees":50}],50:[function(n,r,i){var s=n("../utils/common"),o=[3,4,5,6,7,8,9,10,11,13,15,17,19,23,27,31,35,43,51,59,67,83,99,115,131,163,195,227,258,0,0],a=[16,16,16,16,16,16,16,16,17,17,17,17,18,18,18,18,19,19,19,19,20,20,20,20,21,21,21,21,16,72,78],l=[1,2,3,4,5,7,9,13,17,25,33,49,65,97,129,193,257,385,513,769,1025,1537,2049,3073,4097,6145,8193,12289,16385,24577,0,0],c=[16,16,16,16,17,17,18,18,19,19,20,20,21,21,22,22,23,23,24,24,25,25,26,26,27,27,28,28,29,29,64,64];r.exports=function(u,d,h,f,p,m,_,g){var y,v,w,x,S,C,T,P,F,k=g.bits,A=0,M=0,b=0,j=0,V=0,H=0,U=0,B=0,N=0,O=0,$=null,G=0,R=new s.Buf16(16),L=new s.Buf16(16),W=null,te=0;for(A=0;A<=15;A++)R[A]=0;for(M=0;M<f;M++)R[d[h+M]]++;for(V=k,j=15;1<=j&&R[j]===0;j--);if(j<V&&(V=j),j===0)return p[m++]=20971520,p[m++]=20971520,g.bits=1,0;for(b=1;b<j&&R[b]===0;b++);for(V<b&&(V=b),A=B=1;A<=15;A++)if(B<<=1,(B-=R[A])<0)return-1;if(0<B&&(u===0||j!==1))return-1;for(L[1]=0,A=1;A<15;A++)L[A+1]=L[A]+R[A];for(M=0;M<f;M++)d[h+M]!==0&&(_[L[d[h+M]]++]=M);if(C=u===0?($=W=_,19):u===1?($=o,G-=257,W=a,te-=257,256):($=l,W=c,-1),A=b,S=m,U=M=O=0,w=-1,x=(N=1<<(H=V))-1,u===1&&852<N||u===2&&592<N)return 1;for(;;){for(T=A-U,F=_[M]<C?(P=0,_[M]):_[M]>C?(P=W[te+_[M]],$[G+_[M]]):(P=96,0),y=1<<A-U,b=v=1<<H;p[S+(O>>U)+(v-=y)]=T<<24|P<<16|F|0,v!==0;);for(y=1<<A-1;O&y;)y>>=1;if(y!==0?(O&=y-1,O+=y):O=0,M++,--R[A]==0){if(A===j)break;A=d[h+_[M]]}if(V<A&&(O&x)!==w){for(U===0&&(U=V),S+=b,B=1<<(H=A-U);H+U<j&&!((B-=R[H+U])<=0);)H++,B<<=1;if(N+=1<<H,u===1&&852<N||u===2&&592<N)return 1;p[w=O&x]=V<<24|H<<16|S-m|0}}return O!==0&&(p[S+O]=A-U<<24|64<<16|0),g.bits=V,0}},{"../utils/common":41}],51:[function(n,r,i){r.exports={2:"need dictionary",1:"stream end",0:"","-1":"file error","-2":"stream error","-3":"data error","-4":"insufficient memory","-5":"buffer error","-6":"incompatible version"}},{}],52:[function(n,r,i){var s=n("../utils/common"),o=0,a=1;function l(D){for(var Y=D.length;0<=--Y;)D[Y]=0}var c=0,u=29,d=256,h=d+1+u,f=30,p=19,m=2*h+1,_=15,g=16,y=7,v=256,w=16,x=17,S=18,C=[0,0,0,0,0,0,0,0,1,1,1,1,2,2,2,2,3,3,3,3,4,4,4,4,5,5,5,5,0],T=[0,0,0,0,1,1,2,2,3,3,4,4,5,5,6,6,7,7,8,8,9,9,10,10,11,11,12,12,13,13],P=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,2,3,7],F=[16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15],k=new Array(2*(h+2));l(k);var A=new Array(2*f);l(A);var M=new Array(512);l(M);var b=new Array(256);l(b);var j=new Array(u);l(j);var V,H,U,B=new Array(f);function N(D,Y,ne,re,X){this.static_tree=D,this.extra_bits=Y,this.extra_base=ne,this.elems=re,this.max_length=X,this.has_stree=D&&D.length}function O(D,Y){this.dyn_tree=D,this.max_code=0,this.stat_desc=Y}function $(D){return D<256?M[D]:M[256+(D>>>7)]}function G(D,Y){D.pending_buf[D.pending++]=255&Y,D.pending_buf[D.pending++]=Y>>>8&255}function R(D,Y,ne){D.bi_valid>g-ne?(D.bi_buf|=Y<<D.bi_valid&65535,G(D,D.bi_buf),D.bi_buf=Y>>g-D.bi_valid,D.bi_valid+=ne-g):(D.bi_buf|=Y<<D.bi_valid&65535,D.bi_valid+=ne)}function L(D,Y,ne){R(D,ne[2*Y],ne[2*Y+1])}function W(D,Y){for(var ne=0;ne|=1&D,D>>>=1,ne<<=1,0<--Y;);return ne>>>1}function te(D,Y,ne){var re,X,ie=new Array(_+1),he=0;for(re=1;re<=_;re++)ie[re]=he=he+ne[re-1]<<1;for(X=0;X<=Y;X++){var le=D[2*X+1];le!==0&&(D[2*X]=W(ie[le]++,le))}}function ee(D){var Y;for(Y=0;Y<h;Y++)D.dyn_ltree[2*Y]=0;for(Y=0;Y<f;Y++)D.dyn_dtree[2*Y]=0;for(Y=0;Y<p;Y++)D.bl_tree[2*Y]=0;D.dyn_ltree[2*v]=1,D.opt_len=D.static_len=0,D.last_lit=D.matches=0}function ce(D){8<D.bi_valid?G(D,D.bi_buf):0<D.bi_valid&&(D.pending_buf[D.pending++]=D.bi_buf),D.bi_buf=0,D.bi_valid=0}function ge(D,Y,ne,re){var X=2*Y,ie=2*ne;return D[X]<D[ie]||D[X]===D[ie]&&re[Y]<=re[ne]}function Ce(D,Y,ne){for(var re=D.heap[ne],X=ne<<1;X<=D.heap_len&&(X<D.heap_len&&ge(Y,D.heap[X+1],D.heap[X],D.depth)&&X++,!ge(Y,re,D.heap[X],D.depth));)D.heap[ne]=D.heap[X],ne=X,X<<=1;D.heap[ne]=re}function _t(D,Y,ne){var re,X,ie,he,le=0;if(D.last_lit!==0)for(;re=D.pending_buf[D.d_buf+2*le]<<8|D.pending_buf[D.d_buf+2*le+1],X=D.pending_buf[D.l_buf+le],le++,re===0?L(D,X,Y):(L(D,(ie=b[X])+d+1,Y),(he=C[ie])!==0&&R(D,X-=j[ie],he),L(D,ie=$(--re),ne),(he=T[ie])!==0&&R(D,re-=B[ie],he)),le<D.last_lit;);L(D,v,Y)}function vt(D,Y){var ne,re,X,ie=Y.dyn_tree,he=Y.stat_desc.static_tree,le=Y.stat_desc.has_stree,ve=Y.stat_desc.elems,Ge=-1;for(D.heap_len=0,D.heap_max=m,ne=0;ne<ve;ne++)ie[2*ne]!==0?(D.heap[++D.heap_len]=Ge=ne,D.depth[ne]=0):ie[2*ne+1]=0;for(;D.heap_len<2;)ie[2*(X=D.heap[++D.heap_len]=Ge<2?++Ge:0)]=1,D.depth[X]=0,D.opt_len--,le&&(D.static_len-=he[2*X+1]);for(Y.max_code=Ge,ne=D.heap_len>>1;1<=ne;ne--)Ce(D,ie,ne);for(X=ve;ne=D.heap[1],D.heap[1]=D.heap[D.heap_len--],Ce(D,ie,1),re=D.heap[1],D.heap[--D.heap_max]=ne,D.heap[--D.heap_max]=re,ie[2*X]=ie[2*ne]+ie[2*re],D.depth[X]=(D.depth[ne]>=D.depth[re]?D.depth[ne]:D.depth[re])+1,ie[2*ne+1]=ie[2*re+1]=X,D.heap[1]=X++,Ce(D,ie,1),2<=D.heap_len;);D.heap[--D.heap_max]=D.heap[1],function(ke,sn){var Pi,Yn,ta,At,na,_l,dr=sn.dyn_tree,Ru=sn.max_code,p_=sn.stat_desc.static_tree,Iu=sn.stat_desc.has_stree,ra=sn.stat_desc.extra_bits,qs=sn.stat_desc.extra_base,ti=sn.stat_desc.max_length,ia=0;for(At=0;At<=_;At++)ke.bl_count[At]=0;for(dr[2*ke.heap[ke.heap_max]+1]=0,Pi=ke.heap_max+1;Pi<m;Pi++)ti<(At=dr[2*dr[2*(Yn=ke.heap[Pi])+1]+1]+1)&&(At=ti,ia++),dr[2*Yn+1]=At,Ru<Yn||(ke.bl_count[At]++,na=0,qs<=Yn&&(na=ra[Yn-qs]),_l=dr[2*Yn],ke.opt_len+=_l*(At+na),Iu&&(ke.static_len+=_l*(p_[2*Yn+1]+na)));if(ia!==0){do{for(At=ti-1;ke.bl_count[At]===0;)At--;ke.bl_count[At]--,ke.bl_count[At+1]+=2,ke.bl_count[ti]--,ia-=2}while(0<ia);for(At=ti;At!==0;At--)for(Yn=ke.bl_count[At];Yn!==0;)Ru<(ta=ke.heap[--Pi])||(dr[2*ta+1]!==At&&(ke.opt_len+=(At-dr[2*ta+1])*dr[2*ta],dr[2*ta+1]=At),Yn--)}}(D,Y),te(ie,Ge,D.bl_count)}function I(D,Y,ne){var re,X,ie=-1,he=Y[1],le=0,ve=7,Ge=4;for(he===0&&(ve=138,Ge=3),Y[2*(ne+1)+1]=65535,re=0;re<=ne;re++)X=he,he=Y[2*(re+1)+1],++le<ve&&X===he||(le<Ge?D.bl_tree[2*X]+=le:X!==0?(X!==ie&&D.bl_tree[2*X]++,D.bl_tree[2*w]++):le<=10?D.bl_tree[2*x]++:D.bl_tree[2*S]++,ie=X,Ge=(le=0)===he?(ve=138,3):X===he?(ve=6,3):(ve=7,4))}function Q(D,Y,ne){var re,X,ie=-1,he=Y[1],le=0,ve=7,Ge=4;for(he===0&&(ve=138,Ge=3),re=0;re<=ne;re++)if(X=he,he=Y[2*(re+1)+1],!(++le<ve&&X===he)){if(le<Ge)for(;L(D,X,D.bl_tree),--le!=0;);else X!==0?(X!==ie&&(L(D,X,D.bl_tree),le--),L(D,w,D.bl_tree),R(D,le-3,2)):le<=10?(L(D,x,D.bl_tree),R(D,le-3,3)):(L(D,S,D.bl_tree),R(D,le-11,7));ie=X,Ge=(le=0)===he?(ve=138,3):X===he?(ve=6,3):(ve=7,4)}}l(B);var J=!1;function z(D,Y,ne,re){R(D,(c<<1)+(re?1:0),3),function(X,ie,he,le){ce(X),G(X,he),G(X,~he),s.arraySet(X.pending_buf,X.window,ie,he,X.pending),X.pending+=he}(D,Y,ne)}i._tr_init=function(D){J||(function(){var Y,ne,re,X,ie,he=new Array(_+1);for(X=re=0;X<u-1;X++)for(j[X]=re,Y=0;Y<1<<C[X];Y++)b[re++]=X;for(b[re-1]=X,X=ie=0;X<16;X++)for(B[X]=ie,Y=0;Y<1<<T[X];Y++)M[ie++]=X;for(ie>>=7;X<f;X++)for(B[X]=ie<<7,Y=0;Y<1<<T[X]-7;Y++)M[256+ie++]=X;for(ne=0;ne<=_;ne++)he[ne]=0;for(Y=0;Y<=143;)k[2*Y+1]=8,Y++,he[8]++;for(;Y<=255;)k[2*Y+1]=9,Y++,he[9]++;for(;Y<=279;)k[2*Y+1]=7,Y++,he[7]++;for(;Y<=287;)k[2*Y+1]=8,Y++,he[8]++;for(te(k,h+1,he),Y=0;Y<f;Y++)A[2*Y+1]=5,A[2*Y]=W(Y,5);V=new N(k,C,d+1,h,_),H=new N(A,T,0,f,_),U=new N(new Array(0),P,0,p,y)}(),J=!0),D.l_desc=new O(D.dyn_ltree,V),D.d_desc=new O(D.dyn_dtree,H),D.bl_desc=new O(D.bl_tree,U),D.bi_buf=0,D.bi_valid=0,ee(D)},i._tr_stored_block=z,i._tr_flush_block=function(D,Y,ne,re){var X,ie,he=0;0<D.level?(D.strm.data_type===2&&(D.strm.data_type=function(le){var ve,Ge=4093624447;for(ve=0;ve<=31;ve++,Ge>>>=1)if(1&Ge&&le.dyn_ltree[2*ve]!==0)return o;if(le.dyn_ltree[18]!==0||le.dyn_ltree[20]!==0||le.dyn_ltree[26]!==0)return a;for(ve=32;ve<d;ve++)if(le.dyn_ltree[2*ve]!==0)return a;return o}(D)),vt(D,D.l_desc),vt(D,D.d_desc),he=function(le){var ve;for(I(le,le.dyn_ltree,le.l_desc.max_code),I(le,le.dyn_dtree,le.d_desc.max_code),vt(le,le.bl_desc),ve=p-1;3<=ve&&le.bl_tree[2*F[ve]+1]===0;ve--);return le.opt_len+=3*(ve+1)+5+5+4,ve}(D),X=D.opt_len+3+7>>>3,(ie=D.static_len+3+7>>>3)<=X&&(X=ie)):X=ie=ne+5,ne+4<=X&&Y!==-1?z(D,Y,ne,re):D.strategy===4||ie===X?(R(D,2+(re?1:0),3),_t(D,k,A)):(R(D,4+(re?1:0),3),function(le,ve,Ge,ke){var sn;for(R(le,ve-257,5),R(le,Ge-1,5),R(le,ke-4,4),sn=0;sn<ke;sn++)R(le,le.bl_tree[2*F[sn]+1],3);Q(le,le.dyn_ltree,ve-1),Q(le,le.dyn_dtree,Ge-1)}(D,D.l_desc.max_code+1,D.d_desc.max_code+1,he+1),_t(D,D.dyn_ltree,D.dyn_dtree)),ee(D),re&&ce(D)},i._tr_tally=function(D,Y,ne){return D.pending_buf[D.d_buf+2*D.last_lit]=Y>>>8&255,D.pending_buf[D.d_buf+2*D.last_lit+1]=255&Y,D.pending_buf[D.l_buf+D.last_lit]=255&ne,D.last_lit++,Y===0?D.dyn_ltree[2*ne]++:(D.matches++,Y--,D.dyn_ltree[2*(b[ne]+d+1)]++,D.dyn_dtree[2*$(Y)]++),D.last_lit===D.lit_bufsize-1},i._tr_align=function(D){R(D,2,3),L(D,v,k),function(Y){Y.bi_valid===16?(G(Y,Y.bi_buf),Y.bi_buf=0,Y.bi_valid=0):8<=Y.bi_valid&&(Y.pending_buf[Y.pending++]=255&Y.bi_buf,Y.bi_buf>>=8,Y.bi_valid-=8)}(D)}},{"../utils/common":41}],53:[function(n,r,i){r.exports=function(){this.input=null,this.next_in=0,this.avail_in=0,this.total_in=0,this.output=null,this.next_out=0,this.avail_out=0,this.total_out=0,this.msg="",this.state=null,this.data_type=2,this.adler=0}},{}],54:[function(n,r,i){(function(s){(function(o,a){if(!o.setImmediate){var l,c,u,d,h=1,f={},p=!1,m=o.document,_=Object.getPrototypeOf&&Object.getPrototypeOf(o);_=_&&_.setTimeout?_:o,l={}.toString.call(o.process)==="[object process]"?function(w){process.nextTick(function(){y(w)})}:function(){if(o.postMessage&&!o.importScripts){var w=!0,x=o.onmessage;return o.onmessage=function(){w=!1},o.postMessage("","*"),o.onmessage=x,w}}()?(d="setImmediate$"+Math.random()+"$",o.addEventListener?o.addEventListener("message",v,!1):o.attachEvent("onmessage",v),function(w){o.postMessage(d+w,"*")}):o.MessageChannel?((u=new MessageChannel).port1.onmessage=function(w){y(w.data)},function(w){u.port2.postMessage(w)}):m&&"onreadystatechange"in m.createElement("script")?(c=m.documentElement,function(w){var x=m.createElement("script");x.onreadystatechange=function(){y(w),x.onreadystatechange=null,c.removeChild(x),x=null},c.appendChild(x)}):function(w){setTimeout(y,0,w)},_.setImmediate=function(w){typeof w!="function"&&(w=new Function(""+w));for(var x=new Array(arguments.length-1),S=0;S<x.length;S++)x[S]=arguments[S+1];var C={callback:w,args:x};return f[h]=C,l(h),h++},_.clearImmediate=g}function g(w){delete f[w]}function y(w){if(p)setTimeout(y,0,w);else{var x=f[w];if(x){p=!0;try{(function(S){var C=S.callback,T=S.args;switch(T.length){case 0:C();break;case 1:C(T[0]);break;case 2:C(T[0],T[1]);break;case 3:C(T[0],T[1],T[2]);break;default:C.apply(a,T)}})(x)}finally{g(w),p=!1}}}}function v(w){w.source===o&&typeof w.data=="string"&&w.data.indexOf(d)===0&&y(+w.data.slice(d.length))}})(typeof self>"u"?s===void 0?this:s:self)}).call(this,typeof po<"u"?po:typeof self<"u"?self:typeof window<"u"?window:{})},{}]},{},[10])(10)})})(BN);var aEe=BN.exports;const lEe=Za(aEe),cEe=["property_boundary.geojson","trees_points.geojson","tree_stands.geojson","bedding_areas.geojson","beds_points.geojson","open_woods.geojson","acorn_flats.geojson","mast_check_points.geojson","big_rocks.geojson","cliffs.geojson","ravines.geojson","streams.geojson","trails.geojson","scrapes.geojson","rubs.geojson","stands.geojson","hunts.geojson","animal_sightings.geojson","animal_paths.geojson"];async function uEe(t){const e=new lEe;for(const s of cEe)try{const o=await window.api.readTextFile(t,`data/${s}`);e.file(s,o||'{"type":"FeatureCollection","features":[]}')}catch{e.file(s,'{"type":"FeatureCollection","features":[]}')}const n=await e.generateAsync({type:"base64"}),i=`exports/true-map_${new Date().toISOString().replace(/[:.]/g,"-")}.zip`;return await window.api.writeBinaryFile(t,i,n),i}async function dEe(t){const e=new wL,n=new ut,r=["trails.geojson","hunts.geojson","animal_sightings.geojson","stands.geojson"],i=[];for(const l of r)try{const c=await window.api.readTextFile(t,`data/${l}`),u=JSON.parse(c||'{"type":"FeatureCollection","features":[]}'),d=n.readFeatures(u,{dataProjection:"EPSG:4326",featureProjection:"EPSG:4326"});i.push(...d)}catch{}const s=e.writeFeatures(i,{dataProjection:"EPSG:4326",featureProjection:"EPSG:4326"}),a=`exports/true-map_${new Date().toISOString().replace(/[:.]/g,"-")}.gpx`;return await window.api.writeTextFile(t,a,s),a}function hEe(t){const e=[5,10,20,50,100,200,500,1e3];let n=e[0];for(const r of e)Math.abs(r-t)<Math.abs(n-t)&&(n=r);return{meters:n,label:n>=1e3?`${n/1e3} km`:`${n} m`}}async function fEe(t){var g,y,v,w;const e=Xm();if(!e)return null;const n=e.getViewport(),r=Array.from(n.querySelectorAll("canvas"));if(r.length===0)return null;const i=r[0].width,s=r[0].height,o=document.createElement("canvas");o.width=i,o.height=s;const a=o.getContext("2d");if(!a)return null;for(const x of r)a.globalAlpha=Number(x.style.opacity||"1")||1,a.drawImage(x,0,0);const c=o.toDataURL("image/png").split(",")[1],u=It.getState().preset,d=It.getState().timeWindow,f=(e.getView().getResolution()||1)*150,p=hEe(f),m=new Date().toISOString().replace(/[:.]/g,"-");return await((w=(v=(y=(g=window.api).invoke)==null?void 0:y.call(g,"print:pdf",t,{imageBase64:c,imageWidth:i,imageHeight:s,preset:u,timeWindow:d,scaleMeters:p.meters,scaleLabel:p.label,timestamp:m}))==null?void 0:v.catch)==null?void 0:w.call(v,()=>window.api.printPdf(t,{imageBase64:c,imageWidth:i,imageHeight:s,preset:u,timeWindow:d,scaleMeters:p.meters,scaleLabel:p.label,timestamp:m})))||null}function gEe(){const{projectPath:t}=He(),[e,n]=K.useState(!1),[r,i]=K.useState("");if(!t)return null;const s=async()=>{i("Exporting");try{const[l,c,u]=await Promise.all([uEe(t),dEe(t),window.api.exportGeoPackage(t)]),d=[l?l.split("/").pop():null,c?c.split("/").pop():null,u?u.split("/").pop():null].filter(Boolean);i(d.length?`Exported: ${d.join(", ")}`:"Export complete")}catch{i("Export failed")}setTimeout(()=>i(""),4e3)},o=async()=>{i("Printing");try{const l=await fEe(t);i(l?`Saved: ${l.split("/").pop()}`:"Print failed")}catch{i("Print failed")}setTimeout(()=>i(""),4e3)},a={padding:"8px 12px",borderRadius:6,border:"1px solid rgba(15,23,42,0.12)",background:"#ffffff",cursor:"pointer",fontSize:12};return e?E.jsxs("div",{style:{position:"fixed",right:16,bottom:16,padding:12,borderRadius:10,border:"1px solid rgba(15,23,42,0.12)",background:"rgba(255,255,255,0.96)",boxShadow:"0 10px 24px rgba(15,23,42,0.18)",zIndex:1200,display:"flex",flexDirection:"column",gap:8,minWidth:220},children:[E.jsxs("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center"},children:[E.jsx("strong",{style:{fontSize:12,color:"rgba(15,23,42,0.8)"},children:"Tools"}),E.jsx("button",{onClick:()=>n(!1),style:{border:"none",background:"transparent",fontSize:12,cursor:"pointer",color:"rgba(15,23,42,0.6)"},children:"Hide"})]}),E.jsx("button",{onClick:()=>{window.dispatchEvent(new Event("boundarytools:open")),n(!1)},style:a,children:"Boundary Tools"}),E.jsx("button",{onClick:()=>void s(),style:a,children:"Export"}),E.jsx("button",{onClick:()=>void o(),style:a,children:"Print Map"}),r?E.jsx("div",{style:{fontSize:11,color:"#334155"},children:r}):null]}):E.jsx("button",{onClick:()=>n(!0),style:{position:"fixed",right:16,bottom:16,padding:"8px 14px",borderRadius:6,border:"1px solid rgba(15,23,42,0.12)",background:"#ffffff",cursor:"pointer",fontSize:13,fontWeight:500,zIndex:1200,boxShadow:"0 6px 18px rgba(15,23,42,0.12)"},title:"Tools",children:"Tools"})}const pEe={display:"flex",flexDirection:"column",gap:8,padding:12,borderRadius:10,background:"rgba(255,255,255,0.95)",border:"1px solid rgba(15,23,42,0.1)",boxShadow:"0 8px 18px rgba(15,23,42,0.08)"},mEe={fontSize:11,fontWeight:600,color:"rgba(15,23,42,0.65)",textTransform:"uppercase",letterSpacing:.8},yEe={display:"flex",gap:6},_x={flex:1,padding:"6px 10px",fontSize:12,borderRadius:6,border:"1px solid rgba(15,23,42,0.12)",background:"#f8fafc",cursor:"pointer",fontWeight:500},OI={..._x,background:"#0f172a",color:"#ffffff",border:"1px solid rgba(15,23,42,0.4)",boxShadow:"0 4px 12px rgba(15,23,42,0.2)"},xg={width:"100%"},dv={fontSize:11,color:"rgba(15,23,42,0.6)",lineHeight:1.3},Eg={display:"flex",justifyContent:"space-between",fontSize:12,color:"rgba(15,23,42,0.75)"};function _Ee(){const{enabled:t,verticalExaggeration:e,setEnabled:n,setVerticalExaggeration:r,ionToken:i,terrainUrl:s,terrariumUrl:o}=UB(g=>({enabled:g.enabled,verticalExaggeration:g.verticalExaggeration,setEnabled:g.setEnabled,setVerticalExaggeration:g.setVerticalExaggeration,ionToken:g.ionToken,terrainUrl:g.terrainUrl,terrariumUrl:g.terrariumUrl}));K.useEffect(()=>{n(!1)},[n]),K.useEffect(()=>()=>{m.current!==null&&(clearTimeout(m.current),m.current=null)},[]);const{heading:a,pitch:l,height:c,setHeading:u,setPitch:d,setHeight:h}=KB(g=>({heading:g.heading,pitch:g.pitch,height:g.height,setHeading:g.setHeading,setPitch:g.setPitch,setHeight:g.setHeight})),f=K.useMemo(()=>Math.round(e*10)/10,[e]),p=g=>{const y=Number.parseFloat(g.target.value);Number.isFinite(y)&&r(y)},m=K.useRef(null),_=(g,y=!1)=>{m.current!==null&&clearTimeout(m.current),m.current=window.setTimeout(()=>{window.dispatchEvent(new CustomEvent("map:set-camera-pose",{detail:{...g,animate:y}})),m.current=null},y?0:16)};return E.jsxs("div",{style:pEe,children:[E.jsx("div",{style:mEe,children:"Elevation Mode"}),E.jsxs("div",{style:yEe,children:[E.jsx("button",{type:"button",style:t?_x:OI,onClick:()=>n(!1),"aria-pressed":!t,children:"2D"}),E.jsx("button",{type:"button",style:t?OI:_x,onClick:()=>n(!0),"aria-pressed":t,children:"3D"})]}),E.jsxs("label",{style:{display:"flex",flexDirection:"column",gap:6},children:[E.jsxs("span",{style:Eg,children:[E.jsx("span",{children:"Elevation exaggeration"}),E.jsxs("span",{children:[f.toFixed(1),"x"]})]}),E.jsx("input",{type:"range",min:.5,max:8,step:.1,value:e,onChange:p,style:xg,disabled:!t})]}),E.jsxs("div",{style:{display:"flex",flexDirection:"column",gap:8,opacity:t?1:.55},children:[E.jsxs("label",{style:{display:"flex",flexDirection:"column",gap:6},children:[E.jsxs("span",{style:Eg,children:[E.jsx("span",{children:"Heading"}),E.jsxs("span",{children:[a.toFixed(0),""]})]}),E.jsx("input",{type:"range",min:0,max:360,step:1,value:a,onChange:g=>{const y=Number.parseFloat(g.target.value);Number.isFinite(y)&&(u(y),_({heading:y},!1))},style:xg,disabled:!t})]}),E.jsxs("label",{style:{display:"flex",flexDirection:"column",gap:6},children:[E.jsxs("span",{style:Eg,children:[E.jsx("span",{children:"Pitch / tilt"}),E.jsxs("span",{children:[l.toFixed(0),""]})]}),E.jsx("input",{type:"range",min:5,max:85,step:1,value:l,onChange:g=>{const y=Number.parseFloat(g.target.value);Number.isFinite(y)&&(d(y),_({pitch:y},!1))},style:xg,disabled:!t})]}),E.jsxs("label",{style:{display:"flex",flexDirection:"column",gap:6},children:[E.jsxs("span",{style:Eg,children:[E.jsx("span",{children:"Camera height"}),E.jsxs("span",{children:[Math.round(c),"m"]})]}),E.jsx("input",{type:"range",min:80,max:5e3,step:20,value:c,onChange:g=>{const y=Number.parseFloat(g.target.value);Number.isFinite(y)&&(h(y),_({height:y},!1))},style:xg,disabled:!t})]})]}),E.jsx("div",{style:dv,children:"Toggle 3D to tilt the map like onX. Use the slider to exaggerate hills and valleys for easier terrain reading."}),!i&&!s&&!o?E.jsx("div",{style:{...dv,color:"rgba(220, 38, 38, 0.78)"},children:"Optional: set `VITE_CESIUM_ION_TOKEN` or `VITE_CESIUM_TERRAIN_URL` to stream high-resolution terrain tiles."}):null,!i&&!s&&o?E.jsx("div",{style:{...dv,color:"rgba(34, 197, 94, 0.9)"},children:"Using global AWS Terrarium elevation tiles for realistic hills without a Cesium Ion token."}):null]})}async function vEe(t,e){const n=[`https://wayback-api.arcgis.com/wayback?location=${t},${e}`,`https://wayback-api.arcgis.com/wayback?lon=${t}&lat=${e}`];for(const r of n)try{const i=await fetch(r);if(!i.ok)continue;const s=await i.json(),a=(Array.isArray(s==null?void 0:s.releases)?s.releases:Array.isArray(s)?s:[]).map(l=>({releaseDate:(l.releaseDate||l.release_date||l.date||"").slice(0,10),releaseId:l.releaseId||l.release_id||l.id})).filter(l=>/^\d{4}-\d{2}-\d{2}$/.test(l.releaseDate));if(a.length>0)return a}catch{}return[{releaseDate:"2014-08-26"},{releaseDate:"2016-02-05"},{releaseDate:"2018-05-21"},{releaseDate:"2020-06-01"},{releaseDate:"2022-08-01"}]}function wEe(t){return t.releaseDate?`https://wayback.maptiles.arcgis.com/arcgis/rest/services/World_Imagery/MapServer/tile/{z}/{y}/{x}?release=${t.releaseDate}`:t.releaseId!==void 0?`https://wayback.maptiles.arcgis.com/arcgis/rest/services/World_Imagery/MapServer/tile/{z}/{y}/{x}?releaseID=${t.releaseId}`:"https://wayback.maptiles.arcgis.com/arcgis/rest/services/World_Imagery/MapServer/tile/{z}/{y}/{x}"}function xEe(t){return t.map(e=>({label:`NAIP ${e}`,year:e,arcgisImageUrl:"https://naip-usda.arcgis.com/arcgis/rest/services/NAIP/ImageServer",timeParam:`${e}-01-01,${e}-12-31`,type:"arcgis-image"}))}async function EEe(t){try{const e=`${t.replace(/\/+$/,"")}?f=json`,n=await fetch(e);if(!n.ok)return[];const r=await n.json();return(Array.isArray(r==null?void 0:r.services)?r.services:[]).map(s=>({name:s.name,type:s.type}))}catch{return[]}}async function SEe(){const t=["https://imagery.nationalmap.gov/arcgis/rest/services","https://nrcsgeoservices.sc.egov.usda.gov/arcgis/rest/services","https://imagery.pasda.psu.edu/arcgis/rest/services"],e=[/imagery/i,/ortho/i,/pamap/i,/naip/i,/doq/i],n=[];for(const r of t){const i=await EEe(r);for(const s of i){if(!e.some(c=>c.test(s.name)))continue;const o=s.name.match(/(19|20)\d{2}/),a=o?Number(o[0]):NaN;if(!Number.isFinite(a))continue;const l=`${r.replace(/\/+$/,"")}/${s.name}/${s.type}`;n.push({label:`${s.name.split("/").pop()||s.name}`,year:a,url:l,isImageServer:/ImageServer$/i.test(l)})}}return n}function bEe(){const{projectPath:t,pendingView:e,hasBoundary:n}=He(),r=ci(a=>a.addEntry);ci(a=>a.entries);const i=ci(a=>a.setEnabled),s=ci(a=>a.setSelected),o=K.useRef(!1);return K.useEffect(()=>{!t||o.current||(async()=>{var a,l,c,u;try{let d=e==null?void 0:e.lon,h=e==null?void 0:e.lat;if((!Number.isFinite(d)||!Number.isFinite(h))&&n)try{const v=await window.api.readTextFile(t,"data/property_boundary.geojson");if(v){const w=JSON.parse(v),x=(u=(c=(l=(a=w==null?void 0:w.features)==null?void 0:a[0])==null?void 0:l.geometry)==null?void 0:c.coordinates)==null?void 0:u[0];if(Array.isArray(x)&&x.length>0){const S=x.map(F=>F[0]),C=x.map(F=>F[1]),T=(Math.min(...S)+Math.max(...S))/2,P=(Math.min(...C)+Math.max(...C))/2;Number.isFinite(T)&&Number.isFinite(P)&&(d=T,h=P)}}}catch{}if(!Number.isFinite(d)||!Number.isFinite(h))return;const f=await vEe(d,h);for(const v of f){const w=wEe(v),x=Number((v.releaseDate||"").slice(0,4));Number.isFinite(x)&&r({id:`wayback_${v.releaseDate}`,label:`Wayback ${v.releaseDate}`,year:x,urlTemplate:w,attribution:"Esri Wayback"})}const p=[2013,2015,2017,2019,2021,2023];for(const v of xEe(p))r({id:`naip_${v.year}`,label:v.label,year:v.year,arcgisImageUrl:v.arcgisImageUrl,timeParam:v.timeParam,type:v.type,attribution:"USDA NAIP"});if(typeof d=="number"&&typeof h=="number"&&d>=-80.6&&d<=-74.5&&h>=39.6&&h<=42.3){const v=[2003,2004,2005,2006,2008,2010,2011,2012];for(const x of v)r({id:`naip_usgs_${x}`,label:`NAIP ${x} (USGS)`,year:x,arcgisImageUrl:"https://imagery.nationalmap.gov/arcgis/rest/services/USGSNAIPImagery/ImageServer",timeParam:`${x}-01-01,${x}-12-31`,type:"arcgis-image",attribution:"USGS NAIP"});const w=[1980,1981,1982,1983,1984,1985,1986,1987,1988,1989];for(const x of w)r({id:`nhap_${x}`,label:`NHAP ${x}`,year:x,arcgisImageUrl:"https://nrcsgeoservices.sc.egov.usda.gov/arcgis/rest/services/ortho_imagery/nhap_All/ImageServer",timeParam:`${x}-01-01,${x}-12-31`,type:"arcgis-image",attribution:"USDA NRCS NHAP"});try{if(!window.navigator.onLine)throw new Error("offline");const x=await SEe();for(const S of x){if(p.includes(S.year)||S.year>=1980&&S.year<=1989)continue;const T=S.label.toLowerCase().includes("armstrong");r({id:`pa_arcgis_${S.year}_${S.label.replace(/\W+/g,"_")}`,label:T?`${S.label} (Armstrong)`:S.label,year:S.year,type:S.isImageServer?"arcgis-image":"arcgis-map",arcgisImageUrl:S.isImageServer?S.url:void 0,arcgisMapUrl:S.isImageServer?void 0:S.url,attribution:"PA Imagery"})}}catch{}}const _=f.map(v=>Number((v.releaseDate||"").slice(0,4))).filter(v=>Number.isFinite(v)),g=Math.max(..._.length?_:[0],...p);i(!0);const y=f.map(v=>({id:`wayback_${v.releaseDate}`,year:Number((v.releaseDate||"").slice(0,4))})).filter(v=>v.year===g)[0];s(y?y.id:`naip_${g}`)}finally{o.current=!0}})()},[t]),null}function CEe(){const{createNewProject:t,openExistingProject:e,loading:n}=He();return E.jsxs("div",{style:{display:"grid",placeItems:"center",height:"100vh",gap:16,fontFamily:"system-ui, -apple-system, Segoe UI, Roboto, sans-serif"},children:[E.jsx("h1",{children:"True Map"}),E.jsxs("div",{style:{display:"flex",gap:12},children:[E.jsx("button",{onClick:()=>void t(),disabled:n,children:"Create New Project"}),E.jsx("button",{onClick:()=>void e(),disabled:n,children:"Open Existing Project"})]})]})}function TEe(){const{projectPath:t,pendingView:e,setPendingView:n}=He();return t?E.jsxs(E.Fragment,{children:[E.jsx(ZB,{}),E.jsx(t1e,{}),E.jsx(bEe,{}),E.jsx(i1e,{}),E.jsx(dH,{useExternalToggle:!0}),pO.filter(r=>r!=="trails"&&r!=="hunts"&&r!=="animal_sightings"&&r!=="animal_paths"&&r!=="animal_sign"&&r!=="harvests").map(r=>E.jsx(c1e,{layerId:r},r)),E.jsx(Hwe,{}),E.jsx(Xwe,{}),E.jsx(qwe,{}),E.jsx(txe,{}),E.jsx(Qwe,{}),E.jsx(rxe,{}),E.jsx(Jxe,{}),E.jsx(e1e,{}),E.jsxs("div",{style:{position:"fixed",top:12,right:12,display:"flex",flexDirection:"column",gap:8,alignItems:"stretch",zIndex:1e3,width:260},children:[E.jsx(oEe,{}),E.jsx(n1e,{}),E.jsx(_Ee,{}),E.jsx(Kwe,{}),E.jsx(sEe,{}),E.jsx(ixe,{})]}),E.jsx(l1e,{}),E.jsx(gEe,{}),E.jsx(X1e,{}),E.jsx(eEe,{}),E.jsx(tEe,{}),e?E.jsx(PEe,{target:e,clear:()=>n(null)}):null]}):E.jsx(CEe,{})}function PEe({target:t,clear:e}){return K.useEffect(()=>{const n=window.setTimeout(()=>{Xm()&&window.dispatchEvent(new CustomEvent("map:jump-to",{detail:t}))},100),r=window.setTimeout(()=>{e()},2e3);return()=>{window.clearTimeout(n),window.clearTimeout(r)}},[t,e]),null}function REe(){return E.jsx(TEe,{})}const $I=document.getElementById("root");$I&&KF($I).render(E.jsx(VI.StrictMode,{children:E.jsx(REe,{})}));export{Qm as P,pw as a,e0 as b,RT as c,AEe as d,FEe as e,Q4 as g};
